{"config":{"lang":["en","vi"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"LegoCity Documentation","text":"<p>Welcome to LegoCity \u2014 a Smart City Builder platform for modern, map-based urban dashboards.</p>"},{"location":"#what-is-legocity","title":"What is LegoCity?","text":"<p>LegoCity is a reusable and configurable platform for building smart city dashboards and applications on top of FIWARE / NGSI-LD standards and modern web technologies.</p> <p>Key features</p> <ul> <li>\ud83c\udfd9\ufe0f FIWARE / NGSI-LD integration \u2013 standards-based context and entity management</li> <li>\ud83d\uddfa\ufe0f Interactive maps \u2013 Mapbox GL JS with configurable layers and styles</li> <li>\ud83d\udcca Configurable dashboards \u2013 layouts and blocks managed via PayloadCMS</li> <li>\ud83d\udd0c Extensible architecture \u2013 plugins, proxy services, and custom integrations</li> <li>\ud83e\udd16 Optional AI helpers \u2013 content assistance in the Payload admin (OpenAI / Anthropic / OpenRouter)</li> <li>\ud83c\udf0d Multi-tenant ready \u2013 reusable for different cities and scenarios</li> </ul>"},{"location":"#quick-navigation","title":"Quick navigation","text":""},{"location":"#new-to-legocity","title":"\ud83d\ude80 New to LegoCity?","text":"<p>Start here if you are seeing LegoCity for the first time.</p> <ul> <li>\ud83d\ude80 Getting started</li> </ul> <p>Understand the core concepts and run LegoCity for the first time.</p> <p>Start here</p> <ul> <li>\u2b07\ufe0f Installation</li> </ul> <p>Choose an installation method: local, Docker, or development environment.</p> <p>Install LegoCity</p> <ul> <li>\ud83c\udf93 User guide</li> </ul> <p>Learn how to use maps, layers, dashboards, and entities as an end-user.</p> <p>Read user guide</p> <ul> <li>\u2699\ufe0f Configuration</li> </ul> <p>Configure data sources, Mapbox, brokers, APIs, and optional AI integration.</p> <p>Configure LegoCity</p>"},{"location":"#for-developers","title":"\ud83d\udee0\ufe0f For developers","text":"<p>Use these sections if you want to extend or contribute to LegoCity.</p> <ul> <li>\ud83d\udcbb Development guide</li> </ul> <p>Set up a dev environment, create blocks, and extend the platform.</p> <p>Start developing</p> <ul> <li>\ud83e\udd16 AI integration</li> </ul> <p>Configure the Payload AI plugin and OpenRouter-based models.</p> <p>Configure AI</p> <ul> <li>\u2601\ufe0f Deployment</li> </ul> <p>Deploy LegoCity using Docker, AWS, VMs, Cloudflare, or Coolify.</p> <p>Deployment options</p> <ul> <li>\ud83d\udcda Reference</li> </ul> <p>Troubleshooting, API details, and technical reference material.</p> <p>Browse reference</p>"},{"location":"#quick-start","title":"Quick start","text":"<pre><code># Clone repository\ngit clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity/dashboard\n\n# Install dependencies\npnpm install\n\n# Configure environment\ncp .env.example .env\n# Edit .env with your settings\n\n# Start development server\npnpm dev\n</code></pre> <p>Access at: http://localhost:3000</p> <p>\ud83d\udc49 See the Quick Start Guide for detailed instructions.</p>"},{"location":"#architecture-overview","title":"Architecture Overview","text":"<p>LegoCity uses a three-layer architecture:</p> <ol> <li>Context &amp; Data Layer - FIWARE/NGSI-LD brokers with standardized city data</li> <li>Content &amp; UI Layer - PayloadCMS + Next.js for configurable dashboards</li> <li>Integration Layer - API proxies, AI helpers, external services</li> </ol> <p>\ud83d\udc49 See the Architecture Guide for detailed diagrams and explanations.</p>"},{"location":"#community-support","title":"Community &amp; Support","text":""},{"location":"#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcd6 Documentation: You're reading it!</li> <li>\ud83d\udcac Discussions: GitHub Discussions</li> <li>\ud83d\udc1b Issues: GitHub Issues</li> <li>\ud83d\udce7 Contact: CTU-SematX Team</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>We welcome contributions! See:</p> <ul> <li>Development Guide - How to contribute</li> <li>CONTRIBUTING.md - Guidelines</li> <li>CODE_OF_CONDUCT.md - Community standards</li> </ul>"},{"location":"#resources","title":"Resources","text":"<ul> <li>Repository: github.com/CTU-SematX/LegoCity</li> <li>Demo: [Coming soon]</li> <li>License: Check repository for license details</li> </ul>"},{"location":"#whats-next","title":"What's Next?","text":"<p>Choose your path:</p> I'm NewI Want to Use ItI Want to BuildI Want to Deploy <p>Start Here:</p> <ol> <li>Read Getting Started</li> <li>Follow Quick Start</li> <li>Explore User Guide</li> </ol> <p>Set Up Your City:</p> <ol> <li>Install LegoCity</li> <li>Configure Data Sources</li> <li>Create Dashboard Pages</li> </ol> <p>Start Developing:</p> <ol> <li>Development Environment</li> <li>Development Guide</li> <li>Create Custom Blocks</li> </ol> <p>Deploy to Production:</p> <ol> <li>Deployment Overview</li> <li>Choose deployment method</li> <li>Operations Guide</li> </ol> <p>Ready to begin? Head to the Getting Started Guide \u2192</p>"},{"location":"Open_Source_Checklist/","title":"The Open Source Checklist","text":""},{"location":"Open_Source_Checklist/#about","title":"About","text":"<p>It's easy to overlook important tasks when releasing and maintaining an open source project. This checklist helps ensure your project follows best practices for health, development, and security.</p> <p>Use this checklist as a discussion starter for your team and a foundation for continuous improvement.</p>"},{"location":"Open_Source_Checklist/#archiving-and-deprecating-a-project","title":"Archiving and Deprecating a Project","text":"<ul> <li>Should use the platform's \"Archival\" function. This way, it becomes read-only, including the issues board, and is flagged as inactive.</li> <li>Should state in the README that the project is no longer maintained.</li> <li>Should be archived if there are no maintainers.</li> </ul>"},{"location":"Open_Source_Checklist/#documentation","title":"Documentation","text":"<ul> <li> <p>Must ensure the project includes standard Community Health Files (CHANGELOG, CONTRIBUTING, CODE_OF_CONDUCT, etc.).   See the README.md Template Files section for a complete list.</p> </li> <li> <p>Should include usage documentation and architecture descriptions relevant to the project.</p> </li> </ul>"},{"location":"Open_Source_Checklist/#legal-and-licensing","title":"Legal and Licensing","text":"<ul> <li>Must ensure the project's license doesn't conflict with third-party licenses.</li> <li>License declarations must follow the REUSE licensing specification, ensuring all materials have clear copyright information.</li> </ul>"},{"location":"Open_Source_Checklist/#naming-and-trademarks-check","title":"Naming and Trademarks Check","text":"<ul> <li>Should ensure that the project name does not conflict with an existing project or infringe on trademarks.</li> <li>Conduct a general search engine check for the proposed project name.</li> <li>Perform a Trademark Search.</li> </ul> <p>Note: It might be perfectly acceptable to use a name reminiscent of an existing trademark - if the existing trademark is used for other services/areas and is not recognized as a well-known trademark.</p>"},{"location":"Open_Source_Checklist/#people-maintenance","title":"People &amp; Maintenance","text":"<ul> <li>Must ensure maintainers have education or experience with open source. For example, reading guides at https://opensource.guide.</li> <li>Must ensure maintainers have a plan for handling merge/pull requests (code reviews, etc.).</li> <li>Must ensure maintainers have a plan for community engagement (responding to issues, reviewing pull requests).</li> <li>Must ensure someone is responsible for security issues.</li> <li> <p>Must include a <code>Maintainer</code> section in every project README (team, individual, or role).</p> </li> <li> <p>Should establish a release plan with clear announcement and promotion strategies.</p> </li> <li>Should use a CODEOWNERS file for granular maintenance descriptions (complementing the README's general Maintainer section).</li> </ul>"},{"location":"Open_Source_Checklist/#project-quality","title":"Project Quality","text":"<ul> <li>Must verify that the project has undergone a code review.</li> <li>Should discuss and establish the project's testing goals and ambitions.</li> <li>Should make it easy to use the project - documentation, examples, pre-built releases, etc.</li> </ul>"},{"location":"Open_Source_Checklist/#release-and-versioning","title":"Release and Versioning","text":"<ul> <li>Should use Semantic Versioning 2.0.0 and release tags.</li> </ul>"},{"location":"Open_Source_Checklist/#security","title":"Security","text":"<p>This part of the checklist is based on the Open Source Security Foundation (OpenSSF) guide for more secure open source development, version: 2023-06-14, (and companion post).</p>"},{"location":"Open_Source_Checklist/#general","title":"General","text":"<ul> <li>Must use two-factor authentication (2FA) or multifactor authentication (MFA) to make it harder for account takeovers.</li> <li>Must limit merge and push rights to specific branches.</li> <li>Must have enabled branch protection.</li> <li> <p>Must have a practice of signed commits.</p> </li> <li> <p>Should have a basic knowledge of committers and maintainers, and must do a periodic review of those.</p> </li> <li>Should have automated testing and test coverage practices, including tests for negative cases, to detect bugs and secure the project.</li> </ul>"},{"location":"Open_Source_Checklist/#contribution","title":"Contribution","text":"<ul> <li>Should have a practice of code reviews.</li> <li>Should have good readability and scope requirements to ensure new PRs are not obfuscated, and use of opaque binaries is minimized.</li> </ul>"},{"location":"Open_Source_Checklist/#dependencies-and-vulnerabilities-detection","title":"Dependencies and Vulnerabilities Detection","text":"<ul> <li>Must use SCA-tools in the CI pipeline to detect vulnerabilities and license incompatibilities.</li> <li>Must use linter tools in the CI pipeline to detect vulnerabilities and bad development practices.</li> <li>Must use secret scanning tools to detect secrets (passwords, logs, tokens).</li> <li>Must use automated tooling to monitor dependency updates for critical vulnerabilities.</li> <li> <p>Must have maintenance to quickly handle updating vulnerabilities.</p> </li> <li> <p>Should use SAST-tools in the CI pipeline to detect potential vulnerabilities and bad software practices.</p> </li> <li>Should evaluate the health of every new direct project dependency that is added to the project.</li> <li>Should prefer using package managers (at the system, language, and container level) for automatic and consistent dependency updates.</li> </ul>"},{"location":"Open_Source_Checklist/#publishing","title":"Publishing","text":"<ul> <li>Must produce an SBOM (Software Bill of Materials) for the project so that end-users and systems can verify vulnerabilities and license incompatibilities.</li> <li> <p>Must limit software publishing rights of artifacts.</p> </li> <li> <p>Should sign any project releases.</p> </li> <li>Should make it easy for end-users to upgrade to new releases. Use semantic versioning, support stable APIs, and flag deprecation early.</li> </ul>"},{"location":"Open_Source_Checklist/#policy","title":"Policy","text":"<ul> <li>Must have a security policy in place - it should contain information about where to report non-disclosure vulnerabilities and the process regarding the report.</li> </ul> <p>Secure software practices and tooling from OpenSSF and OWASP:</p>"},{"location":"Open_Source_Checklist/#tooling","title":"Tooling","text":"<ul> <li>OpenSSF guide to security tools.</li> <li>OWASP Application Security Tools</li> <li>OpenSSF Scorecards for repository security</li> </ul>"},{"location":"Open_Source_Checklist/#guides","title":"Guides","text":"<ul> <li>OpenSSF's Concise Guide for Evaluating Open Source Software</li> <li>CNCF Security TAG Software Supply Chain Best Practices guide.</li> <li>OWASP Cheatsheets.</li> <li>OWASP Software Developer Guide.</li> <li>Signing artifacts in the supply chain - OpenSSF sigstore project.</li> <li>OWASP Application Security Verification Standard - ASVS.</li> <li>Supply-chain Levels for Software Artifacts - (SLSA).</li> </ul>"},{"location":"Open_Source_Checklist/#workflows","title":"Workflows","text":"<ul> <li>May discuss your GitHub workflow - a brief summary and suggestion can be found in CONTRIBUTING - Pull Request Lifecycle</li> </ul>"},{"location":"Open_Source_Checklist/#specifications-and-standards-to-follow","title":"Specifications and Standards to Follow","text":"<p>The following will help your Open Source Project to be collaborative, reusable, accessible, and up-to-date.</p> <ul> <li> <p>REUSE License specification</p> </li> <li> <p>Ensures clear and standardized license compliance across the project.</p> </li> <li> <p>Conventional Commits format</p> </li> <li> <p>Provides a clear and structured project history through standardized commit messages.</p> </li> <li> <p>Keep-A-Changelog format</p> </li> <li> <p>Maintains a clear and user-friendly release history.</p> </li> <li> <p>Semantic Versioning 2.0.0</p> </li> <li> <p>Provides consistent version numbering for releases.</p> </li> <li> <p>Contributor Covenant guidelines</p> </li> <li> <p>Establishes a social contract for respectful and inclusive collaboration.</p> </li> <li> <p>OpenSSF Scorecard</p> </li> <li> <p>Helps assess and improve the security health of our project.</p> </li> <li> <p>PublicCode.yml</p> </li> <li> <p>Facilitates easy metadata indexing for better discoverability of our project.</p> </li> <li> <p>Standard for Public Code</p> </li> <li>Ensures the project meets criteria for public code quality and sustainability.</li> </ul>"},{"location":"about-sematx/","title":"About SematX","text":"<p>SematX is a comprehensive smart city platform that provides the infrastructure and tools needed to build, deploy, and manage IoT applications at scale. Built on open standards and modern technologies, SematX enables organizations to create data-driven smart city solutions.</p>"},{"location":"about-sematx/#what-is-sematx","title":"What is SematX?","text":"<p>SematX is more than just a platform\u2014it's an ecosystem that brings together:</p> <ul> <li>Standards-based architecture: Built on FIWARE and NGSI-LD standards for interoperability</li> <li>Modern developer tools: Intuitive dashboard and APIs for rapid development</li> <li>Scalable infrastructure: Cloud-native design that grows with your needs</li> <li>Open source foundation: Community-driven development with enterprise support</li> </ul>"},{"location":"about-sematx/#our-vision","title":"Our Vision","text":"<p>We envision a world where cities and organizations can easily harness the power of IoT data to improve services, optimize operations, and enhance quality of life. SematX makes this vision achievable by removing the complexity traditionally associated with IoT platforms.</p>"},{"location":"about-sematx/#the-sematx-ecosystem","title":"The SematX Ecosystem","text":"<p>The SematX ecosystem consists of three main components working together:</p> <p></p>"},{"location":"about-sematx/#1-orion-ld-context-broker","title":"1. Orion-LD Context Broker","text":"<p>The heart of the SematX platform is the Orion-LD Context Broker - an implementation of the FIWARE NGSI-LD standard. This component:</p> <ul> <li>Stores and manages all IoT entity data</li> <li>Provides powerful query and subscription APIs</li> <li>Ensures data persistence and reliability</li> <li>Handles temporal data for historical analysis</li> </ul>"},{"location":"about-sematx/#2-orion-nginx-gateway","title":"2. Orion Nginx Gateway","text":"<p>The Orion Nginx Gateway acts as the intelligent front door to your data:</p> <ul> <li>Provides secure API access with JWT authentication</li> <li>Routes requests to the appropriate backend services</li> <li>Enforces access control and rate limiting</li> <li>Delivers high-performance request handling</li> </ul>"},{"location":"about-sematx/#3-lego-dashboard","title":"3. Lego Dashboard","text":"<p>The Lego Dashboard is your visual interface to the SematX platform:</p> <ul> <li>Drag-and-drop dashboard builder for visualizing data</li> <li>Entity management interface for CRUD operations</li> <li>API key management for secure integrations</li> <li>Real-time data subscriptions and webhooks</li> <li>User and access control management</li> </ul>"},{"location":"about-sematx/#why-choose-sematx","title":"Why Choose SematX?","text":""},{"location":"about-sematx/#standards-based-architecture","title":"Standards-Based Architecture","text":"<p>SematX is built on the NGSI-LD standard, ensuring your data is portable and your integrations are future-proof. This means:</p> <ul> <li>No vendor lock-in</li> <li>Easy integration with other FIWARE-compatible systems</li> <li>Industry-proven data models</li> <li>Long-term sustainability</li> </ul>"},{"location":"about-sematx/#developer-friendly","title":"Developer-Friendly","text":"<p>We've designed SematX with developers in mind:</p> <ul> <li>RESTful APIs that are intuitive and well-documented</li> <li>SDKs and client libraries in multiple languages</li> <li>Clear examples and tutorials</li> <li>Active community support</li> </ul>"},{"location":"about-sematx/#production-ready","title":"Production-Ready","text":"<p>SematX is built for real-world deployments:</p> <ul> <li>Battle-tested components used in production systems</li> <li>Comprehensive security features</li> <li>Scalable architecture from prototype to enterprise</li> <li>Professional support options available</li> </ul>"},{"location":"about-sematx/#open-source","title":"Open Source","text":"<p>SematX is open source, which means:</p> <ul> <li>Full transparency into how the platform works</li> <li>Ability to customize for your specific needs</li> <li>Community-driven improvements and features</li> <li>No licensing fees for the core platform</li> </ul>"},{"location":"about-sematx/#use-cases","title":"Use Cases","text":"<p>SematX powers a wide range of smart city and IoT applications:</p> <ul> <li>Environmental Monitoring: Track air quality, noise levels, and weather conditions</li> <li>Smart Infrastructure: Manage street lights, traffic signals, and public facilities</li> <li>Urban Mobility: Monitor parking, traffic flow, and public transportation</li> <li>Public Safety: Integrate emergency response systems and monitoring</li> <li>Resource Management: Optimize water, energy, and waste management</li> </ul>"},{"location":"about-sematx/#getting-started","title":"Getting Started","text":"<p>Ready to build with SematX? Here's how to get started:</p> <ol> <li>Start a Local Server: Get SematX running on your local machine in minutes</li> <li>Bring Your Own Server: Deploy SematX to your own infrastructure</li> <li>Explore Core Concepts: Deep dive into how SematX works</li> </ol>"},{"location":"about-sematx/#community-and-support","title":"Community and Support","text":"<ul> <li>GitHub: github.com/CTU-SematX</li> <li>Documentation: github.com/CTU-SematX/Lego-doc</li> <li>Issues: Report bugs and request features on GitHub</li> <li>Discussions: Join the conversation in GitHub Discussions</li> </ul> <p>We're continuously improving SematX. Here's what's coming:</p>"},{"location":"about-sematx/#q1-2025","title":"Q1 2025","text":"<ul> <li>Enhanced dashboard widgets and customization options</li> <li>Advanced data analytics and visualization tools</li> <li>Improved API documentation with interactive examples</li> </ul>"},{"location":"about-sematx/#q2-2025","title":"Q2 2025","text":"<ul> <li>Multi-tenancy support for enterprise deployments</li> <li>Advanced alerting and notification system</li> <li>Integration marketplace for common IoT devices</li> </ul>"},{"location":"about-sematx/#q3-2025","title":"Q3 2025","text":"<ul> <li>Machine learning integration for predictive analytics</li> <li>Mobile application for dashboard access</li> <li>Advanced geospatial queries and mapping</li> </ul>"},{"location":"about-sematx/#q4-2025","title":"Q4 2025","text":"<ul> <li>Edge computing capabilities for distributed deployments</li> <li>Advanced security features and compliance tools</li> <li>Performance optimizations and scalability improvements</li> </ul> <p>Want to contribute to the roadmap? Join the discussion and share your ideas!</p>"},{"location":"about-sematx/ecosystem/","title":"Understanding the SematX Ecosystem","text":"<p>This page provides a detailed explanation of how the different components of SematX work together to create a complete smart city platform.</p>"},{"location":"about-sematx/ecosystem/#architecture-overview","title":"Architecture Overview","text":"<p>The SematX platform follows a layered architecture that separates concerns and provides flexibility:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Users &amp; Devices                    \u2502\n\u2502              (Web, Mobile, IoT Devices)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n                      \u2502 HTTPS/JWT\n                      \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Orion Nginx Gateway                     \u2502\n\u2502         (Authentication &amp; API Gateway)               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502                       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Lego Dashboard    \u2502  \u2502   Orion-LD       \u2502\n\u2502  (PayloadCMS)      \u2502  \u2502 Context Broker   \u2502\n\u2502  - UI/Dashboard    \u2502  \u2502  - Entity Store  \u2502\n\u2502  - User Mgmt       \u2502  \u2502  - NGSI-LD API   \u2502\n\u2502  - API Keys        \u2502  \u2502  - Subscriptions \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502                      \u2502\n          \u2502        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502        \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    MongoDB Database         \u2502\n\u2502  - Dashboard Data           \u2502\n\u2502  - Entity Data (Orion)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"about-sematx/ecosystem/#component-deep-dive","title":"Component Deep Dive","text":""},{"location":"about-sematx/ecosystem/#orion-ld-context-broker","title":"Orion-LD Context Broker","text":"<p>Purpose: The central data repository and NGSI-LD API server.</p> <p>Key Responsibilities: - Store and manage entity data following NGSI-LD standard - Provide query API for retrieving entity information - Handle entity subscriptions for real-time notifications - Maintain entity relationships and properties - Support temporal queries for historical data</p> <p>Technology Stack: - Written in C++ for high performance - Uses MongoDB for data persistence - Implements NGSI-LD v1.6.1 specification - Supports GeoJSON for geospatial queries</p> <p>API Endpoints: - <code>POST /ngsi-ld/v1/entities</code> - Create entities - <code>GET /ngsi-ld/v1/entities</code> - Query entities - <code>PATCH /ngsi-ld/v1/entities/{entityId}/attrs</code> - Update entity attributes - <code>DELETE /ngsi-ld/v1/entities/{entityId}</code> - Delete entities - <code>POST /ngsi-ld/v1/subscriptions</code> - Create subscriptions</p> <p>Example Entity: <pre><code>{\n  \"id\": \"urn:ngsi-ld:AirQualityObserved:001\",\n  \"type\": \"AirQualityObserved\",\n  \"dateObserved\": {\n    \"type\": \"Property\",\n    \"value\": {\n      \"@type\": \"DateTime\",\n      \"@value\": \"2025-12-02T10:30:00Z\"\n    }\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"PM25\": {\n    \"type\": \"Property\",\n    \"value\": 35,\n    \"unitCode\": \"GQ\"\n  },\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 28.5,\n    \"unitCode\": \"CEL\"\n  }\n}\n</code></pre></p>"},{"location":"about-sematx/ecosystem/#orion-nginx-gateway","title":"Orion Nginx Gateway","text":"<p>Purpose: Secure, high-performance API gateway and authentication layer.</p> <p>Key Responsibilities: - Authenticate requests using JWT tokens - Route API calls to appropriate backend services - Enforce rate limiting to prevent abuse - Handle CORS for web applications - Provide SSL/TLS termination - Log and monitor API usage</p> <p>Technology Stack: - Nginx for high-performance request handling - Lua scripts for custom authentication logic - JWT validation using public keys - Redis for rate limiting and caching</p> <p>Security Features:</p> <ol> <li> <p>JWT Authentication: Every API request must include a valid JWT token in the <code>Authorization</code> header:    <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n</code></pre></p> </li> <li> <p>API Key Validation: Tokens are issued by the Lego Dashboard and contain:</p> </li> <li>User ID</li> <li>Permissions/scopes</li> <li>Expiration time</li> <li> <p>Rate limit tier</p> </li> <li> <p>Rate Limiting: Prevents API abuse with configurable limits:</p> </li> <li>Default: 100 requests per minute per API key</li> <li> <p>Custom tiers available for different use cases</p> </li> <li> <p>CORS Configuration: Allows web applications to access the API:    <pre><code>add_header 'Access-Control-Allow-Origin' '*';\nadd_header 'Access-Control-Allow-Methods' 'GET, POST, PATCH, DELETE, OPTIONS';\nadd_header 'Access-Control-Allow-Headers' 'Authorization, Content-Type, NGSILD-Tenant';\n</code></pre></p> </li> </ol> <p>Routing Logic:</p> <pre><code># Dashboard API routes\nlocation /api/ {\n    proxy_pass http://dashboard:3000;\n}\n\n# NGSI-LD API routes (requires JWT)\nlocation /ngsi-ld/ {\n    access_by_lua_file /etc/nginx/lua/jwt_verify.lua;\n    proxy_pass http://orion:1026;\n}\n\n# Health check endpoint (no auth required)\nlocation /health {\n    return 200 \"OK\";\n}\n</code></pre>"},{"location":"about-sematx/ecosystem/#lego-dashboard","title":"Lego Dashboard","text":"<p>Purpose: User-friendly web interface for managing and visualizing IoT data.</p> <p>Key Responsibilities: - Provide visual dashboard builder with drag-and-drop widgets - Manage users, teams, and access control - Generate and manage API keys - Create and manage entity templates - Configure data subscriptions and webhooks - Display real-time data visualization</p> <p>Technology Stack: - Built on PayloadCMS (Node.js/React) - MongoDB for dashboard configuration storage - Next.js for server-side rendering - React for interactive UI components - TypeScript for type safety</p> <p>Core Features:</p> <ol> <li>Dashboard Builder:</li> <li>Drag-and-drop card creation</li> <li>Multiple card types: maps, charts, tables, metrics</li> <li>Real-time data updates via subscriptions</li> <li> <p>Responsive layouts for mobile and desktop</p> </li> <li> <p>Entity Management:</p> </li> <li>Browse and search entities</li> <li>Create entities with form builder</li> <li>Update entity attributes in real-time</li> <li>Delete and bulk operations</li> <li> <p>Import/export entities as JSON</p> </li> <li> <p>API Key Management:</p> </li> <li>Generate JWT tokens for API access</li> <li>Set permissions and rate limits per key</li> <li>Revoke keys instantly</li> <li> <p>Monitor API usage per key</p> </li> <li> <p>Access Control:</p> </li> <li>Role-based access control (RBAC)</li> <li>Organization and team management</li> <li>Fine-grained permissions per entity type</li> <li> <p>Audit logs for security compliance</p> </li> <li> <p>Subscriptions:</p> </li> <li>Create NGSI-LD subscriptions</li> <li>Configure webhook endpoints</li> <li>Filter entities by type and properties</li> <li>Monitor subscription status</li> </ol>"},{"location":"about-sematx/ecosystem/#data-flow-examples","title":"Data Flow Examples","text":""},{"location":"about-sematx/ecosystem/#example-1-iot-device-sends-data","title":"Example 1: IoT Device Sends Data","text":"<ol> <li>Device generates sensor reading (temperature: 28.5\u00b0C)</li> <li>Device sends HTTP POST to <code>/ngsi-ld/v1/entities/{id}/attrs</code> with JWT token</li> <li>Nginx Gateway validates JWT and checks rate limits</li> <li>Nginx Gateway forwards request to Orion-LD</li> <li>Orion-LD updates entity in MongoDB</li> <li>Orion-LD triggers active subscriptions</li> <li>Orion-LD sends notifications to Lego Dashboard webhooks</li> <li>Lego Dashboard updates real-time charts on user dashboards</li> </ol>"},{"location":"about-sematx/ecosystem/#example-2-user-creates-dashboard-card","title":"Example 2: User Creates Dashboard Card","text":"<ol> <li>User logs into Lego Dashboard web UI</li> <li>User navigates to dashboard builder</li> <li>User drags a \"Temperature Chart\" card onto canvas</li> <li>User configures card to show entity <code>urn:ngsi-ld:Sensor:001</code></li> <li>Dashboard saves card configuration to MongoDB</li> <li>Dashboard creates NGSI-LD subscription in Orion-LD</li> <li>Orion-LD notifies Dashboard when entity updates</li> <li>Dashboard pushes update to user's browser via WebSocket</li> </ol>"},{"location":"about-sematx/ecosystem/#example-3-third-party-app-queries-data","title":"Example 3: Third-Party App Queries Data","text":"<ol> <li>Developer obtains API key from Lego Dashboard</li> <li>App makes GET request to <code>/ngsi-ld/v1/entities?type=Sensor</code></li> <li>Nginx Gateway validates JWT token</li> <li>Nginx Gateway checks rate limits (99/100 used)</li> <li>Nginx Gateway forwards query to Orion-LD</li> <li>Orion-LD queries MongoDB for matching entities</li> <li>Orion-LD returns JSON response</li> <li>Nginx Gateway forwards response to App</li> <li>App displays sensor data to end user</li> </ol>"},{"location":"about-sematx/ecosystem/#next-steps","title":"Next Steps","text":"<ul> <li>Start a Local Server</li> <li>Deploy to Production</li> <li>Learn Core Concepts</li> </ul>"},{"location":"about-sematx/tools/","title":"SematX Tools and Technologies","text":"<p>This page provides an overview of the key technologies and tools that power the SematX platform.</p>"},{"location":"about-sematx/tools/#core-technologies","title":"Core Technologies","text":""},{"location":"about-sematx/tools/#ngsi-ld-standard","title":"NGSI-LD Standard","text":"<p>What is NGSI-LD?</p> <p>NGSI-LD (Next Generation Service Interface - Linked Data) is an information model and API specification developed by ETSI (European Telecommunications Standards Institute) for managing context information in IoT and smart city applications.</p> <p>Key Features: - Standardized entity representation - Property-based data model - Relationship management between entities - Geospatial query support - Temporal data handling - Subscription mechanism for real-time notifications</p> <p>Why NGSI-LD? - Interoperability: Standard data format across systems - Semantic Web: Built on JSON-LD for linked data - Future-proof: Supported by FIWARE and major IoT platforms - Flexible: Supports any entity type and property</p> <p>Example Entity in NGSI-LD: <pre><code>{\n  \"@context\": [\n    \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n  ],\n  \"id\": \"urn:ngsi-ld:Building:001\",\n  \"type\": \"Building\",\n  \"address\": {\n    \"type\": \"Property\",\n    \"value\": {\n      \"streetAddress\": \"123 Main Street\",\n      \"addressLocality\": \"Can Tho\",\n      \"addressCountry\": \"Vietnam\"\n    }\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"hasFloor\": {\n    \"type\": \"Relationship\",\n    \"object\": \"urn:ngsi-ld:Floor:001\"\n  }\n}\n</code></pre></p>"},{"location":"about-sematx/tools/#fiware-orion-ld","title":"FIWARE Orion-LD","text":"<p>What is FIWARE?</p> <p>FIWARE is an open-source platform providing a curated framework of components and standards for building smart solutions. Orion-LD is the next-generation context broker component of FIWARE.</p> <p>Orion-LD Features: - Full NGSI-LD v1.6.1 compliance - High-performance C++ implementation - MongoDB backend for persistence - Temporal API for historical queries - Distributed tracing support - Horizontal scalability</p> <p>Performance Characteristics: - Handles 1000+ requests/second per instance - Sub-10ms latency for simple queries - Supports millions of entities - Real-time subscriptions with &lt;100ms notification delay</p> <p>Configuration Options: <pre><code># Key Orion-LD startup parameters\n-dbhost mongodb:27017          # MongoDB connection\n-logLevel DEBUG                # Logging verbosity\n-forwarding                    # Enable federation\n-experimental                  # Enable experimental features\n-corsOrigin __ALL              # CORS configuration\n</code></pre></p> <p>When to use Orion-LD: - Need standards-compliant context broker - Building multi-vendor IoT systems - Require geospatial queries - Need real-time data subscriptions - Want open-source solution</p>"},{"location":"about-sematx/tools/#payloadcms","title":"PayloadCMS","text":"<p>What is PayloadCMS?</p> <p>Payload is a headless CMS and application framework built with Node.js, React, and TypeScript. In SematX, we use Payload as the foundation for the Lego Dashboard.</p> <p>Why PayloadCMS? - Type-safe: Full TypeScript support - Flexible: Customizable collections and fields - Modern: React-based admin UI - API-first: Auto-generated REST and GraphQL APIs - Extensible: Plugin architecture for custom functionality - Open Source: Active community and development</p> <p>Key Features Used in SematX: - Collection-based data modeling - Role-based access control (RBAC) - Custom React components for dashboard cards - Hooks for business logic - File uploads for assets - Authentication and user management</p> <p>Example Collection Definition: <pre><code>export const Cards: CollectionConfig = {\n  slug: 'cards',\n  admin: {\n    useAsTitle: 'name',\n  },\n  access: {\n    read: authenticated,\n    create: authenticated,\n    update: authenticated,\n    delete: authenticated,\n  },\n  fields: [\n    {\n      name: 'name',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'type',\n      type: 'select',\n      options: ['map', 'chart', 'table', 'metric'],\n      required: true,\n    },\n    {\n      name: 'entityType',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'configuration',\n      type: 'json',\n    },\n  ],\n}\n</code></pre></p>"},{"location":"about-sematx/tools/#mongodb","title":"MongoDB","text":"<p>Role in SematX:</p> <p>MongoDB serves as the persistence layer for both Orion-LD and the Lego Dashboard, storing: - Entity data (Orion-LD) - Dashboard configurations - User accounts and permissions - API keys and access tokens - Subscription definitions</p> <p>Why MongoDB? - Schema-less: Flexible document structure for NGSI-LD entities - Performance: Fast read/write operations - Scalability: Replica sets and sharding - Geospatial: Native support for GeoJSON queries - Aggregation: Powerful data analysis pipeline</p> <p>Deployment Patterns:</p> <ol> <li>Development: Single MongoDB instance</li> <li>Production: Replica set (3+ nodes) for high availability</li> <li>Large Scale: Sharded cluster for horizontal scaling</li> </ol> <p>Backup Strategy: <pre><code># Regular backup using mongodump\nmongodump --uri=\"mongodb://localhost:27017/orion\" --out=/backup/\n\n# Point-in-time recovery with replica sets\n# Use oplog for continuous backup\n</code></pre></p>"},{"location":"about-sematx/tools/#nginx","title":"Nginx","text":"<p>Role in SematX:</p> <p>Nginx serves as the API gateway and reverse proxy, handling: - SSL/TLS termination - Request routing - JWT authentication - Rate limiting - Load balancing - Static file serving</p> <p>Key Modules Used: - <code>ngx_http_auth_jwt_module</code> - JWT validation - <code>ngx_http_limit_req_module</code> - Rate limiting - <code>ngx_http_headers_module</code> - CORS headers - <code>ngx_http_upstream_module</code> - Load balancing</p> <p>Configuration Example: <pre><code>http {\n  # Rate limiting zone\n  limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;\n\n  upstream dashboard {\n    server dashboard:3000;\n  }\n\n  upstream orion {\n    server orion:1026;\n  }\n\n  server {\n    listen 443 ssl;\n    server_name api.sematx.io;\n\n    ssl_certificate /etc/nginx/ssl/cert.pem;\n    ssl_certificate_key /etc/nginx/ssl/key.pem;\n\n    # Dashboard routes\n    location /api/ {\n      proxy_pass http://dashboard;\n    }\n\n    # Orion-LD routes (with JWT)\n    location /ngsi-ld/ {\n      limit_req zone=api_limit burst=20 nodelay;\n      auth_jwt \"SematX API\";\n      auth_jwt_key_file /etc/nginx/jwt_key.json;\n      proxy_pass http://orion;\n    }\n  }\n}\n</code></pre></p>"},{"location":"about-sematx/tools/#development-tools","title":"Development Tools","text":""},{"location":"about-sematx/tools/#docker-and-docker-compose","title":"Docker and Docker Compose","text":"<p>Why Docker? - Consistent environments across dev/staging/prod - Easy dependency management - Simplified deployment - Isolation and security</p> <p>SematX Docker Setup: <pre><code>version: '3.8'\nservices:\n  mongodb:\n    image: mongo:6.0\n    volumes:\n      - mongo-data:/data/db\n\n  orion:\n    image: fiware/orion-ld:1.5.1\n    depends_on:\n      - mongodb\n    command: -dbhost mongodb\n\n  dashboard:\n    build: ./dashboard\n    depends_on:\n      - mongodb\n    environment:\n      - DATABASE_URI=mongodb://mongodb:27017/payload\n      - PAYLOAD_SECRET=${PAYLOAD_SECRET}\n\n  nginx:\n    image: nginx:alpine\n    ports:\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n    depends_on:\n      - orion\n      - dashboard\n</code></pre></p>"},{"location":"about-sematx/tools/#typescript","title":"TypeScript","text":"<p>Benefits: - Type safety prevents runtime errors - Better IDE support and autocomplete - Self-documenting code - Easier refactoring - Modern JavaScript features</p> <p>Used in SematX for: - Dashboard frontend (React components) - Dashboard backend (PayloadCMS configuration) - API type definitions - Utility functions</p>"},{"location":"about-sematx/tools/#react-and-nextjs","title":"React and Next.js","text":"<p>React: Component-based UI library - Reusable dashboard widgets - Real-time data updates - Interactive forms</p> <p>Next.js: React framework with server-side rendering - Fast page loads - SEO optimization - API routes for backend logic - Static site generation</p>"},{"location":"about-sematx/tools/#git-and-github","title":"Git and GitHub","text":"<p>Version Control: - All SematX code is version-controlled with Git - GitHub for collaboration and CI/CD - Branching strategy for features and releases</p> <p>Repository Structure: <pre><code>LegoCity/\n\u251c\u2500\u2500 dashboard/              # Lego Dashboard (PayloadCMS)\n\u251c\u2500\u2500 orion-ld/              # Orion-LD configuration\n\u251c\u2500\u2500 nginx/                 # Nginx gateway config\n\u251c\u2500\u2500 docs/                  # Documentation (MkDocs)\n\u2514\u2500\u2500 docker-compose.yml     # Full stack orchestration\n</code></pre></p>"},{"location":"about-sematx/tools/#testing-tools","title":"Testing Tools","text":""},{"location":"about-sematx/tools/#postmaninsomnia","title":"Postman/Insomnia","text":"<p>API Testing: - Test NGSI-LD endpoints - Validate JWT authentication - Check subscription notifications - Debug API issues</p> <p>Sample NGSI-LD Request: <pre><code># Create Entity\nPOST /ngsi-ld/v1/entities\nAuthorization: Bearer &lt;jwt_token&gt;\nContent-Type: application/ld+json\n\n{\n  \"id\": \"urn:ngsi-ld:Sensor:001\",\n  \"type\": \"Sensor\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 25.5\n  }\n}\n</code></pre></p>"},{"location":"about-sematx/tools/#playwright","title":"Playwright","text":"<p>End-to-End Testing: - Automated UI testing for dashboard - User flow validation - Cross-browser testing - Visual regression testing</p>"},{"location":"about-sematx/tools/#vitest","title":"Vitest","text":"<p>Unit Testing: - Test React components - Validate business logic - Mock API responses - Fast test execution</p>"},{"location":"about-sematx/tools/#monitoring-tools","title":"Monitoring Tools","text":""},{"location":"about-sematx/tools/#prometheus","title":"Prometheus","text":"<p>Metrics Collection: - API request rates - Response times - Error rates - Resource usage</p>"},{"location":"about-sematx/tools/#grafana","title":"Grafana","text":"<p>Visualization: - Real-time dashboards - Custom metrics charts - Alerting rules - Log aggregation</p>"},{"location":"about-sematx/tools/#mongodb-compass","title":"MongoDB Compass","text":"<p>Database Management: - Visual query builder - Index analysis - Performance insights - Data import/export</p>"},{"location":"about-sematx/tools/#recommended-ide","title":"Recommended IDE","text":""},{"location":"about-sematx/tools/#visual-studio-code","title":"Visual Studio Code","text":"<p>Extensions: - ESLint - Code linting - Prettier - Code formatting - Docker - Container management - MongoDB - Database viewer - REST Client - API testing - GitLens - Git visualization</p>"},{"location":"about-sematx/tools/#learning-resources","title":"Learning Resources","text":""},{"location":"about-sematx/tools/#official-documentation","title":"Official Documentation","text":"<ul> <li>NGSI-LD Specification</li> <li>FIWARE Documentation</li> <li>PayloadCMS Docs</li> <li>MongoDB Manual</li> <li>Nginx Documentation</li> </ul>"},{"location":"about-sematx/tools/#tutorials","title":"Tutorials","text":"<ul> <li>NGSI-LD Step-by-Step</li> <li>PayloadCMS Examples</li> <li>Docker Compose Samples</li> </ul>"},{"location":"about-sematx/tools/#community","title":"Community","text":"<ul> <li>FIWARE Community</li> <li>PayloadCMS Discord</li> <li>SematX GitHub Discussions</li> </ul>"},{"location":"about-sematx/tools/#next-steps","title":"Next Steps","text":"<ul> <li>Understand the Ecosystem</li> <li>Start Building</li> <li>Explore Core Concepts</li> </ul>"},{"location":"ai/openrouter/","title":"OpenRouter Custom Provider","text":"<p>OpenRouter provides access to 100+ AI models through a single API, making it easy to use custom models like Gemini 2.0 Flash, Claude, GPT-4o, and more without managing multiple provider integrations.</p> <p>!!! success \"Why OpenRouter?\" - \ud83c\udd93 Free models available (Gemini 2.0 Flash, etc.) - \ud83d\udd0c 100+ models - Access to latest models from all providers - \ud83d\udcb0 Cost-effective - Competitive pricing, pay-as-you-go - \ud83d\ude80 No rate limits from individual providers - \ud83d\udd04 Automatic fallbacks - Built-in retry logic - \ud83c\udfaf Single API - One integration for all models</p>"},{"location":"ai/openrouter/#quick-start","title":"Quick Start","text":""},{"location":"ai/openrouter/#1-get-openrouter-api-key","title":"1. Get OpenRouter API Key","text":"<ol> <li>Visit openrouter.ai</li> <li>Sign up or log in</li> <li>Go to API Keys</li> <li>Create a new API key</li> </ol>"},{"location":"ai/openrouter/#2-configure-environment","title":"2. Configure Environment","text":".env<pre><code># Enable AI Features\nENABLE_AI=true\nAI_PROVIDER=openrouter\n\n# OpenRouter Configuration\nOPENROUTER_API_KEY=sk-or-v1-...\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\nOPENROUTER_SITE_URL=https://legocity.example.com  # Optional\nOPENROUTER_APP_NAME=LegoCity                      # Optional\n</code></pre>"},{"location":"ai/openrouter/#3-configure-custom-provider","title":"3. Configure Custom Provider","text":"src/payload.config.ts<pre><code>import { buildConfig } from \"payload/config\";\n\nexport default buildConfig({\n  plugins: [\n    // Custom OpenRouter provider\n    {\n      name: \"ai-openrouter\",\n      provider: async ({ apiKey, model }) =&gt; {\n        return {\n          generateText: async ({ prompt, max_tokens = 500 }) =&gt; {\n            const response = await fetch(\n              \"https://openrouter.ai/api/v1/chat/completions\",\n              {\n                method: \"POST\",\n                headers: {\n                  Authorization: `Bearer ${apiKey}`,\n                  \"Content-Type\": \"application/json\",\n                  \"HTTP-Referer\": process.env.OPENROUTER_SITE_URL,\n                  \"X-Title\": process.env.OPENROUTER_APP_NAME,\n                },\n                body: JSON.stringify({\n                  model: model,\n                  messages: [{ role: \"user\", content: prompt }],\n                  max_tokens,\n                }),\n              }\n            );\n\n            const data = await response.json();\n            return data.choices[0].message.content;\n          },\n        };\n      },\n      apiKey: process.env.OPENROUTER_API_KEY,\n      model: process.env.OPENROUTER_MODEL,\n      enabled: process.env.ENABLE_AI === \"true\",\n    },\n  ],\n});\n</code></pre>"},{"location":"ai/openrouter/#recommended-models","title":"Recommended Models","text":""},{"location":"ai/openrouter/#free-models-perfect-for-development","title":"Free Models (Perfect for Development)","text":"Model Provider Speed Quality Context google/gemini-2.0-flash-exp:free Google \u26a1\u26a1\u26a1 \u2b50\u2b50\u2b50\u2b50 1M tokens google/gemini-flash-1.5:free Google \u26a1\u26a1\u26a1 \u2b50\u2b50\u2b50\u2b50 1M tokens meta-llama/llama-3.2-3b-instruct:free Meta \u26a1\u26a1 \u2b50\u2b50\u2b50 128K qwen/qwen-2-7b-instruct:free Alibaba \u26a1\u26a1 \u2b50\u2b50\u2b50 32K <p>Best Free Model</p> <p>google/gemini-2.0-flash-exp:free - Excellent quality, very fast, 1M token context window</p>"},{"location":"ai/openrouter/#premium-models-production-use","title":"Premium Models (Production Use)","text":"Model Cost (per 1M tokens) Best For google/gemini-2.0-flash-thinking-exp $0.10 / $0.40 Advanced reasoning anthropic/claude-3.5-sonnet $3.00 / $15.00 High-quality content openai/gpt-4o-mini $0.15 / $0.60 General use openai/gpt-4o $2.50 / $10.00 Complex tasks meta-llama/llama-3.3-70b-instruct $0.59 / $0.79 Cost-effective"},{"location":"ai/openrouter/#specialized-models","title":"Specialized Models","text":"Model Purpose Context google/gemini-flash-1.5-8b Ultra-fast responses 1M tokens anthropic/claude-3-haiku Quick drafts 200K perplexity/llama-3.1-sonar-huge-128k-online Web search + AI 128K"},{"location":"ai/openrouter/#model-selection-guide","title":"Model Selection Guide","text":""},{"location":"ai/openrouter/#by-use-case","title":"By Use Case","text":"Content Generation <p>Recommended: <code>google/gemini-2.0-flash-exp:free</code></p> <pre><code>- Blog posts, descriptions\n- User-facing content\n- Documentation\n\n```typescript\nmodel: 'google/gemini-2.0-flash-exp:free'\n```\n</code></pre> Code Generation <p>Recommended: <code>anthropic/claude-3.5-sonnet</code></p> <pre><code>- Configuration files\n- API examples\n- Technical docs\n\n```typescript\nmodel: 'anthropic/claude-3.5-sonnet'\n```\n</code></pre> Quick Drafts <p>Recommended: <code>google/gemini-flash-1.5-8b</code></p> <pre><code>- Short descriptions\n- Labels, titles\n- Quick summaries\n\n```typescript\nmodel: 'google/gemini-flash-1.5-8b'\n```\n</code></pre> Complex Reasoning <p>Recommended: <code>google/gemini-2.0-flash-thinking-exp</code></p> <pre><code>- Data analysis\n- Decision support\n- Multi-step tasks\n\n```typescript\nmodel: 'google/gemini-2.0-flash-thinking-exp'\n```\n</code></pre>"},{"location":"ai/openrouter/#by-budget","title":"By Budget","text":"Free Tier <pre><code>// Best free option\nmodel: 'google/gemini-2.0-flash-exp:free'\n\n    // Alternatives\n    // model: 'google/gemini-flash-1.5:free'\n    // model: 'meta-llama/llama-3.2-3b-instruct:free'\n    ```\n\n=== \"Low Cost ($)\"\n```typescript\n// Best value\nmodel: 'openai/gpt-4o-mini' // $0.15/$0.60 per 1M\n\n    // Alternative\n    // model: 'google/gemini-flash-1.5'  // $0.075/$0.30 per 1M\n    ```\n\n=== \"High Quality ($$)\"\n```typescript\n// Best quality\nmodel: 'anthropic/claude-3.5-sonnet' // $3/$15 per 1M\n\n    // Alternative\n    // model: 'openai/gpt-4o'  // $2.50/$10 per 1M\n    ```\n\n---\n\n## Advanced Configuration\n\n### Model Switching\n\nSwitch models based on task:\n\n```typescript title=\"src/lib/ai-helper.ts\"\nconst AI_MODELS = {\n  content: \"google/gemini-2.0-flash-exp:free\",\n  code: \"anthropic/claude-3.5-sonnet\",\n  quick: \"google/gemini-flash-1.5-8b\",\n  reasoning: \"google/gemini-2.0-flash-thinking-exp\",\n};\n\nexport async function generateWithAI(\n  prompt: string,\n  task: keyof typeof AI_MODELS\n) {\n  const model = AI_MODELS[task];\n\n  const response = await fetch(\n    \"https://openrouter.ai/api/v1/chat/completions\",\n    {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${process.env.OPENROUTER_API_KEY}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        model,\n        messages: [{ role: \"user\", content: prompt }],\n      }),\n    }\n  );\n\n  return response.json();\n}\n</code></pre>"},{"location":"ai/openrouter/#fallback-chain","title":"Fallback Chain","text":"<pre><code>const FALLBACK_MODELS = [\n  \"google/gemini-2.0-flash-exp:free\", // Try free first\n  \"openai/gpt-4o-mini\", // Fallback to paid\n  \"anthropic/claude-3.5-haiku\", // Last resort\n];\n\nasync function generateWithFallback(prompt: string) {\n  for (const model of FALLBACK_MODELS) {\n    try {\n      return await generateWithAI(prompt, model);\n    } catch (error) {\n      console.warn(`Model ${model} failed, trying next...`);\n    }\n  }\n  throw new Error(\"All AI models failed\");\n}\n</code></pre>"},{"location":"ai/openrouter/#custom-parameters","title":"Custom Parameters","text":"<pre><code>await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\n  method: \"POST\",\n  headers: {\n    Authorization: `Bearer ${process.env.OPENROUTER_API_KEY}`,\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify({\n    model: \"google/gemini-2.0-flash-exp:free\",\n    messages: [{ role: \"user\", content: prompt }],\n\n    // Custom parameters\n    temperature: 0.7, // Creativity (0-2)\n    max_tokens: 1000, // Response length\n    top_p: 0.9, // Nucleus sampling\n    frequency_penalty: 0.5, // Reduce repetition\n    presence_penalty: 0.5, // Encourage diversity\n\n    // OpenRouter-specific\n    transforms: [\"middle-out\"], // Reduce latency\n    route: \"fallback\", // Auto-fallback on error\n  }),\n});\n</code></pre>"},{"location":"ai/openrouter/#cost-management","title":"Cost Management","text":""},{"location":"ai/openrouter/#monitor-usage","title":"Monitor Usage","text":"<p>OpenRouter provides usage tracking:</p> <ol> <li>Visit openrouter.ai/activity</li> <li>View costs per model</li> <li>Set budget alerts</li> </ol>"},{"location":"ai/openrouter/#cost-saving-strategies","title":"Cost-Saving Strategies","text":"Use Free Models for Dev <p><code>env title=\".env.development\"     OPENROUTER_MODEL=google/gemini-2.0-flash-exp:free</code></p> Limit Token Usage <p><code>typescript     max_tokens: 300  // Keep responses concise</code></p> Cache Responses <pre><code>// Cache AI responses for identical prompts\nconst cache = new Map()\n\n    async function cachedGenerate(prompt: string) {\n      if (cache.has(prompt)) return cache.get(prompt)\n\n      const result = await generateWithAI(prompt)\n      cache.set(prompt, result)\n      return result\n    }\n    ```\n\n=== \"Batch Processing\"\n`` typescript\n    // Generate multiple items in one request\n    const prompt = `Generate descriptions for these layers:\n    1. Weather observations\n    2. Flood zones\n    3. Parking facilities`\n     ``\n\n---\n\n## Model Features Comparison\n\n### Context Window\n\n| Model                 | Context   | Use Case                      |\n| --------------------- | --------- | ----------------------------- |\n| **gemini-2.0-flash**  | 1M tokens | Long documents, full codebase |\n| **claude-3.5-sonnet** | 200K      | Long articles                 |\n| **gpt-4o**            | 128K      | Standard content              |\n| **llama-3.3-70b**     | 128K      | General use                   |\n\n### Special Capabilities\n\n| Model                         | Special Features            |\n| ----------------------------- | --------------------------- |\n| **gemini-2.0-flash-thinking** | Chain-of-thought reasoning  |\n| **claude-3.5-sonnet**         | Excellent at code, analysis |\n| **perplexity-sonar-online**   | Web search integration      |\n| **gpt-4o**                    | Vision (image analysis)     |\n\n---\n\n## Troubleshooting\n\n### Common Issues\n\n=== \"401 Unauthorized\"\n**Problem**: Invalid API key\n\n    **Solution**:\n    ```bash\n    # Verify key format\n    echo $OPENROUTER_API_KEY  # Should start with sk-or-v1-\n\n    # Test key\n    curl https://openrouter.ai/api/v1/models \\\n      -H \"Authorization: Bearer $OPENROUTER_API_KEY\"\n    ```\n\n=== \"402 Payment Required\"\n**Problem**: Insufficient credits\n\n    **Solution**:\n    - Use free models: `google/gemini-2.0-flash-exp:free`\n    - Add credits: [openrouter.ai/credits](https://openrouter.ai/credits)\n\n=== \"429 Rate Limited\"\n**Problem**: Too many requests\n\n    **Solution**:\n    ```typescript\n    // Add delays between requests\n    await new Promise(resolve =&gt; setTimeout(resolve, 1000))\n    ```\n\n=== \"Model Not Found\"\n**Problem**: Invalid model name\n\n    **Solution**:\n    ```bash\n    # List available models\n    curl https://openrouter.ai/api/v1/models \\\n      -H \"Authorization: Bearer $OPENROUTER_API_KEY\"\n    ```\n\n---\n\n## Best Practices\n\n### 1. Development Setup\n\n```env title=\".env.development\"\n# Use free models for development\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\nOPENROUTER_SITE_URL=http://localhost:3000\n</code></pre>"},{"location":"ai/openrouter/#2-production-setup","title":"2. Production Setup","text":".env.production<pre><code># Use reliable paid models for production\nOPENROUTER_MODEL=anthropic/claude-3.5-sonnet\nOPENROUTER_SITE_URL=https://legocity.example.com\n</code></pre>"},{"location":"ai/openrouter/#3-error-handling","title":"3. Error Handling","text":"<pre><code>async function safeGenerate(prompt: string) {\n  try {\n    return await generateWithAI(prompt);\n  } catch (error) {\n    console.error(\"AI generation failed:\", error);\n    // Fallback to manual content\n    return null;\n  }\n}\n</code></pre>"},{"location":"ai/openrouter/#4-rate-limiting","title":"4. Rate Limiting","text":"<pre><code>import pLimit from \"p-limit\";\n\n// Limit concurrent AI requests\nconst limit = pLimit(3);\n\nconst promises = prompts.map((prompt) =&gt; limit(() =&gt; generateWithAI(prompt)));\n\nawait Promise.all(promises);\n</code></pre>"},{"location":"ai/openrouter/#example-integration","title":"Example Integration","text":""},{"location":"ai/openrouter/#full-implementation","title":"Full Implementation","text":"src/lib/openrouter.ts<pre><code>export class OpenRouterClient {\n  private apiKey: string;\n  private model: string;\n\n  constructor() {\n    this.apiKey = process.env.OPENROUTER_API_KEY!;\n    this.model =\n      process.env.OPENROUTER_MODEL || \"google/gemini-2.0-flash-exp:free\";\n  }\n\n  async generateText(prompt: string, options = {}) {\n    const response = await fetch(\n      \"https://openrouter.ai/api/v1/chat/completions\",\n      {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${this.apiKey}`,\n          \"Content-Type\": \"application/json\",\n          \"HTTP-Referer\": process.env.OPENROUTER_SITE_URL || \"\",\n          \"X-Title\": \"LegoCity\",\n        },\n        body: JSON.stringify({\n          model: this.model,\n          messages: [{ role: \"user\", content: prompt }],\n          max_tokens: 500,\n          temperature: 0.7,\n          ...options,\n        }),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(`OpenRouter API error: ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    return data.choices[0].message.content;\n  }\n\n  async generateDescription(layerName: string, entityType: string) {\n    const prompt = `Generate a concise, user-friendly description for a smart city map layer:\n\nLayer: ${layerName}\nEntity Type: ${entityType}\n\nFocus on what citizens can learn from this data. Keep it under 100 words.`;\n\n    return this.generateText(prompt);\n  }\n}\n\n// Usage\nconst ai = new OpenRouterClient();\nconst description = await ai.generateDescription(\n  \"Weather Stations\",\n  \"WeatherObserved\"\n);\n</code></pre>"},{"location":"ai/openrouter/#resources","title":"Resources","text":"<ul> <li>OpenRouter Docs: openrouter.ai/docs</li> <li>Model List: openrouter.ai/models</li> <li>Pricing: openrouter.ai/docs#pricing</li> <li>API Reference: openrouter.ai/docs/api-reference</li> </ul>"},{"location":"ai/openrouter/#next-steps","title":"Next Steps","text":"<ul> <li>AI Provider Configuration - Compare all providers</li> <li>AI Use Cases - Practical examples</li> <li>AI Overview - Understanding AI in LegoCity</li> </ul>"},{"location":"ai/overview/","title":"AI Helpers (Optional)","text":"<p>This page describes how LegoCity can use AI helpers in PayloadCMS, primarily via the Payload AI plugin, and what role they play in the overall system.</p> <p>AI Features are Optional</p> <p>AI features are considered optional and supportive:</p> <pre><code>- \u2705 The platform must work without any AI provider configured\n- \u2705 AI is used to **assist** content editors and developers\n- \u274c AI does **not replace** human decision-making\n</code></pre>"},{"location":"ai/overview/#scope-of-ai-features","title":"Scope of AI Features","text":""},{"location":"ai/overview/#what-ai-can-help-with","title":"What AI Can Help With","text":"<p>AI helpers are useful for content-related tasks:</p> Content Generation <p>Drafting Descriptions</p> <pre><code>- Human-friendly explanations for layers, views, blocks\n- Summaries and tooltips\n- Documentation snippets\n- Quick drafts of \"what this view does\"\n</code></pre> Naming &amp; Labeling <p>Suggesting Names</p> <pre><code>- Layer names\n- Legend entries\n- KPI titles\n- Block labels\n- View headings\n</code></pre> Low-Risk Transformations <p>Content Enhancement</p> <pre><code>- Rephrasing text for clarity\n- Generating alt text\n- Accessibility hints\n- Multi-language translations\n- Short explanations for non-technical users\n</code></pre>"},{"location":"ai/overview/#what-ai-is-not-responsible-for","title":"What AI is NOT Responsible For","text":"<p>AI Limitations</p> <p>AI is not responsible for:</p> <pre><code>- \u274c Defining entity models or NGSI-LD schema\n- \u274c Making security or access control decisions\n- \u274c Executing operational or deployment changes\n- \u274c Critical business logic\n- \u274c Data validation or integrity checks\n</code></pre>"},{"location":"ai/overview/#payload-ai-plugin","title":"Payload AI Plugin","text":"<p>LegoCity uses the Payload AI plugin as the main integration point for AI features.</p>"},{"location":"ai/overview/#plugin-capabilities","title":"Plugin Capabilities","text":"<p>The Payload AI plugin:</p> <ul> <li>\u2795 Adds AI functionality into the PayloadCMS admin UI</li> <li>\ud83d\udd0c Connects to various AI providers (OpenAI, Anthropic, etc.)</li> <li>\u2699\ufe0f Configures via environment variables and plugin options</li> <li>\ud83c\udf9b\ufe0f Provides UI controls for AI-assisted editing</li> </ul>"},{"location":"ai/overview/#integration-approach","title":"Integration Approach","text":"<p>From LegoCity's perspective:</p> <p>!!! tip \"Plugin Philosophy\" - AI integration is just another plugin - Configured per environment (dev, staging, prod) - Used only where explicitly enabled - Should gracefully disable if no provider configured</p> <p>Behavior when disabled:</p> <ul> <li>Admin UI hides AI features, or</li> <li>Shows them as disabled with clear messaging</li> <li>No functionality breaks or errors</li> </ul>"},{"location":"ai/overview/#example-use-cases-in-legocity","title":"Example Use Cases in LegoCity","text":"<p>Practical examples of AI usage in smart city context:</p>"},{"location":"ai/overview/#use-case-1-layer-descriptions","title":"Use Case 1: Layer Descriptions","text":"<p>=== \"Workflow\" 1. Editor defines technical metadata for a layer: - Source: NGSI-LD broker - Entity type: <code>WeatherObserved</code> - Attributes: <code>temperature</code>, <code>humidity</code>, <code>precipitation</code></p> <pre><code>2. AI generates user-facing description:\n   &gt; \"This layer displays real-time weather data from stations across the city. View current temperature, humidity levels, and rainfall measurements updated every 15 minutes.\"\n</code></pre> <p>=== \"Benefits\" - Saves time for content editors - Consistent tone and style - Non-technical language for end users - Editable output for refinement</p>"},{"location":"ai/overview/#use-case-2-view-summaries","title":"Use Case 2: View Summaries","text":"<p>=== \"Workflow\" 1. Editor creates a \"Flood Monitoring\" view with: - Weather layer (rainfall) - Flood risk zones - Water level sensors</p> <pre><code>2. AI suggests introduction text:\n   &gt; **Flood Monitoring Dashboard**\n   &gt;\n   &gt; Monitor real-time flood risk across the city:\n   &gt; - Track rainfall intensity and accumulation\n   &gt; - View high-risk flood zones\n   &gt; - Monitor river water levels at key points\n</code></pre> <p>=== \"Benefits\" - Quick drafts for new views - Structured content format - Sample questions for help tooltips</p>"},{"location":"ai/overview/#use-case-3-block-labels","title":"Use Case 3: Block Labels","text":"<p>=== \"Workflow\" 1. <code>LayerToggle</code> block configured with layers: - <code>flood-risk-high</code> - <code>flood-risk-medium</code> - <code>flood-risk-low</code></p> <pre><code>2. AI suggests concise label:\n   &gt; \"Flood Risk Zones\"\n</code></pre> <p>=== \"Benefits\" - Consistent naming conventions - User-friendly terminology - Saves repetitive naming tasks</p>"},{"location":"ai/overview/#use-case-4-example-questions","title":"Use Case 4: Example Questions","text":"Workflow\" 1. AI analyzes view configuration 2. Proposes sample questions users might ask: - \"Where are the highest flood risk areas?\" - \"What's the current rainfall intensity?\" - \"Which areas should be evacuated? <p>=== \"Benefits\" - Helps with help documentation - Improves user guidance - Identifies common use cases</p>"},{"location":"ai/overview/#editor-control-principles","title":"Editor Control Principles","text":"<p>Human in the Loop</p> <p>In all cases:</p> <pre><code>- \u2705 AI output is **editable** and **reversible**\n- \u2705 Editors retain **full control**\n- \u2705 AI provides **suggestions**, not final decisions\n- \u2705 Previous content is preserved\n</code></pre>"},{"location":"ai/overview/#configuration-and-environments","title":"Configuration and Environments","text":""},{"location":"ai/overview/#environment-setup","title":"Environment Setup","text":"<p>To use the AI plugin, each environment must have:</p> <p>=== \"Required Configuration\" - API keys or credentials for chosen provider - Plugin configuration in Payload config - Environment variables for secrets - Optional: Provider-specific settings</p> Example Configuration payload.config.ts<pre><code>import { payloadAI } from '@payloadcms/plugin-ai'\n\n    export default buildConfig({\n      plugins: [\n        payloadAI({\n          provider: 'openai',\n          apiKey: process.env.OPENAI_API_KEY,\n          enabled: process.env.ENABLE_AI === 'true',\n          collections: {\n            layers: {\n              fields: ['description', 'tooltip']\n            },\n            views: {\n              fields: ['summary', 'introduction']\n            }\n          }\n        })\n      ]\n    })\n    ```\n\n=== \"Environment Variables\"\n```env title=\".env\" # AI Provider Configuration\nENABLE_AI=true\nAI_PROVIDER=openai\nOPENAI_API_KEY=sk-...\n\n    # Optional: Provider-specific settings\n    AI_MODEL=gpt-4\n    AI_TEMPERATURE=0.7\n    AI_MAX_TOKENS=500\n    ```\n\n### Configuration Principles\n\n!!! warning \"Security Best Practices\" - \ud83d\udd10 Store AI provider keys as **secrets** (env vars or secret manager) - \ud83c\udf0d Allow **different providers or keys per environment** - \ud83d\udd0c Allow AI to be **completely disabled** - \ud83d\udeab Never commit API keys to version control\n\n### Environment Matrix\n\n| Environment     | AI Enabled  | Provider          | Use Case                   |\n| --------------- | ----------- | ----------------- | -------------------------- |\n| **Development** | \u2705 Yes      | OpenAI (test key) | Testing AI features        |\n| **Staging**     | \u2705 Yes      | OpenAI (prod key) | Pre-prod validation        |\n| **Production**  | \u26a0\ufe0f Optional | OpenAI (prod key) | Content editing assistance |\n| **CI/CD**       | \u274c No       | None              | Automated testing          |\n\n### Platform Independence\n\n!!! success \"No Dependencies\"\nThe platform logic must **not depend** on AI features:\n\n    - Core functionality works without AI\n    - Seeds, migrations, and workflows are AI-independent\n    - AI features are purely additive enhancements\n\n---\n\n## UX Guidelines\n\nWhen adding AI helpers to the admin UI:\n\n### 1. Explicit AI Actions\n\n!!! tip \"User Intent Required\" - Add clear buttons: \"Generate description\", \"Suggest labels\" - **Never** auto-run AI without user action - Provide keyboard shortcuts for power users - Show loading states during AI operations\n\n**Example:**\n\n```tsx\n&lt;Button\n  onClick={handleGenerateDescription}\n  icon={&lt;SparklesIcon /&gt;}\n  loading={isGenerating}\n&gt;\n  \u2728 Generate Description with AI\n&lt;/Button&gt;\n</code></pre>"},{"location":"ai/overview/#2-clear-suggestion-display","title":"2. Clear Suggestion Display","text":"<p>!!! tip \"Transparent AI Output\" - Show AI output as suggested content, not final truth - Allow editors to accept, edit, or discard - Preserve original content if replaced - Show comparison view when useful</p> <p>Example UI:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 AI Suggestion:                      \u2502\n\u2502                                     \u2502\n\u2502 \"This layer displays real-time...\" \u2502\n\u2502                                     \u2502\n\u2502 [\u2713 Accept] [\u270e Edit] [\u2717 Discard]   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nOriginal content: \"Weather layer\"\n</code></pre>"},{"location":"ai/overview/#3-focused-actions","title":"3. Focused Actions","text":"<p>!!! tip \"Small, Single-Purpose Tasks\" - Keep actions small and focused (one field or section) - Avoid complex, multi-step AI chains - Allow partial acceptance of suggestions - Enable undo/redo</p>"},{"location":"ai/overview/#4-graceful-error-handling","title":"4. Graceful Error Handling","text":"<p>Handle Failures Well</p> <p>Timeouts, provider issues, or invalid configuration should:</p> <pre><code>- Show **clear error messages**\n- Suggest **actionable fixes**\n- **Never break** the entire admin UI\n- Fall back to manual editing\n</code></pre> <p>Error Message Example:</p> <pre><code>\u274c AI generation failed\n\nThe AI provider is currently unavailable. You can:\n\u2022 Try again in a few moments\n\u2022 Edit the field manually\n\u2022 Contact support if the issue persists\n\n[Retry] [Edit Manually]\n</code></pre>"},{"location":"ai/overview/#safety-and-limitations","title":"Safety and Limitations","text":""},{"location":"ai/overview/#data-privacy","title":"Data Privacy","text":"<p>Sensitive Data Protection</p> <p>Avoid sending to external AI providers:</p> <pre><code>- Personal identifiable information (PII)\n- Authentication credentials\n- Internal system details\n- Full configuration dumps\n- Application logs\n</code></pre> <p>What to send:</p> <ul> <li>\u2705 Field labels and descriptions</li> <li>\u2705 Public-facing content</li> <li>\u2705 Generic entity type names</li> <li>\u2705 Non-sensitive metadata</li> </ul>"},{"location":"ai/overview/#content-validation","title":"Content Validation","text":"<p>AI Output Review</p> <p>Treat AI outputs as untrusted until human approval:</p> <pre><code>- Review for technical accuracy\n- Check for hallucinated facts\n- Verify entity mappings\n- Validate against domain knowledge\n- Ensure brand/tone consistency\n</code></pre>"},{"location":"ai/overview/#context-limits","title":"Context Limits","text":"<p>Send only necessary context:</p> <pre><code>// \u2705 Good: Minimal context\n{\n  field: \"description\",\n  entityType: \"WeatherObserved\",\n  attributes: [\"temperature\", \"humidity\"]\n}\n\n// \u274c Bad: Excessive context\n{\n  field: \"description\",\n  fullConfig: {...}, // Entire payload config\n  logs: [...],       // System logs\n  secrets: {...}     // Environment variables\n}\n</code></pre>"},{"location":"ai/overview/#transparency-requirements","title":"Transparency Requirements","text":"<p>Clear Communication</p> <p>Documentation and UI should make clear:</p> <pre><code>- AI output might be **imprecise or incomplete**\n- Editors are **responsible** for final content\n- AI is a **tool**, not a replacement for expertise\n- Human review is **always required**\n</code></pre>"},{"location":"ai/overview/#development-and-contribution-guidelines","title":"Development and Contribution Guidelines","text":""},{"location":"ai/overview/#1-decoupled-architecture","title":"1. Decoupled Architecture","text":"<p>!!! success \"Separation of Concerns\" - Keep AI features independent from core functionality - AI plugin should be usable standalone - Don't tie core flows to AI completion: - Seed data generation - Database migrations - Authentication/authorization - API responses</p>"},{"location":"ai/overview/#2-transparent-prompts","title":"2. Transparent Prompts","text":"<p>!!! success \"Document AI Behavior\" - Store prompts in a clearly documented place - Make them concise and domain-specific: - Smart city concepts - NGSI-LD terminology - LegoCity architecture - Version control prompt changes - Review prompt updates in PRs</p> <p>Example Prompt Storage:</p> src/ai/prompts/layer-description.ts<pre><code>export const LAYER_DESCRIPTION_PROMPT = `\nGenerate a user-friendly description for a smart city map layer.\n\nContext:\n- Entity Type: {entityType}\n- Domain: {domain}\n- Attributes: {attributes}\n\nRequirements:\n- 2-3 sentences maximum\n- Non-technical language\n- Explain what users can learn from this layer\n- Mention update frequency if relevant\n\nOutput: A clear, concise description.\n`;\n</code></pre>"},{"location":"ai/overview/#3-configurable-usage","title":"3. Configurable Usage","text":"<p>!!! success \"Flexible Control\" - Allow admins to enable/disable AI per collection - Allow admins to enable/disable AI per field - Support role-based restrictions: - Only editors can use AI features - Viewers cannot trigger AI actions - Provide global AI toggle</p> <p>Example Configuration:</p> <pre><code>payloadAI({\n  collections: {\n    layers: {\n      enabled: true,\n      fields: [\"description\", \"tooltip\"],\n      roles: [\"editor\", \"admin\"],\n    },\n    views: {\n      enabled: true,\n      fields: [\"summary\"],\n      roles: [\"admin\"],\n    },\n  },\n});\n</code></pre>"},{"location":"ai/overview/#4-privacy-conscious-logging","title":"4. Privacy-Conscious Logging","text":"<p>!!! success \"Minimal Logging\" - Log AI interactions for debugging only - Avoid storing full prompts and responses - Never log sensitive content - Use log levels appropriately: - INFO: AI action triggered - DEBUG: Request/response metadata - ERROR: Failures and timeouts</p> <p>Example Log Structure:</p> <pre><code>logger.info(\"AI action\", {\n  action: \"generate_description\",\n  collection: \"layers\",\n  field: \"description\",\n  provider: \"openai\",\n  model: \"gpt-4\",\n  duration_ms: 1250,\n  success: true,\n  // \u274c Don't log: prompt, response, user content\n});\n</code></pre>"},{"location":"ai/overview/#testing-ai-features","title":"Testing AI Features","text":""},{"location":"ai/overview/#unit-tests","title":"Unit Tests","text":"<p>Test AI integration without calling real providers:</p> ai-helpers.test.ts<pre><code>import { generateLayerDescription } from './ai-helpers'\n\njest.mock('@payloadcms/plugin-ai')\n\ndescribe('AI Layer Description Generator', () =&gt; {\n  it('generates description with valid input', async () =&gt; {\n    const result = await generateLayerDescription({\n      entityType: 'WeatherObserved',\n      domain: 'environment'\n    })\n\n    expect(result).toContain('weather')\n    expect(result.length).toBeLessThan(500)\n  })\n\n  it('handles provider failures gracefully', async () =&gt; {\n    mockAIProvider.mockRejectedValue(new Error('API timeout'))\n\n    await expect(\n      generateLayerDescription({...})\n    ).rejects.toThrow('AI generation failed')\n  })\n})\n</code></pre>"},{"location":"ai/overview/#integration-tests","title":"Integration Tests","text":"<p>Test AI features with mock providers:</p> <pre><code>describe(\"AI Integration\", () =&gt; {\n  it(\"disables AI UI when no provider configured\", () =&gt; {\n    process.env.ENABLE_AI = \"false\";\n\n    const { queryByText } = render(&lt;LayerEditor /&gt;);\n\n    expect(queryByText(\"Generate with AI\")).toBeNull();\n  });\n});\n</code></pre>"},{"location":"ai/overview/#summary","title":"Summary","text":"<p>Key Takeaways</p> <p>AI helpers in LegoCity are optional and supportive</p> <pre><code>**Purpose:**\n\n- Assist with descriptions, labels, and content tasks\n- Not responsible for core behavior or architecture\n- Purely additive enhancement to editing experience\n\n**Configuration:**\n\n- Uses environment variables and secret storage\n- Can differ per environment (dev, staging, prod)\n- Must allow AI features to be fully disabled\n- No core functionality depends on AI\n\n**UX Principles:**\n\n- AI actions are explicit and user-triggered\n- Output is reversible and editable\n- Clearly marked as suggestions, not truth\n- Graceful error handling\n\n**Development:**\n\n- Keep AI integrations decoupled from core platform\n- Document prompts and behaviors transparently\n- Apply safety and privacy principles\n- Log minimally and responsibly\n</code></pre> <p>Related Pages:</p> <ul> <li>AI Providers</li> <li>OpenRouter Integration</li> <li>AI Use Cases</li> <li>Creating New Blocks</li> </ul>"},{"location":"ai/providers/","title":"AI Provider Configuration","text":"<p>LegoCity supports multiple AI providers through the Payload AI plugin. This guide covers officially supported providers and custom provider setup.</p> <p>Official Support</p> <p>Officially Supported Providers:</p> <pre><code>- \u2705 **OpenAI** (GPT-4, GPT-3.5-turbo)\n- \u2705 **Anthropic** (Claude 3.5, Claude 3)\n- \u2705 **ElevenLabs** (Voice synthesis)\n\n**Custom Providers:**\n\n- \ud83d\udd0c **OpenRouter** - Access to 100+ models (Gemini, Claude, GPT-4o, etc.)\n- \ud83d\udd27 **Custom Providers** - Build your own integration\n</code></pre>"},{"location":"ai/providers/#openai-configuration","title":"OpenAI Configuration","text":""},{"location":"ai/providers/#setup","title":"Setup","text":"<ol> <li> <p>Get API Key from platform.openai.com</p> </li> <li> <p>Configure Environment:</p> </li> </ol> .env<pre><code># Enable AI Features\nENABLE_AI=true\nAI_PROVIDER=openai\n\n# OpenAI Credentials\nOPENAI_API_KEY=sk-proj-...\nOPENAI_MODEL=gpt-4o-mini\nOPENAI_ORGANIZATION=org-...  # Optional\n</code></pre> <ol> <li>Configure Payload Plugin:</li> </ol> src/payload.config.ts<pre><code>import { payloadAI } from \"@payloadcms/plugin-ai\";\n\nexport default buildConfig({\n  plugins: [\n    payloadAI({\n      provider: \"openai\",\n      apiKey: process.env.OPENAI_API_KEY,\n      model: process.env.OPENAI_MODEL || \"gpt-4o-mini\",\n      enabled: process.env.ENABLE_AI === \"true\",\n      collections: {\n        pages: {\n          fields: [\"content\", \"description\"],\n        },\n        posts: {\n          fields: [\"content\", \"excerpt\"],\n        },\n      },\n    }),\n  ],\n});\n</code></pre>"},{"location":"ai/providers/#recommended-models","title":"Recommended Models","text":"Model Best For Cost Speed gpt-4o High-quality content, complex tasks $$$ Fast gpt-4o-mini General use, cost-effective $ Very Fast gpt-4-turbo Advanced reasoning $$$ Medium gpt-3.5-turbo Simple tasks, drafts $ Very Fast <p>Recommendation</p> <p>Start with gpt-4o-mini for most use cases - excellent quality at low cost.</p>"},{"location":"ai/providers/#anthropic-claude-configuration","title":"Anthropic (Claude) Configuration","text":""},{"location":"ai/providers/#setup_1","title":"Setup","text":"<ol> <li> <p>Get API Key from console.anthropic.com</p> </li> <li> <p>Configure Environment:</p> </li> </ol> .env<pre><code># Enable AI Features\nENABLE_AI=true\nAI_PROVIDER=anthropic\n\n# Anthropic Credentials\nANTHROPIC_API_KEY=sk-ant-...\nANTHROPIC_MODEL=claude-3-5-sonnet-20241022\n</code></pre> <ol> <li>Configure Payload Plugin:</li> </ol> src/payload.config.ts<pre><code>import { payloadAI } from \"@payloadcms/plugin-ai\";\n\nexport default buildConfig({\n  plugins: [\n    payloadAI({\n      provider: \"anthropic\",\n      apiKey: process.env.ANTHROPIC_API_KEY,\n      model: process.env.ANTHROPIC_MODEL,\n      enabled: process.env.ENABLE_AI === \"true\",\n      collections: {\n        pages: {\n          fields: [\"content\", \"description\"],\n        },\n      },\n    }),\n  ],\n});\n</code></pre>"},{"location":"ai/providers/#recommended-models_1","title":"Recommended Models","text":"Model Best For Context Window Cost claude-3-5-sonnet-20241022 Best quality, coding 200K $$ claude-3-5-haiku-20241022 Fast, cost-effective 200K $ claude-3-opus Most capable 200K $$$ <p>Recommendation</p> <p>Claude 3.5 Sonnet offers excellent quality with large context windows - great for long-form content.</p>"},{"location":"ai/providers/#elevenlabs-voice-synthesis","title":"ElevenLabs (Voice Synthesis)","text":""},{"location":"ai/providers/#setup_2","title":"Setup","text":"<ol> <li> <p>Get API Key from elevenlabs.io</p> </li> <li> <p>Configure Environment:</p> </li> </ol> .env<pre><code>ELEVENLABS_API_KEY=...\nELEVENLABS_VOICE_ID=21m00Tcm4TlvDq8ikWAM  # Default voice\n</code></pre> <ol> <li>Use Case: Generate audio descriptions for accessibility</li> </ol> <pre><code>// Example: Generate audio for page descriptions\nconst audioUrl = await generateAudio({\n  text: page.description,\n  voiceId: process.env.ELEVENLABS_VOICE_ID,\n});\n</code></pre>"},{"location":"ai/providers/#openrouter-custom-models","title":"OpenRouter (Custom Models)","text":"<p>OpenRouter provides access to 100+ AI models through a unified API.</p> <p>!!! success \"Why OpenRouter?\" - \u2705 Access to Gemini 2.0 Flash, Claude, GPT-4o, and many more - \u2705 No rate limits from individual providers - \u2705 Cost-effective - competitive pricing - \u2705 Automatic fallbacks - if one model fails, try another - \u2705 Easy switching - change models without code changes</p>"},{"location":"ai/providers/#setup_3","title":"Setup","text":"<p>See detailed guide: OpenRouter Custom Provider</p> <p>Quick Setup:</p> .env<pre><code>AI_PROVIDER=openrouter\nOPENROUTER_API_KEY=sk-or-v1-...\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\n</code></pre>"},{"location":"ai/providers/#provider-comparison","title":"Provider Comparison","text":""},{"location":"ai/providers/#feature-matrix","title":"Feature Matrix","text":"Feature OpenAI Anthropic OpenRouter Quality \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 (depends on model) Speed Fast Fast Fast Cost $$ $$ $ (varies by model) Context Window 128K 200K Varies (up to 2M) Ease of Setup \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 Model Variety Limited Limited 100+ models Rate Limits Yes Yes Provider-dependent"},{"location":"ai/providers/#cost-comparison-per-1m-tokens","title":"Cost Comparison (per 1M tokens)","text":"Provider Input Output Best For OpenAI gpt-4o-mini $0.15 $0.60 General use Anthropic Claude 3.5 Haiku $0.80 $4.00 Fast tasks OpenRouter Gemini 2.0 Flash Free Free Development, testing"},{"location":"ai/providers/#environment-specific-configuration","title":"Environment-Specific Configuration","text":""},{"location":"ai/providers/#development","title":"Development","text":".env.development<pre><code>ENABLE_AI=true\nAI_PROVIDER=openrouter\nOPENROUTER_API_KEY=...\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\n</code></pre> <p>Why: Free tier, fast iteration</p>"},{"location":"ai/providers/#staging","title":"Staging","text":".env.staging<pre><code>ENABLE_AI=true\nAI_PROVIDER=openai\nOPENAI_API_KEY=...\nOPENAI_MODEL=gpt-4o-mini\n</code></pre> <p>Why: Test production setup with cost-effective model</p>"},{"location":"ai/providers/#production","title":"Production","text":".env.production<pre><code>ENABLE_AI=true\nAI_PROVIDER=anthropic\nANTHROPIC_API_KEY=...\nANTHROPIC_MODEL=claude-3-5-sonnet-20241022\n</code></pre> <p>Why: Best quality for end users</p>"},{"location":"ai/providers/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"ai/providers/#multiple-providers-fallback","title":"Multiple Providers (Fallback)","text":"src/payload.config.ts<pre><code>export default buildConfig({\n  plugins: [\n    payloadAI({\n      providers: [\n        {\n          name: \"primary\",\n          provider: \"openai\",\n          apiKey: process.env.OPENAI_API_KEY,\n          model: \"gpt-4o-mini\",\n        },\n        {\n          name: \"fallback\",\n          provider: \"openrouter\",\n          apiKey: process.env.OPENROUTER_API_KEY,\n          model: \"google/gemini-2.0-flash-exp:free\",\n        },\n      ],\n      fallbackStrategy: \"sequential\", // Try primary first, fallback if fails\n    }),\n  ],\n});\n</code></pre>"},{"location":"ai/providers/#rate-limiting","title":"Rate Limiting","text":"<pre><code>payloadAI({\n  provider: \"openai\",\n  rateLimit: {\n    requests: 100,\n    period: \"1h\",\n  },\n});\n</code></pre>"},{"location":"ai/providers/#custom-prompts","title":"Custom Prompts","text":"<pre><code>payloadAI({\n  prompts: {\n    generateDescription: `Generate a concise, user-friendly description for this smart city data layer. \nFocus on what citizens can learn from this data.\nKeep it under 100 words.`,\n  },\n});\n</code></pre>"},{"location":"ai/providers/#troubleshooting","title":"Troubleshooting","text":""},{"location":"ai/providers/#api-key-issues","title":"API Key Issues","text":"<pre><code># Test OpenAI connection\ncurl https://api.openai.com/v1/models \\\n  -H \"Authorization: Bearer $OPENAI_API_KEY\"\n\n# Test Anthropic connection\ncurl https://api.anthropic.com/v1/messages \\\n  -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n  -H \"anthropic-version: 2023-06-01\"\n</code></pre>"},{"location":"ai/providers/#common-errors","title":"Common Errors","text":"Error Cause Solution <code>401 Unauthorized</code> Invalid API key Check key, regenerate if needed <code>429 Too Many Requests</code> Rate limit exceeded Add delays, upgrade tier <code>500 Server Error</code> Provider outage Use fallback provider <code>AI features disabled</code> <code>ENABLE_AI=false</code> Set to <code>true</code> in .env"},{"location":"ai/providers/#best-practices","title":"Best Practices","text":""},{"location":"ai/providers/#1-security","title":"1. Security","text":"<ul> <li>\ud83d\udd10 Store API keys in environment variables, never in code</li> <li>\ud83d\udd12 Use different keys for dev/staging/prod</li> <li>\ud83d\udd04 Rotate keys regularly</li> <li>\ud83d\udeab Never commit <code>.env</code> files</li> </ul>"},{"location":"ai/providers/#2-cost-management","title":"2. Cost Management","text":"<ul> <li>\ud83d\udcb0 Start with free/cheap models (Gemini 2.0 Flash, gpt-4o-mini)</li> <li>\ud83d\udcca Monitor usage via provider dashboards</li> <li>\ud83c\udfaf Limit AI features to specific collections/fields</li> <li>\u26a0\ufe0f Set rate limits and budgets</li> </ul>"},{"location":"ai/providers/#3-performance","title":"3. Performance","text":"<ul> <li>\u26a1 Use faster models for real-time features</li> <li>\ud83d\udd04 Cache AI responses when possible</li> <li>\ud83d\udce6 Batch requests where appropriate</li> <li>\u23f1\ufe0f Set reasonable timeouts</li> </ul>"},{"location":"ai/providers/#next-steps","title":"Next Steps","text":"<ul> <li>OpenRouter Setup Guide - Use custom models</li> <li>AI Use Cases - Practical examples</li> <li>AI Overview - Understanding AI in LegoCity</li> </ul>"},{"location":"ai/use-cases/","title":"AI Use Cases for LegoCity","text":"<p>This guide covers practical use cases where AI can assist in building and managing smart city dashboards, with appropriate limitations and best practices.</p> <p>AI is Optional and Supportive</p> <p>AI features are helpers, not core functionality:</p> <pre><code>- \u2705 Find use cases where AI **saves time** without compromising quality\n- \u2705 Keep humans **in control** of critical decisions\n- \u274c Don't rely on AI for **security**, **data integrity**, or **system logic**\n</code></pre>"},{"location":"ai/use-cases/#recommended-use-cases","title":"Recommended Use Cases","text":""},{"location":"ai/use-cases/#1-content-generation-for-pages-posts","title":"1. Content Generation for Pages &amp; Posts","text":"<p>Use Case: Generate blog posts, announcements, or documentation about city services and data.</p> <p>=== \"When to Use\" - \u2705 Drafting public announcements - \u2705 Creating tutorial content - \u2705 Writing FAQ responses - \u2705 Generating example scenarios</p> Implementation <pre><code>// In PayloadCMS admin\n// Enable AI on Posts collection\n\n    export const Posts: CollectionConfig = {\n      slug: 'posts',\n      fields: [\n        {\n          name: 'title',\n          type: 'text',\n          required: true\n        },\n        {\n          name: 'content',\n          type: 'richText',\n          admin: {\n            ai: {\n              enabled: true,\n              prompts: {\n                generate: 'Write an engaging blog post about smart city initiatives'\n              }\n            }\n          }\n        }\n      ]\n    }\n    ```\n\n=== \"Example Workflow\" 1. Editor creates new post: \"New Bike Sharing Program\" 2. Clicks \"Generate with AI\" 3. AI produces draft based on title 4. Editor reviews, edits, and publishes\n\n    **AI Output**:\n    &gt; \"We're excited to announce the launch of our new bike-sharing program!\n    &gt; Starting next month, residents can access 500 bikes across 50 stations\n    &gt; throughout the city...\"\n\n=== \"Best Practices\" - \u2705 Review AI content for accuracy - \u2705 Add city-specific details manually - \u2705 Verify dates, numbers, and facts - \u2705 Maintain consistent tone and voice\n\n---\n\n### 2. Layer Description Automation\n\n**Use Case**: Generate user-friendly descriptions for map layers based on technical metadata.\n\n=== \"When to Use\" - \u2705 Creating layer descriptions quickly - \u2705 Maintaining consistent documentation - \u2705 Explaining technical data to citizens - \u2705 Multi-language descriptions\n\n=== \"Implementation\"\n```typescript\n    // Custom AI helper for layers\n    async function generateLayerDescription(layer: Layer) {\n      const prompt = `Generate a user-friendly description for this smart city map layer:\n\n      Layer Name: ${layer.name}\n      Entity Type: ${layer.entityType}\n      Attributes: ${layer.attributes.join(', ')}\n      Data Source: ${layer.source}\n\n      Write a 2-3 sentence description that:\n      - Explains what citizens can learn from this data\n      - Uses simple, non-technical language\n      - Mentions update frequency if relevant\n\n      Keep it under 100 words.`\n\n      return await ai.generateText(prompt)\n    }\n    ```\n\n=== \"Example Output\"\n**Input**: - Layer: \"Air Quality Monitoring\" - Entity Type: `AirQualityObserved` - Attributes: `pm25`, `pm10`, `no2`, `co`\n\n    **AI Generated**:\n    &gt; \"View real-time air quality measurements from sensors across the city.\n    &gt; This layer shows PM2.5, PM10, nitrogen dioxide, and carbon monoxide levels,\n    &gt; updated every hour. Use this data to check air quality in your neighborhood\n    &gt; and plan outdoor activities accordingly.\"\n\n=== \"Best Practices\" - \u2705 Provide clear, structured prompts - \u2705 Include technical context (entity type, attributes) - \u2705 Review for technical accuracy - \u2705 Ensure consistency across layers\n\n---\n\n### 3. Configuration Suggestions\n\n**Use Case**: Suggest optimal configuration based on data patterns and common practices.\n\n=== \"When to Use\" - \u2705 Recommending color schemes for layers - \u2705 Suggesting zoom levels for map views - \u2705 Proposing filter configurations - \u2705 Auto-generating legend labels\n\n=== \"Implementation\"\n```typescript\n    // Suggest color scheme for pollution data\n    async function suggestColorScheme(layerConfig: LayerConfig) {\n      const prompt = `Suggest an appropriate color scheme for this map layer:\n\n      Data Type: ${layerConfig.dataType}\n      Value Range: ${layerConfig.min} to ${layerConfig.max}\n      Purpose: ${layerConfig.purpose}\n\n      Provide 5 colors in hex format from lowest to highest value.\n      Consider accessibility and common conventions (e.g., green=good, red=bad).`\n\n      const colors = await ai.generateText(prompt)\n      return parseColors(colors)\n    }\n    ```\n\n=== \"Example Scenarios\"\n**Air Quality Index**: - AI suggests: `['#00E400', '#FFFF00', '#FF7E00', '#FF0000', '#8F3F97']` - Rationale: Standard AQI color scheme\n\n    **Temperature**:\n    - AI suggests: `['#0000FF', '#00FFFF', '#00FF00', '#FFFF00', '#FF0000']`\n    - Rationale: Cold (blue) to hot (red) gradient\n\n=== \"Limitations\" - \u26a0\ufe0f Verify color accessibility (WCAG compliance) - \u26a0\ufe0f Check color blindness compatibility - \u26a0\ufe0f Ensure cultural appropriateness - \u26a0\ufe0f Test with actual data\n\n---\n\n### 4. Documentation Assistant\n\n**Use Case**: Generate technical documentation, API examples, and configuration guides.\n\n=== \"When to Use\" - \u2705 Documenting API endpoints - \u2705 Creating configuration examples - \u2705 Writing integration guides - \u2705 Generating code snippets\n\n=== \"Implementation\"\n```typescript\n    // Generate API documentation\n    async function generateAPIDoc(endpoint: APIEndpoint) {\n      const prompt = `Generate API documentation for this endpoint:\n\n      Method: ${endpoint.method}\n      Path: ${endpoint.path}\n      Parameters: ${JSON.stringify(endpoint.params)}\n      Response: ${JSON.stringify(endpoint.response)}\n\n      Include:\n      - Description\n      - Request example (curl)\n      - Response example\n      - Common use cases`\n\n      return await ai.generateText(prompt)\n    }\n    ```\n\n=== \"Example Output\"\n**Endpoint**: `GET /api/entities/weather`\n\n    **AI Generated**:\n    ```markdown\n    ## Get Weather Entities\n\n    Retrieve weather observation entities from the context broker.\n\n    ### Request\n    ```bash\n    curl https://api.city.example/api/entities/weather?limit=10\n    ```\n\n    ### Response\n    ```json\n    {\n      \"entities\": [\n        {\n          \"id\": \"WeatherObserved:Station1\",\n          \"temperature\": 22.5,\n          \"humidity\": 65\n        }\n      ]\n    }\n    ```\n\n    ### Use Cases\n    - Display current weather on dashboard\n    - Analyze temperature trends\n    - Monitor humidity levels\n    ```\n\n=== \"Best Practices\" - \u2705 Provide complete endpoint specifications - \u2705 Verify code examples work - \u2705 Update docs when APIs change - \u2705 Include error cases\n\n---\n\n### 5. Seed Data Generation\n\n**Use Case**: Generate realistic test data for development and demos.\n\n=== \"When to Use\" - \u2705 Creating demo content - \u2705 Populating development databases - \u2705 Testing UI with varied data - \u2705 Generating placeholder content\n\n=== \"Implementation\"\n```typescript\n    // Generate sample weather data\n    async function generateSeedData(entityType: string, count: number) {\n      const prompt = `Generate ${count} realistic sample records for this entity type:\n\n      Entity Type: ${entityType}\n      Schema: ${getEntitySchema(entityType)}\n\n      Return as JSON array with realistic values for a smart city context.\n      Include varied data (different times, locations, values).`\n\n      const data = await ai.generateText(prompt)\n      return JSON.parse(data)\n    }\n    ```\n\n=== \"Example Output\"\n**Request**: 3 weather observations\n\n    **AI Generated**:\n    ```json\n    [\n      {\n        \"id\": \"WeatherObserved:Station1\",\n        \"location\": { \"coordinates\": [10.762622, 106.660172] },\n        \"temperature\": 32.5,\n        \"humidity\": 75,\n        \"observedAt\": \"2025-11-29T14:00:00Z\"\n      },\n      {\n        \"id\": \"WeatherObserved:Station2\",\n        \"location\": { \"coordinates\": [10.762733, 106.660283] },\n        \"temperature\": 31.8,\n        \"humidity\": 72,\n        \"observedAt\": \"2025-11-29T14:00:00Z\"\n      },\n      {\n        \"id\": \"WeatherObserved:Station3\",\n        \"location\": { \"coordinates\": [10.762844, 106.660394] },\n        \"temperature\": 33.2,\n        \"humidity\": 78,\n        \"observedAt\": \"2025-11-29T14:00:00Z\"\n      }\n    ]\n    ```\n\n=== \"Limitations\" - \u26a0\ufe0f Validate data schema compliance - \u26a0\ufe0f Check for realistic value ranges - \u26a0\ufe0f Verify geographic coordinates - \u26a0\ufe0f Not suitable for production data\n\n---\n\n### 6. Intelligent Search Enhancement\n\n**Use Case**: Improve search with natural language understanding and semantic matching.\n\n=== \"When to Use\" - \u2705 Natural language queries - \u2705 Semantic search for content - \u2705 Query expansion and suggestions - \u2705 Fuzzy matching for typos\n\n=== \"Implementation\"\n```typescript\n    // Enhance search with AI\n    async function enhanceSearch(query: string) {\n      // Generate search keywords\n      const prompt = `Given this search query: \"${query}\"\n\n      Generate:\n      1. Normalized keywords\n      2. Related terms\n      3. Entity types that might match\n\n      Return as JSON.`\n\n      const enhanced = await ai.generateText(prompt)\n      const { keywords, related, entityTypes } = JSON.parse(enhanced)\n\n      // Search with enhanced terms\n      return searchEntities({ keywords, related, entityTypes })\n    }\n    ```\n\n=== \"Example\"\n**User Query**: \"Where are the air pollution sensors?\"\n\n    **AI Enhancement**:\n    ```json\n    {\n      \"keywords\": [\"air\", \"pollution\", \"sensors\"],\n      \"related\": [\"air quality\", \"PM2.5\", \"PM10\", \"AQI\", \"monitoring stations\"],\n      \"entityTypes\": [\"AirQualityObserved\", \"Device\"]\n    }\n    ```\n\n    **Result**: Better search results including related terms\n\n=== \"Best Practices\" - \u2705 Cache common queries - \u2705 Fall back to regular search if AI fails - \u2705 Monitor search quality metrics - \u2705 Respect user privacy\n\n---\n\n### 7. Chatbot for Citizens\n\n**Use Case**: Answer citizen questions about city services and data.\n\n=== \"When to Use\" - \u2705 Common questions (FAQs) - \u2705 Data interpretation help - \u2705 Service information - \u2705 Navigation assistance\n\n=== \"Implementation\"\n```typescript\n    // Simple chatbot implementation\n    async function answerQuestion(question: string, context: CityContext) {\n      const prompt = `You are a helpful assistant for a smart city dashboard.\n\n      City Context:\n      - Available data: ${context.availableData.join(', ')}\n      - Services: ${context.services.join(', ')}\n\n      Citizen Question: ${question}\n\n      Provide a helpful, concise answer (max 150 words).\n      If you don't know, direct them to contact support.`\n\n      return await ai.generateText(prompt)\n    }\n    ```\n\n=== \"Example Conversation\"\n**Q**: \"How do I find parking near City Hall?\"\n\n    **AI**: \"You can use the parking facilities layer on the map to find available\n    parking near City Hall. Click on the parking icon to see real-time availability\n    and pricing. There are 3 public parking lots within 500m of City Hall with a\n    total of 250 spaces.\"\n\n    **Q**: \"What's the air quality today?\"\n\n    **AI**: \"Based on the latest readings from our air quality sensors, the Air\n    Quality Index (AQI) is 65, which is in the 'Moderate' range. This means air\n    quality is acceptable for most people, though unusually sensitive individuals\n    should consider limiting prolonged outdoor exertion.\"\n\n=== \"Safety Considerations\" - \u26a0\ufe0f Don't provide emergency response info - \u26a0\ufe0f Don't make policy decisions - \u26a0\ufe0f Always cite data sources - \u26a0\ufe0f Include disclaimers for predictions - \u26a0\ufe0f Provide human contact option\n\n---\n\n## Use Cases to AVOID\n\n### \u274c Security and Access Control\n\n**Don't use AI for**:\n\n- Deciding user permissions\n- Generating security policies\n- Validating credentials\n- Making authentication decisions\n\n**Why**: Security requires deterministic, auditable logic, not probabilistic AI.\n\n### \u274c Data Validation and Integrity\n\n**Don't use AI for**:\n\n- Validating entity schemas\n- Checking data consistency\n- Enforcing business rules\n- Data transformation logic\n\n**Why**: Data integrity requires precise, testable validation rules.\n\n### \u274c Critical Operations\n\n**Don't use AI for**:\n\n- Deployment decisions\n- System configuration\n- Database migrations\n- Backup/restore operations\n\n**Why**: Operational tasks require deterministic, tested procedures.\n\n### \u274c Real-time Alerts\n\n**Don't use AI for**:\n\n- Emergency notifications\n- Threshold-based alerts\n- Critical system warnings\n- Safety announcements\n\n**Why**: Alerts require reliable, immediate, rule-based triggers.\n\n---\n\n## Implementation Guidelines\n\n### 1. Human Review Required\n\n```typescript\n// Always require human approval for AI-generated content\nasync function generateWithApproval(prompt: string) {\n  const draft = await ai.generateText(prompt);\n\n  return {\n    draft,\n    status: \"pending_review\",\n    requiresApproval: true,\n    reviewer: null,\n    approvedAt: null,\n  };\n}\n</code></pre>"},{"location":"ai/use-cases/#2-fallback-to-manual","title":"2. Fallback to Manual","text":"<pre><code>// Graceful fallback if AI unavailable\nasync function generateContent(prompt: string) {\n  if (!process.env.ENABLE_AI) {\n    return {\n      content: \"\",\n      mode: \"manual\",\n      message: \"AI features disabled. Please enter content manually.\",\n    };\n  }\n\n  try {\n    const content = await ai.generateText(prompt);\n    return { content, mode: \"ai\" };\n  } catch (error) {\n    return {\n      content: \"\",\n      mode: \"manual\",\n      message: \"AI generation failed. Please enter content manually.\",\n    };\n  }\n}\n</code></pre>"},{"location":"ai/use-cases/#3-audit-trail","title":"3. Audit Trail","text":"<pre><code>// Log all AI operations\nasync function generateWithAudit(prompt: string, userId: string) {\n  const result = await ai.generateText(prompt);\n\n  await logAIOperation({\n    userId,\n    prompt: prompt.substring(0, 100), // Truncate for privacy\n    model: process.env.OPENROUTER_MODEL,\n    timestamp: new Date(),\n    approved: false,\n  });\n\n  return result;\n}\n</code></pre>"},{"location":"ai/use-cases/#4-cost-monitoring","title":"4. Cost Monitoring","text":"<pre><code>// Track AI usage and costs\nasync function generateWithCostTracking(prompt: string) {\n  const startTime = Date.now();\n  const result = await ai.generateText(prompt);\n  const duration = Date.now() - startTime;\n\n  await trackAICost({\n    model: process.env.OPENROUTER_MODEL,\n    promptTokens: estimateTokens(prompt),\n    completionTokens: estimateTokens(result),\n    duration,\n    cost: calculateCost(prompt, result),\n  });\n\n  return result;\n}\n</code></pre>"},{"location":"ai/use-cases/#best-practices-summary","title":"Best Practices Summary","text":""},{"location":"ai/use-cases/#do","title":"\u2705 Do","text":"<ul> <li>Use AI for drafts and suggestions</li> <li>Keep humans in control</li> <li>Review all AI outputs</li> <li>Provide manual alternatives</li> <li>Monitor costs and usage</li> <li>Log AI operations</li> <li>Test with real scenarios</li> </ul>"},{"location":"ai/use-cases/#dont","title":"\u274c Don't","text":"<ul> <li>Rely on AI for critical logic</li> <li>Auto-publish AI content</li> <li>Use AI for security decisions</li> <li>Generate production data</li> <li>Skip human review</li> <li>Ignore AI limitations</li> <li>Over-rely on AI</li> </ul>"},{"location":"ai/use-cases/#next-steps","title":"Next Steps","text":"<ul> <li>AI Provider Configuration - Set up AI providers</li> <li>OpenRouter Guide - Use custom models</li> <li>AI Overview - Understanding AI in LegoCity</li> </ul>"},{"location":"configuration/","title":"Configuration Guide","text":"<p>Configure LegoCity to work with your city's data sources, maps, and services.</p>"},{"location":"configuration/#configuration-overview","title":"Configuration Overview","text":"<p>LegoCity configuration happens in three places:</p> <ol> <li>Environment Variables (<code>.env</code>) - Secrets, URLs, API keys</li> <li>PayloadCMS Admin - Content, pages, blocks, collections</li> <li>Code Configuration - Advanced customization, plugins</li> </ol>"},{"location":"configuration/#quick-configuration-checklist","title":"Quick Configuration Checklist","text":"<p>After installation, configure these essentials:</p> <ul> <li>[ ] Data Sources - Connect NGSI-LD brokers</li> <li>[ ] Map Settings - Configure Mapbox and map views (see below)</li> <li>[ ] API Keys - Set up external service keys</li> <li>[ ] Admin Users - Create admin accounts and roles in PayloadCMS</li> <li>[ ] AI Integration (Optional) - Configure AI helpers (see AI Integration section)</li> </ul>"},{"location":"configuration/#environment-configuration","title":"Environment Configuration","text":""},{"location":"configuration/#core-settings-env","title":"Core Settings (<code>.env</code>)","text":"<pre><code># ================================\n# Database\n# ================================\nDATABASE_URI=mongodb://127.0.0.1/legocity\n\n# ================================\n# Security\n# ================================\nPAYLOAD_SECRET=your-secret-key-minimum-32-characters-long\n\n# ================================\n# Server\n# ================================\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\nPORT=3000\n\n# ================================\n# NGSI-LD Context Broker\n# ================================\nNGSI_LD_BROKER_URL=http://localhost:1026\nNGSI_LD_TENANT=your-tenant-name\n\n# ================================\n# Mapbox\n# ================================\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_access_token\n\n# ================================\n# Optional Services\n# ================================\n# Redis caching\nREDIS_URL=redis://localhost:6379\n\n# External APIs (stored server-side)\nWEATHER_API_KEY=your-weather-api-key\nGEOCODING_API_KEY=your-geocoding-api-key\n</code></pre>"},{"location":"configuration/#security-best-practices","title":"Security Best Practices","text":"<p>!!! warning \"Never Commit Secrets\" - Add <code>.env</code> to <code>.gitignore</code> - Use different secrets per environment - Rotate keys regularly</p> <p>Generate secure secrets:</p> <pre><code># Generate PAYLOAD_SECRET\nnode -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"\n\n# Or use OpenSSL\nopenssl rand -hex 32\n</code></pre> <p>Environment-specific files:</p> <pre><code>.env                    # Local development (gitignored)\n.env.example            # Template (committed)\n.env.production         # Production (secure storage)\n.env.test               # Testing\n</code></pre>"},{"location":"configuration/#payloadcms-configuration","title":"PayloadCMS Configuration","text":""},{"location":"configuration/#access-admin-panel","title":"Access Admin Panel","text":"<ol> <li>Navigate to <code>http://localhost:3000/admin</code></li> <li>Log in with admin credentials</li> <li>Explore collections:</li> </ol>"},{"location":"configuration/#collections-overview","title":"Collections Overview","text":"Collection Purpose Examples Pages Dashboard layouts Home, Map View, Analytics Posts Articles, news Announcements, guides Media Images, files Icons, photos, documents Categories Content organization News, Events, Reports Users Admin accounts Admins, Editors, Viewers"},{"location":"configuration/#global-settings","title":"Global Settings","text":"<p>Navigation \u2192 Globals \u2192 Configure:</p> <ul> <li>Header - Logo, navigation menu, theme</li> <li>Footer - Links, contact info, social media</li> <li>Site Settings - Title, description, metadata</li> </ul>"},{"location":"configuration/#configuration-workflows","title":"Configuration Workflows","text":""},{"location":"configuration/#initial-setup","title":"Initial Setup","text":"<ol> <li> <p>Create Admin Account</p> </li> <li> <p>First user automatically becomes admin</p> </li> <li> <p>Add additional users in Users collection</p> </li> <li> <p>Configure Site Basics</p> </li> <li> <p>Set site name and description</p> </li> <li>Upload logo and favicon</li> <li> <p>Configure header and footer</p> </li> <li> <p>Connect Data Sources</p> </li> <li> <p>Add NGSI-LD broker URL</p> </li> <li>Test connection</li> <li> <p>Configure entity types</p> </li> <li> <p>Set Up Maps</p> </li> <li> <p>Add Mapbox token</p> </li> <li>Create map views</li> <li> <p>Configure layers</p> </li> <li> <p>Create First Page</p> </li> <li>Use blocks to build layout</li> <li>Add map views and content</li> <li>Publish page</li> </ol>"},{"location":"configuration/#adding-a-city","title":"Adding a City","text":"<p>For multi-tenant deployments:</p> <ol> <li>Create Tenant</li> </ol> <pre><code>NGSI_LD_TENANT=city-name\n</code></pre> <ol> <li> <p>Configure Data Sources</p> </li> <li> <p>Point to city's NGSI-LD broker</p> </li> <li> <p>Map entity types to views</p> </li> <li> <p>Customize Branding</p> </li> <li> <p>Upload city logo</p> </li> <li>Set city colors (Tailwind config)</li> <li> <p>Create custom pages</p> </li> <li> <p>Load City Data</p> </li> <li>Seed database with city entities</li> <li>Create map views for city zones</li> <li>Add sample content</li> </ol>"},{"location":"configuration/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"configuration/#payload-config-payloadconfigts","title":"Payload Config (<code>payload.config.ts</code>)","text":"<pre><code>import { buildConfig } from \"payload/config\";\nimport { mongooseAdapter } from \"@payloadcms/db-mongodb\";\nimport { lexicalEditor } from \"@payloadcms/richtext-lexical\";\n\nexport default buildConfig({\n  // Admin panel\n  admin: {\n    user: Users.slug,\n    meta: {\n      titleSuffix: \"- LegoCity Admin\",\n      favicon: \"/favicon.ico\",\n    },\n  },\n\n  // Collections\n  collections: [Pages, Posts, Media, Categories, Users],\n\n  // Database\n  db: mongooseAdapter({\n    url: process.env.DATABASE_URI,\n  }),\n\n  // Editor\n  editor: lexicalEditor({}),\n\n  // Plugins\n  plugins: [\n    formBuilderPlugin(),\n    nestedDocsPlugin(),\n    redirectsPlugin(),\n    seoPlugin(),\n    searchPlugin(),\n  ],\n});\n</code></pre>"},{"location":"configuration/#nextjs-config-nextconfigjs","title":"Next.js Config (<code>next.config.js</code>)","text":"<pre><code>const withPayload = require(\"@payloadcms/next/withPayload\");\n\nmodule.exports = withPayload({\n  // Next.js config\n  reactStrictMode: true,\n\n  // Image optimization\n  images: {\n    domains: [\"api.mapbox.com\", \"your-cdn.com\"],\n  },\n\n  // Environment variables\n  env: {\n    NEXT_PUBLIC_MAPBOX_TOKEN: process.env.NEXT_PUBLIC_MAPBOX_TOKEN,\n  },\n\n  // Redirects\n  async redirects() {\n    return [\n      {\n        source: \"/home\",\n        destination: \"/\",\n        permanent: true,\n      },\n    ];\n  },\n});\n</code></pre>"},{"location":"configuration/#configuration-by-feature","title":"Configuration by Feature","text":""},{"location":"configuration/#data-integration","title":"Data Integration","text":"<p>Connect Context Broker:</p> <ul> <li>Data Sources Configuration</li> </ul>"},{"location":"configuration/#maps-visualization","title":"Maps &amp; Visualization","text":"<p>Configure Maps - See PayloadCMS admin for map configuration</p>"},{"location":"configuration/#security-access","title":"Security &amp; Access","text":"<p>Set Up Security:</p> <ul> <li>API Keys Management</li> </ul>"},{"location":"configuration/#ai-features","title":"AI Features","text":"<p>Enable AI Helpers (Optional):</p> <ul> <li>See AI Integration section for AI provider configuration</li> </ul>"},{"location":"configuration/#configuration-validation","title":"Configuration Validation","text":""},{"location":"configuration/#health-check","title":"Health Check","text":"<p>Create a health check endpoint:</p> <pre><code>// app/api/health/route.ts\nexport async function GET() {\n  const checks = {\n    database: await checkDatabase(),\n    broker: await checkBroker(),\n    mapbox: !!process.env.NEXT_PUBLIC_MAPBOX_TOKEN,\n  };\n\n  return Response.json(checks);\n}\n</code></pre> <p>Access at: <code>http://localhost:3000/api/health</code></p>"},{"location":"configuration/#verify-configuration","title":"Verify Configuration","text":"<pre><code># Check environment variables\npnpm run check:env\n\n# Test database connection\npnpm run check:db\n\n# Test NGSI-LD broker\ncurl http://localhost:1026/version\n\n# Test Mapbox token\ncurl \"https://api.mapbox.com/v4/mapbox.mapbox-streets-v8.json?access_token=$NEXT_PUBLIC_MAPBOX_TOKEN\"\n</code></pre>"},{"location":"configuration/#backup-restore","title":"Backup &amp; Restore","text":""},{"location":"configuration/#backup-configuration","title":"Backup Configuration","text":"<pre><code># Export PayloadCMS data\nmongodump --db legocity --out ./backup\n\n# Backup environment\ncp .env .env.backup\n\n# Backup media files\ncp -r public/media ./backup/media\n</code></pre>"},{"location":"configuration/#restore-configuration","title":"Restore Configuration","text":"<pre><code># Restore database\nmongorestore --db legocity ./backup/legocity\n\n# Restore environment\ncp .env.backup .env\n\n# Restore media\ncp -r ./backup/media public/media\n</code></pre>"},{"location":"configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"configuration/#configuration-not-applied","title":"Configuration Not Applied","text":"<p>Clear cache:</p> <pre><code>rm -rf .next\npnpm dev\n</code></pre> <p>Check environment:</p> <pre><code># Print config (safe variables only)\npnpm run config:show\n</code></pre>"},{"location":"configuration/#connection-failures","title":"Connection Failures","text":"<p>Test broker connection:</p> <pre><code>curl http://localhost:1026/version\n</code></pre> <p>Test database:</p> <pre><code>mongosh $DATABASE_URI --eval \"db.version()\"\n</code></pre>"},{"location":"configuration/#invalid-configuration","title":"Invalid Configuration","text":"<p>Validate schema:</p> <pre><code>pnpm run validate:config\n</code></pre> <p>Check logs:</p> <pre><code># Development mode shows detailed errors\npnpm dev\n</code></pre>"},{"location":"configuration/#configuration-references","title":"Configuration References","text":"<ul> <li>PayloadCMS Config API</li> <li>Next.js Configuration</li> </ul>"},{"location":"configuration/#next-steps","title":"Next Steps","text":"<p>After configuration:</p> <ol> <li>User Guide - Learn to use LegoCity</li> <li>Development Guide - Customize and extend</li> <li>Deployment Guide - Deploy to production</li> </ol> <p>Need specific configuration? Choose your topic:</p> <ul> <li>Data Sources - Connect brokers</li> <li>API Keys - External services</li> </ul>"},{"location":"configuration/api-keys/","title":"API keys and access control","text":"<p>This page describes how write access to the context broker is controlled in a LegoCity deployment and how API keys or tokens are shared with update servers and read clients.</p> <p>It is intended for people who:</p> <ul> <li>configure security on the broker and proxy,</li> <li>operate update servers,</li> <li>need to understand how credentials are managed across environments.</li> </ul>"},{"location":"configuration/api-keys/#access-patterns","title":"Access patterns","text":"<p>In LegoCity, there are three main classes of access to the broker and related APIs:</p> <ul> <li> <p>Write access to the broker   Granted only to update servers and administrative tools. Used to create and update NGSI-LD entities.</p> </li> <li> <p>Internal read access to the broker   Used by the proxy and internal services to query entities. May have broader permissions but is not exposed to browsers.</p> </li> <li> <p>Public read access via the proxy   Used by the dashboard and any external clients. Constrained to specific endpoints, often with rate limits.</p> </li> </ul> <p>LegoCity recommends:</p> <ul> <li>limiting write access to a small set of controlled services,</li> <li>exposing read access to the UI through a proxy layer, not directly to the broker.</li> </ul>"},{"location":"configuration/api-keys/#configuration-variables","title":"Configuration variables","text":"<p>A deployment should standardise how broker endpoints and credentials are passed into services.</p> <p>Typical variables:</p> <ul> <li> <p><code>BROKER_URL</code>   Base URL of the NGSI-LD context broker, for example: <code>https://broker.example.com/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_KEY</code> or <code>BROKER_WRITE_TOKEN</code>   Credential (token, API key, etc.) for write access.</p> </li> <li> <p><code>BROKER_READ_KEY</code> (optional)   Credential for read access, if the broker enforces read authentication.</p> </li> </ul> <p>These variables are:</p> <ul> <li>defined per environment (development, staging, production),</li> <li>set as environment variables or stored in a secret manager,</li> <li>never committed to the source repository.</li> </ul> <p>Example <code>.env</code> for local development:</p> <pre><code>BROKER_URL=https://dev-broker.example.com/ngsi-ld/v1\nBROKER_WRITE_KEY=dev-broker-write-key\nBROKER_READ_KEY=dev-broker-read-key\n</code></pre> <p><code>.env</code> files should be ignored by version control.</p>"},{"location":"configuration/api-keys/#authentication-mechanisms","title":"Authentication mechanisms","text":"<p>The actual authentication mechanism depends on the chosen broker and infrastructure. Common options:</p> <ul> <li> <p>Static API keys or tokens   Keys sent in a header such as <code>Authorization</code> or <code>X-API-Key</code>. Simple to configure.</p> </li> <li> <p>Mutual TLS (mTLS)   Client certificates used to authenticate services. Stronger security, more complex management.</p> </li> <li> <p>OAuth2 / OpenID Connect   Tokens issued by an identity provider. Useful when the broker is part of a larger identity-aware platform.</p> </li> </ul> <p>LegoCity expects that:</p> <ul> <li>update servers use non-interactive methods (no manual logins),</li> <li>credentials are configurable, not hard-coded,</li> <li>the chosen mechanism and required headers are documented for the deployment.</li> </ul>"},{"location":"configuration/api-keys/#patterns-for-write-keys","title":"Patterns for write keys","text":"<p>There are multiple ways to assign write keys to update servers. The deployment must choose one and document it.</p>"},{"location":"configuration/api-keys/#single-shared-write-key","title":"Single shared write key","text":"<p>All update servers use the same key or token to write to the broker.</p> <p>Characteristics</p> <ul> <li>one write key per broker or per environment.</li> </ul> <p>Advantages</p> <ul> <li>simple to reason about,</li> <li>low administrative overhead.</li> </ul> <p>Drawbacks</p> <ul> <li>if one server is compromised, the same key can be abused from anywhere,</li> <li>revoking the key requires updating all servers at once.</li> </ul> <p>Suitable for small deployments or prototypes.</p>"},{"location":"configuration/api-keys/#separate-keys-per-update-server","title":"Separate keys per update server","text":"<p>Each update server has its own write key or token.</p> <p>Characteristics</p> <ul> <li>different credentials for each domain server (<code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>, etc.).</li> </ul> <p>Advantages</p> <ul> <li>compromise of one server does not expose write access from others,</li> <li>access can be revoked for a single server without affecting the rest,</li> <li>possible to assign different scopes per key.</li> </ul> <p>Drawbacks</p> <ul> <li>more credentials to manage,</li> <li>more documentation required to track ownership.</li> </ul> <p>Recommended for serious deployments.</p>"},{"location":"configuration/api-keys/#hybrid-patterns","title":"Hybrid patterns","text":"<p>Some deployments may use one key per domain:</p> <ul> <li>one key for environment-related servers,</li> <li>one key for water and flooding,</li> <li>one key for mobility.</li> </ul> <p>The important point is that the pattern is stable, documented, and reflected in monitoring and incident response.</p>"},{"location":"configuration/api-keys/#storage-and-distribution","title":"Storage and distribution","text":"<p>Regardless of the pattern, keys must be stored and distributed securely.</p>"},{"location":"configuration/api-keys/#acceptable-storage","title":"Acceptable storage","text":"<ul> <li>environment variables injected at deployment time,</li> <li>secret managers provided by cloud platforms,</li> <li>secure configuration stores, separate from the application image.</li> </ul>"},{"location":"configuration/api-keys/#unacceptable-storage","title":"Unacceptable storage","text":"<ul> <li>hard-coded keys in source code,</li> <li>keys committed to git repositories,</li> <li>keys shared informally over unencrypted channels.</li> </ul>"},{"location":"configuration/api-keys/#example-configuration","title":"Example configuration","text":"<p>For three update servers:</p> <ul> <li> <p><code>env-weather-server</code></p> </li> <li> <p><code>BROKER_URL</code></p> </li> <li> <p><code>BROKER_WRITE_KEY_ENV</code></p> </li> <li> <p><code>water-flood-server</code></p> </li> <li> <p><code>BROKER_URL</code></p> </li> <li> <p><code>BROKER_WRITE_KEY_WATER</code></p> </li> <li> <p><code>mobility-parking-server</code></p> </li> <li><code>BROKER_URL</code></li> <li><code>BROKER_WRITE_KEY_MOBILITY</code></li> </ul> <p>Each service reads its configuration from the environment or a secret manager at startup.</p>"},{"location":"configuration/api-keys/#key-rotation","title":"Key rotation","text":"<p>Key rotation replaces existing keys with new ones without long service interruption.</p> <p>A simple rotation process:</p> <ol> <li> <p>Generate new keys    Create new keys or tokens at the broker or gateway. Store them in the secret manager or configuration system.</p> </li> <li> <p>Update services    Update environment variables or config for each update server to use the new key. Restart or reload the servers.</p> </li> <li> <p>Verify operation    Check that update servers continue to write entities successfully. Monitor logs and metrics for write failures.</p> </li> <li> <p>Revoke old keys    Once all services are confirmed to use the new keys, remove or disable the old keys.</p> </li> </ol> <p>The documentation should state:</p> <ul> <li>where keys are defined,</li> <li>who is allowed to rotate them,</li> <li>which monitoring signals indicate a failed rotation.</li> </ul>"},{"location":"configuration/api-keys/#read-access-and-the-proxy","title":"Read access and the proxy","text":"<p>Write access and read access must be treated differently.</p>"},{"location":"configuration/api-keys/#internal-read-access","title":"Internal read access","text":"<p>Internal services (proxy, analytics) may read directly from the broker. Depending on configuration, read operations may be:</p> <ul> <li>unrestricted inside a trusted network, or</li> <li>protected by a read-only key or token.</li> </ul> <p>If a read-only key is used, it should be:</p> <ul> <li>distinct from write keys,</li> <li>not exposed to browsers.</li> </ul>"},{"location":"configuration/api-keys/#public-read-access-via-proxy","title":"Public read access via proxy","text":"<p>The dashboard and public clients should call the proxy, not the broker directly. The proxy:</p> <ul> <li>issues read queries to the broker,</li> <li>transforms responses into simpler structures,</li> <li>enforces caching, rate limits and access control.</li> </ul> <p>Broker credentials (read or write) are never embedded in frontend code. Browsers only see the proxy URL and any proxy-level keys or user authentication mechanisms.</p>"},{"location":"configuration/api-keys/#example-scenario","title":"Example scenario","text":"<p>Consider a deployment with:</p> <ul> <li>a broker at <code>https://broker.city.example/ngsi-ld/v1</code>,</li> <li>three update servers: <code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>,</li> <li>one proxy at <code>https://api.city.example</code>.</li> </ul>"},{"location":"configuration/api-keys/#broker","title":"Broker","text":"<p>Write tokens configured at the broker or gateway:</p> <ul> <li><code>TOKEN_ENV</code> for environment entities,</li> <li><code>TOKEN_WATER</code> for water and flooding entities,</li> <li><code>TOKEN_MOBILITY</code> for mobility entities.</li> </ul>"},{"location":"configuration/api-keys/#update-servers","title":"Update servers","text":"<ul> <li> <p><code>env-weather-server</code></p> </li> <li> <p><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_TOKEN=TOKEN_ENV</code></p> </li> <li> <p><code>water-flood-server</code></p> </li> <li> <p><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_TOKEN=TOKEN_WATER</code></p> </li> <li> <p><code>mobility-parking-server</code></p> </li> <li><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></li> <li><code>BROKER_WRITE_TOKEN=TOKEN_MOBILITY</code></li> </ul> <p>Each server sends its token in the appropriate header when writing entities.</p>"},{"location":"configuration/api-keys/#proxy","title":"Proxy","text":"<ul> <li>runs at <code>https://api.city.example</code>,</li> <li>uses internal credentials or network trust to query the broker,</li> <li>exposes endpoints such as:</li> <li><code>/map/weather</code></li> <li><code>/map/flood-zones</code></li> <li><code>/map/parking-facilities</code></li> </ul> <p>The dashboard calls these endpoints and never sees broker-level tokens.</p>"},{"location":"configuration/api-keys/#incident-handling","title":"Incident handling","text":"<p>If a key is exposed or suspected to be compromised:</p> <ul> <li>identify which key was exposed and which services use it,</li> <li>revoke or disable the key at the broker or gateway,</li> <li>generate and distribute a replacement key where necessary,</li> <li>update configuration and restart affected services,</li> <li>review logs for unauthorised write attempts or suspicious patterns.</li> </ul> <p>The documentation should indicate:</p> <ul> <li>where keys can be revoked,</li> <li>which logs or dashboards show broker access,</li> <li>how to verify that entities have not been corrupted.</li> </ul>"},{"location":"configuration/api-keys/#summary","title":"Summary","text":"<ul> <li>Update servers are the only components with write access to the broker and use keys or tokens defined via configuration, not in code.</li> <li>A deployment must choose and document a clear pattern for write keys (shared, per-server, or hybrid).</li> <li>Keys must be stored securely, rotated regularly, and revoked immediately if compromised.</li> <li>The dashboard and public clients obtain data through the proxy; broker credentials are never exposed to browsers.</li> <li>Internal read access, external read access, and write access should be configured and monitored separately.</li> </ul>"},{"location":"configuration/data-sources/","title":"Data and brokers","text":"<p>This page explains in detail how the data layer of LegoCity is organised around NGSI-LD context brokers and update servers.</p> <p>It focuses on:</p> <ul> <li>what the broker is expected to store and provide,</li> <li>how data is grouped into domains,</li> <li>how update servers are designed and operated,</li> <li>how decisions about history, quality and source-of-truth are made.</li> </ul> <p>It does not cover deployment commands or infrastructure automation; those are documented in the Deployment section.</p>"},{"location":"configuration/data-sources/#1-overall-data-flow","title":"1. Overall data flow","text":"<p>The basic data flow in a LegoCity deployment is:</p> <ol> <li>An external system (for example, a weather API, a sensor gateway, a flood model, a transport feed) exposes raw data.</li> <li>An update server for that domain reads the raw data on a schedule.</li> <li>The update server converts the raw data into NGSI-LD entities that follow the agreed models and conventions.</li> <li>The update server writes those entities into a context broker.</li> <li>The dashboard and other application services read entities from the broker (usually via a proxy) and turn them into map layers and UI elements.</li> </ol> <p>The important constraints are:</p> <ul> <li>update servers are the only components that write to the broker in normal operation,</li> <li>the broker is the only source where the dashboard reads city context,</li> <li>if something is not in the broker, it does not exist from LegoCity\u2019s point of view.</li> </ul>"},{"location":"configuration/data-sources/#2-context-broker-role","title":"2. Context broker role","text":"<p>The context broker is responsible for:</p> <ul> <li>storing all current state of city entities that LegoCity needs,</li> <li>exposing a standard NGSI-LD API for create, update, query and subscription,</li> <li>providing a consistent, canonical view of \u201cwhat the city looks like right now\u201d.</li> </ul> <p>From LegoCity\u2019s perspective, the broker must:</p> <ul> <li>store entities for all domains in scope (for example, environment, flooding, mobility, public services),</li> <li>support geospatial queries and filtering on attributes that the UI will need,</li> <li>handle the expected volume and update frequency of the entities.</li> </ul> <p>The broker is not expected to:</p> <ul> <li>perform heavy analytics,</li> <li>render maps,</li> <li>be aware of UI concepts like pages, blocks or permissions inside the dashboard.</li> </ul> <p>Those concerns are external to the broker.</p>"},{"location":"configuration/data-sources/#21-what-is-stored-in-the-broker","title":"2.1 What is stored in the broker","text":"<p>For each domain, the broker stores:</p> <ul> <li>entity identifiers that represent real-world objects or observations,</li> <li>current values of attributes (status, measurements, capacities, etc.),</li> <li>geospatial attributes (locations, geometries, coverage areas),</li> <li>timestamps that indicate when the information was observed or last updated.</li> </ul> <p>Examples of what is in scope for the broker:</p> <ul> <li>\u201cThere is a flood zone with this polygon and this current risk level.\u201d</li> <li>\u201cThere is a parking facility with this capacity and this current occupancy.\u201d</li> <li>\u201cThere is a weather observation at this location with this temperature and humidity.\u201d</li> </ul> <p>If the dashboard needs to show a value for the user, that value should be present or derivable from entities in the broker.</p>"},{"location":"configuration/data-sources/#22-what-is-not-stored-in-the-broker","title":"2.2 What is not stored in the broker","text":"<p>The broker is not required to store:</p> <ul> <li>UI configuration (map styles, layer visibility defaults, panel layouts),</li> <li>user accounts, roles or permissions,</li> <li>documentation or descriptive text that is only relevant for the admin UI.</li> </ul> <p>These items belong to PayloadCMS or other parts of the LegoCity stack.</p>"},{"location":"configuration/data-sources/#3-broker-topology","title":"3. Broker topology","text":"<p>A LegoCity deployment must choose how many brokers to run and what each one is responsible for. This is a structural decision that affects every other part of the system.</p>"},{"location":"configuration/data-sources/#31-single-broker-deployments","title":"3.1 Single-broker deployments","text":"<p>In a single-broker deployment:</p> <ul> <li>one broker instance stores all entities for the deployment (all domains, all city areas),</li> <li>all update servers write to that broker,</li> <li>all dashboards and application services read from that broker.</li> </ul> <p>This is usually the default for:</p> <ul> <li>proofs of concept,</li> <li>small to medium deployments,</li> <li>a single city or campus.</li> </ul> <p>Advantages:</p> <ul> <li>fewer endpoints to configure,</li> <li>simpler monitoring and logging,</li> <li>easier for new team members to understand.</li> </ul> <p>Risks and constraints:</p> <ul> <li>if the broker is unavailable, all domains are affected,</li> <li>all domains share the same performance and scaling limits,</li> <li>careful naming and scoping is needed to avoid conflicts between domains.</li> </ul> <p>In practice, a single-broker deployment should still separate environments (for example, one broker for development and one for production).</p>"},{"location":"configuration/data-sources/#32-multi-broker-deployments","title":"3.2 Multi-broker deployments","text":"<p>In a multi-broker deployment, different brokers are used for different scopes. Common patterns:</p> <ul> <li>one broker per environment (development, staging, production),</li> <li>one broker per city or administrative region,</li> <li>one broker for high-frequency telemetry and another for more static reference data.</li> </ul> <p>Advantages:</p> <ul> <li>clearer separation between environments or cities,</li> <li>different tuning and retention policies per broker,</li> <li>failures in one broker do not immediately affect all domains.</li> </ul> <p>Costs and constraints:</p> <ul> <li>more endpoints and credentials to manage,</li> <li>update servers must know which broker to write to,</li> <li>dashboards and proxies must be configured to query the correct broker for each context.</li> </ul> <p>The documentation of a LegoCity deployment should explicitly list:</p> <ul> <li>each broker instance (name and base URL),</li> <li>which domains and entity types each broker owns,</li> <li>which update servers and applications are allowed to access each broker.</li> </ul>"},{"location":"configuration/data-sources/#4-domains-and-ownership","title":"4. Domains and ownership","text":"<p>Without structure, a broker can become a random collection of entities. LegoCity encourages grouping entities into domains and assigning clear responsibility.</p> <p>Typical domains are:</p> <ul> <li>Environment (weather, air quality, noise),</li> <li>Water and flooding,</li> <li>Mobility and transport,</li> <li>Public services (health, education, administration),</li> <li>Infrastructure assets (parking, charging stations, cameras).</li> </ul> <p>For each domain, the documentation should state:</p> <ul> <li>which entity types belong to it (by <code>type</code> name),</li> <li>which update server(s) are responsible for creating and updating those entities,</li> <li>which broker instance stores those entities,</li> <li>which dashboards or map views consume that domain.</li> </ul> <p>This gives a clear answer to questions like:</p> <ul> <li>\u201cIf flood data is wrong, which server should we check?\u201d</li> <li>\u201cWhere does the air quality data come from?\u201d</li> <li>\u201cIf we add a new city, which domains need new brokers or new servers?\u201d</li> </ul> <p>Domains are a documentation and ownership concept; they are not a new technical component.</p>"},{"location":"configuration/data-sources/#5-update-servers","title":"5. Update servers","text":"<p>Update servers are integration services. They connect external systems to the context broker and are the only regular writers of entities.</p>"},{"location":"configuration/data-sources/#51-responsibilities","title":"5.1 Responsibilities","text":"<p>An update server is responsible for a complete loop:</p> <ol> <li>Configuration    It reads all its configuration from environment variables or configuration files, including:</li> <li>broker URL and credentials,</li> <li>external API endpoints and keys,</li> <li> <p>update frequency and any domain-specific parameters (for example, list of locations to monitor).</p> </li> <li> <p>Data ingestion    It contacts external data sources:</p> </li> <li>fetches raw data,</li> <li>handles paging, rate limits and temporary errors,</li> <li> <p>validates that the received data is structurally sound.</p> </li> <li> <p>Transformation    It converts raw data into the internal entity representation:</p> </li> <li>chooses the entity type,</li> <li>sets identifiers according to the project\u2019s conventions,</li> <li>fills attributes that match the chosen Smart Data Model,</li> <li> <p>sets locations and timestamps.</p> </li> <li> <p>Publishing    It writes entities to the broker:</p> </li> <li>creates entities that do not exist yet,</li> <li>updates attributes for existing entities,</li> <li> <p>handles partial failures and retries where appropriate.</p> </li> <li> <p>Reporting and health    It logs key events:</p> </li> <li>how many entities were created or updated,</li> <li>when the last successful update occurred,</li> <li>whether there were errors and of what kind.</li> </ol> <p>This loop can be implemented as a continuously running service with a timer or as a scheduled job.</p>"},{"location":"configuration/data-sources/#52-granularity-and-scope","title":"5.2 Granularity and scope","text":"<p>The recommended approach is to keep update servers narrow in scope:</p> <ul> <li>one server per external data source,</li> <li>or one server per domain when sources are tightly related.</li> </ul> <p>This avoids:</p> <ul> <li>mixing unrelated concerns in a single codebase,</li> <li>making one failure affect many domains,</li> <li>creating hidden couplings that are hard to debug.</li> </ul> <p>Each server should have a clear name and documented scope, for example:</p> <ul> <li><code>env-weather-server</code> \u2013 reads weather API, writes <code>WeatherObserved</code>,</li> <li><code>water-flood-server</code> \u2013 reads flood model outputs, writes <code>FloodZone</code>,</li> <li><code>mobility-parking-server</code> \u2013 reads parking backend, writes <code>ParkingFacility</code> and <code>ParkingSpot</code>.</li> </ul>"},{"location":"configuration/data-sources/#53-idempotency-and-conflict-handling","title":"5.3 Idempotency and conflict handling","text":"<p>Update servers should be designed to be idempotent:</p> <ul> <li>running the same update twice in a row should not create duplicate entities,</li> <li>updates should always converge to the correct state.</li> </ul> <p>This has implications for:</p> <ul> <li>how IDs are generated (stable IDs vs new random IDs),</li> <li>how updates are applied (replace vs patch),</li> <li>how deleted or obsolete entities are handled (explicit deletion, or marking as inactive).</li> </ul> <p>The project should define how deletions and deactivations are represented, so the UI can interpret them correctly (for example, whether inactive entities are hidden or styled differently).</p>"},{"location":"configuration/data-sources/#6-current-state-and-history","title":"6. Current state and history","text":"<p>NGSI-LD brokers can support both current context and temporal queries, but LegoCity must define how it uses this capability.</p>"},{"location":"configuration/data-sources/#61-current-state","title":"6.1 Current state","text":"<p>For many dashboards, only the current state matters. For example:</p> <ul> <li>current water level,</li> <li>current parking occupancy,</li> <li>current flood risk level.</li> </ul> <p>In this mode:</p> <ul> <li>the broker holds one entity per real-world object,</li> <li>each update overwrites relevant attributes,</li> <li>old values are not kept in the broker.</li> </ul> <p>This is simpler to operate and often sufficient for monitoring-style use cases.</p>"},{"location":"configuration/data-sources/#62-history-and-trends","title":"6.2 History and trends","text":"<p>For some use cases, LegoCity may need short-term history, for example:</p> <ul> <li>charts of the last 24 hours of weather or air quality,</li> <li>recent evolution of water levels during a flood event.</li> </ul> <p>Two approaches are possible:</p> <ul> <li>use the broker\u2019s temporal features (if available and enabled) to store attribute history,</li> <li>forward data to a specialised time-series database while keeping only the latest values in the broker.</li> </ul> <p>The choice should be documented for each domain:</p> <ul> <li>which domains store only current state,</li> <li>which domains retain a limited history,</li> <li>where long-term analytics data is stored if not in the broker.</li> </ul> <p>The dashboard and proxy must be aligned with this decision so that queries are realistic and efficient.</p>"},{"location":"configuration/data-sources/#7-data-contracts-and-conventions","title":"7. Data contracts and conventions","text":"<p>To keep the data layer coherent, LegoCity relies on explicit data contracts between update servers, brokers and the UI.</p> <p>These contracts cover:</p> <ul> <li>which entity types are used,</li> <li>which attributes must be present,</li> <li>which naming conventions are followed.</li> </ul>"},{"location":"configuration/data-sources/#71-entity-types-and-models","title":"7.1 Entity types and models","text":"<p>For each entity type used in LegoCity, the documentation should specify:</p> <ul> <li>the name of the entity type (for example, <code>WeatherObserved</code>),</li> <li>whether it follows a FIWARE Smart Data Model directly, an extended version, or a custom schema,</li> <li>which attributes are mandatory (must always be present),</li> <li>which attributes are optional and under which conditions they appear.</li> </ul> <p>Update servers must respect these definitions when creating or updating entities.</p>"},{"location":"configuration/data-sources/#72-identifiers","title":"7.2 Identifiers","text":"<p>Identifiers (<code>id</code>) need to be:</p> <ul> <li>stable over time for the same real-world object or location,</li> <li>predictable enough that systems can refer to entities by ID if needed,</li> <li>unique across the broker, or at least across a domain.</li> </ul> <p>The documentation should state:</p> <ul> <li>how IDs are constructed (for example, URN patterns that include domain and location),</li> <li>whether IDs are derived from external identifiers or generated internally,</li> <li>how ID changes are handled if an external system renames something.</li> </ul>"},{"location":"configuration/data-sources/#73-geospatial-attributes","title":"7.3 Geospatial attributes","text":"<p>Because LegoCity is map-centric, geospatial attributes must be consistent:</p> <ul> <li>which attribute name is used for location (for example, always <code>location</code>),</li> <li>which types of geometries are expected for each entity type (point, line, polygon),</li> <li>how coordinate reference systems are handled (typically WGS84).</li> </ul> <p>This consistency allows:</p> <ul> <li>generic map layers that can handle many entity types,</li> <li>simple filtering by bounding box or area of interest.</li> </ul>"},{"location":"configuration/data-sources/#74-time-attributes","title":"7.4 Time attributes","text":"<p>Time is critical for context:</p> <ul> <li>each observation-type entity should have a clear observation timestamp,</li> <li>entities representing static objects (for example, a public facility) may have creation or last-update timestamps.</li> </ul> <p>The documentation should list:</p> <ul> <li>which attributes carry time information,</li> <li>how they are used in the UI (for example, to mark stale data).</li> </ul>"},{"location":"configuration/data-sources/#8-multiple-sources-for-the-same-entity-type","title":"8. Multiple sources for the same entity type","text":"<p>Sometimes more than one external source can provide data for the same conceptual entity type. For example, different agencies might publish partially overlapping flood maps.</p> <p>In such cases, LegoCity needs explicit rules to avoid confusion:</p> <ul> <li>whether one source is considered the authoritative source and others are ignored,</li> <li>whether entities from different sources are kept separate by ID and metadata,</li> <li>whether a dedicated aggregation service combines data from multiple sources into a single set of entities.</li> </ul> <p>If multiple sources are used, the documentation should specify for each entity type:</p> <ul> <li>which sources feed this type,</li> <li>how conflicts are resolved,</li> <li>which attributes indicate the origin or quality of each entity.</li> </ul>"},{"location":"configuration/data-sources/#9-subscriptions-and-reactive-flows","title":"9. Subscriptions and reactive flows","text":"<p>NGSI-LD supports subscriptions so that services can be notified when entities change. LegoCity may use subscriptions to drive backend workflows, but not as a primary mechanism for the dashboard.</p> <p>Possible uses include:</p> <ul> <li>a service that updates aggregated indicators when sensor entities change,</li> <li>a monitoring component that alerts when certain thresholds are crossed.</li> </ul> <p>If subscriptions are used:</p> <ul> <li>the components that create and manage subscriptions should be identified,</li> <li>the scopes of subscriptions (which entity types, which conditions) should be documented,</li> <li>error handling and recovery strategies should be defined (what happens when notification delivery fails).</li> </ul> <p>The dashboard is expected to continue using normal queries; any \u201cpush\u201d logic should be mediated by application services.</p>"},{"location":"configuration/data-sources/#10-relationship-to-the-dashboard-and-proxy","title":"10. Relationship to the dashboard and proxy","text":"<p>The data layer and the UI layer communicate through a narrow interface.</p> <p>In a typical setup:</p> <ul> <li>the proxy layer exposes a small set of HTTP endpoints tailored to the UI,</li> <li>these endpoints internally query the broker using NGSI-LD and project the results into simpler structures,</li> <li>the dashboard calls these endpoints to obtain the data it needs for map views and blocks.</li> </ul> <p>Consequences:</p> <ul> <li>the broker\u2019s internal details are not exposed directly to browsers or untrusted clients,</li> <li>changes in entity structures can be absorbed by the proxy without immediately breaking the UI,</li> <li>security policies (who can read what) can be implemented in one place.</li> </ul> <p>The design of these proxy endpoints is documented in the Development section; from the data-layer perspective, it is enough to understand that:</p> <ul> <li>read access is centralised,</li> <li>write access remains with update servers,</li> <li>the broker remains the single source of truth.</li> </ul>"},{"location":"configuration/data-sources/#11-summary","title":"11. Summary","text":"<ul> <li>The context broker stores the current representation of the city as NGSI-LD entities and is treated as the source of truth.</li> <li>A deployment must choose and document its broker topology (single or multiple brokers) and domain structure.</li> <li>Domains group related entity types and update servers; each domain has clear ownership and responsibilities.</li> <li>Update servers are the only regular writers to the broker and must follow shared data contracts for entity structure, identifiers, geospatial attributes and timestamps.</li> <li>Decisions about history, retention and multiple data sources must be explicit so that the dashboard and analytics behave predictably.</li> <li>The dashboard reads from the broker through a proxy, keeping UI concerns clearly separated from data ingestion and storage.</li> </ul>"},{"location":"core-concepts/lego-dashboard/","title":"Lego Dashboard Internals","text":"<p>The Lego Dashboard is the visual interface and control center for SematX. Built on PayloadCMS, it provides entity management, dashboard building, and API key generation.</p>"},{"location":"core-concepts/lego-dashboard/#overview","title":"Overview","text":"<p>The Lego Dashboard serves multiple purposes:</p> <ul> <li>Admin UI: Web interface for managing entities and settings</li> <li>Dashboard Builder: Drag-and-drop card creation</li> <li>API Server: RESTful API for programmatic access</li> <li>User Management: Authentication and access control</li> <li>Entity Browser: Visual NGSI-LD entity explorer</li> </ul>"},{"location":"core-concepts/lego-dashboard/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Lego Dashboard                         \u2502\n\u2502                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502         Next.js Application                    \u2502    \u2502\n\u2502  \u2502  \u2022 Server-Side Rendering (SSR)                 \u2502    \u2502\n\u2502  \u2502  \u2022 API Routes (/api/*)                         \u2502    \u2502\n\u2502  \u2502  \u2022 Static Asset Serving                        \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                       \u2502                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502         PayloadCMS Core                        \u2502    \u2502\n\u2502  \u2502  \u2022 Collection Management                       \u2502    \u2502\n\u2502  \u2502  \u2022 Admin Panel Rendering                       \u2502    \u2502\n\u2502  \u2502  \u2022 Hooks &amp; Lifecycle Events                    \u2502    \u2502\n\u2502  \u2502  \u2022 Plugin System                               \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                       \u2502                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  React Admin UI                                \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502    \u2502\n\u2502  \u2502  \u2502  Entity     \u2502  \u2502  Dashboard  \u2502            \u2502    \u2502\n\u2502  \u2502  \u2502  Manager    \u2502  \u2502  Builder    \u2502            \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502    \u2502\n\u2502  \u2502  \u2502  API Key    \u2502  \u2502  User       \u2502            \u2502    \u2502\n\u2502  \u2502  \u2502  Manager    \u2502  \u2502  Manager    \u2502            \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                       \u2502                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Custom Components &amp; Blocks                    \u2502    \u2502\n\u2502  \u2502  \u2022 Card Renderer                               \u2502    \u2502\n\u2502  \u2502  \u2022 NGSI-LD Entity Forms                        \u2502    \u2502\n\u2502  \u2502  \u2022 Real-time Data Display                      \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                       \u2502                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  MongoDB Adapter                               \u2502    \u2502\n\u2502  \u2502  \u2022 CRUD Operations                             \u2502    \u2502\n\u2502  \u2502  \u2022 Query Building                              \u2502    \u2502\n\u2502  \u2502  \u2022 Relationships                               \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                  \u2502  MongoDB   \u2502\n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#payloadcms-collections","title":"PayloadCMS Collections","text":"<p>Collections are the data structures in PayloadCMS. SematX defines several key collections:</p>"},{"location":"core-concepts/lego-dashboard/#1-users-collection","title":"1. Users Collection","text":"<p>Manages authentication and user accounts:</p> <pre><code>// src/collections/Users/index.ts\nimport { CollectionConfig } from 'payload/types';\n\nexport const Users: CollectionConfig = {\n  slug: 'users',\n  auth: {\n    tokenExpiration: 7200, // 2 hours\n    verify: false,\n    maxLoginAttempts: 5,\n    lockTime: 600000, // 10 minutes\n  },\n  admin: {\n    useAsTitle: 'email',\n    defaultColumns: ['email', 'name', 'role', 'createdAt'],\n  },\n  access: {\n    read: () =&gt; true,\n    create: () =&gt; true,\n    update: ({ req: { user } }) =&gt; {\n      // Users can update their own profile\n      if (user) {\n        return {\n          id: {\n            equals: user.id,\n          },\n        };\n      }\n      return false;\n    },\n    delete: ({ req: { user } }) =&gt; {\n      // Only admins can delete users\n      return user?.role === 'admin';\n    },\n  },\n  fields: [\n    {\n      name: 'name',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'email',\n      type: 'email',\n      required: true,\n      unique: true,\n    },\n    {\n      name: 'role',\n      type: 'select',\n      defaultValue: 'user',\n      options: [\n        { label: 'Admin', value: 'admin' },\n        { label: 'User', value: 'user' },\n        { label: 'Viewer', value: 'viewer' },\n      ],\n      required: true,\n    },\n    {\n      name: 'tenant',\n      type: 'text',\n      admin: {\n        description: 'NGSI-LD tenant for multi-tenancy',\n      },\n    },\n  ],\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#2-api-keys-collection","title":"2. API Keys Collection","text":"<p>Manages JWT tokens for API access:</p> <pre><code>// src/collections/APIKeys.ts\nimport { CollectionConfig } from 'payload/types';\nimport jwt from 'jsonwebtoken';\n\nexport const APIKeys: CollectionConfig = {\n  slug: 'api-keys',\n  admin: {\n    useAsTitle: 'name',\n    defaultColumns: ['name', 'user', 'expiresAt', 'createdAt'],\n  },\n  access: {\n    read: ({ req: { user } }) =&gt; {\n      if (user?.role === 'admin') return true;\n      // Users can only see their own API keys\n      return {\n        user: {\n          equals: user?.id,\n        },\n      };\n    },\n    create: () =&gt; true,\n    delete: ({ req: { user } }) =&gt; {\n      if (user?.role === 'admin') return true;\n      return {\n        user: {\n          equals: user?.id,\n        },\n      };\n    },\n  },\n  fields: [\n    {\n      name: 'name',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'user',\n      type: 'relationship',\n      relationTo: 'users',\n      required: true,\n      hasMany: false,\n    },\n    {\n      name: 'token',\n      type: 'text',\n      admin: {\n        readOnly: true,\n        description: 'JWT token - shown only once on creation',\n      },\n    },\n    {\n      name: 'permissions',\n      type: 'select',\n      hasMany: true,\n      options: [\n        { label: 'Read Entities', value: 'read:entities' },\n        { label: 'Write Entities', value: 'write:entities' },\n        { label: 'Delete Entities', value: 'delete:entities' },\n        { label: 'Manage Subscriptions', value: 'manage:subscriptions' },\n      ],\n      defaultValue: ['read:entities'],\n    },\n    {\n      name: 'rateLimit',\n      type: 'number',\n      defaultValue: 100,\n      admin: {\n        description: 'Requests per minute',\n      },\n    },\n    {\n      name: 'expiresAt',\n      type: 'date',\n      admin: {\n        description: 'Leave empty for no expiration',\n      },\n    },\n    {\n      name: 'lastUsedAt',\n      type: 'date',\n      admin: {\n        readOnly: true,\n      },\n    },\n  ],\n  hooks: {\n    beforeChange: [\n      async ({ operation, data, req }) =&gt; {\n        // Generate JWT token on creation\n        if (operation === 'create') {\n          const payload = {\n            userId: data.user,\n            email: req.user?.email,\n            permissions: data.permissions || ['read:entities'],\n            tenant: req.user?.tenant || 'default',\n            rateLimit: data.rateLimit || 100,\n            iat: Math.floor(Date.now() / 1000),\n          };\n\n          if (data.expiresAt) {\n            payload.exp = Math.floor(new Date(data.expiresAt).getTime() / 1000);\n          }\n\n          const token = jwt.sign(payload, process.env.JWT_SECRET || 'secret');\n          data.token = token;\n        }\n        return data;\n      },\n    ],\n  },\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#3-cards-collection","title":"3. Cards Collection","text":"<p>Dashboard card configurations:</p> <pre><code>// src/collections/Cards.ts\nimport { CollectionConfig } from 'payload/types';\n\nexport const Cards: CollectionConfig = {\n  slug: 'cards',\n  admin: {\n    useAsTitle: 'name',\n    defaultColumns: ['name', 'type', 'entityType', 'createdAt'],\n  },\n  access: {\n    read: () =&gt; true,\n    create: ({ req: { user } }) =&gt; !!user,\n    update: ({ req: { user } }) =&gt; !!user,\n    delete: ({ req: { user } }) =&gt; !!user,\n  },\n  fields: [\n    {\n      name: 'name',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'description',\n      type: 'textarea',\n    },\n    {\n      name: 'type',\n      type: 'select',\n      required: true,\n      options: [\n        { label: 'Metric', value: 'metric' },\n        { label: 'Chart', value: 'chart' },\n        { label: 'Map', value: 'map' },\n        { label: 'Table', value: 'table' },\n        { label: 'Gauge', value: 'gauge' },\n      ],\n    },\n    {\n      name: 'entityType',\n      type: 'text',\n      required: true,\n      admin: {\n        description: 'NGSI-LD entity type (e.g., TemperatureSensor)',\n      },\n    },\n    {\n      name: 'entityId',\n      type: 'text',\n      admin: {\n        description: 'Specific entity ID (optional)',\n      },\n    },\n    {\n      name: 'attribute',\n      type: 'text',\n      admin: {\n        description: 'Entity attribute to display',\n      },\n    },\n    {\n      name: 'configuration',\n      type: 'json',\n      admin: {\n        description: 'Card-specific configuration (colors, thresholds, etc.)',\n      },\n    },\n    {\n      name: 'layout',\n      type: 'group',\n      fields: [\n        {\n          name: 'width',\n          type: 'number',\n          defaultValue: 12,\n          min: 1,\n          max: 12,\n          admin: {\n            description: 'Grid columns (1-12)',\n          },\n        },\n        {\n          name: 'height',\n          type: 'number',\n          defaultValue: 200,\n          admin: {\n            description: 'Height in pixels',\n          },\n        },\n        {\n          name: 'order',\n          type: 'number',\n          defaultValue: 0,\n        },\n      ],\n    },\n    {\n      name: 'refreshInterval',\n      type: 'number',\n      defaultValue: 60,\n      admin: {\n        description: 'Auto-refresh interval in seconds',\n      },\n    },\n  ],\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#4-data-sources-collection","title":"4. Data Sources Collection","text":"<p>External data source configurations:</p> <pre><code>// src/collections/DataSources.ts\nimport { CollectionConfig } from 'payload/types';\n\nexport const DataSources: CollectionConfig = {\n  slug: 'data-sources',\n  admin: {\n    useAsTitle: 'name',\n  },\n  fields: [\n    {\n      name: 'name',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'type',\n      type: 'select',\n      required: true,\n      options: [\n        { label: 'Orion-LD', value: 'orion-ld' },\n        { label: 'HTTP API', value: 'http' },\n        { label: 'MQTT', value: 'mqtt' },\n        { label: 'WebSocket', value: 'websocket' },\n      ],\n    },\n    {\n      name: 'url',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'authentication',\n      type: 'group',\n      fields: [\n        {\n          name: 'type',\n          type: 'select',\n          options: [\n            { label: 'None', value: 'none' },\n            { label: 'Basic Auth', value: 'basic' },\n            { label: 'Bearer Token', value: 'bearer' },\n            { label: 'API Key', value: 'api-key' },\n          ],\n          defaultValue: 'none',\n        },\n        {\n          name: 'credentials',\n          type: 'json',\n          admin: {\n            description: 'Authentication credentials',\n          },\n        },\n      ],\n    },\n    {\n      name: 'tenant',\n      type: 'text',\n      admin: {\n        description: 'NGSI-LD tenant name',\n      },\n    },\n  ],\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#ngsi-ld-entity-management","title":"NGSI-LD Entity Management","text":""},{"location":"core-concepts/lego-dashboard/#entity-browser-component","title":"Entity Browser Component","text":"<p>Custom React component for browsing entities:</p> <pre><code>// src/components/EntityBrowser/index.tsx\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from 'payload/components/utilities';\n\ninterface Entity {\n  id: string;\n  type: string;\n  [key: string]: any;\n}\n\nexport const EntityBrowser: React.FC = () =&gt; {\n  const { user } = useAuth();\n  const [entities, setEntities] = useState&lt;Entity[]&gt;([]);\n  const [loading, setLoading] = useState(true);\n  const [entityType, setEntityType] = useState('');\n\n  useEffect(() =&gt; {\n    fetchEntities();\n  }, [entityType]);\n\n  const fetchEntities = async () =&gt; {\n    setLoading(true);\n    try {\n      const query = entityType ? `?type=${entityType}` : '';\n      const response = await fetch(`/api/entities${query}`, {\n        headers: {\n          'Authorization': `Bearer ${user?.token}`,\n        },\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setEntities(data);\n      }\n    } catch (error) {\n      console.error('Failed to fetch entities:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deleteEntity = async (entityId: string) =&gt; {\n    if (!confirm('Are you sure you want to delete this entity?')) return;\n\n    try {\n      const response = await fetch(`/api/entities/${encodeURIComponent(entityId)}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${user?.token}`,\n        },\n      });\n\n      if (response.ok) {\n        fetchEntities(); // Refresh list\n      }\n    } catch (error) {\n      console.error('Failed to delete entity:', error);\n    }\n  };\n\n  return (\n    &lt;div className=\"entity-browser\"&gt;\n      &lt;div className=\"filters\"&gt;\n        &lt;input\n          type=\"text\"\n          placeholder=\"Filter by entity type...\"\n          value={entityType}\n          onChange={(e) =&gt; setEntityType(e.target.value)}\n        /&gt;\n        &lt;button onClick={fetchEntities}&gt;Refresh&lt;/button&gt;\n      &lt;/div&gt;\n\n      {loading ? (\n        &lt;div&gt;Loading...&lt;/div&gt;\n      ) : (\n        &lt;table className=\"entity-table\"&gt;\n          &lt;thead&gt;\n            &lt;tr&gt;\n              &lt;th&gt;ID&lt;/th&gt;\n              &lt;th&gt;Type&lt;/th&gt;\n              &lt;th&gt;Attributes&lt;/th&gt;\n              &lt;th&gt;Actions&lt;/th&gt;\n            &lt;/tr&gt;\n          &lt;/thead&gt;\n          &lt;tbody&gt;\n            {entities.map((entity) =&gt; (\n              &lt;tr key={entity.id}&gt;\n                &lt;td&gt;{entity.id}&lt;/td&gt;\n                &lt;td&gt;{entity.type}&lt;/td&gt;\n                &lt;td&gt;{Object.keys(entity).filter(k =&gt; !['id', 'type', '@context'].includes(k)).length}&lt;/td&gt;\n                &lt;td&gt;\n                  &lt;button onClick={() =&gt; window.open(`/admin/entities/${entity.id}`, '_blank')}&gt;\n                    View\n                  &lt;/button&gt;\n                  &lt;button onClick={() =&gt; deleteEntity(entity.id)}&gt;\n                    Delete\n                  &lt;/button&gt;\n                &lt;/td&gt;\n              &lt;/tr&gt;\n            ))}\n          &lt;/tbody&gt;\n        &lt;/table&gt;\n      )}\n    &lt;/div&gt;\n  );\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#entity-api-endpoints","title":"Entity API Endpoints","text":"<p>Custom API routes for entity operations:</p> <pre><code>// src/app/api/entities/route.ts\nimport { NextRequest, NextResponse } from 'next/server';\n\nconst ORION_URL = process.env.ORION_URL || 'http://orion:1026';\n\nexport async function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams;\n  const type = searchParams.get('type');\n  const limit = searchParams.get('limit') || '100';\n\n  const url = new URL(`${ORION_URL}/ngsi-ld/v1/entities`);\n  if (type) url.searchParams.set('type', type);\n  url.searchParams.set('limit', limit);\n\n  try {\n    const response = await fetch(url.toString(), {\n      headers: {\n        'Accept': 'application/ld+json',\n        'Authorization': request.headers.get('Authorization') || '',\n        'NGSILD-Tenant': request.headers.get('NGSILD-Tenant') || 'default',\n      },\n    });\n\n    if (!response.ok) {\n      return NextResponse.json(\n        { error: 'Failed to fetch entities' },\n        { status: response.status }\n      );\n    }\n\n    const data = await response.json();\n    return NextResponse.json(data);\n  } catch (error) {\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const entity = await request.json();\n\n    const response = await fetch(`${ORION_URL}/ngsi-ld/v1/entities`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/ld+json',\n        'Authorization': request.headers.get('Authorization') || '',\n        'NGSILD-Tenant': request.headers.get('NGSILD-Tenant') || 'default',\n      },\n      body: JSON.stringify(entity),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      return NextResponse.json(\n        { error },\n        { status: response.status }\n      );\n    }\n\n    return NextResponse.json(\n      { success: true },\n      { status: 201 }\n    );\n  } catch (error) {\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#access-control-system","title":"Access Control System","text":""},{"location":"core-concepts/lego-dashboard/#role-based-access-control-rbac","title":"Role-Based Access Control (RBAC)","text":"<p>PayloadCMS access control configuration:</p> <pre><code>// Access control for entities\nconst entityAccess = {\n  read: ({ req: { user } }) =&gt; {\n    // Admins can read everything\n    if (user?.role === 'admin') return true;\n\n    // Users can only read entities in their tenant\n    return {\n      tenant: {\n        equals: user?.tenant || 'default',\n      },\n    };\n  },\n\n  create: ({ req: { user } }) =&gt; {\n    // Only authenticated users can create\n    return !!user;\n  },\n\n  update: ({ req: { user }, id }) =&gt; {\n    // Admins can update everything\n    if (user?.role === 'admin') return true;\n\n    // Users can only update entities they own\n    return {\n      createdBy: {\n        equals: user?.id,\n      },\n      tenant: {\n        equals: user?.tenant || 'default',\n      },\n    };\n  },\n\n  delete: ({ req: { user } }) =&gt; {\n    // Only admins can delete\n    return user?.role === 'admin';\n  },\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#field-level-access","title":"Field-Level Access","text":"<pre><code>{\n  name: 'sensitiveData',\n  type: 'text',\n  access: {\n    read: ({ req: { user } }) =&gt; user?.role === 'admin',\n    update: ({ req: { user } }) =&gt; user?.role === 'admin',\n  },\n}\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#card-rendering-engine","title":"Card Rendering Engine","text":""},{"location":"core-concepts/lego-dashboard/#card-renderer-component","title":"Card Renderer Component","text":"<pre><code>// src/components/CardRenderer/index.tsx\nimport React from 'react';\nimport { MetricCard } from './MetricCard';\nimport { ChartCard } from './ChartCard';\nimport { MapCard } from './MapCard';\nimport { TableCard } from './TableCard';\n\ninterface CardConfig {\n  id: string;\n  type: string;\n  name: string;\n  entityType: string;\n  entityId?: string;\n  attribute?: string;\n  configuration: any;\n  layout: {\n    width: number;\n    height: number;\n    order: number;\n  };\n  refreshInterval: number;\n}\n\nexport const CardRenderer: React.FC&lt;{ config: CardConfig }&gt; = ({ config }) =&gt; {\n  const renderCard = () =&gt; {\n    switch (config.type) {\n      case 'metric':\n        return &lt;MetricCard config={config} /&gt;;\n      case 'chart':\n        return &lt;ChartCard config={config} /&gt;;\n      case 'map':\n        return &lt;MapCard config={config} /&gt;;\n      case 'table':\n        return &lt;TableCard config={config} /&gt;;\n      default:\n        return &lt;div&gt;Unknown card type: {config.type}&lt;/div&gt;;\n    }\n  };\n\n  return (\n    &lt;div\n      className=\"card-container\"\n      style={{\n        gridColumn: `span ${config.layout.width}`,\n        height: `${config.layout.height}px`,\n        order: config.layout.order,\n      }}\n    &gt;\n      {renderCard()}\n    &lt;/div&gt;\n  );\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#metric-card-implementation","title":"Metric Card Implementation","text":"<pre><code>// src/components/CardRenderer/MetricCard.tsx\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from 'payload/components/utilities';\n\nexport const MetricCard: React.FC&lt;{ config: any }&gt; = ({ config }) =&gt; {\n  const { user } = useAuth();\n  const [value, setValue] = useState&lt;number | null&gt;(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() =&gt; {\n    fetchValue();\n    const interval = setInterval(fetchValue, config.refreshInterval * 1000);\n    return () =&gt; clearInterval(interval);\n  }, [config]);\n\n  const fetchValue = async () =&gt; {\n    try {\n      const response = await fetch(\n        `/api/entities/${encodeURIComponent(config.entityId)}`,\n        {\n          headers: {\n            'Authorization': `Bearer ${user?.token}`,\n          },\n        }\n      );\n\n      if (response.ok) {\n        const entity = await response.json();\n        const attrValue = entity[config.attribute]?.value;\n        setValue(attrValue);\n      }\n    } catch (error) {\n      console.error('Failed to fetch value:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getColor = () =&gt; {\n    if (value === null) return config.configuration.color || '#888';\n\n    const threshold = config.configuration.threshold;\n    if (!threshold) return config.configuration.color || '#51CF66';\n\n    if (threshold.critical &amp;&amp; value &gt;= threshold.critical.min) {\n      return threshold.critical.color || '#FF0000';\n    }\n    if (threshold.warning &amp;&amp; value &gt;= threshold.warning.min) {\n      return threshold.warning.color || '#FFA500';\n    }\n    return threshold.normal?.color || '#51CF66';\n  };\n\n  return (\n    &lt;div className=\"metric-card\" style={{ borderColor: getColor() }}&gt;\n      &lt;div className=\"metric-label\"&gt;{config.configuration.label || config.name}&lt;/div&gt;\n      &lt;div className=\"metric-value\" style={{ color: getColor() }}&gt;\n        {loading ? (\n          '...'\n        ) : value !== null ? (\n          &lt;&gt;\n            {value.toFixed(config.configuration.decimals || 1)}\n            {config.configuration.unit &amp;&amp; (\n              &lt;span className=\"metric-unit\"&gt;{config.configuration.unit}&lt;/span&gt;\n            )}\n          &lt;/&gt;\n        ) : (\n          'No data'\n        )}\n      &lt;/div&gt;\n    &lt;/div&gt;\n  );\n};\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#real-time-subscriptions","title":"Real-Time Subscriptions","text":""},{"location":"core-concepts/lego-dashboard/#websocket-integration","title":"WebSocket Integration","text":"<pre><code>// src/services/websocket.ts\nimport { Server } from 'socket.io';\nimport { Server as HttpServer } from 'http';\n\nexport function initializeWebSocket(httpServer: HttpServer) {\n  const io = new Server(httpServer, {\n    cors: {\n      origin: '*',\n      methods: ['GET', 'POST'],\n    },\n  });\n\n  io.on('connection', (socket) =&gt; {\n    console.log('Client connected:', socket.id);\n\n    // Subscribe to entity updates\n    socket.on('subscribe', (data: { entityType?: string; entityId?: string }) =&gt; {\n      const room = data.entityId || `type:${data.entityType}`;\n      socket.join(room);\n      console.log(`Client ${socket.id} subscribed to ${room}`);\n    });\n\n    // Unsubscribe\n    socket.on('unsubscribe', (data: { entityType?: string; entityId?: string }) =&gt; {\n      const room = data.entityId || `type:${data.entityType}`;\n      socket.leave(room);\n      console.log(`Client ${socket.id} unsubscribed from ${room}`);\n    });\n\n    socket.on('disconnect', () =&gt; {\n      console.log('Client disconnected:', socket.id);\n    });\n  });\n\n  return io;\n}\n\n// Broadcast entity updates\nexport function broadcastEntityUpdate(io: Server, entity: any) {\n  // Broadcast to entity ID room\n  io.to(entity.id).emit('entity:update', entity);\n\n  // Broadcast to entity type room\n  io.to(`type:${entity.type}`).emit('entity:update', entity);\n}\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#ngsi-ld-subscription-handler","title":"NGSI-LD Subscription Handler","text":"<pre><code>// src/app/api/webhooks/ngsi-ld/route.ts\nimport { NextRequest, NextResponse } from 'next/server';\nimport { getIO } from '@/services/websocket';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const notification = await request.json();\n\n    console.log('Received NGSI-LD notification:', notification.id);\n\n    // Broadcast to connected WebSocket clients\n    const io = getIO();\n    notification.data.forEach((entity: any) =&gt; {\n      io.to(entity.id).emit('entity:update', entity);\n      io.to(`type:${entity.type}`).emit('entity:update', entity);\n    });\n\n    // Always respond quickly\n    return NextResponse.json({ success: true }, { status: 200 });\n  } catch (error) {\n    console.error('Error processing notification:', error);\n    return NextResponse.json({ success: false }, { status: 500 });\n  }\n}\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#performance-optimization","title":"Performance Optimization","text":""},{"location":"core-concepts/lego-dashboard/#database-indexing","title":"Database Indexing","text":"<pre><code>// src/server.ts\nimport payload from 'payload';\n\nawait payload.init({\n  // ... other config\n  onInit: async () =&gt; {\n    // Create indexes for better query performance\n    const db = payload.db;\n\n    // Index on API keys\n    await db.collection('api-keys').createIndex({ user: 1, expiresAt: 1 });\n\n    // Index on cards\n    await db.collection('cards').createIndex({ entityType: 1, entityId: 1 });\n\n    // Index on data sources\n    await db.collection('data-sources').createIndex({ type: 1, tenant: 1 });\n\n    console.log('Database indexes created');\n  },\n});\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#caching-strategy","title":"Caching Strategy","text":"<pre><code>// src/services/cache.ts\nimport { Redis } from 'ioredis';\n\nconst redis = new Redis(process.env.REDIS_URL || 'redis://localhost:6379');\n\nexport async function getCachedEntity(entityId: string): Promise&lt;any | null&gt; {\n  const cached = await redis.get(`entity:${entityId}`);\n  return cached ? JSON.parse(cached) : null;\n}\n\nexport async function setCachedEntity(entityId: string, entity: any, ttl: number = 60) {\n  await redis.setex(`entity:${entityId}`, ttl, JSON.stringify(entity));\n}\n\nexport async function invalidateEntityCache(entityId: string) {\n  await redis.del(`entity:${entityId}`);\n}\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#monitoring-and-debugging","title":"Monitoring and Debugging","text":""},{"location":"core-concepts/lego-dashboard/#custom-logging","title":"Custom Logging","text":"<pre><code>// src/utils/logger.ts\nimport winston from 'winston';\n\nexport const logger = winston.createLogger({\n  level: process.env.LOG_LEVEL || 'info',\n  format: winston.format.combine(\n    winston.format.timestamp(),\n    winston.format.json()\n  ),\n  transports: [\n    new winston.transports.Console({\n      format: winston.format.simple(),\n    }),\n    new winston.transports.File({\n      filename: 'logs/dashboard.log',\n      maxsize: 10485760, // 10MB\n      maxFiles: 5,\n    }),\n  ],\n});\n\n// Usage\nlogger.info('Entity created', { entityId: 'urn:ngsi-ld:Sensor:001' });\nlogger.error('Failed to fetch entities', { error: error.message });\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#health-check-endpoint","title":"Health Check Endpoint","text":"<pre><code>// src/app/api/health/route.ts\nimport { NextResponse } from 'next/server';\nimport payload from 'payload';\n\nexport async function GET() {\n  try {\n    // Check database connection\n    await payload.db.connect();\n\n    // Check Orion-LD connection\n    const orionResponse = await fetch(`${process.env.ORION_URL}/version`);\n    const orionHealthy = orionResponse.ok;\n\n    const health = {\n      status: orionHealthy ? 'healthy' : 'degraded',\n      timestamp: new Date().toISOString(),\n      services: {\n        database: 'up',\n        orion: orionHealthy ? 'up' : 'down',\n      },\n    };\n\n    return NextResponse.json(health, {\n      status: orionHealthy ? 200 : 503,\n    });\n  } catch (error) {\n    return NextResponse.json(\n      {\n        status: 'unhealthy',\n        error: error.message,\n      },\n      { status: 503 }\n    );\n  }\n}\n</code></pre>"},{"location":"core-concepts/lego-dashboard/#best-practices","title":"Best Practices","text":""},{"location":"core-concepts/lego-dashboard/#security","title":"Security","text":"<p>\u2705 Do: - Validate all user inputs - Use parameterized queries - Implement rate limiting per user - Sanitize entity data before display - Keep dependencies updated - Use environment variables for secrets</p> <p>\u274c Don't: - Trust client-side data - Store passwords in plain text - Expose internal error details - Allow unlimited file uploads - Use eval() or similar functions</p>"},{"location":"core-concepts/lego-dashboard/#performance","title":"Performance","text":"<p>\u2705 Do: - Use database indexes - Implement caching for frequently accessed data - Paginate large result sets - Use WebSockets for real-time updates - Optimize bundle size (code splitting) - Monitor query performance</p> <p>\u274c Don't: - Fetch all entities at once - Make N+1 queries - Block the event loop - Keep unused connections open - Cache sensitive data</p>"},{"location":"core-concepts/lego-dashboard/#next-steps","title":"Next Steps","text":"<ul> <li>Deployment Guide \u2192 - Deploy to production</li> <li>Development \u2192 - Extend and customize</li> <li>Troubleshooting \u2192 - Common issues and solutions</li> </ul>"},{"location":"core-concepts/lego-dashboard/#further-reading","title":"Further Reading","text":"<ul> <li>PayloadCMS Documentation</li> <li>Next.js Documentation</li> <li>React Documentation</li> <li>MongoDB Best Practices</li> </ul>"},{"location":"core-concepts/orion-nginx/","title":"Orion Nginx Gateway","text":"<p>The Orion Nginx Gateway is the front door to your SematX deployment. It handles authentication, rate limiting, routing, and security for all API requests.</p>"},{"location":"core-concepts/orion-nginx/#overview","title":"Overview","text":"<p>The gateway sits between clients and backend services (Orion-LD and Lego Dashboard), providing:</p> <ul> <li>Authentication: JWT token validation</li> <li>Authorization: Permission checking</li> <li>Rate Limiting: Request throttling</li> <li>Routing: Request forwarding to correct service</li> <li>Security: CORS, SSL/TLS, security headers</li> <li>Monitoring: Access logging and metrics</li> </ul>"},{"location":"core-concepts/orion-nginx/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Orion Nginx Gateway                   \u2502\n\u2502                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502           Nginx Core (C/C++)                   \u2502    \u2502\n\u2502  \u2502  \u2022 Event Loop                                  \u2502    \u2502\n\u2502  \u2502  \u2022 Connection Handling                         \u2502    \u2502\n\u2502  \u2502  \u2022 SSL/TLS Termination                         \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                         \u2502                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                \u2502    \u2502\n\u2502  \u25bc                                                \u25bc    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Lua Authentication \u2502         \u2502  Rate Limiting  \u2502  \u2502\n\u2502  \u2502  Module             \u2502         \u2502  Module         \u2502  \u2502\n\u2502  \u2502                     \u2502         \u2502                 \u2502  \u2502\n\u2502  \u2502  \u2022 JWT Decode       \u2502         \u2502  \u2022 Token Bucket \u2502  \u2502\n\u2502  \u2502  \u2022 Signature Verify \u2502         \u2502  \u2022 Redis Cache  \u2502  \u2502\n\u2502  \u2502  \u2022 Claims Extract   \u2502         \u2502  \u2022 Per-key Limit\u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                         \u2502                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502           Request Routing                      \u2502    \u2502\n\u2502  \u2502  \u2022 /ngsi-ld/* \u2192 Orion-LD                      \u2502    \u2502\n\u2502  \u2502  \u2022 /api/* \u2192 Dashboard                         \u2502    \u2502\n\u2502  \u2502  \u2022 /admin/* \u2192 Dashboard UI                    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"core-concepts/orion-nginx/#jwt-authentication","title":"JWT Authentication","text":""},{"location":"core-concepts/orion-nginx/#how-jwt-works-in-sematx","title":"How JWT Works in SematX","text":"<ol> <li>User obtains API key from Lego Dashboard</li> <li>API key IS the JWT token (no separate auth step needed)</li> <li>Client includes token in Authorization header</li> <li>Nginx validates token using Lua script</li> <li>Request forwarded to backend if valid</li> </ol>"},{"location":"core-concepts/orion-nginx/#jwt-token-structure","title":"JWT Token Structure","text":"<pre><code>// Header\n{\n  \"alg\": \"HS256\",\n  \"typ\": \"JWT\"\n}\n\n// Payload\n{\n  \"userId\": \"6587f2a123456789\",\n  \"email\": \"user@example.com\",\n  \"permissions\": [\"read:entities\", \"write:entities\"],\n  \"tenant\": \"my-iot-project\",\n  \"rateLimit\": 100,\n  \"iat\": 1704153600,    // Issued at\n  \"exp\": 1712015600     // Expires at\n}\n\n// Signature\nHMACSHA256(\n  base64UrlEncode(header) + \".\" + base64UrlEncode(payload),\n  secret\n)\n</code></pre>"},{"location":"core-concepts/orion-nginx/#nginx-jwt-validation","title":"Nginx JWT Validation","text":"<p>The Lua script that validates JWTs:</p> <pre><code>-- /etc/nginx/lua/jwt_verify.lua\n\nlocal jwt = require \"resty.jwt\"\nlocal cjson = require \"cjson\"\n\n-- Read JWT from Authorization header\nlocal auth_header = ngx.var.http_authorization\nif not auth_header then\n    ngx.status = 401\n    ngx.say('{\"error\": \"Missing Authorization header\"}')\n    ngx.exit(401)\nend\n\n-- Extract token (format: \"Bearer &lt;token&gt;\")\nlocal token = string.match(auth_header, \"Bearer%s+(.+)\")\nif not token then\n    ngx.status = 401\n    ngx.say('{\"error\": \"Invalid Authorization format\"}')\n    ngx.exit(401)\nend\n\n-- Verify JWT signature\nlocal jwt_secret = os.getenv(\"JWT_SECRET\")\nlocal jwt_obj = jwt:verify(jwt_secret, token)\n\nif not jwt_obj.verified then\n    ngx.status = 401\n    ngx.say('{\"error\": \"Invalid token: ' .. jwt_obj.reason .. '\"}')\n    ngx.exit(401)\nend\n\n-- Check expiration\nlocal now = ngx.time()\nif jwt_obj.payload.exp and jwt_obj.payload.exp &lt; now then\n    ngx.status = 401\n    ngx.say('{\"error\": \"Token expired\"}')\n    ngx.exit(401)\nend\n\n-- Extract claims for downstream use\nngx.var.jwt_user_id = jwt_obj.payload.userId\nngx.var.jwt_tenant = jwt_obj.payload.tenant or \"default\"\nngx.var.jwt_rate_limit = jwt_obj.payload.rateLimit or 100\n\n-- Set tenant header for Orion-LD\nif jwt_obj.payload.tenant then\n    ngx.req.set_header(\"NGSILD-Tenant\", jwt_obj.payload.tenant)\nend\n</code></pre>"},{"location":"core-concepts/orion-nginx/#nginx-configuration","title":"Nginx Configuration","text":"<pre><code># /etc/nginx/nginx.conf\n\nhttp {\n    # Load Lua modules\n    lua_package_path \"/usr/local/openresty/lualib/?.lua;;\";\n\n    # JWT secret from environment\n    env JWT_SECRET;\n\n    # Rate limiting zones\n    limit_req_zone $jwt_user_id zone=api_limit:10m rate=100r/m;\n\n    upstream dashboard {\n        server dashboard:3000 max_fails=3 fail_timeout=30s;\n        keepalive 32;\n    }\n\n    upstream orion {\n        server orion:1026 max_fails=3 fail_timeout=30s;\n        keepalive 32;\n    }\n\n    server {\n        listen 80;\n        server_name _;\n\n        # Redirect HTTP to HTTPS\n        return 301 https://$host$request_uri;\n    }\n\n    server {\n        listen 443 ssl http2;\n        server_name api.sematx.io;\n\n        # SSL configuration\n        ssl_certificate /etc/nginx/ssl/cert.pem;\n        ssl_certificate_key /etc/nginx/ssl/key.pem;\n        ssl_protocols TLSv1.2 TLSv1.3;\n        ssl_ciphers HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers on;\n\n        # Security headers\n        add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;\n        add_header X-Frame-Options \"SAMEORIGIN\" always;\n        add_header X-Content-Type-Options \"nosniff\" always;\n        add_header X-XSS-Protection \"1; mode=block\" always;\n\n        # CORS headers\n        add_header Access-Control-Allow-Origin \"*\" always;\n        add_header Access-Control-Allow-Methods \"GET, POST, PATCH, DELETE, OPTIONS\" always;\n        add_header Access-Control-Allow-Headers \"Authorization, Content-Type, NGSILD-Tenant\" always;\n\n        # Handle OPTIONS preflight\n        if ($request_method = OPTIONS) {\n            return 204;\n        }\n\n        # Health check endpoint (no auth)\n        location /health {\n            access_log off;\n            return 200 \"OK\\n\";\n            add_header Content-Type text/plain;\n        }\n\n        # Dashboard UI (no auth for login page)\n        location /admin {\n            proxy_pass http://dashboard;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n\n        # Dashboard API (requires auth)\n        location /api/ {\n            access_by_lua_file /etc/nginx/lua/jwt_verify.lua;\n\n            limit_req zone=api_limit burst=20 nodelay;\n\n            proxy_pass http://dashboard;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-User-ID $jwt_user_id;\n            proxy_set_header X-Tenant $jwt_tenant;\n        }\n\n        # Orion-LD NGSI-LD API (requires auth)\n        location /ngsi-ld/ {\n            access_by_lua_file /etc/nginx/lua/jwt_verify.lua;\n\n            limit_req zone=api_limit burst=20 nodelay;\n\n            proxy_pass http://orion;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header NGSILD-Tenant $jwt_tenant;\n\n            # Timeouts for long queries\n            proxy_connect_timeout 60s;\n            proxy_send_timeout 60s;\n            proxy_read_timeout 60s;\n        }\n\n        # Access logs\n        access_log /var/log/nginx/access.log combined;\n        error_log /var/log/nginx/error.log warn;\n    }\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#rate-limiting","title":"Rate Limiting","text":""},{"location":"core-concepts/orion-nginx/#how-rate-limiting-works","title":"How Rate Limiting Works","text":"<p>SematX uses token bucket algorithm:</p> <ol> <li>Each API key has a bucket of tokens</li> <li>Bucket refills at a constant rate (e.g., 100 tokens/minute)</li> <li>Each request consumes 1 token</li> <li>If bucket is empty, request is rejected with 429</li> </ol>"},{"location":"core-concepts/orion-nginx/#rate-limit-configuration","title":"Rate Limit Configuration","text":"<pre><code># Define rate limit zone\nlimit_req_zone $jwt_user_id zone=api_limit:10m rate=100r/m;\n\n# Apply to location\nlocation /ngsi-ld/ {\n    # Allow bursts of 20 requests\n    # nodelay = don't delay requests, reject immediately if over limit\n    limit_req zone=api_limit burst=20 nodelay;\n\n    # Custom error response\n    limit_req_status 429;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#rate-limit-headers","title":"Rate Limit Headers","text":"<p>Nginx adds headers to inform clients:</p> <pre><code>HTTP/1.1 200 OK\nX-RateLimit-Limit: 100\nX-RateLimit-Remaining: 85\nX-RateLimit-Reset: 1704153660\n</code></pre>"},{"location":"core-concepts/orion-nginx/#per-key-rate-limits","title":"Per-Key Rate Limits","text":"<p>Different API keys can have different limits:</p> <pre><code>-- In jwt_verify.lua\nlocal rate_limit = jwt_obj.payload.rateLimit or 100\n\n-- Set dynamic rate limit\nngx.var.rate_limit = rate_limit .. \"r/m\"\n</code></pre> <pre><code># Use variable rate limit\nlimit_req_zone $jwt_user_id zone=api_limit:10m rate=$rate_limit;\n</code></pre>"},{"location":"core-concepts/orion-nginx/#request-routing","title":"Request Routing","text":""},{"location":"core-concepts/orion-nginx/#routing-table","title":"Routing Table","text":"Path Pattern Backend Description <code>/health</code> Local Health check <code>/admin/*</code> Dashboard Admin UI <code>/api/*</code> Dashboard Dashboard API <code>/ngsi-ld/*</code> Orion-LD NGSI-LD API <code>/*</code> Dashboard Frontend assets"},{"location":"core-concepts/orion-nginx/#path-rewriting","title":"Path Rewriting","text":"<p>Some paths need rewriting:</p> <pre><code># Rewrite /api/v1/entities to /entities\nlocation /api/v1/ {\n    rewrite ^/api/v1/(.*)$ /$1 break;\n    proxy_pass http://dashboard;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#load-balancing","title":"Load Balancing","text":"<p>For multiple backend instances:</p> <pre><code>upstream orion_cluster {\n    # Round-robin (default)\n    server orion-1:1026 weight=1;\n    server orion-2:1026 weight=1;\n    server orion-3:1026 weight=2;  # More powerful server\n\n    # Health checks\n    keepalive 32;\n    keepalive_timeout 60s;\n}\n\nlocation /ngsi-ld/ {\n    proxy_pass http://orion_cluster;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#sticky-sessions","title":"Sticky Sessions","text":"<p>If needed for stateful applications:</p> <pre><code>upstream dashboard_cluster {\n    ip_hash;  # Route same IP to same backend\n    server dashboard-1:3000;\n    server dashboard-2:3000;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#ssltls-configuration","title":"SSL/TLS Configuration","text":""},{"location":"core-concepts/orion-nginx/#generate-self-signed-certificate-development","title":"Generate Self-Signed Certificate (Development)","text":"<pre><code>openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n  -keyout /etc/nginx/ssl/key.pem \\\n  -out /etc/nginx/ssl/cert.pem \\\n  -subj \"/CN=localhost\"\n</code></pre>"},{"location":"core-concepts/orion-nginx/#production-certificate-lets-encrypt","title":"Production Certificate (Let's Encrypt)","text":"<pre><code># Install certbot\napt-get install certbot python3-certbot-nginx\n\n# Obtain certificate\ncertbot --nginx -d api.sematx.io\n\n# Auto-renewal (cron job)\n0 0 * * * certbot renew --quiet\n</code></pre>"},{"location":"core-concepts/orion-nginx/#ssl-best-practices","title":"SSL Best Practices","text":"<pre><code>server {\n    listen 443 ssl http2;\n\n    # Certificates\n    ssl_certificate /etc/letsencrypt/live/api.sematx.io/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/api.sematx.io/privkey.pem;\n\n    # Protocols (disable old versions)\n    ssl_protocols TLSv1.2 TLSv1.3;\n\n    # Ciphers (strong only)\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';\n    ssl_prefer_server_ciphers on;\n\n    # OCSP stapling\n    ssl_stapling on;\n    ssl_stapling_verify on;\n\n    # Session cache\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n\n    # HSTS header\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#security-headers","title":"Security Headers","text":""},{"location":"core-concepts/orion-nginx/#essential-security-headers","title":"Essential Security Headers","text":"<pre><code># Prevent clickjacking\nadd_header X-Frame-Options \"SAMEORIGIN\" always;\n\n# Prevent MIME sniffing\nadd_header X-Content-Type-Options \"nosniff\" always;\n\n# XSS protection\nadd_header X-XSS-Protection \"1; mode=block\" always;\n\n# Referrer policy\nadd_header Referrer-Policy \"strict-origin-when-cross-origin\" always;\n\n# Content Security Policy\nadd_header Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';\" always;\n\n# Permissions policy\nadd_header Permissions-Policy \"geolocation=(), microphone=(), camera=()\" always;\n</code></pre>"},{"location":"core-concepts/orion-nginx/#performance-optimization","title":"Performance Optimization","text":""},{"location":"core-concepts/orion-nginx/#connection-pooling","title":"Connection Pooling","text":"<pre><code>upstream orion {\n    server orion:1026;\n\n    # Keep 32 idle connections open\n    keepalive 32;\n    keepalive_timeout 60s;\n    keepalive_requests 100;\n}\n\nlocation /ngsi-ld/ {\n    proxy_pass http://orion;\n\n    # Use HTTP/1.1 for keepalive\n    proxy_http_version 1.1;\n    proxy_set_header Connection \"\";\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#caching","title":"Caching","text":"<pre><code># Define cache zone\nproxy_cache_path /var/cache/nginx levels=1:2 keys_zone=api_cache:10m max_size=1g inactive=60m;\n\nlocation /ngsi-ld/v1/entities {\n    # Cache GET requests only\n    proxy_cache api_cache;\n    proxy_cache_valid 200 1m;\n    proxy_cache_key \"$request_uri|$jwt_user_id\";\n    proxy_cache_methods GET HEAD;\n\n    # Add cache status header\n    add_header X-Cache-Status $upstream_cache_status;\n\n    proxy_pass http://orion;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#compression","title":"Compression","text":"<pre><code>http {\n    # Enable gzip\n    gzip on;\n    gzip_vary on;\n    gzip_min_length 1024;\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/ld+json;\n    gzip_comp_level 6;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#buffer-tuning","title":"Buffer Tuning","text":"<pre><code>http {\n    # Client buffers\n    client_body_buffer_size 128k;\n    client_max_body_size 10m;\n    client_header_buffer_size 1k;\n    large_client_header_buffers 4 8k;\n\n    # Proxy buffers\n    proxy_buffer_size 4k;\n    proxy_buffers 8 4k;\n    proxy_busy_buffers_size 8k;\n}\n</code></pre>"},{"location":"core-concepts/orion-nginx/#monitoring-and-logging","title":"Monitoring and Logging","text":""},{"location":"core-concepts/orion-nginx/#access-log-format","title":"Access Log Format","text":"<pre><code>log_format main '$remote_addr - $remote_user [$time_local] '\n                '\"$request\" $status $body_bytes_sent '\n                '\"$http_referer\" \"$http_user_agent\" '\n                'rt=$request_time uct=\"$upstream_connect_time\" '\n                'uht=\"$upstream_header_time\" urt=\"$upstream_response_time\" '\n                'tenant=\"$jwt_tenant\" user=\"$jwt_user_id\"';\n\naccess_log /var/log/nginx/access.log main;\n</code></pre>"},{"location":"core-concepts/orion-nginx/#metrics-endpoint","title":"Metrics Endpoint","text":"<pre><code># Nginx stub_status module\nlocation /nginx_status {\n    stub_status on;\n    access_log off;\n    allow 127.0.0.1;\n    deny all;\n}\n</code></pre> <p>Output: <pre><code>Active connections: 245\nserver accepts handled requests\n 1000 1000 3000\nReading: 0 Writing: 1 Waiting: 244\n</code></pre></p>"},{"location":"core-concepts/orion-nginx/#prometheus-exporter","title":"Prometheus Exporter","text":"<p>Use <code>nginx-prometheus-exporter</code>:</p> <pre><code>docker run -p 9113:9113 nginx/nginx-prometheus-exporter:latest \\\n  -nginx.scrape-uri=http://localhost/nginx_status\n</code></pre>"},{"location":"core-concepts/orion-nginx/#troubleshooting","title":"Troubleshooting","text":""},{"location":"core-concepts/orion-nginx/#common-issues","title":"Common Issues","text":""},{"location":"core-concepts/orion-nginx/#502-bad-gateway","title":"502 Bad Gateway","text":"<p>Causes: - Backend service down - Connection timeout - Backend overloaded</p> <p>Debug: <pre><code># Check backend health\ncurl http://orion:1026/version\n\n# Check Nginx error logs\ntail -f /var/log/nginx/error.log\n\n# Test backend connection\ntelnet orion 1026\n</code></pre></p>"},{"location":"core-concepts/orion-nginx/#401-unauthorized","title":"401 Unauthorized","text":"<p>Causes: - Invalid JWT token - Expired token - Wrong secret key</p> <p>Debug: <pre><code># Decode JWT (without verification)\necho \"YOUR_TOKEN\" | base64 -d\n\n# Check Nginx Lua logs\ntail -f /var/log/nginx/error.log | grep lua\n</code></pre></p>"},{"location":"core-concepts/orion-nginx/#429-too-many-requests","title":"429 Too Many Requests","text":"<p>Causes: - Exceeded rate limit - Rate limit zone full</p> <p>Debug: <pre><code># Increase zone size\nlimit_req_zone $jwt_user_id zone=api_limit:50m rate=100r/m;\n\n# Check current usage\n# View /var/cache/nginx/rate_limit\n</code></pre></p>"},{"location":"core-concepts/orion-nginx/#debug-mode","title":"Debug Mode","text":"<p>Enable debug logging:</p> <pre><code>error_log /var/log/nginx/error.log debug;\n\n# Reload Nginx\nnginx -s reload\n</code></pre>"},{"location":"core-concepts/orion-nginx/#best-practices","title":"Best Practices","text":""},{"location":"core-concepts/orion-nginx/#security","title":"Security","text":"<p>\u2705 Do: - Use HTTPS in production - Rotate JWT secrets regularly - Implement rate limiting - Validate all inputs - Keep Nginx updated - Use strong SSL ciphers</p> <p>\u274c Don't: - Expose Nginx status publicly - Use default SSL certificates - Allow unlimited request sizes - Trust client headers blindly - Run Nginx as root</p>"},{"location":"core-concepts/orion-nginx/#performance","title":"Performance","text":"<p>\u2705 Do: - Enable keepalive connections - Use connection pooling - Enable gzip compression - Cache static content - Tune buffer sizes - Monitor metrics</p> <p>\u274c Don't: - Keep too many idle connections - Cache dynamic content - Use synchronous I/O - Ignore memory limits</p>"},{"location":"core-concepts/orion-nginx/#next-steps","title":"Next Steps","text":"<ul> <li>Lego Dashboard Internals \u2192 - Learn about dashboard architecture</li> <li>Deployment Guide \u2192 - Deploy to production</li> <li>Configuration \u2192 - Configure your instance</li> </ul>"},{"location":"core-concepts/orion-nginx/#further-reading","title":"Further Reading","text":"<ul> <li>Nginx Official Docs</li> <li>OpenResty Lua</li> <li>JWT RFC 7519</li> <li>OWASP Security Headers</li> </ul>"},{"location":"core-concepts/overview/","title":"Core Concepts","text":"<p>This section provides deep technical insights into how SematX works internally. Understanding these concepts will help you make better architectural decisions and troubleshoot issues effectively.</p>"},{"location":"core-concepts/overview/#what-youll-learn","title":"What You'll Learn","text":"<p>This section covers the technical internals of SematX's core components:</p>"},{"location":"core-concepts/overview/#orion-nginx-gateway","title":"Orion Nginx Gateway","text":"<p>Deep dive into the API gateway layer: - JWT authentication and token validation - Request routing and proxying - Rate limiting implementation - CORS and security headers - SSL/TLS configuration - Performance optimization - Monitoring and logging</p>"},{"location":"core-concepts/overview/#lego-dashboard-internals","title":"Lego Dashboard Internals","text":"<p>Understanding the dashboard architecture: - PayloadCMS collection structure - NGSI-LD entity management - Access control system - Card rendering engine - Real-time subscriptions - API key generation - Data source configuration</p>"},{"location":"core-concepts/overview/#when-to-read-this","title":"When to Read This","text":"<p>Read Core Concepts if you: - Need to customize or extend SematX - Want to deploy to production - Need to troubleshoot issues - Want to contribute to development - Need to integrate with existing systems - Want to understand security model</p> <p>Skip Core Concepts if you: - Just want to use SematX quickly - Don't need technical details - Only building simple applications</p>"},{"location":"core-concepts/overview/#architecture-recap","title":"Architecture Recap","text":"<p>Before diving into specifics, let's review the high-level architecture:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Client Layer                       \u2502\n\u2502  (Web Apps, Mobile Apps, IoT Devices, APIs)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n                       \u2502 HTTPS + JWT\n                       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Orion Nginx Gateway                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  \u2022 JWT Validation                          \u2502    \u2502\n\u2502  \u2502  \u2022 Rate Limiting                           \u2502    \u2502\n\u2502  \u2502  \u2022 Request Routing                         \u2502    \u2502\n\u2502  \u2502  \u2022 SSL Termination                         \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502                         \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Lego Dashboard    \u2502    \u2502   Orion-LD Context   \u2502\n\u2502  (PayloadCMS)      \u2502    \u2502   Broker (FIWARE)    \u2502\n\u2502                    \u2502    \u2502                      \u2502\n\u2502  \u2022 Web UI          \u2502    \u2502  \u2022 Entity Storage    \u2502\n\u2502  \u2022 API Management  \u2502    \u2502  \u2022 NGSI-LD API       \u2502\n\u2502  \u2022 User Auth       \u2502    \u2502  \u2022 Subscriptions     \u2502\n\u2502  \u2022 Dashboard Cards \u2502    \u2502  \u2022 Queries           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502                        \u2502\n          \u2502                        \u2502\n          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502    MongoDB Database      \u2502\n          \u2502                          \u2502\n          \u2502  \u2022 Dashboard Config      \u2502\n          \u2502  \u2022 User Data             \u2502\n          \u2502  \u2022 Entity Data           \u2502\n          \u2502  \u2022 Subscriptions         \u2502\n          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"core-concepts/overview/#key-technical-decisions","title":"Key Technical Decisions","text":""},{"location":"core-concepts/overview/#why-nginx-as-api-gateway","title":"Why Nginx as API Gateway?","text":"<p>Advantages: - High performance (C implementation) - Battle-tested in production - Low memory footprint - Flexible configuration - Extensive module ecosystem - Active community</p> <p>Alternatives considered: - Kong (too heavy for our use case) - Traefik (less mature Lua support) - Custom Node.js proxy (performance concerns)</p>"},{"location":"core-concepts/overview/#why-payloadcms-for-dashboard","title":"Why PayloadCMS for Dashboard?","text":"<p>Advantages: - TypeScript-based (type safety) - Flexible collection system - Built-in admin UI - Extensible with hooks and plugins - Modern React stack - Active development</p> <p>Alternatives considered: - Strapi (JavaScript-only, less type-safe) - Directus (different architecture) - Custom dashboard (development time)</p>"},{"location":"core-concepts/overview/#why-mongodb","title":"Why MongoDB?","text":"<p>Advantages: - Flexible schema (JSON-like documents) - NGSI-LD compatibility (Orion-LD requirement) - Geospatial query support - Good performance at scale - Horizontal scaling support</p> <p>Alternatives considered: - PostgreSQL + PostGIS (Orion-LD doesn't support it yet) - TimescaleDB (NGSI-LD compatibility issues)</p>"},{"location":"core-concepts/overview/#design-principles","title":"Design Principles","text":""},{"location":"core-concepts/overview/#1-standards-compliance","title":"1. Standards Compliance","text":"<p>SematX strictly follows NGSI-LD v1.6.1 specification: - All entity operations are NGSI-LD compliant - Standard context handling - Proper URN format for entity IDs - GeoJSON for geographic data</p>"},{"location":"core-concepts/overview/#2-security-first","title":"2. Security First","text":"<p>Multiple layers of security: - Transport: HTTPS/TLS encryption - Authentication: JWT tokens for all API calls - Authorization: Role-based access control - Rate Limiting: Prevent abuse - Input Validation: Prevent injection attacks</p>"},{"location":"core-concepts/overview/#3-performance-optimization","title":"3. Performance Optimization","text":"<p>Designed for high throughput: - Nginx: Event-driven architecture - Connection Pooling: Reuse database connections - Caching: Redis for frequently accessed data (optional) - Indexing: MongoDB indexes on common queries - Compression: Gzip for API responses</p>"},{"location":"core-concepts/overview/#4-developer-experience","title":"4. Developer Experience","text":"<p>Easy to use and extend: - Clear APIs: RESTful, well-documented - Code Examples: Multiple languages - Type Safety: TypeScript throughout - Error Messages: Descriptive and actionable - Extensibility: Plugin architecture</p>"},{"location":"core-concepts/overview/#data-flow-deep-dive","title":"Data Flow Deep Dive","text":""},{"location":"core-concepts/overview/#write-operation-createupdate-entity","title":"Write Operation (Create/Update Entity)","text":"<pre><code>1. Client sends PATCH request\n   \u2514\u2500&gt; POST /ngsi-ld/v1/entities/{id}/attrs\n   \u2514\u2500&gt; Authorization: Bearer &lt;jwt&gt;\n   \u2514\u2500&gt; Body: {\"temperature\": {\"type\": \"Property\", \"value\": 25.5}}\n\n2. Nginx receives request\n   \u2514\u2500&gt; Validate JWT signature\n   \u2514\u2500&gt; Check rate limits\n   \u2514\u2500&gt; Extract tenant from JWT or header\n   \u2514\u2500&gt; Route to Orion-LD\n\n3. Orion-LD processes request\n   \u2514\u2500&gt; Validate NGSI-LD format\n   \u2514\u2500&gt; Check entity exists\n   \u2514\u2500&gt; Update MongoDB document\n   \u2514\u2500&gt; Trigger active subscriptions\n\n4. Subscriptions fire\n   \u2514\u2500&gt; Find matching subscriptions\n   \u2514\u2500&gt; Build notification payload\n   \u2514\u2500&gt; HTTP POST to webhook URLs\n   \u2514\u2500&gt; Lego Dashboard receives notification\n\n5. Dashboard updates\n   \u2514\u2500&gt; WebSocket to connected clients\n   \u2514\u2500&gt; Real-time card updates\n   \u2514\u2500&gt; Cache invalidation\n\n6. Response to client\n   \u2514\u2500&gt; 204 No Content (success)\n   \u2514\u2500&gt; Error code if failed\n</code></pre>"},{"location":"core-concepts/overview/#read-operation-query-entities","title":"Read Operation (Query Entities)","text":"<pre><code>1. Client sends GET request\n   \u2514\u2500&gt; GET /ngsi-ld/v1/entities?type=Sensor\n   \u2514\u2500&gt; Authorization: Bearer &lt;jwt&gt;\n\n2. Nginx receives request\n   \u2514\u2500&gt; Validate JWT\n   \u2514\u2500&gt; Check rate limits\n   \u2514\u2500&gt; Route to Orion-LD\n\n3. Orion-LD queries MongoDB\n   \u2514\u2500&gt; Parse query parameters\n   \u2514\u2500&gt; Build MongoDB query\n   \u2514\u2500&gt; Apply tenant filter\n   \u2514\u2500&gt; Execute query with indexes\n\n4. MongoDB returns results\n   \u2514\u2500&gt; Cursor-based pagination\n   \u2514\u2500&gt; Convert to NGSI-LD format\n\n5. Response to client\n   \u2514\u2500&gt; JSON array of entities\n   \u2514\u2500&gt; Pagination headers (Link header)\n   \u2514\u2500&gt; 200 OK status\n</code></pre>"},{"location":"core-concepts/overview/#performance-characteristics","title":"Performance Characteristics","text":""},{"location":"core-concepts/overview/#latency-benchmarks","title":"Latency Benchmarks","text":"<p>Based on typical deployments:</p> Operation Avg Latency P95 Latency P99 Latency Create Entity 15ms 30ms 50ms Update Attributes 10ms 20ms 35ms Get Entity by ID 5ms 10ms 20ms Query 100 Entities 25ms 50ms 100ms Subscription Notification 50ms 100ms 200ms <p>Factors affecting latency: - Network round-trip time - MongoDB performance - Number of active subscriptions - Entity complexity - Query filters</p>"},{"location":"core-concepts/overview/#throughput","title":"Throughput","text":"<p>Typical single-server deployment:</p> <ul> <li>Writes: 500-1000 req/sec</li> <li>Reads: 2000-5000 req/sec</li> <li>Subscriptions: 100-200 notifications/sec</li> </ul> <p>Scaling options: - Vertical: More CPU/RAM - Horizontal: Multiple Nginx + Orion-LD instances - Database: MongoDB replica set or sharding</p>"},{"location":"core-concepts/overview/#error-handling","title":"Error Handling","text":""},{"location":"core-concepts/overview/#http-status-codes","title":"HTTP Status Codes","text":"<p>SematX uses standard HTTP status codes:</p> Code Meaning Example 200 OK Successful GET request 201 Created Entity created 204 No Content Successful update/delete 400 Bad Request Invalid JSON or NGSI-LD format 401 Unauthorized Missing or invalid JWT 403 Forbidden JWT valid but lacks permissions 404 Not Found Entity doesn't exist 409 Conflict Entity ID already exists 422 Unprocessable Entity Valid JSON but semantic errors 429 Too Many Requests Rate limit exceeded 500 Internal Server Error Server-side error 503 Service Unavailable MongoDB or service down"},{"location":"core-concepts/overview/#error-response-format","title":"Error Response Format","text":"<pre><code>{\n  \"type\": \"https://uri.etsi.org/ngsi-ld/errors/BadRequestData\",\n  \"title\": \"Invalid entity attribute\",\n  \"detail\": \"Attribute 'temperature' is missing required 'type' field\",\n  \"status\": 400\n}\n</code></pre>"},{"location":"core-concepts/overview/#monitoring-and-observability","title":"Monitoring and Observability","text":""},{"location":"core-concepts/overview/#key-metrics-to-monitor","title":"Key Metrics to Monitor","text":"<p>Infrastructure: - CPU usage (&lt; 70% normal) - Memory usage (&lt; 80% normal) - Disk I/O (&lt; 70% capacity) - Network bandwidth</p> <p>Application: - Request rate (req/sec) - Response time (avg, p95, p99) - Error rate (&lt; 1% normal) - Queue depth (subscriptions)</p> <p>Database: - Query execution time - Connection pool usage - Index hit rate - Disk usage growth</p>"},{"location":"core-concepts/overview/#logging","title":"Logging","text":"<p>SematX components log to: - Nginx: Access logs + error logs - Orion-LD: Application logs - Dashboard: Application logs + audit logs - MongoDB: Database logs</p> <p>Log levels: - DEBUG: Detailed debugging information - INFO: Normal operations - WARN: Warning conditions - ERROR: Error conditions - FATAL: Fatal errors causing shutdown</p>"},{"location":"core-concepts/overview/#next-steps","title":"Next Steps","text":"<p>Ready to dive deeper? Choose a component:</p> <ul> <li>Orion Nginx Gateway \u2192 - Learn about API gateway internals</li> <li>Lego Dashboard \u2192 - Understand dashboard architecture</li> </ul> <p>Or return to: - Getting Started - Basic tutorials - Deployment - Production deployment guides</p>"},{"location":"deployment/","title":"Deployment overview","text":"<p>This page describes how to deploy and operate a LegoCity installation.</p> <p>It focuses on:</p> <ul> <li>the main components that need to be deployed,</li> <li>common deployment patterns (single VM, cloud platforms, platform-as-a-service),</li> <li>operational tasks such as updates, monitoring and backups.</li> </ul> <p>Separate pages provide concrete guidance for specific platforms:</p> <ul> <li>AWS</li> <li>Cloudflare-based setups</li> <li>virtual machines and Docker</li> <li>Coolify</li> </ul>"},{"location":"deployment/#components-to-deploy","title":"Components to deploy","text":"<p>A LegoCity deployment typically includes the following components:</p> <ul> <li> <p>Context broker   NGSI-LD broker that stores entities (FIWARE Orion-LD or equivalent).</p> </li> <li> <p>Update servers   One or more services that fetch external data, transform it and write entities to the broker.</p> </li> <li> <p>Proxy / API layer   A small backend service that:</p> </li> <li>reads from the broker,</li> <li>exposes simplified, UI-friendly endpoints,</li> <li> <p>applies access control, caching and rate limits.</p> </li> <li> <p>Dashboard (frontend)   The Next.js + Mapbox UI built from the LegoCity codebase.</p> </li> <li> <p>PayloadCMS   The admin interface for configuring map views, layers, blocks and content.</p> </li> <li> <p>Supporting services (optional, depending on the deployment):</p> </li> <li>database for PayloadCMS,</li> <li>logging / monitoring stack,</li> <li>reverse proxies or load balancers.</li> </ul> <p>The deployment architecture decides:</p> <ul> <li>where each component runs,</li> <li>how components communicate,</li> <li>how configuration and secrets are managed.</li> </ul>"},{"location":"deployment/#deployment-modes","title":"Deployment modes","text":"<p>There are several ways to deploy LegoCity. The most common modes are:</p> <ul> <li> <p>Single virtual machine using Docker or process managers   Simple to set up, suitable for development and small pilots.</p> </li> <li> <p>Cloud provider (e.g. AWS)   Components are split across managed services (containers, databases, storage).</p> </li> <li> <p>Static hosting + serverless APIs (Cloudflare, etc.)   Frontend hosted on an edge platform, APIs and proxy as serverless functions.</p> </li> <li> <p>Application platforms (Coolify, etc.)   A platform that manages containers, routing and TLS for you.</p> </li> </ul> <p>Each mode has different trade-offs in terms of:</p> <ul> <li>ease of setup,</li> <li>cost,</li> <li>scalability,</li> <li>operational complexity.</li> </ul> <p>The following sections describe a generic approach that can be adapted to each platform.</p>"},{"location":"deployment/#environments","title":"Environments","text":"<p>LegoCity deployments should use at least two environments:</p> <ul> <li>Development / staging   Used for:</li> <li>testing new views, layers and blocks,</li> <li>experimenting with update servers,</li> <li> <p>validating entity models.</p> </li> <li> <p>Production   Used for:</p> </li> <li>live dashboards,</li> <li>public or internal users,</li> <li>stable data feeds.</li> </ul> <p>Each environment should have:</p> <ul> <li>its own context broker (or clearly separated broker namespaces),</li> <li>its own PayloadCMS instance,</li> <li>its own configuration (API keys, database URLs, etc.),</li> <li>a clear process for promoting changes from development to production.</li> </ul>"},{"location":"deployment/#configuration-and-secrets","title":"Configuration and secrets","text":"<p>Regardless of the deployment platform, configuration should be externalised.</p> <p>Typical configuration items:</p> <ul> <li>broker URLs and credentials,</li> <li>PayloadCMS database URL and credentials,</li> <li>proxy configuration (allowed origins, rate limits),</li> <li>external API endpoints and keys (for update servers),</li> <li>environment identifiers (e.g. <code>NODE_ENV</code>, <code>APP_ENV</code>).</li> </ul> <p>Best practices:</p> <ul> <li>store configuration in environment variables or configuration files that are not committed to version control,</li> <li>store secrets (tokens, passwords) in a secret manager or encrypted store,</li> <li>avoid hard-coding any credentials in the codebase.</li> </ul> <p>In production:</p> <ul> <li>changes to configuration should be applied through a controlled process,</li> <li>all configuration changes should be traceable (who changed what and when).</li> </ul>"},{"location":"deployment/#network-and-security-basics","title":"Network and security basics","text":"<p>At a high level, the network structure should ensure that:</p> <ul> <li>the context broker is not directly exposed to the public internet,</li> <li>update servers and proxy have access to the broker,</li> <li>the dashboard is reachable by the intended users,</li> <li>PayloadCMS admin is restricted to authorised users and networks.</li> </ul> <p>Typical patterns:</p> <ul> <li>place broker, update servers, PayloadCMS and proxy in a private network or VPC,</li> <li>expose only:</li> <li>the dashboard URL,</li> <li>the proxy API URL,</li> <li>the PayloadCMS admin URL (optionally restricted by IP or VPN),</li> <li>terminate TLS at a reverse proxy, load balancer or platform gateway.</li> </ul> <p>Each platform-specific page will describe how to achieve this using its tools (for example, AWS security groups and load balancers, Cloudflare routing rules, Coolify domains and TLS).</p>"},{"location":"deployment/#single-vm-docker-based-deployment-conceptual","title":"Single-VM / Docker-based deployment (conceptual)","text":"<p>The simplest deployment pattern is:</p> <ul> <li>one virtual machine,</li> <li>all services run as Docker containers,</li> <li>a reverse proxy like Nginx or Traefik routes requests.</li> </ul> <p>The typical containers are:</p> <ul> <li><code>broker</code> \u2013 context broker,</li> <li><code>payload</code> \u2013 PayloadCMS and its database,</li> <li><code>proxy</code> \u2013 API layer between UI and broker,</li> <li><code>dashboard</code> \u2013 Next.js frontend (either server-rendered or static build served by a web server),</li> <li><code>update-*</code> \u2013 one or more update servers.</li> </ul> <p>Advantages:</p> <ul> <li>minimal infrastructure,</li> <li>easy to reason about and debug,</li> <li>suitable for demos, workshops and pilots.</li> </ul> <p>Limitations:</p> <ul> <li>scaling is limited to the capacity of the single machine,</li> <li>no automatic high availability,</li> <li>maintenance windows may affect all components.</li> </ul> <p>Details for setting up this pattern are provided in the \u201cVirtual machines &amp; Docker\u201d documentation.</p>"},{"location":"deployment/#cloud-deployments-aws-etc","title":"Cloud deployments (AWS, etc.)","text":"<p>When deploying to a cloud provider such as AWS, the common approach is to:</p> <ul> <li>run services in containers (for example, ECS or Kubernetes),</li> <li>use managed databases for PayloadCMS and other persistence,</li> <li>use load balancers and DNS for traffic routing.</li> </ul> <p>Typical AWS architecture:</p> <ul> <li>ECS or EKS services for:</li> <li>broker,</li> <li>proxy,</li> <li>update servers,</li> <li>PayloadCMS and dashboard (if not fully static),</li> <li>RDS or a managed database service for PayloadCMS data,</li> <li>Application Load Balancer for HTTP routing,</li> <li>Route 53 for DNS,</li> <li>CloudWatch for logs and metrics.</li> </ul> <p>Benefits:</p> <ul> <li>easier horizontal scaling,</li> <li>managed databases and storage,</li> <li>integration with AWS identity and security features.</li> </ul> <p>Costs:</p> <ul> <li>higher operational complexity,</li> <li>more moving parts to monitor and configure.</li> </ul> <p>The AWS-specific page will outline recommended mappings from LegoCity components to AWS services and provide step-by-step guidance for a minimal deployment.</p>"},{"location":"deployment/#edge-and-serverless-deployments-cloudflare-etc","title":"Edge and serverless deployments (Cloudflare, etc.)","text":"<p>In some scenarios, it is useful to:</p> <ul> <li>host the dashboard as static assets on an edge platform,</li> <li>run the proxy and some APIs as serverless functions,</li> <li>keep the broker and PayloadCMS in a more traditional environment.</li> </ul> <p>For example, using Cloudflare:</p> <ul> <li>static dashboard built and deployed to Cloudflare Pages,</li> <li>proxy implemented as Cloudflare Workers calling the broker,</li> <li>PayloadCMS and broker run elsewhere (for example, a VM or another cloud provider),</li> <li>DNS and TLS handled by Cloudflare.</li> </ul> <p>Benefits:</p> <ul> <li>fast global delivery of the dashboard,</li> <li>simplified scaling and management for frontend and proxy,</li> <li>good fit for public-facing portals.</li> </ul> <p>Considerations:</p> <ul> <li>broker and PayloadCMS still need reliable hosting elsewhere,</li> <li>connectivity between Cloudflare Workers and the broker must be secure and monitored.</li> </ul> <p>The Cloudflare-specific page will describe the division of responsibilities and the basic deployment flow.</p>"},{"location":"deployment/#application-platforms-coolify-and-similar","title":"Application platforms (Coolify and similar)","text":"<p>Platforms such as Coolify aim to:</p> <ul> <li>run containerised applications on a server or cluster,</li> <li>manage deploys, domains and TLS certificates,</li> <li>provide a UI to configure and maintain services.</li> </ul> <p>In this model:</p> <ul> <li>each LegoCity component is a service in the platform,</li> <li>platform configuration defines:</li> <li>container image or build method,</li> <li>environment variables,</li> <li>exposed ports and domains.</li> </ul> <p>Typical setup:</p> <ul> <li>one Coolify instance running on a VM or server,</li> <li>services for:</li> <li>broker,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>dashboard,</li> <li>update servers.</li> </ul> <p>This approach:</p> <ul> <li>reduces the amount of low-level infrastructure work,</li> <li>still allows per-service control and logs,</li> <li>is well suited for teams without a dedicated DevOps function.</li> </ul> <p>The Coolify-specific page will describe concrete service definitions and deployment steps.</p>"},{"location":"deployment/#maintenance-and-operations","title":"Maintenance and operations","text":"<p>Deployment is only one part of the lifecycle. A LegoCity installation must also be maintained.</p> <p>Key operational activities:</p> <ul> <li>Monitoring and alerting</li> <li>monitor:<ul> <li>broker availability,</li> <li>update server success/failure rates,</li> <li>PayloadCMS and proxy health,</li> <li>resource usage (CPU, memory, disk).</li> </ul> </li> <li> <p>define alerts for:</p> <ul> <li>broker down,</li> <li>repeated update failures,</li> <li>unexpected increase or drop in entity counts.</li> </ul> </li> <li> <p>Backups</p> </li> <li>databases used by PayloadCMS must be backed up regularly,</li> <li>if the broker persists entities, its storage should be backed up or replicated,</li> <li> <p>configuration and documentation should be version-controlled.</p> </li> <li> <p>Updates</p> </li> <li>establish a process for:<ul> <li>building and testing new versions of the dashboard, proxy, update servers and PayloadCMS,</li> <li>deploying updates to development first,</li> <li>rolling out to production with minimal disruption.</li> </ul> </li> <li> <p>maintain a changelog for major changes in:</p> <ul> <li>entity models,</li> <li>APIs,</li> <li>configuration structure.</li> </ul> </li> <li> <p>Security</p> </li> <li>rotate API keys and tokens periodically,</li> <li>apply security updates to underlying platforms (VMs, container runtimes, OS images),</li> <li>review access to PayloadCMS and admin endpoints.</li> </ul> <p>Each platform-specific page should tie these tasks to platform tools (for example, CloudWatch alarms on AWS, Coolify health checks, Cloudflare analytics).</p>"},{"location":"deployment/#choosing-a-deployment-strategy","title":"Choosing a deployment strategy","text":"<p>When selecting a deployment strategy, teams should consider:</p> <ul> <li>expected load and number of users,</li> <li>number of domains and update servers in scope,</li> <li>available operational expertise,</li> <li>constraints from the host organisation (preferred cloud, existing tools).</li> </ul> <p>Rough guidelines:</p> <ul> <li>Single VM + Docker   Good for:</li> <li>initial prototypes,</li> <li>internal demos,</li> <li> <p>small deployments managed by a single team.</p> </li> <li> <p>Cloud provider (AWS)   Suitable when:</p> </li> <li>high availability or scaling is required,</li> <li>there is an existing cloud infrastructure,</li> <li> <p>integration with other cloud services is needed.</p> </li> <li> <p>Cloudflare-based setup   Useful when:</p> </li> <li>the dashboard is public and benefits from edge delivery,</li> <li>the proxy can be implemented as lightweight functions,</li> <li> <p>existing backends (broker, PayloadCMS) are hosted elsewhere.</p> </li> <li> <p>Coolify or similar platform   Appropriate when:</p> </li> <li>the team prefers UI-driven deployment and management,</li> <li>the deployment is small to medium sized,</li> <li>the focus is on quickly getting a working platform rather than managing raw infrastructure.</li> </ul>"},{"location":"deployment/#relationship-to-other-documentation","title":"Relationship to other documentation","text":"<p>This deployment overview is intentionally high-level. It is complemented by:</p> <ul> <li>AWS deployment \u2013 mapping LegoCity components to AWS services and ready-to-use patterns,</li> <li>Cloudflare deployment \u2013 static frontend + serverless proxy design,</li> <li>Virtual machines &amp; Docker \u2013 single-VM and multi-VM deployments using containers,</li> <li>Coolify deployment \u2013 defining LegoCity services inside Coolify and managing them over time.</li> </ul> <p>These pages provide more concrete, platform-specific guidance and should be consulted when implementing a specific deployment.</p>"},{"location":"deployment/#summary","title":"Summary","text":"<ul> <li>A LegoCity deployment consists of a context broker, update servers, a proxy, a dashboard, PayloadCMS and supporting services.</li> <li>There are multiple deployment modes: single VM, cloud provider, edge/serverless combinations and application platforms.</li> <li>Each environment (development, production) needs clearly separated brokers, configurations and credentials.</li> <li>Security, configuration management, monitoring, backups and update processes are core parts of the deployment design, not afterthoughts.</li> <li>Platform-specific pages refine this overview into ready-to-use steps for AWS, Cloudflare, virtual machines and Coolify.</li> </ul>"},{"location":"deployment/aws/","title":"AWS deployment","text":"<p>This page describes a practical way to deploy LegoCity on AWS using managed services.</p> <p>It focuses on:</p> <ul> <li>mapping LegoCity components to AWS services,</li> <li>a minimal but realistic architecture (dev + prod),</li> <li>concrete steps to get a working deployment,</li> <li>basic maintenance: updates, monitoring, backups.</li> </ul> <p>It is not a full Terraform/CloudFormation template, but it should be detailed enough for an engineer familiar with AWS basics to implement.</p>"},{"location":"deployment/aws/#when-to-use-aws","title":"When to use AWS","text":"<p>An AWS-based deployment is a good fit when:</p> <ul> <li>the organisation already uses AWS,</li> <li>uptime and scalability requirements are higher than \u201cone VM with Docker\u201d,</li> <li>managed databases and monitoring are preferred over self-hosted.</li> </ul> <p>It may be overkill when:</p> <ul> <li>you only need a short-lived prototype,</li> <li>you do not have access to an AWS account or basic AWS skills.</li> </ul>"},{"location":"deployment/aws/#component-aws-service-mapping","title":"Component \u2192 AWS service mapping","text":"<p>A typical mapping from LegoCity components to AWS looks like this:</p> <ul> <li>Context broker </li> <li>Run as a container on:<ul> <li>AWS ECS (Fargate or EC2 launch type), or</li> <li>EKS (Kubernetes) if you already have it.</li> </ul> </li> <li> <p>Storage on:</p> <ul> <li>EBS volume or</li> <li>S3 (if the broker supports it) or</li> <li>internal DB, depending on broker implementation.</li> </ul> </li> <li> <p>PayloadCMS </p> </li> <li>Run as a container on ECS/EKS.</li> <li> <p>Database on:</p> <ul> <li>Amazon RDS (PostgreSQL or MySQL) or</li> <li>Amazon DocumentDB / Mongo-compatible service.</li> </ul> </li> <li> <p>Proxy / API layer </p> </li> <li>Run as a container on ECS/EKS.</li> <li> <p>Optionally fronted by:</p> <ul> <li>Application Load Balancer (ALB) or</li> <li>API Gateway + Lambda if rewritten.</li> </ul> </li> <li> <p>Dashboard (Next.js + Mapbox)   Options:</p> </li> <li>build as static assets and host on:<ul> <li>S3 + CloudFront, OR</li> </ul> </li> <li> <p>run as a container on ECS/EKS behind ALB if you need server-side rendering.</p> </li> <li> <p>Update servers </p> </li> <li> <p>Run as:</p> <ul> <li>ECS services (long-running tasks), or</li> <li>ECS scheduled tasks (cron-like), or</li> <li>Lambda functions (if implemented serverless).</li> </ul> </li> <li> <p>Networking &amp; ingress</p> </li> <li>VPC with public and private subnets,</li> <li>ALB in public subnets routing to ECS services in private subnets,</li> <li> <p>security groups controlling traffic.</p> </li> <li> <p>Configuration &amp; secrets</p> </li> <li> <p>AWS Systems Manager Parameter Store or Secrets Manager for:</p> <ul> <li>broker write keys,</li> <li>DB credentials,</li> <li>external API keys.</li> </ul> </li> <li> <p>Monitoring &amp; logs</p> </li> <li>CloudWatch Logs for container logs,</li> <li>CloudWatch metrics and alarms.</li> </ul>"},{"location":"deployment/aws/#environments-dev-and-prod","title":"Environments: dev and prod","text":"<p>At a minimum, you should define:</p> <ul> <li>a development environment:</li> <li>smaller ECS services,</li> <li>smaller RDS instance,</li> <li>restricted access (only internal users),</li> <li> <p>used to test new blocks, map views and update servers.</p> </li> <li> <p>a production environment:</p> </li> <li>scaled versions of the same components,</li> <li>stricter access controls,</li> <li>visible to end users.</li> </ul> <p>You can implement this by:</p> <ul> <li>separate AWS accounts (preferred in larger orgs), or</li> <li>separate VPCs and ECS clusters within the same account, or</li> <li>at least separate ECS services, RDS instances and Parameter Store paths with prefixes (e.g. <code>/legocity/dev/...</code> vs <code>/legocity/prod/...</code>).</li> </ul> <p>This documentation assumes separate dev and prod ECS services and RDS instances inside the same account, with configuration separated by Parameter Store prefixes.</p>"},{"location":"deployment/aws/#container-images-and-registries","title":"Container images and registries","text":"<p>All LegoCity components that run as containers need images:</p> <ul> <li>broker image (official or custom),</li> <li>PayloadCMS image,</li> <li>proxy image,</li> <li>dashboard image (if not purely static),</li> <li>update server images.</li> </ul> <p>Workflow:</p> <ol> <li>Build images locally or in CI.</li> <li>Push images to Amazon ECR (Elastic Container Registry).</li> <li>Configure ECS services to use these images by tag.</li> </ol> <p>Recommended patterns:</p> <ul> <li>use separate ECR repositories per service:</li> <li><code>legocity-broker</code>,</li> <li><code>legocity-payload</code>,</li> <li><code>legocity-proxy</code>,</li> <li><code>legocity-dashboard</code>,</li> <li><code>legocity-update-env</code>, etc.</li> <li>use semantic tags or at least:</li> <li><code>dev-&lt;short-sha&gt;</code> for dev,</li> <li><code>prod-&lt;short-sha&gt;</code> for prod.</li> </ul>"},{"location":"deployment/aws/#network-and-vpc-layout","title":"Network and VPC layout","text":"<p>A common minimal network layout:</p> <ul> <li>one VPC with:</li> <li>public subnets (for ALB),</li> <li>private subnets (for ECS tasks and RDS).</li> </ul> <p>Components:</p> <ul> <li>ALB in public subnets:</li> <li>receives HTTPS traffic from the internet,</li> <li>terminates TLS (ACM certificates),</li> <li> <p>forwards to ECS target groups.</p> </li> <li> <p>ECS services in private subnets:</p> </li> <li>broker (for internal access only),</li> <li>proxy,</li> <li>PayloadCMS,</li> <li>Next.js (if SSR),</li> <li> <p>update servers.</p> </li> <li> <p>RDS in private subnets:</p> </li> <li>only accessible from ECS tasks via security groups.</li> </ul> <p>Security groups:</p> <ul> <li>one SG for ALB (ingress 80/443 from internet),</li> <li>one SG for ECS tasks (ingress from ALB SG and from other internal SGs),</li> <li>one SG for RDS (ingress from ECS SG only),</li> <li>optional SGs for broker if you want to restrict which ECS services can call it.</li> </ul>"},{"location":"deployment/aws/#minimal-architecture-pattern","title":"Minimal architecture pattern","text":"<p>For a minimal but structured setup:</p> <ul> <li>ECS Cluster: <code>legocity-cluster</code></li> <li> <p>runs all services as ECS services with Fargate.</p> </li> <li> <p>Services:</p> </li> <li><code>legocity-broker-service</code> (Fargate, private subnets, no public IP),</li> <li><code>legocity-payload-service</code> (Fargate, private, behind ALB),</li> <li><code>legocity-proxy-service</code> (Fargate, private, behind ALB),</li> <li><code>legocity-dashboard-service</code> (Fargate, private, behind ALB)     (skip if you host dashboard on S3+CloudFront),</li> <li> <p><code>legocity-update-env-service</code> (Fargate, private, no ALB, long-running / scheduled).</p> </li> <li> <p>RDS:</p> </li> <li><code>legocity-payload-db</code> \u2013 PostgreSQL or MySQL,</li> <li> <p>security group only allowing connections from ECS tasks.</p> </li> <li> <p>ALB:</p> </li> <li>listeners on 80/443, redirect 80 \u2192 443,</li> <li> <p>target groups:</p> <ul> <li><code>/admin</code> \u2192 PayloadCMS,</li> <li><code>/api</code> \u2192 proxy,</li> <li><code>/</code> \u2192 dashboard.</li> </ul> </li> <li> <p>S3 + CloudFront (optional but recommended for Next.js static build):</p> </li> <li>S3 bucket for static assets,</li> <li>CloudFront distribution fronting the bucket,</li> <li>API requests routed to ALB.</li> </ul>"},{"location":"deployment/aws/#configuration-and-secrets-on-aws","title":"Configuration and secrets on AWS","text":"<p>Use SSM Parameter Store or Secrets Manager for configuration, not hard-coded environment variables in the ECS task definitions.</p> <p>Examples of Parameter Store paths:</p> <ul> <li><code>/legocity/dev/broker/url</code></li> <li><code>/legocity/dev/broker/write-key/env</code></li> <li><code>/legocity/dev/payload/db-url</code></li> <li> <p><code>/legocity/dev/external/weather/api-key</code></p> </li> <li> <p><code>/legocity/prod/broker/url</code></p> </li> <li><code>/legocity/prod/broker/write-key/env</code></li> <li><code>/legocity/prod/payload/db-url</code></li> <li><code>/legocity/prod/external/weather/api-key</code></li> </ul> <p>Each ECS task:</p> <ul> <li>obtains its config at runtime via environment variables,</li> <li>environment values can be pulled from SSM parameters by name.</li> </ul> <p>Basic pattern:</p> <ul> <li>TASK_DEF env:</li> <li><code>BROKER_URL</code> \u2190 SSM <code>/legocity/prod/broker/url</code></li> <li><code>BROKER_WRITE_KEY</code> \u2190 SSM <code>/legocity/prod/broker/write-key/env</code></li> <li><code>PAYLOAD_DB_URL</code> \u2190 SSM <code>/legocity/prod/payload/db-url</code></li> <li><code>WEATHER_API_KEY</code> \u2190 SSM <code>/legocity/prod/external/weather/api-key</code></li> </ul> <p>Grant ECS task role permission to read the specific parameter paths required.</p>"},{"location":"deployment/aws/#step-by-step-skeleton-first-production-like-deployment","title":"Step-by-step skeleton: first production-like deployment","text":"<p>This is a skeleton sequence for setting up a first production-like environment. Details depend on your chosen tools (console vs IaC), nh\u01b0ng th\u1ee9 t\u1ef1 c\u1ea7n r\u00f5 r\u00e0ng.</p>"},{"location":"deployment/aws/#1-prepare-vpc-and-networking","title":"1. Prepare VPC and networking","text":"<ul> <li>Create a VPC (or reuse an existing one) with:</li> <li>at least two public subnets (in different AZs),</li> <li>at least two private subnets (in different AZs),</li> <li>an Internet Gateway,</li> <li> <p>NAT Gateway(s) for private subnets (so ECS tasks can fetch images, call external APIs).</p> </li> <li> <p>Create security groups:</p> </li> <li><code>sg-alb</code>:<ul> <li>ingress: 80/443 from internet,</li> <li>egress: to ECS SG.</li> </ul> </li> <li><code>sg-ecs</code>:<ul> <li>ingress: from <code>sg-alb</code> on app ports,</li> <li>ingress: from itself if services call each other,</li> <li>egress: to <code>sg-rds</code>, internet via NAT.</li> </ul> </li> <li><code>sg-rds</code>:<ul> <li>ingress: from <code>sg-ecs</code> on DB port (e.g. 5432).</li> </ul> </li> </ul>"},{"location":"deployment/aws/#2-create-rds-for-payloadcms","title":"2. Create RDS for PayloadCMS","text":"<ul> <li>Choose engine: PostgreSQL or MySQL.</li> <li>Deploy <code>legocity-payload-db</code> into private subnets with <code>sg-rds</code>.</li> <li>Configure:</li> <li>DB name, user, password,</li> <li>backup retention, automated backups.</li> <li>Ensure ECS tasks can resolve and connect via DB endpoint.</li> </ul>"},{"location":"deployment/aws/#3-create-ecr-repositories-and-push-images","title":"3. Create ECR repositories and push images","text":"<p>For each component:</p> <ul> <li>create an ECR repo (e.g. <code>legocity-payload</code>),</li> <li>build image and push:</li> <li><code>dev</code> tag for dev,</li> <li><code>prod</code> tag for prod.</li> </ul> <p>Do this for:</p> <ul> <li>broker,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>dashboard (if container-based),</li> <li>at least one update server.</li> </ul>"},{"location":"deployment/aws/#4-configure-ssm-parameters-for-configuration","title":"4. Configure SSM parameters for configuration","text":"<p>Create parameters for prod environment:</p> <ul> <li><code>/legocity/prod/broker/url</code></li> <li><code>/legocity/prod/broker/write-key/env</code></li> <li><code>/legocity/prod/payload/db-url</code></li> <li><code>/legocity/prod/external/weather/api-key</code></li> <li>any others needed by proxy and update servers.</li> </ul> <p>Store sensitive values as SecureString.</p>"},{"location":"deployment/aws/#5-create-ecs-cluster-and-task-definitions","title":"5. Create ECS cluster and task definitions","text":"<ul> <li>Create <code>legocity-cluster</code>.</li> <li>For each service, define a task definition:</li> <li>container image from ECR,</li> <li>CPU/memory limits,</li> <li>environment variables referencing SSM parameters,</li> <li>logging to CloudWatch Logs,</li> <li>port mappings.</li> </ul> <p>Services:</p> <ul> <li><code>broker-task</code> / <code>broker-service</code>:</li> <li>desired count: 1 (to start),</li> <li>private subnets, <code>sg-ecs</code>,</li> <li>no public IP,</li> <li> <p>no ALB (internal only).</p> </li> <li> <p><code>payload-task</code> / <code>payload-service</code>:</p> </li> <li>desired count: 1,</li> <li>private subnets, <code>sg-ecs</code>,</li> <li> <p>ALB target group (HTTP port, e.g. 3000).</p> </li> <li> <p><code>proxy-task</code> / <code>proxy-service</code>:</p> </li> <li> <p>similar to payload, with ALB target group (HTTP port, e.g. 4000).</p> </li> <li> <p><code>dashboard-task</code> / <code>dashboard-service</code> (if container-based):</p> </li> <li> <p>ALB target group (HTTP port, e.g. 3001).</p> </li> <li> <p><code>update-env-task</code> / <code>update-env-service</code>:</p> </li> <li>no ALB,</li> <li>private subnets, <code>sg-ecs</code>,</li> <li><code>desiredCount = 1</code> (long-running) or scheduled task.</li> </ul>"},{"location":"deployment/aws/#6-create-and-configure-application-load-balancer","title":"6. Create and configure Application Load Balancer","text":"<ul> <li>Create an ALB in public subnets with <code>sg-alb</code>.</li> <li>Create target groups:</li> <li><code>tg-payload</code> \u2192 ECS tasks (payload),</li> <li><code>tg-proxy</code> \u2192 ECS tasks (proxy),</li> <li> <p><code>tg-dashboard</code> \u2192 ECS tasks (dashboard) if applicable.</p> </li> <li> <p>Configure listeners:</p> </li> <li>HTTP (80) \u2192 redirect to HTTPS (443),</li> <li> <p>HTTPS (443):</p> <ul> <li>path <code>/admin*</code> \u2192 <code>tg-payload</code>,</li> <li>path <code>/api*</code> \u2192 <code>tg-proxy</code>,</li> <li>path <code>/</code> \u2192 <code>tg-dashboard</code> (or CloudFront if using static hosting).</li> </ul> </li> <li> <p>Attach an ACM certificate for your domain(s).</p> </li> </ul>"},{"location":"deployment/aws/#7-dns-and-domains","title":"7. DNS and domains","text":"<p>Use Route 53 (or another DNS provider) to:</p> <ul> <li>point <code>city.example</code> or <code>dashboard.city.example</code> to the ALB,</li> <li>point <code>admin.city.example</code> to the same ALB if you want a separate host for PayloadCMS admin.</li> </ul> <p>Check:</p> <ul> <li>HTTP(S) routing,</li> <li>TLS configuration,</li> <li>that PayloadCMS and the dashboard load correctly.</li> </ul>"},{"location":"deployment/aws/#8-verify-data-flow","title":"8. Verify data flow","text":"<p>After services are running:</p> <ul> <li>confirm broker health:</li> <li> <p>from an ECS task or a bastion host, call the broker\u2019s NGSI-LD endpoint.</p> </li> <li> <p>confirm PayloadCMS connects to RDS:</p> </li> <li>complete any initial admin setup,</li> <li> <p>log in to the admin UI.</p> </li> <li> <p>confirm update servers write entities:</p> </li> <li>check update server logs in CloudWatch,</li> <li> <p>query broker for <code>WeatherObserved</code> or other entities.</p> </li> <li> <p>confirm proxy returns data:</p> </li> <li>call <code>/api/...</code> endpoints through ALB,</li> <li> <p>check that the responses reflect entities in the broker.</p> </li> <li> <p>confirm dashboard shows data:</p> </li> <li>open the dashboard URL,</li> <li>check map layers and widgets for live entities.</li> </ul>"},{"location":"deployment/aws/#monitoring-and-logging","title":"Monitoring and logging","text":"<p>Use CloudWatch Logs and CloudWatch metrics:</p> <ul> <li>send logs from ECS tasks to CloudWatch Log Groups:</li> <li> <p>one log group per service is usually sufficient.</p> </li> <li> <p>define CloudWatch alarms for:</p> </li> <li>ECS service not reaching desired count,</li> <li>high CPU/memory usage,</li> <li>RDS storage or CPU thresholds,</li> <li>broker or proxy health check failures.</li> </ul> <p>Optional:</p> <ul> <li>integrate with email/Slack/other via SNS for alerts,</li> <li>use AWS X-Ray or similar for deeper request tracing if necessary.</li> </ul>"},{"location":"deployment/aws/#backups-and-restoration","title":"Backups and restoration","text":"<p>Primary stateful components:</p> <ul> <li>RDS (PayloadCMS DB):</li> <li>configure automatic backups,</li> <li>enable point-in-time recovery if needed,</li> <li> <p>create manual snapshots before major changes.</p> </li> <li> <p>Broker storage:</p> </li> <li> <p>if the broker keeps state on disk:</p> <ul> <li>use EBS snapshots,</li> <li>or export entities periodically.</li> </ul> </li> <li> <p>Configuration:</p> </li> <li>SSM parameters and service definitions are part of infrastructure-as-code or documented procedures.</li> </ul> <p>Restoration drills:</p> <ul> <li>periodically restore RDS to a test instance,</li> <li>verify PayloadCMS can connect and data is consistent.</li> </ul>"},{"location":"deployment/aws/#updating-services","title":"Updating services","text":"<p>To deploy new versions of LegoCity components:</p> <ol> <li>Build and push new images to ECR.</li> <li>Update ECS task definitions to reference new image tags.</li> <li>Deploy new task definitions to the corresponding services:</li> <li>via ECS rolling update,</li> <li>or using deployment pipelines.</li> </ol> <p>Order of updates:</p> <ul> <li>update non-critical components first (dashboard),</li> <li>then proxy and update servers,</li> <li>finally broker and PayloadCMS (during a maintenance window if schema changes).</li> </ul> <p>Ensure:</p> <ul> <li>backward compatibility where possible,</li> <li>that configuration (SSM parameters) matches the expected schema of new versions.</li> </ul>"},{"location":"deployment/aws/#cost-and-resource-considerations","title":"Cost and resource considerations","text":"<p>Rough cost drivers on AWS:</p> <ul> <li>ECS tasks (CPU/memory) for broker, PayloadCMS, proxy, dashboard and update servers,</li> <li>RDS instance size and storage,</li> <li>ALB and data transfer,</li> <li>S3 and CloudFront (if used),</li> <li>NAT gateway (can be non-trivial for low-traffic deployments).</li> </ul> <p>To control costs:</p> <ul> <li>start with small Fargate task sizes (for example 0.25 vCPU / 0.5\u20131 GB RAM),</li> <li>choose a small RDS instance for dev and a moderate one for prod,</li> <li>scale task counts and sizes when usage grows,</li> <li>consider turning off non-essential update servers in dev when not in use.</li> </ul>"},{"location":"deployment/aws/#summary","title":"Summary","text":"<ul> <li>On AWS, LegoCity components map cleanly to ECS/EKS, RDS, ALB, S3/CloudFront and supporting services like SSM and CloudWatch.</li> <li>A minimal architecture uses an ECS cluster in a VPC, RDS for PayloadCMS, Fargate services for broker, PayloadCMS, proxy, dashboard, and update servers, plus an ALB for ingress.</li> <li>Configuration and secrets should be stored in SSM Parameter Store or Secrets Manager and injected into ECS tasks at runtime.</li> <li>A staged deployment (dev + prod) with separate SSM prefixes and ECS services helps control changes and risk.</li> <li>Maintenance requires regular monitoring (CloudWatch), backups (RDS snapshots, broker storage), and controlled rolling updates via ECS.</li> </ul>"},{"location":"deployment/cloudflare/","title":"Cloudflare deployment","text":"<p>This page describes how to use Cloudflare as part of a LegoCity deployment.</p> <p>It focuses on:</p> <ul> <li>hosting the dashboard on Cloudflare Pages,</li> <li>running a proxy layer on Cloudflare Workers,</li> <li>connecting to a broker and PayloadCMS that run elsewhere (for example on a VM or AWS),</li> <li>basic deployment and maintenance steps.</li> </ul> <p>This is useful when you want:</p> <ul> <li>fast, global delivery of the frontend,</li> <li>simple, serverless proxy logic close to users,</li> <li>but you still host the core backend (broker, PayloadCMS, DB) on your own infrastructure.</li> </ul>"},{"location":"deployment/cloudflare/#when-to-use-cloudflare","title":"When to use Cloudflare","text":"<p>Cloudflare integration is a good fit when:</p> <ul> <li>the dashboard is public-facing,</li> <li>you want low-latency map interaction for users in many locations,</li> <li>you prefer a managed, serverless runtime for simple API/proxy logic.</li> </ul> <p>It is less suitable when:</p> <ul> <li>you want to keep all traffic inside a closed network with no external edge provider,</li> <li>you need complex backend logic that does not fit well into Workers (CPU or memory heavy).</li> </ul>"},{"location":"deployment/cloudflare/#high-level-architecture","title":"High-level architecture","text":"<p>In a Cloudflare-powered deployment, the architecture can be split as:</p> <ul> <li>Edge (Cloudflare):</li> <li>Cloudflare Pages serves the dashboard static assets,</li> <li> <p>Cloudflare Workers provide a thin proxy/API layer.</p> </li> <li> <p>Backend (your infrastructure \u2013 VM / AWS / other):</p> </li> <li>context broker,</li> <li>PayloadCMS,</li> <li>database for PayloadCMS,</li> <li> <p>any legacy backend services.</p> </li> <li> <p>Update servers:</p> </li> <li>usually run in the backend environment (VM, AWS ECS, etc.),</li> <li>write to the broker directly.</li> </ul> <p>Traffic flow:</p> <ol> <li>User\u2019s browser requests <code>https://city.example</code> \u2192 Cloudflare Pages (static dashboard).</li> <li>Dashboard calls <code>/api/...</code> \u2192 Cloudflare Worker.</li> <li>Cloudflare Worker:</li> <li>authenticates/validates the request if needed,</li> <li>calls the internal backend API or broker proxy endpoint (over HTTPS),</li> <li>returns a simplified response to the browser.</li> </ol> <p>The broker and PayloadCMS are not exposed directly; only the Worker and Pages endpoints are visible.</p>"},{"location":"deployment/cloudflare/#required-components-on-cloudflare","title":"Required components on Cloudflare","text":"<p>You will typically create:</p> <ul> <li>one Cloudflare Pages project:</li> <li>builds the Next.js dashboard into static assets,</li> <li> <p>serves them at your domain (or subdomain).</p> </li> <li> <p>one or more Cloudflare Workers:</p> </li> <li>handle <code>/api/*</code> requests from the dashboard,</li> <li>forward requests to your backend,</li> <li>handle responses and errors.</li> </ul> <p>Optionally:</p> <ul> <li>route <code>/admin</code> or a separate host (e.g. <code>admin.city.example</code>) directly to your backend (PayloadCMS) instead of going through Workers.</li> </ul>"},{"location":"deployment/cloudflare/#dashboard-on-cloudflare-pages","title":"Dashboard on Cloudflare Pages","text":""},{"location":"deployment/cloudflare/#project-setup","title":"Project setup","text":"<ol> <li>Prepare the dashboard repo (Next.js):</li> <li>ensure you have a build script, e.g. <code>npm run build</code>,</li> <li> <p>ensure you have an export or static build step if needed (for Pages static mode).</p> </li> <li> <p>Create a Cloudflare Pages project:</p> </li> <li>connect it to the dashboard repository (GitHub, GitLab, etc.),</li> <li> <p>configure:</p> <ul> <li>build command: <code>npm run build</code> (or your specific command),</li> <li>output directory:</li> <li>if using <code>next export</code>: <code>out</code>,</li> <li>if using the official Next.js Pages integration: follow Cloudflare docs.</li> </ul> </li> <li> <p>Configure environment variables for the build:</p> </li> <li><code>NEXT_PUBLIC_API_BASE_URL</code>:<ul> <li>set to your Worker\u2019s base path, e.g. <code>https://city.example/api</code>,</li> </ul> </li> <li> <p>any map token or public configuration:</p> <ul> <li><code>NEXT_PUBLIC_MAPBOX_TOKEN</code>,</li> <li>etc.</li> </ul> </li> <li> <p>Trigger a build:</p> </li> <li>on push to main / specific branch,</li> <li>verify that Pages successfully builds and deploys the dashboard.</li> </ol>"},{"location":"deployment/cloudflare/#dns-and-domain","title":"DNS and domain","text":"<ul> <li>In Cloudflare DNS:</li> <li>configure <code>city.example</code> or <code>dashboard.city.example</code> as a CNAME pointing to the Pages project,</li> <li> <p>ensure HTTPS is enabled (Cloudflare handles TLS certificates).</p> </li> <li> <p>Access the site:</p> </li> <li>confirm the dashboard loads,</li> <li>expect that data/API calls may fail until Workers and backend are ready.</li> </ul>"},{"location":"deployment/cloudflare/#api-proxy-using-workers","title":"API proxy using Workers","text":"<p>The dashboard should never talk directly to the broker. Instead, it calls:</p> <ul> <li><code>https://city.example/api/...</code> \u2192 Cloudflare Worker.</li> </ul>"},{"location":"deployment/cloudflare/#worker-responsibilities","title":"Worker responsibilities","text":"<p>The Worker should:</p> <ul> <li>accept incoming <code>/api/...</code> requests from the dashboard,</li> <li>validate or authenticate the request if needed (for example, check a header or cookie),</li> <li>forward the request to the backend proxy/broker API (in your infrastructure),</li> <li>handle errors (e.g. timeouts, 5xx from backend),</li> <li>return a simplified JSON response to the frontend.</li> </ul> <p>Example flow:</p> <ol> <li>Browser: <code>GET https://city.example/api/flood-zones?bbox=...</code></li> <li>Worker:</li> <li>send a request to <code>\"https://backend.internal/api/flood-zones?bbox=...\"</code>,</li> <li>include any necessary auth for the backend,</li> <li>check the response status,</li> <li>return JSON to the browser.</li> </ol>"},{"location":"deployment/cloudflare/#backend-api-endpoint","title":"Backend API endpoint","text":"<p>In your backend environment (VM, AWS, etc.), expose a proxy or API endpoint:</p> <ul> <li>base URL, e.g. <code>https://backend.city.example</code> (behind your own load balancer or reverse proxy),</li> <li>endpoints:</li> <li><code>/api/flood-zones</code>,</li> <li><code>/api/weather</code>,</li> <li><code>/api/parking</code>, etc.</li> </ul> <p>These endpoints call the broker, process entities, and return UI-friendly data.</p> <p>The Worker will only talk to <code>https://backend.city.example</code>, not directly to the broker.</p>"},{"location":"deployment/cloudflare/#worker-configuration","title":"Worker configuration","text":"<p>For each Worker, configure environment variables (Worker bindings or plain strings):</p> <ul> <li><code>BACKEND_API_BASE_URL</code>:</li> <li>e.g. <code>https://backend.city.example/api</code>,</li> <li>any API keys or tokens required to call your backend (if applicable).</li> </ul> <p>Worker code (conceptually) uses these values to construct requests to the backend.</p>"},{"location":"deployment/cloudflare/#network-and-security-considerations","title":"Network and security considerations","text":""},{"location":"deployment/cloudflare/#exposing-the-backend","title":"Exposing the backend","text":"<p>Your backend endpoint (<code>backend.city.example</code>) must be reachable from the Cloudflare Worker:</p> <ul> <li>it needs a public DNS name and HTTPS endpoint,</li> <li>access should be restricted as much as possible:</li> <li>allow only Cloudflare IP ranges (via firewall rules), or</li> <li>enforce additional authentication (API keys, tokens).</li> </ul> <p>The broker and PayloadCMS:</p> <ul> <li>should remain on internal networks,</li> <li>should be behind a reverse proxy in the backend environment,</li> <li>should not be directly reachable from the internet.</li> </ul> <p>The Worker only talks to your backend proxy, which then talks to the broker.</p>"},{"location":"deployment/cloudflare/#authentication","title":"Authentication","text":"<p>Options for securing Worker \u2192 backend traffic:</p> <ul> <li>Static backend token:</li> <li>Worker includes a header like <code>X-Backend-Token: &lt;value&gt;</code>,</li> <li> <p>backend checks the token before handling the request.</p> </li> <li> <p>Mutual TLS or IP-based allowlisting:</p> </li> <li>if your backend supports it and you want stronger controls.</li> </ul> <p>Regardless of the method:</p> <ul> <li>broker write keys remain in the backend,</li> <li>only read access or aggregated views are exposed through the backend API to the Worker.</li> </ul>"},{"location":"deployment/cloudflare/#configuration-management","title":"Configuration management","text":"<p>You will have configuration in two places:</p> <ul> <li>Cloudflare:</li> <li>Pages project env vars:<ul> <li><code>NEXT_PUBLIC_API_BASE_URL</code>,</li> <li><code>NEXT_PUBLIC_MAPBOX_TOKEN</code>, etc.</li> </ul> </li> <li> <p>Worker env vars:</p> <ul> <li><code>BACKEND_API_BASE_URL</code>,</li> <li><code>BACKEND_API_KEY</code> if used.</li> </ul> </li> <li> <p>Backend environment (VM/AWS):</p> </li> <li>broker URL, write keys, etc. (as described in other deployment docs),</li> <li>PayloadCMS DB URL,</li> <li>external API keys for update servers.</li> </ul> <p>Guidelines:</p> <ul> <li>keep secrets (API keys, tokens) out of the dashboard build and <code>.env</code> files committed to git,</li> <li>only expose public config (Mapbox public token, base URL) to the dashboard,</li> <li>keep Worker secrets and backend secrets in secure stores or environment configuration.</li> </ul>"},{"location":"deployment/cloudflare/#deployment-workflow","title":"Deployment workflow","text":"<p>A typical workflow with Cloudflare in place:</p> <ol> <li>Update backend logic (broker proxy, PayloadCMS, update servers):</li> <li>push code to your backend repo,</li> <li>deploy to your VM or AWS setup,</li> <li> <p>verify backend API endpoints.</p> </li> <li> <p>Update Worker (if API shape changes or new endpoints are needed):</p> </li> <li>update Worker code to handle new paths,</li> <li>deploy Worker via Cloudflare,</li> <li> <p>test calls from the browser or using <code>curl</code> to <code>/api/...</code>.</p> </li> <li> <p>Update dashboard:</p> </li> <li>update UI components in the dashboard repo,</li> <li>ensure the code calls the correct <code>/api/...</code> paths,</li> <li>push changes to the branch connected to Cloudflare Pages,</li> <li>let Pages rebuild and deploy,</li> <li>verify the UI and data flow.</li> </ol> <p>This keeps the frontend deployment (Pages) decoupled from backend deployment.</p>"},{"location":"deployment/cloudflare/#monitoring-and-debugging","title":"Monitoring and debugging","text":"<p>Monitoring components:</p> <ul> <li>Cloudflare Pages:</li> <li>build logs,</li> <li> <p>deployment history.</p> </li> <li> <p>Workers:</p> </li> <li>logs and metrics via Cloudflare dashboard,</li> <li> <p>see errors for <code>/api</code> requests.</p> </li> <li> <p>Backend:</p> </li> <li>logs and metrics from your backend platform (VM logs, AWS CloudWatch, etc.).</li> </ul> <p>Typical debugging flow for a failing map/API call:</p> <ol> <li>Check the browser network tab:</li> <li>see which <code>/api/...</code> call fails,</li> <li> <p>note the status code and response.</p> </li> <li> <p>Check Worker logs:</p> </li> <li>see if the Worker received the request,</li> <li> <p>see if the request to backend failed (timeout, DNS, 5xx).</p> </li> <li> <p>Check backend logs:</p> </li> <li>inspect the backend proxy or broker service that handles the request,</li> <li> <p>check connectivity to the broker.</p> </li> <li> <p>Fix in the appropriate layer:</p> </li> <li>Worker (incorrect URL or header),</li> <li>backend (missing route, logic error, broker connectivity),</li> <li>dashboard (wrong request parameters).</li> </ol>"},{"location":"deployment/cloudflare/#integration-with-other-deployments","title":"Integration with other deployments","text":"<p>Cloudflare deployment works together with other patterns:</p> <ul> <li>you can host the backend on:</li> <li>a VM + Docker (as in the VM/Docker doc),</li> <li>AWS ECS/RDS (as in the AWS doc),</li> <li>Coolify, etc.</li> </ul> <p>Cloudflare then becomes:</p> <ul> <li>the public face for the dashboard,</li> <li>and optionally the public face for API requests (via Workers).</li> </ul> <p>This separation allows:</p> <ul> <li>changing backend platform (e.g. from VM to AWS) with minimal changes in the dashboard,  </li> <li>keeping brokers and PayloadCMS behind controlled endpoints.</li> </ul>"},{"location":"deployment/cloudflare/#summary","title":"Summary","text":"<ul> <li>Cloudflare is used to host the LegoCity dashboard (via Pages) and a thin API proxy layer (via Workers).</li> <li>The broker, PayloadCMS and update servers remain in your backend infrastructure (VM / AWS / other).</li> <li>The dashboard calls <code>/api/...</code> on your domain; Workers forward these to your backend API, which in turn talks to the broker.</li> <li>Security is handled by:</li> <li>keeping broker and DB off the public internet,</li> <li>restricting backend endpoints and protecting them with tokens or firewall rules,</li> <li>exposing only Workers + Pages publicly.</li> <li>Deployment is split into three steps: backend deployment, Worker deployment, and dashboard deployment.</li> <li>Monitoring uses Cloudflare logs for edge components and your usual tooling for backend components.</li> </ul>"},{"location":"deployment/coolify/","title":"Coolify deployment","text":"<p>This page describes how to deploy LegoCity using Coolify or a similar self-hosted application platform.</p> <p>It focuses on:</p> <ul> <li>mapping LegoCity components to Coolify \u201cservices\u201d,</li> <li>a ready-to-use pattern for a single server or small cluster,</li> <li>how to configure environment variables, domains and TLS,</li> <li>basic maintenance (updates, backups, monitoring) in this setup.</li> </ul> <p>Coolify acts as a control plane for containers, making it easier to deploy without managing raw Docker commands and reverse proxies manually.</p>"},{"location":"deployment/coolify/#when-to-use-coolify","title":"When to use Coolify","text":"<p>A Coolify-based deployment is a good fit when:</p> <ul> <li>you have one or a small number of servers,</li> <li>you want a UI-driven way to deploy Dockerised applications,</li> <li>you want automatic domain, routing and TLS handling,</li> <li>you do not want to manage Kubernetes or complex AWS services.</li> </ul> <p>It may be less suitable when:</p> <ul> <li>you need large-scale, multi-region high availability,</li> <li>the organisation mandates a specific cloud platform and tooling.</li> </ul>"},{"location":"deployment/coolify/#components-as-coolify-services","title":"Components as Coolify services","text":"<p>In Coolify, each LegoCity component becomes one or more services:</p> <ul> <li> <p>Context broker service</p> </li> <li> <p>runs the NGSI-LD broker container.</p> </li> <li> <p>PayloadCMS service</p> </li> <li> <p>runs PayloadCMS (Node.js) container.</p> </li> <li> <p>Database service for PayloadCMS</p> </li> <li> <p>PostgreSQL or MongoDB container.</p> </li> <li> <p>Proxy / API service</p> </li> <li> <p>backend between UI and broker.</p> </li> <li> <p>Dashboard service</p> </li> <li> <p>Next.js frontend (can be SSR or static build).</p> </li> <li> <p>Update server services</p> </li> <li>one service per update server (long-running worker).</li> </ul> <p>Optionally, you can:</p> <ul> <li>add a separate reverse proxy or let Coolify manage routing directly,</li> <li>add other supporting services (metrics, monitoring, etc.) if needed.</li> </ul>"},{"location":"deployment/coolify/#pre-requisites","title":"Pre-requisites","text":"<p>To use this pattern, you need:</p> <ul> <li>a server (or VM) on which Coolify is installed,</li> <li>a domain name with DNS control (for example <code>city.example</code>),</li> <li>ability to point DNS records to the Coolify server.</li> </ul> <p>On the LegoCity side:</p> <ul> <li>container images for broker, PayloadCMS, proxy, dashboard and update servers,</li> <li>repository URLs (Git) if you let Coolify build images from source.</li> </ul>"},{"location":"deployment/coolify/#high-level-architecture-on-coolify","title":"High-level architecture on Coolify","text":"<p>Logically, the deployment looks like:</p> <ul> <li> <p>Coolify host</p> </li> <li> <p>runs all LegoCity services as containers,</p> </li> <li> <p>manages:</p> <ul> <li>container lifecycle,</li> <li>routing and domains,</li> <li>TLS certificates.</li> </ul> </li> <li> <p>LegoCity services</p> </li> <li>database service (PayloadCMS DB),</li> <li>context broker service,</li> <li>PayloadCMS service,</li> <li>proxy service,</li> <li>dashboard service,</li> <li>update servers.</li> </ul> <p>Network layout:</p> <ul> <li>Coolify manages internal networks between containers,</li> <li>external traffic comes through:</li> <li>Coolify\u2019s reverse proxy and domain configuration.</li> </ul> <p>The broker and database are not directly exposed, unless explicitly configured.</p>"},{"location":"deployment/coolify/#planning-services-and-domains","title":"Planning services and domains","text":"<p>Before creating services, decide:</p> <ul> <li> <p>which domains or subdomains you want:</p> </li> <li> <p>e.g. <code>city.example</code> \u2192 dashboard,</p> </li> <li><code>api.city.example</code> \u2192 proxy,</li> <li> <p><code>admin.city.example</code> \u2192 PayloadCMS.</p> </li> <li> <p>where each service should be reachable:</p> </li> <li>some only internal (broker, DB, update servers),</li> <li>some external (dashboard, proxy, PayloadCMS admin).</li> </ul> <p>Typical mapping:</p> <ul> <li>Dashboard \u2192 <code>city.example</code></li> <li>Proxy \u2192 <code>api.city.example</code></li> <li>PayloadCMS admin \u2192 <code>admin.city.example</code></li> <li>Broker \u2192 no public domain (internal only)</li> <li>Update servers \u2192 no public domain (internal only)</li> </ul> <p>Coolify allows you to assign domains per service and will request TLS certificates automatically.</p>"},{"location":"deployment/coolify/#defining-services-in-coolify","title":"Defining services in Coolify","text":""},{"location":"deployment/coolify/#1-database-service-payloadcms-db","title":"1. Database service (PayloadCMS DB)","text":"<ul> <li> <p>Add a new Database service in Coolify:</p> </li> <li> <p>choose PostgreSQL or MongoDB, according to your PayloadCMS configuration.</p> </li> <li> <p>Configuration:</p> </li> <li> <p>database name: <code>payload_db</code> (example),</p> </li> <li>user: <code>payload_user</code>,</li> <li> <p>password: secure random password.</p> </li> <li> <p>Make note of:</p> </li> <li>internal host,</li> <li>port,</li> <li>database name,</li> <li>user and password.</li> </ul> <p>Coolify usually provides a connection string you can use directly in environment variables.</p>"},{"location":"deployment/coolify/#2-context-broker-service","title":"2. Context broker service","text":"<ul> <li> <p>Add a new Application (container) service:</p> </li> <li> <p>choose \u201cDocker image\u201d as source,</p> </li> <li> <p>specify the broker image (e.g. <code>orion-ld</code> or your custom image).</p> </li> <li> <p>Configuration:</p> </li> <li> <p>internal port: whatever the broker uses (e.g. <code>1026</code>),</p> </li> <li>no public domain if you want it internal only,</li> <li> <p>internal networking enabled so other services can reach it.</p> </li> <li> <p>Environment variables:</p> </li> <li>any broker configuration required (depending on broker implementation).</li> </ul> <p>Coolify will manage the container; other LegoCity services will use the broker\u2019s internal hostname and port.</p>"},{"location":"deployment/coolify/#3-payloadcms-service","title":"3. PayloadCMS service","text":"<ul> <li> <p>Add another Application service:</p> </li> <li> <p>source: Git repo or Docker image for PayloadCMS.</p> </li> <li> <p>If using Git:</p> </li> <li> <p>configure build:</p> <ul> <li>Node.js version,</li> <li>build command (<code>npm run build</code> or similar),</li> <li>start command (<code>npm run start</code>),</li> <li>or use a Dockerfile.</li> </ul> </li> <li> <p>Attach a domain:</p> </li> <li> <p>e.g. <code>admin.city.example</code> for the PayloadCMS admin UI.</p> </li> <li> <p>Environment variables:</p> </li> <li><code>PAYLOAD_DB_URL</code> or equivalent:<ul> <li>use the connection string provided by the database service,</li> </ul> </li> <li><code>PAYLOAD_SECRET</code>, <code>NODE_ENV</code>, etc.,</li> <li>any other variables required by your PayloadCMS configuration (e.g. auth, storage).</li> </ul> <p>Ensure:</p> <ul> <li>service is in the same internal network as the DB service,</li> <li>DB service is not exposed externally.</li> </ul>"},{"location":"deployment/coolify/#4-proxy-api-service","title":"4. Proxy / API service","text":"<ul> <li> <p>Add an Application service for the proxy backend:</p> </li> <li> <p>source: Git repo or Docker image holding the proxy.</p> </li> <li> <p>Attach a domain:</p> </li> <li> <p>e.g. <code>api.city.example</code>.</p> </li> <li> <p>Environment variables:</p> </li> <li><code>BROKER_URL</code> set to the internal URL of the broker service,</li> <li>other config (e.g. allowed origins, API keys),</li> <li><code>NODE_ENV</code> / <code>APP_ENV</code>.</li> </ul> <p>The proxy is the only component that needs network access to the broker (besides update servers).</p>"},{"location":"deployment/coolify/#5-dashboard-service","title":"5. Dashboard service","text":"<p>There are two main ways to host the dashboard:</p>"},{"location":"deployment/coolify/#option-a-nextjs-ssr-application-service","title":"Option A \u2013 Next.js SSR (Application service)","text":"<ul> <li> <p>Add an Application service:</p> </li> <li> <p>source: dashboard repo or image,</p> </li> <li> <p>build and start commands as usual for Next.js.</p> </li> <li> <p>Attach domain:</p> </li> <li> <p>e.g. <code>city.example</code>.</p> </li> <li> <p>Environment variables:</p> </li> <li><code>NEXT_PUBLIC_API_BASE_URL=https://api.city.example</code>,</li> <li><code>NEXT_PUBLIC_MAPBOX_TOKEN</code> and any other public config.</li> </ul> <p>This option runs Next.js as a Node.js process behind Coolify\u2019s reverse proxy.</p>"},{"location":"deployment/coolify/#option-b-static-build-application-static-mode","title":"Option B \u2013 Static build (Application + static mode)","text":"<ul> <li>Build dashboard into static files (e.g. <code>next export</code>).</li> <li>Configure the service in Coolify to serve static files only.</li> <li>Simplifies runtime but restricts SSR functionality.</li> </ul> <p>The exact configuration depends on how your dashboard is built; the key is:</p> <ul> <li><code>NEXT_PUBLIC_API_BASE_URL</code> must point to the proxy,</li> <li>static assets must be served on your chosen domain.</li> </ul>"},{"location":"deployment/coolify/#6-update-server-services","title":"6. Update server services","text":"<ul> <li> <p>For each update server, add an Application service:</p> </li> <li> <p>source: Git repo or Docker image,</p> </li> <li> <p>type: background worker / long-running process.</p> </li> <li> <p>Environment variables:</p> </li> <li> <p><code>BROKER_URL</code> \u2192 internal broker URL,</p> </li> <li><code>BROKER_WRITE_KEY</code> \u2192 write key for the relevant domain,</li> <li>external API keys (e.g. <code>WEATHER_API_KEY</code>),</li> <li> <p>any schedule configuration (if workers handle their own timing).</p> </li> <li> <p>Networking:</p> </li> <li>same internal network as broker,</li> <li>no public domains (no need for HTTP ingress).</li> </ul> <p>You can run different update servers for environment, flooding, mobility, etc.</p>"},{"location":"deployment/coolify/#environment-separation","title":"Environment separation","text":"<p>To keep dev and prod separate, you can:</p> <ul> <li>run two Coolify instances on different servers, or</li> <li>run:</li> <li>dev services and prod services on the same Coolify but:<ul> <li>with different domains (e.g. <code>dev.city.example</code> vs <code>city.example</code>),</li> <li>with separate DB instances,</li> <li>with different broker instances.</li> </ul> </li> </ul> <p>Recommended for clarity:</p> <ul> <li>one Coolify instance per environment, or</li> <li>at least clear naming and isolation of services and databases.</li> </ul>"},{"location":"deployment/coolify/#configuration-and-secrets-in-coolify","title":"Configuration and secrets in Coolify","text":"<p>Coolify allows you to:</p> <ul> <li>define environment variables per service,</li> <li>mark some as secrets,</li> <li>override values per deployment.</li> </ul> <p>Best practices:</p> <ul> <li>do not put secrets in the repository,</li> <li>define DB passwords, broker write keys, external API keys as secrets in Coolify,</li> <li>keep non-secret configuration (like map style names) as plain variables.</li> </ul> <p>For each service, document:</p> <ul> <li>which variables must be set,</li> <li>where values come from (DB service, broker, external provider).</li> </ul>"},{"location":"deployment/coolify/#deployment-workflow-in-coolify","title":"Deployment workflow in Coolify","text":"<p>A typical workflow for deploying a change:</p> <ol> <li>Push new code to the Git repository.</li> <li>In Coolify:</li> <li>either:<ul> <li>configure automatic deployment on push, or</li> <li>trigger deployment manually.</li> </ul> </li> <li>Coolify:</li> <li>pulls the latest code,</li> <li>builds the application image or bundle,</li> <li>restarts the service with new version.</li> </ol> <p>For image-based services:</p> <ul> <li>update image tag in Coolify service configuration,</li> <li>trigger redeploy.</li> </ul> <p>Order of changes:</p> <ul> <li>backend/proxy updates first,</li> <li>then dashboard,</li> <li>occasionally PayloadCMS or broker if data contracts change.</li> </ul>"},{"location":"deployment/coolify/#monitoring-and-logs","title":"Monitoring and logs","text":"<p>Coolify provides basic management and access to logs:</p> <ul> <li>you can view logs per service from the UI,</li> <li>you can see container status (running, failed, restarting).</li> </ul> <p>Recommended:</p> <ul> <li>periodically check logs for:</li> <li>update servers (data ingestion),</li> <li>proxy (API errors),</li> <li>PayloadCMS (DB issues),</li> <li>broker (resource or context errors).</li> </ul> <p>If needed, you can:</p> <ul> <li>export logs to an external system (ELK, Loki, etc.),</li> <li>add health endpoints to services and use Coolify health checks.</li> </ul>"},{"location":"deployment/coolify/#backups-and-maintenance","title":"Backups and maintenance","text":"<p>Stateful components on a Coolify server:</p> <ul> <li> <p>PayloadCMS database:</p> </li> <li> <p>critical to back up regularly,</p> </li> <li> <p>use DB-native tooling or a backup add-on if Coolify supports it.</p> </li> <li> <p>Broker storage (if using persistent volume):</p> </li> <li> <p>remember where it is stored on the host,</p> </li> <li> <p>snapshot or backup this directory.</p> </li> <li> <p>Coolify configuration:</p> </li> <li>backup Coolify configuration and metadata,</li> <li>keep a copy of deployment definitions and environment variables in a safe place (text export or IaC).</li> </ul> <p>Maintenance tasks:</p> <ul> <li>apply OS updates on the host (kernel, security),</li> <li>update Docker engine if relevant,</li> <li>update Coolify itself (following their upgrade guide),</li> <li>rotate credentials (DB passwords, broker keys, external API keys).</li> </ul> <p>Test:</p> <ul> <li>restoration of DB backups in a staging environment,</li> <li>service restart after host reboot.</li> </ul>"},{"location":"deployment/coolify/#scaling-and-limitations","title":"Scaling and limitations","text":"<p>Coolify simplifies deployment but does not remove all infrastructure limits.</p> <p>Scaling strategies:</p> <ul> <li>increase CPU/memory assigned to specific services,</li> <li>move DB to a separate, more powerful server,</li> <li>split heavy services (e.g. broker and PayloadCMS) across multiple hosts managed by the same Coolify instance (if supported).</li> </ul> <p>Limitations:</p> <ul> <li>horizontal scaling across multiple data centres is not automatic,</li> <li>you still depend on the health and capacity of the underlying host(s).</li> </ul> <p>For larger deployments, you may later migrate:</p> <ul> <li>broker and DB to dedicated infrastructure (AWS/RDS, etc.),</li> <li>keep Coolify mainly for frontend and smaller services.</li> </ul>"},{"location":"deployment/coolify/#summary","title":"Summary","text":"<ul> <li>Coolify provides a UI-driven way to deploy LegoCity components as Docker containers on a single server or small set of servers.</li> <li>Each major component (broker, PayloadCMS, DB, proxy, dashboard, update servers) is defined as a separate service with its own environment variables and, where needed, domain.</li> <li>Domains such as <code>city.example</code>, <code>api.city.example</code> and <code>admin.city.example</code> are mapped through Coolify\u2019s reverse proxy, which also manages TLS certificates.</li> <li>Configuration and secrets are handled via service-level environment variables; stateful services like the DB and broker use persistent volumes and require regular backups.</li> <li>This pattern is suitable for teams who want to avoid managing low-level Docker/NGINX but do not need the complexity of full cloud platforms or Kubernetes.</li> </ul>"},{"location":"deployment/operations/","title":"Operations and maintenance","text":"<p>This page describes how to run LegoCity in the long term:</p> <ul> <li>what to monitor,</li> <li>what to back up,</li> <li>how to update components safely,</li> <li>how to handle incidents and security.</li> </ul> <p>It is platform-agnostic: the same ideas apply whether you deploy on a VM, AWS, Coolify or another platform. Platform-specific pages show how to implement these ideas with concrete tools.</p>"},{"location":"deployment/operations/#operational-responsibilities","title":"Operational responsibilities","text":"<p>A LegoCity deployment is more than just the first <code>deploy</code>:</p> <ul> <li> <p>Availability   The dashboard, PayloadCMS and API endpoints should be reachable and responsive.</p> </li> <li> <p>Data freshness   Update servers must continue to ingest data and update entities.</p> </li> <li> <p>Consistency   Entity models and APIs must stay in sync across services and documentation.</p> </li> <li> <p>Security   Broker write access, admin UI and secrets must be protected and rotated.</p> </li> <li> <p>Recoverability   It must be possible to restore the system after data loss or misconfiguration.</p> </li> </ul> <p>This page assumes that:</p> <ul> <li>deployment is already running,</li> <li>you have at least one environment (dev) and ideally a separate prod.</li> </ul>"},{"location":"deployment/operations/#what-to-monitor","title":"What to monitor","text":"<p>Monitoring should cover both infrastructure and application-level health.</p>"},{"location":"deployment/operations/#core-components","title":"Core components","text":"<p>At minimum, track the following:</p> <ul> <li> <p>Context broker</p> </li> <li> <p>process/container health,</p> </li> <li>response time and error rate on key endpoints,</li> <li> <p>storage usage and any internal metrics (if available).</p> </li> <li> <p>Update servers</p> </li> <li> <p>last successful run time,</p> </li> <li>number of entities created/updated per run,</li> <li> <p>error rates when calling external APIs or the broker.</p> </li> <li> <p>PayloadCMS</p> </li> <li> <p>HTTP error rates (4xx/5xx),</p> </li> <li>response time for admin UI,</li> <li> <p>database connection errors.</p> </li> <li> <p>Proxy / API</p> </li> <li> <p>response time and error rate for <code>/api/...</code> endpoints,</p> </li> <li>timeouts to the broker,</li> <li> <p>volume of requests per endpoint.</p> </li> <li> <p>Dashboard</p> </li> <li>basic availability (can it be loaded at all),</li> <li>critical UI errors (if you collect frontend error reports).</li> </ul>"},{"location":"deployment/operations/#signals-and-thresholds","title":"Signals and thresholds","text":"<p>Examples of useful alerts:</p> <ul> <li>broker down or returning 5xx on health endpoints,</li> <li>update servers failing consecutively for a period (e.g. 10\u201315 minutes),</li> <li>payload admin returning frequent 500 errors,</li> <li>sudden drop in entity counts (may indicate bad updates),</li> <li>unbounded growth in entity counts (may indicate duplication).</li> </ul> <p>The exact thresholds depend on:</p> <ul> <li>data update frequency,</li> <li>expected traffic,</li> <li>tolerance for delay in dashboards.</li> </ul>"},{"location":"deployment/operations/#logs-and-observability","title":"Logs and observability","text":"<p>Logs are the first source of truth when something goes wrong.</p>"},{"location":"deployment/operations/#what-to-log","title":"What to log","text":"<p>Each component should log at least:</p> <ul> <li> <p>startup:</p> </li> <li> <p>configuration summary (sanitised, no secrets),</p> </li> <li> <p>version or commit hash.</p> </li> <li> <p>normal operations:</p> </li> <li> <p>update servers:</p> <ul> <li>number of entities processed per cycle,</li> <li>key external API calls,</li> <li>partial failures (time-limited, but informative).</li> </ul> </li> <li> <p>proxy:</p> <ul> <li>upstream errors when calling broker,</li> <li>validation errors on incoming requests.</li> </ul> </li> <li> <p>errors:</p> </li> <li>network timeouts,</li> <li>broker write failures,</li> <li>database errors (PayloadCMS).</li> </ul> <p>Logs should be structured enough that:</p> <ul> <li>you can filter by component, severity and time,</li> <li>you can correlate events between update servers and broker/proxy.</li> </ul>"},{"location":"deployment/operations/#where-to-store-logs","title":"Where to store logs","text":"<p>Depends on deployment:</p> <ul> <li> <p>VM / Docker:</p> </li> <li> <p>Docker logs (via <code>docker logs</code>),</p> </li> <li>log files on disk,</li> <li> <p>optionally shipped to a central system.</p> </li> <li> <p>AWS:</p> </li> <li> <p>CloudWatch Logs per ECS service,</p> </li> <li> <p>CloudWatch metrics and alarms.</p> </li> <li> <p>Coolify:</p> </li> <li>logs per service via Coolify UI,</li> <li>optional integration with external log systems.</li> </ul> <p>Whatever the platform, operators should:</p> <ul> <li>know how to view logs for each component,</li> <li>have a short list of log locations and commands.</li> </ul>"},{"location":"deployment/operations/#backups","title":"Backups","text":"<p>Backups are essential for PayloadCMS data and any stateful broker storage.</p>"},{"location":"deployment/operations/#what-to-back-up","title":"What to back up","text":"<p>Minimum:</p> <ul> <li> <p>PayloadCMS database</p> </li> <li> <p>all collections (layers, blocks, UI configs, content),</p> </li> <li> <p>user accounts and permissions.</p> </li> <li> <p>Broker data (if it is persisted on disk and not fully reconstructible):</p> </li> <li>entity store or database used by the broker,</li> <li>configuration files (if not already version-controlled).</li> </ul> <p>Important but often overlooked:</p> <ul> <li>Configuration:</li> <li><code>.env</code>-like configuration files (without secrets) under version control,</li> <li>infrastructure-as-code or deployment definitions,</li> <li>SSM/Secrets Manager parameter names and structure (values are secret, but keys/paths are needed).</li> </ul>"},{"location":"deployment/operations/#how-often-to-back-up","title":"How often to back up","text":"<p>Baseline recommendations:</p> <ul> <li> <p>production database:</p> </li> <li> <p>automatic daily backups,</p> </li> <li> <p>manual snapshot before major releases or schema changes.</p> </li> <li> <p>development database:</p> </li> <li> <p>periodic backups if needed, but lower strictness.</p> </li> <li> <p>broker data:</p> </li> <li>backup frequency depends on whether entities can be rebuilt from sources:<ul> <li>if external sources can recreate state \u2192 less frequent or optional,</li> <li>if broker holds unique or manually curated data \u2192 back up in line with DB.</li> </ul> </li> </ul>"},{"location":"deployment/operations/#testing-restores","title":"Testing restores","text":"<p>Backups are only useful if they can be restored.</p> <ul> <li> <p>periodically restore PayloadCMS DB into a test environment:</p> </li> <li> <p>verify that:</p> <ul> <li>admin can log in,</li> <li>pages and map configurations load correctly,</li> <li>no corruption or missing tables/collections.</li> </ul> </li> <li> <p>if broker data is backed up:</p> </li> <li>restore into a test broker instance,</li> <li>run basic queries to ensure entities appear as expected.</li> </ul> <p>Document:</p> <ul> <li>exact procedures to restore:</li> <li>from which backup source,</li> <li>into which environment,</li> <li>who is responsible.</li> </ul>"},{"location":"deployment/operations/#updating-components","title":"Updating components","text":"<p>LegoCity consists of multiple components that may evolve at different speeds.</p>"},{"location":"deployment/operations/#general-principles","title":"General principles","text":"<p>When updating:</p> <ul> <li>change one layer at a time where possible,</li> <li>keep dev and prod environments separate,</li> <li>ensure backward compatibility for data contracts whenever feasible.</li> </ul> <p>Typical update order:</p> <ol> <li>Update servers and proxy (backwards compatible changes).</li> <li>Dashboard (UI changes that consume existing APIs).</li> <li>PayloadCMS (if schema or admin UI changes are required).</li> <li>Broker and core data models (only when necessary, with planning).</li> </ol>"},{"location":"deployment/operations/#update-process","title":"Update process","text":"<p>A safe path for a new release:</p> <ol> <li> <p>Dev environment</p> </li> <li> <p>deploy new images to dev,</p> </li> <li>apply migrations (if any) to dev DB/broker,</li> <li> <p>run smoke tests:</p> <ul> <li>can update servers start and update entities,</li> <li>can the proxy and dashboard read entities correctly.</li> </ul> </li> <li> <p>Staging (if available)</p> </li> <li> <p>repeat with more realistic data and users.</p> </li> <li> <p>Production</p> </li> <li> <p>choose a maintenance window if updates are disruptive,</p> </li> <li>back up PayloadCMS DB and broker state beforehand,</li> <li> <p>deploy new versions:</p> <ul> <li>update containers (image tags),</li> <li>apply migrations,</li> <li>monitor logs and dashboards closely.</li> </ul> </li> <li> <p>Post-deployment checks</p> </li> <li> <p>validate:</p> <ul> <li>admin login,</li> <li>key dashboards,</li> <li>data freshness (update servers running normally),</li> </ul> </li> <li>confirm metrics and error rates remain within expected ranges.</li> </ol>"},{"location":"deployment/operations/#schema-and-data-contract-changes","title":"Schema and data contract changes","text":"<p>Changes to entity models or APIs are high-risk.</p>"},{"location":"deployment/operations/#planning-schema-changes","title":"Planning schema changes","text":"<p>For any change to entity structure (new attributes, renamed fields, removed attributes):</p> <ul> <li> <p>update the entity documentation first:</p> </li> <li> <p>type name,</p> </li> <li>attributes,</li> <li>ID patterns,</li> <li> <p>relationships.</p> </li> <li> <p>identify all consumers:</p> </li> <li> <p>proxy endpoints,</p> </li> <li>dashboard views and blocks,</li> <li> <p>any external integrations.</p> </li> <li> <p>decide migration strategy:</p> </li> <li>temporary dual-structure support (old and new attributes),</li> <li>one-step break (only in controlled scenarios).</li> </ul>"},{"location":"deployment/operations/#applying-schema-changes","title":"Applying schema changes","text":"<p>Suggested pattern:</p> <ul> <li> <p>add new attributes first, while keeping old ones:</p> </li> <li> <p>update update servers to write both,</p> </li> <li>update proxy and dashboard to use the new attributes,</li> <li> <p>monitor for any regressions.</p> </li> <li> <p>remove or deprecate old attributes last:</p> </li> <li>only after confirming the new structure is fully used,</li> <li>communicating changes to all teams.</li> </ul> <p>Any breaking change should be clearly recorded in a changelog or release notes.</p>"},{"location":"deployment/operations/#security-operations","title":"Security operations","text":"<p>Security is not a one-time setup; it requires ongoing maintenance.</p>"},{"location":"deployment/operations/#credential-management","title":"Credential management","text":"<p>Areas to focus on:</p> <ul> <li> <p>Broker write keys:</p> </li> <li> <p>confined to update servers,</p> </li> <li>rotated on a regular schedule or when team membership changes,</li> <li> <p>never logged or displayed in plaintext.</p> </li> <li> <p>PayloadCMS admin accounts:</p> </li> <li> <p>strong passwords,</p> </li> <li>limited to required admins,</li> <li> <p>periodic review of user list and roles.</p> </li> <li> <p>External API keys (weather, mobility data providers, etc.):</p> </li> <li>stored in secret managers or deployment configuration,</li> <li>rotated according to provider recommendations.</li> </ul> <p>Whenever a key is suspected to be exposed:</p> <ul> <li>revoke and replace it,</li> <li>check logs for unusual activity involving that key.</li> </ul>"},{"location":"deployment/operations/#surface-reduction","title":"Surface reduction","text":"<p>Reduce the attack surface by:</p> <ul> <li>exposing only:</li> <li>proxy and dashboard to general users,</li> <li>PayloadCMS admin UI to admins (use IP filtering, VPN or access control),</li> <li>keeping broker and DB on internal networks,</li> <li>ensuring update servers are not publicly reachable unless strictly required.</li> </ul>"},{"location":"deployment/operations/#incident-response","title":"Incident response","text":"<p>Incidents will happen: broker downtime, external API failures, bad deployments, etc.</p>"},{"location":"deployment/operations/#basic-playbooks","title":"Basic playbooks","text":"<p>Prepare short, practical checklists for common incidents:</p> <ul> <li> <p>Dashboard cannot reach backend:</p> </li> <li> <p>check proxy container or service status,</p> </li> <li>check DNS and reverse proxy routing,</li> <li> <p>check TLS certificate validity.</p> </li> <li> <p>Dashboard shows no data:</p> </li> <li> <p>check update server logs:</p> <ul> <li>are there recent updates?</li> </ul> </li> <li>check broker entities:<ul> <li>are they present but filtered incorrectly?</li> </ul> </li> <li> <p>check proxy:</p> <ul> <li>does it return entities for basic queries?</li> </ul> </li> <li> <p>PayloadCMS unreachable:</p> </li> <li> <p>check Payload service status,</p> </li> <li>check DB connectivity,</li> <li> <p>check admin domain and TLS.</p> </li> <li> <p>Broker errors:</p> </li> <li>check resource usage (CPU, memory, disk),</li> <li>check write error logs from update servers,</li> <li>check whether entity volume or request patterns have changed.</li> </ul>"},{"location":"deployment/operations/#communication","title":"Communication","text":"<p>For larger incidents:</p> <ul> <li> <p>decide who:</p> </li> <li> <p>triages and mitigates,</p> </li> <li>communicates status to stakeholders,</li> <li> <p>documents what happened.</p> </li> <li> <p>record:</p> </li> <li>timeline of the incident,</li> <li>root cause (if identified),</li> <li>actions taken,</li> <li>follow-up improvements.</li> </ul>"},{"location":"deployment/operations/#routine-operational-tasks","title":"Routine operational tasks","text":"<p>For a stable deployment, define regular tasks:</p>"},{"location":"deployment/operations/#daily-or-per-shift","title":"Daily or per-shift","text":"<ul> <li>check dashboard for obvious errors or missing data,</li> <li>glance at broker and update server logs for any recurring errors,</li> <li>confirm that at least one update cycle has succeeded recently.</li> </ul>"},{"location":"deployment/operations/#weekly","title":"Weekly","text":"<ul> <li>review alerts and thresholds; tune if there is alert fatigue,</li> <li>check for available updates in critical dependencies (if you track them manually),</li> <li>run basic health queries against the broker.</li> </ul>"},{"location":"deployment/operations/#monthly-or-quarterly","title":"Monthly or quarterly","text":"<ul> <li>test restore of PayloadCMS DB (in non-production),</li> <li>rotate selected credentials (API keys, write tokens) as a practice,</li> <li>review entity documentation and update it if the implementation has drifted,</li> <li>evaluate resource usage against capacity.</li> </ul>"},{"location":"deployment/operations/#summary","title":"Summary","text":"<ul> <li>Operations and maintenance for LegoCity revolve around availability, data freshness, consistency, security and recoverability.</li> <li>Monitoring should cover brokers, update servers, PayloadCMS, proxy and dashboard, with clear alerts for failures and abnormal behaviour.</li> <li>Backups, especially of PayloadCMS DB and any broker storage that cannot be easily recreated, must be regular and tested.</li> <li>Updates should flow through dev (and staging, if available) before production, with particular care when changing entity schemas and APIs.</li> <li>Security operations include managing broker write keys, admin access, external API keys and limiting exposed surfaces.</li> <li>Clear incident playbooks and routine operational tasks help keep the deployment predictable and easier to maintain over time.</li> </ul>"},{"location":"deployment/vm-docker/","title":"Virtual machines and Docker","text":"<p>This page describes how to deploy LegoCity on one or more virtual machines using Docker and Docker Compose.</p> <p>It focuses on a ready-to-use pattern for:</p> <ul> <li>small to medium deployments,</li> <li>demos and pilots,</li> <li>teams without a dedicated DevOps platform.</li> </ul> <p>It also covers basic maintenance tasks: updating services, viewing logs and backing up data.</p>"},{"location":"deployment/vm-docker/#when-to-use-this-approach","title":"When to use this approach","text":"<p>A VM + Docker deployment is a good fit when:</p> <ul> <li>you have access to one or a few virtual machines (for example on a university or city server),</li> <li>you want to run all components on the same host or a small number of hosts,</li> <li>you prefer a simple setup over a fully managed cloud solution.</li> </ul> <p>It may not be ideal when:</p> <ul> <li>you require high availability across data centres,</li> <li>you expect very high traffic or strict SLAs,</li> <li>your organisation enforces specific cloud-native platforms (Kubernetes, ECS, etc.).</li> </ul>"},{"location":"deployment/vm-docker/#components-in-this-setup","title":"Components in this setup","text":"<p>In a typical VM + Docker deployment, you run the following components as containers:</p> <ul> <li>context broker (NGSI-LD broker),</li> <li>PayloadCMS,</li> <li>database for PayloadCMS (for example PostgreSQL or MongoDB),</li> <li>proxy / API layer (backend between UI and broker),</li> <li>dashboard (Next.js / Mapbox frontend),</li> <li>one or more update servers.</li> </ul> <p>A typical single-VM setup will have:</p> <ul> <li>one Docker host,</li> <li>one reverse proxy (optional but recommended),</li> <li>multiple containers for the services above.</li> </ul>"},{"location":"deployment/vm-docker/#high-level-architecture-on-a-single-vm","title":"High-level architecture on a single VM","text":"<p>On a single VM, the logical architecture is:</p> <ul> <li>external network:</li> <li> <p>users access:</p> <ul> <li>dashboard URL,</li> <li>API (proxy) URL,</li> <li>PayloadCMS admin URL (controlled access).</li> </ul> </li> <li> <p>internal network (Docker network):</p> </li> <li>context broker,</li> <li>database,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>update servers.</li> </ul> <p>Network access:</p> <ul> <li>only the reverse proxy or a limited set of containers expose ports to the host,</li> <li>most services communicate on an internal Docker network,</li> <li>broker and database are not directly exposed to the internet.</li> </ul>"},{"location":"deployment/vm-docker/#prerequisites","title":"Prerequisites","text":"<p>On the virtual machine:</p> <ul> <li>a supported Linux distribution (for example Ubuntu LTS),</li> <li>Docker Engine installed,</li> <li>Docker Compose (v2 or integrated in Docker),</li> <li>access to the VM as a user with permission to run Docker (often via SSH),</li> <li>domain names or subdomains for:</li> <li>the dashboard (optional but recommended),</li> <li>the API/proxy,</li> <li>PayloadCMS admin.</li> </ul> <p>Optional but recommended:</p> <ul> <li>a reverse proxy such as Nginx or Traefik to terminate TLS and route incoming HTTP requests to the correct containers.</li> </ul>"},{"location":"deployment/vm-docker/#directory-layout","title":"Directory layout","text":"<p>A simple directory layout on the VM might be:</p> <pre><code>/opt/legocity/\n  docker-compose.yml\n  .env\n  reverse-proxy/\n    docker-compose.yml (if using separate compose)\n    config/...\n  data/\n    broker/\n    db/\n  logs/\n    ...\n</code></pre> <p>Alternative layouts are possible as long as:</p> <ul> <li>volumes for persistent data (database, broker storage) are clearly separated,</li> <li>configuration (.env, compose files) is checked into version control (without secrets).</li> </ul>"},{"location":"deployment/vm-docker/#environment-configuration","title":"Environment configuration","text":"<p>All secrets and environment-specific configuration should be taken from a <code>.env</code> file or equivalent, not hard-coded in <code>docker-compose.yml</code>.</p> <p>Example <code>.env</code> (illustrative, not exhaustive):</p> <pre><code># General\nAPP_ENV=production\n\n# Broker\nBROKER_IMAGE=orion-ld:latest\nBROKER_PORT=1026\n\n# PayloadCMS\nPAYLOAD_IMAGE=legocity-payload:latest\nPAYLOAD_PORT=3000\nPAYLOAD_DB_URL=postgres://payload_user:payload_pass@db:5432/payload_db\n\n# Postgres (for PayloadCMS)\nPOSTGRES_IMAGE=postgres:16\nPOSTGRES_DB=payload_db\nPOSTGRES_USER=payload_user\nPOSTGRES_PASSWORD=payload_pass\n\n# Proxy/API\nPROXY_IMAGE=legocity-proxy:latest\nPROXY_PORT=4000\n\n# Dashboard\nDASHBOARD_IMAGE=legocity-dashboard:latest\nDASHBOARD_PORT=3001\n\n# Update servers (example)\nUPDATE_ENV_IMAGE=legocity-update-env:latest\n\n# Broker auth (example)\nBROKER_WRITE_KEY_ENV=change-me-env\nBROKER_WRITE_KEY_WATER=change-me-water\nBROKER_WRITE_KEY_MOBILITY=change-me-mobility\n\n# External APIs (example)\nWEATHER_API_KEY=change-me-weather\n</code></pre> <p>In production, the actual secrets should be:</p> <ul> <li>set via deployment automation or configuration management,</li> <li>stored in a secure location (not committed to a public repository).</li> </ul>"},{"location":"deployment/vm-docker/#docker-compose-structure","title":"Docker Compose structure","text":"<p>A minimal <code>docker-compose.yml</code> for a single-VM deployment could include services for:</p> <ul> <li>broker,</li> <li>database,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>dashboard,</li> <li>one sample update server.</li> </ul> <p>Conceptually:</p> <pre><code>version: \"3.9\"\n\nservices:\n  broker:\n    image: ${BROKER_IMAGE}\n    container_name: legocity-broker\n    ports:\n      - \"${BROKER_PORT}:1026\"\n    environment:\n      # broker-specific configuration here\n    volumes:\n      - ./data/broker:/data\n    networks:\n      - internal\n\n  db:\n    image: ${POSTGRES_IMAGE}\n    container_name: legocity-db\n    environment:\n      POSTGRES_DB: ${POSTGRES_DB}\n      POSTGRES_USER: ${POSTGRES_USER}\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n    volumes:\n      - ./data/db:/var/lib/postgresql/data\n    networks:\n      - internal\n\n  payload:\n    image: ${PAYLOAD_IMAGE}\n    container_name: legocity-payload\n    environment:\n      PAYLOAD_DB_URL: ${PAYLOAD_DB_URL}\n      APP_ENV: ${APP_ENV}\n      # more PayloadCMS variables as needed\n    ports:\n      - \"${PAYLOAD_PORT}:3000\"\n    depends_on:\n      - db\n    networks:\n      - internal\n\n  proxy:\n    image: ${PROXY_IMAGE}\n    container_name: legocity-proxy\n    environment:\n      BROKER_URL: http://broker:1026/ngsi-ld/v1\n      APP_ENV: ${APP_ENV}\n      # any API keys or config needed\n    ports:\n      - \"${PROXY_PORT}:4000\"\n    depends_on:\n      - broker\n    networks:\n      - internal\n\n  dashboard:\n    image: ${DASHBOARD_IMAGE}\n    container_name: legocity-dashboard\n    environment:\n      NEXT_PUBLIC_API_BASE_URL: http://proxy:4000\n      APP_ENV: ${APP_ENV}\n    ports:\n      - \"${DASHBOARD_PORT}:3001\"\n    depends_on:\n      - proxy\n    networks:\n      - internal\n\n  update-env:\n    image: ${UPDATE_ENV_IMAGE}\n    container_name: legocity-update-env\n    restart: unless-stopped\n    environment:\n      BROKER_URL: http://broker:1026/ngsi-ld/v1\n      BROKER_WRITE_KEY: ${BROKER_WRITE_KEY_ENV}\n      WEATHER_API_KEY: ${WEATHER_API_KEY}\n      APP_ENV: ${APP_ENV}\n    depends_on:\n      - broker\n    networks:\n      - internal\n\nnetworks:\n  internal:\n    driver: bridge\n</code></pre> <p>Notes:</p> <ul> <li>the example assumes:</li> <li>a simple broker on port 1026,</li> <li>PayloadCMS listening on port 3000 internally,</li> <li>a proxy on port 4000,</li> <li> <p>the dashboard on port 3001.</p> </li> <li> <p>in production, you will typically place a reverse proxy in front to:</p> </li> <li>terminate HTTPS,</li> <li>map public routes to these internal ports.</li> </ul>"},{"location":"deployment/vm-docker/#reverse-proxy-optional-but-recommended","title":"Reverse proxy (optional but recommended)","text":"<p>On the same VM, you can run a reverse proxy such as Nginx or Traefik:</p> <ul> <li>listens on ports 80/443,</li> <li>routes traffic based on hostname or path.</li> </ul> <p>For example:</p> <ul> <li><code>https://city.example/dashboard</code> \u2192 dashboard container (port 3001),</li> <li><code>https://city.example/api</code> \u2192 proxy container (port 4000),</li> <li><code>https://admin.city.example</code> \u2192 PayloadCMS (port 3000, restricted access).</li> </ul> <p>The reverse proxy can:</p> <ul> <li>manage TLS certificates (for example via Let\u2019s Encrypt),</li> <li>enforce some access control,</li> <li>provide basic logging.</li> </ul> <p>In Docker-based setups, the reverse proxy itself is often another container on the same network.</p>"},{"location":"deployment/vm-docker/#step-by-step-deployment-on-a-single-vm","title":"Step-by-step deployment on a single VM","text":"<p>A typical initial deployment workflow:</p> <ol> <li> <p>Prepare the VM</p> </li> <li> <p>provision a VM (for example Ubuntu LTS),</p> </li> <li>install security updates,</li> <li>install Docker and Docker Compose,</li> <li> <p>configure firewall rules to allow HTTP/HTTPS and SSH only.</p> </li> <li> <p>Create the LegoCity directory</p> </li> <li> <p>create a directory, e.g. <code>/opt/legocity</code>,</p> </li> <li>place <code>docker-compose.yml</code> and <code>.env</code> there,</li> <li> <p>create subdirectories for persistent data:</p> <pre><code> mkdir -p /opt/legocity/data/broker\n mkdir -p /opt/legocity/data/db\n</code></pre> </li> <li> <p>Configure environment variables</p> </li> <li> <p>edit <code>.env</code>:</p> <ul> <li>set database credentials,</li> <li>set broker image and ports,</li> <li>set PayloadCMS DB URL,</li> <li>set write keys and any external API keys,</li> <li>set hostnames if needed by the application.</li> </ul> </li> <li> <p>Pull images</p> </li> <li> <p>run:</p> <pre><code> docker compose pull\n</code></pre> </li> <li> <p>this will download images referenced by <code>docker-compose.yml</code>.</p> </li> <li> <p>Start services</p> </li> <li> <p>run:</p> <pre><code> docker compose up -d\n</code></pre> </li> <li> <p>wait for containers to start. Check status:</p> <pre><code> docker compose ps\n</code></pre> </li> <li> <p>Verify components</p> </li> <li> <p>broker:</p> <ul> <li>check container logs,</li> <li>optionally call a health endpoint (if available) from the VM.</li> </ul> </li> <li>database:<ul> <li>check that the DB container is running.</li> </ul> </li> <li>PayloadCMS:<ul> <li>access the configured port (or reverse proxy route) from a browser,</li> <li>complete any initial setup (admin user).</li> </ul> </li> <li>proxy:<ul> <li>call a simple API endpoint to confirm it can reach the broker.</li> </ul> </li> <li>dashboard:<ul> <li>open the dashboard URL and confirm that it loads,</li> <li>accept that map and data may be empty until update servers are running.</li> </ul> </li> <li> <p>update servers:</p> <ul> <li>check logs to ensure they are fetching external data and writing entities.</li> </ul> </li> <li> <p>Set up the reverse proxy (if not already)</p> </li> <li> <p>configure hostnames and routes,</p> </li> <li>obtain TLS certificates,</li> <li>ensure that only the reverse proxy ports are exposed externally.</li> </ol>"},{"location":"deployment/vm-docker/#logs-and-troubleshooting","title":"Logs and troubleshooting","text":"<p>For a running deployment:</p> <ul> <li> <p>list containers:</p> <p>docker compose ps</p> </li> <li> <p>view logs for a specific service:</p> <p>docker compose logs -f broker   docker compose logs -f payload   docker compose logs -f proxy   docker compose logs -f dashboard   docker compose logs -f update-env</p> </li> </ul> <p>Typical troubleshooting steps:</p> <ul> <li>if the dashboard shows empty maps:</li> <li>check that update servers are running and writing entities,</li> <li> <p>check that the proxy can query the broker.</p> </li> <li> <p>if PayloadCMS is unreachable:</p> </li> <li>confirm the container is running,</li> <li> <p>check reverse proxy configuration and port mappings.</p> </li> <li> <p>if the broker is unresponsive:</p> </li> <li>check its container logs,</li> <li>check disk usage for its storage volume.</li> </ul>"},{"location":"deployment/vm-docker/#updating-services","title":"Updating services","text":"<p>To deploy a new version of any component (for example, dashboard or proxy):</p> <ol> <li>Build and publish new container images  </li> <li>update the image tag in <code>.env</code> or <code>docker-compose.yml</code>,</li> <li> <p>or ensure <code>latest</code> points to the new version.</p> </li> <li> <p>Pull new images on the VM</p> <p>docker compose pull</p> </li> <li> <p>Restart services</p> <p>docker compose up -d</p> </li> <li> <p>Verify behaviour</p> </li> <li> <p>check logs for errors,</p> </li> <li>validate the dashboard and APIs in a browser.</li> </ol> <p>For safer updates:</p> <ul> <li>update non-critical services first (for example, dashboard),</li> <li>update critical services (broker, database) with planned maintenance windows,</li> <li>keep a record of which version is running in each environment.</li> </ul>"},{"location":"deployment/vm-docker/#backups-and-data-persistence","title":"Backups and data persistence","text":"<p>At minimum, you should back up:</p> <ul> <li>PayloadCMS database (PostgreSQL or MongoDB),</li> <li>any broker persistence volume (if the broker stores state on disk),</li> <li>configuration files (<code>docker-compose.yml</code>, <code>.env</code>, documentation).</li> </ul> <p>Typical backup strategies:</p> <ul> <li>for the database:</li> <li>use database-level tools (e.g. <code>pg_dump</code> for PostgreSQL),</li> <li>schedule backups via cron jobs or external tools,</li> <li> <p>store backups on separate storage or remote locations.</p> </li> <li> <p>for broker data:</p> </li> <li>if using persistent volumes, periodically snapshot or copy the storage directory,</li> <li>depending on the broker configuration, consider exporting entity data via API.</li> </ul> <p>Backups should be:</p> <ul> <li>tested periodically (restore in a separate environment),</li> <li>documented (what is backed up, how often, where it is stored).</li> </ul>"},{"location":"deployment/vm-docker/#scaling-and-multi-vm-extensions","title":"Scaling and multi-VM extensions","text":"<p>A single VM is sufficient for small deployments. As needs grow, you can:</p> <ul> <li>move certain services to separate VMs:</li> <li>run the database on a dedicated host,</li> <li>run broker and update servers on another,</li> <li> <p>keep PayloadCMS and dashboard on a third.</p> </li> <li> <p>or use multiple Docker hosts with additional orchestration.</p> </li> </ul> <p>Even in multi-VM scenarios, you can still use Docker Compose if:</p> <ul> <li>you keep groups of services tightly coupled per host,</li> <li>you use DNS or IP addresses between hosts.</li> </ul> <p>For larger-scale or highly available deployments, consider:</p> <ul> <li>moving to a managed container platform (see the AWS deployment page),</li> <li>or using an orchestration system such as Kubernetes.</li> </ul>"},{"location":"deployment/vm-docker/#summary","title":"Summary","text":"<ul> <li>A VM + Docker deployment is the simplest way to run LegoCity in a real environment.</li> <li>All core components (broker, PayloadCMS, database, proxy, dashboard, update servers) run as containers on a single host or a small number of hosts.</li> <li>Configuration and secrets are handled via environment variables and a <code>.env</code> file, not hard-coded in the compose file.</li> <li>Maintenance tasks include checking container logs, updating images via <code>docker compose pull</code> and <code>docker compose up -d</code>, and backing up the database and broker storage.</li> <li>This pattern is suitable for pilots, demos and small deployments, and can be extended to multi-VM setups as requirements grow.</li> </ul>"},{"location":"development/","title":"Development Guide","text":"<p>Learn how to extend and customize LegoCity for your city's needs.</p>"},{"location":"development/#overview","title":"Overview","text":"<p>This guide covers:</p> <ul> <li>\ud83e\uddf1 Creating Blocks - Build custom UI components</li> <li>\ud83d\udd0c Writing Plugins - Extend PayloadCMS functionality</li> <li>\ud83c\udf31 Seed Data - Populate sample data</li> <li>\ud83d\uddfa\ufe0f Map Customization - Add custom map layers (see User Guide)</li> <li>\ud83e\uddea Testing - Write and run tests (coming soon)</li> </ul>"},{"location":"development/#development-philosophy","title":"Development Philosophy","text":""},{"location":"development/#configuration-over-code","title":"Configuration Over Code","text":"<p>Prefer configuring in PayloadCMS admin panel over writing code:</p> <p>\u274c Don't: Hard-code page layouts in components \u2705 Do: Create configurable blocks in PayloadCMS</p> <p>\u274c Don't: Hard-code API endpoints in frontend \u2705 Do: Use server-side API proxies</p>"},{"location":"development/#extensibility","title":"Extensibility","text":"<p>Build features as reusable blocks and plugins:</p> <p>\u274c Don't: Modify core components directly \u2705 Do: Create new blocks and extend existing ones</p> <p>\u274c Don't: Fork the repository for customization \u2705 Do: Use plugin system and configuration</p>"},{"location":"development/#type-safety","title":"Type Safety","text":"<p>Use TypeScript for all custom code:</p> <p>\u274c Don't: Use <code>any</code> types \u2705 Do: Define proper interfaces and types</p> <pre><code>// \u274c Bad\nconst processData = (data: any) =&gt; { ... }\n\n// \u2705 Good\ninterface CityData {\n  id: string;\n  name: string;\n  sensors: Sensor[];\n}\n\nconst processData = (data: CityData) =&gt; { ... }\n</code></pre>"},{"location":"development/#project-structure","title":"Project Structure","text":"<pre><code>dashboard/src/\n\u251c\u2500\u2500 app/                    # Next.js App Router\n\u2502   \u251c\u2500\u2500 (frontend)/        # Public pages\n\u2502   \u2502   \u251c\u2500\u2500 page.tsx       # Home page\n\u2502   \u2502   \u2514\u2500\u2500 [slug]/        # Dynamic pages\n\u2502   \u251c\u2500\u2500 (payload)/         # Admin routes\n\u2502   \u2514\u2500\u2500 api/               # API routes\n\u2502\n\u251c\u2500\u2500 blocks/                 # PayloadCMS Blocks\n\u2502   \u251c\u2500\u2500 RenderBlocks.tsx   # Block renderer\n\u2502   \u251c\u2500\u2500 ArchiveBlock/      # List posts\n\u2502   \u251c\u2500\u2500 MediaBlock/        # Display media\n\u2502   \u2514\u2500\u2500 CustomBlock/       # Your custom blocks\n\u2502\n\u251c\u2500\u2500 collections/            # PayloadCMS Collections\n\u2502   \u251c\u2500\u2500 Pages.ts           # Page content type\n\u2502   \u251c\u2500\u2500 Posts.ts           # Blog posts\n\u2502   \u251c\u2500\u2500 Media.ts           # File uploads\n\u2502   \u2514\u2500\u2500 Users.ts           # Admin users\n\u2502\n\u251c\u2500\u2500 components/             # React Components\n\u2502   \u251c\u2500\u2500 Card/              # Reusable card\n\u2502   \u251c\u2500\u2500 Map/               # Map components\n\u2502   \u2514\u2500\u2500 ui/                # Shadcn components\n\u2502\n\u251c\u2500\u2500 fields/                 # Custom Fields\n\u2502   \u251c\u2500\u2500 link.ts            # Link field\n\u2502   \u2514\u2500\u2500 linkGroup.ts       # Link group\n\u2502\n\u251c\u2500\u2500 plugins/                # PayloadCMS Plugins\n\u2502   \u2514\u2500\u2500 index.ts           # Plugin registration\n\u2502\n\u251c\u2500\u2500 providers/              # React Context\n\u2502   \u251c\u2500\u2500 Theme/             # Theme provider\n\u2502   \u2514\u2500\u2500 HeaderTheme/       # Header theme\n\u2502\n\u2514\u2500\u2500 utilities/              # Helper Functions\n    \u251c\u2500\u2500 generateMeta.ts    # SEO metadata\n    \u2514\u2500\u2500 getDocument.ts     # Fetch documents\n</code></pre>"},{"location":"development/#development-workflow","title":"Development Workflow","text":""},{"location":"development/#1-plan-your-feature","title":"1. Plan Your Feature","text":"<p>Before coding:</p> <ul> <li>\ud83d\udcdd Define requirements</li> <li>\ud83c\udfa8 Design UI mockups</li> <li>\ud83c\udfd7\ufe0f Choose architecture (block, plugin, component)</li> <li>\ud83d\udccb Break into tasks</li> </ul>"},{"location":"development/#2-create-branch","title":"2. Create Branch","text":"<pre><code>git checkout -b feature/your-feature-name\n</code></pre>"},{"location":"development/#3-implement","title":"3. Implement","text":"<p>Follow these steps:</p> <ol> <li>Create Types (if needed)</li> </ol> <pre><code>// types/city-data.ts\nexport interface CityEntity {\n  id: string;\n  type: string;\n  location: GeoJSON.Point;\n}\n</code></pre> <ol> <li>Build Component/Block</li> </ol> <pre><code>// blocks/MyBlock/Component.tsx\nexport const MyBlock: React.FC&lt;Props&gt; = ({ data }) =&gt; {\n  return &lt;div&gt;{/* Implementation */}&lt;/div&gt;;\n};\n</code></pre> <ol> <li>Add Configuration</li> </ol> <pre><code>// blocks/MyBlock/config.ts\nexport const MyBlock: Block = {\n  slug: \"myBlock\",\n  fields: [\n    /* ... */\n  ],\n};\n</code></pre> <ol> <li>Write Tests</li> </ol> <pre><code>// blocks/MyBlock/MyBlock.test.tsx\ndescribe(\"MyBlock\", () =&gt; {\n  it(\"renders correctly\", () =&gt; {\n    // Test implementation\n  });\n});\n</code></pre> <ol> <li>Update Documentation</li> <li>Add to relevant docs</li> <li>Include usage examples</li> </ol>"},{"location":"development/#4-test","title":"4. Test","text":"<pre><code># Run tests\npnpm test\n\n# Check types\npnpm type-check\n\n# Lint code\npnpm lint\n\n# Build\npnpm build\n</code></pre>"},{"location":"development/#5-create-pull-request","title":"5. Create Pull Request","text":"<pre><code>git add .\ngit commit -m \"feat: add custom block for city stats\"\ngit push origin feature/your-feature-name\n</code></pre> <p>Create PR on GitHub with:</p> <ul> <li>Clear description</li> <li>Screenshots (if UI changes)</li> <li>Test results</li> <li>Documentation updates</li> </ul>"},{"location":"development/#common-development-tasks","title":"Common Development Tasks","text":""},{"location":"development/#creating-a-block","title":"Creating a Block","text":"<p>See Creating Blocks Guide for detailed instructions.</p> <p>Quick example:</p> <pre><code>// blocks/CityStats/config.ts\nimport { Block } from \"payload/types\";\n\nexport const CityStats: Block = {\n  slug: \"cityStats\",\n  fields: [\n    {\n      name: \"title\",\n      type: \"text\",\n      required: true,\n    },\n    {\n      name: \"metrics\",\n      type: \"array\",\n      fields: [\n        { name: \"label\", type: \"text\" },\n        { name: \"value\", type: \"number\" },\n      ],\n    },\n  ],\n};\n</code></pre> <pre><code>// blocks/CityStats/Component.tsx\nexport const CityStatsBlock = ({ title, metrics }) =&gt; (\n  &lt;div&gt;\n    &lt;h2&gt;{title}&lt;/h2&gt;\n    {metrics.map((m) =&gt; (\n      &lt;div key={m.label}&gt;\n        &lt;span&gt;{m.label}&lt;/span&gt;: {m.value}\n      &lt;/div&gt;\n    ))}\n  &lt;/div&gt;\n);\n</code></pre>"},{"location":"development/#creating-a-plugin","title":"Creating a Plugin","text":"<p>See Writing Plugins Guide for details.</p> <p>Example:</p> <pre><code>// plugins/customPlugin.ts\nimport { Plugin } from \"payload/config\";\n\nexport const customPlugin = (): Plugin =&gt; ({\n  name: \"custom-plugin\",\n\n  init: (payload) =&gt; {\n    // Initialize plugin\n  },\n\n  hooks: {\n    beforeChange: [\n      (args) =&gt; {\n        // Hook logic\n      },\n    ],\n  },\n});\n</code></pre>"},{"location":"development/#creating-a-collection","title":"Creating a Collection","text":"<pre><code>// collections/CityServices.ts\nimport { CollectionConfig } from \"payload/types\";\n\nexport const CityServices: CollectionConfig = {\n  slug: \"city-services\",\n  admin: {\n    useAsTitle: \"name\",\n    group: \"Content\",\n  },\n  access: {\n    read: () =&gt; true,\n  },\n  fields: [\n    {\n      name: \"name\",\n      type: \"text\",\n      required: true,\n    },\n    {\n      name: \"description\",\n      type: \"textarea\",\n    },\n    {\n      name: \"location\",\n      type: \"point\",\n    },\n  ],\n};\n</code></pre> <p>Register in <code>payload.config.ts</code>:</p> <pre><code>import { CityServices } from \"./collections/CityServices\";\n\nexport default buildConfig({\n  collections: [\n    // ... existing\n    CityServices,\n  ],\n});\n</code></pre>"},{"location":"development/#adding-api-route","title":"Adding API Route","text":"<pre><code>// app/api/city-data/route.ts\nimport { NextRequest } from \"next/server\";\n\nexport async function GET(req: NextRequest) {\n  const city = req.nextUrl.searchParams.get(\"city\");\n\n  // Fetch data\n  const data = await fetchCityData(city);\n\n  return Response.json(data);\n}\n</code></pre>"},{"location":"development/#custom-map-layer","title":"Custom Map Layer","text":"<pre><code>// lib/mapLayers/trafficLayer.ts\nexport const trafficLayer: LayerDefinition = {\n  id: \"traffic\",\n  type: \"line\",\n  source: {\n    type: \"geojson\",\n    data: \"/api/traffic-data\",\n  },\n  paint: {\n    \"line-color\": [\n      \"interpolate\",\n      [\"linear\"],\n      [\"get\", \"congestion\"],\n      0,\n      \"#00ff00\",\n      50,\n      \"#ffff00\",\n      100,\n      \"#ff0000\",\n    ],\n    \"line-width\": 3,\n  },\n};\n</code></pre>"},{"location":"development/#best-practices","title":"Best Practices","text":""},{"location":"development/#code-organization","title":"Code Organization","text":"<p>\u2705 One component per file \u2705 Colocate related files (component + styles + tests) \u2705 Use index files for exports \u2705 Group by feature, not by type</p>"},{"location":"development/#performance","title":"Performance","text":"<p>\u2705 Use React Server Components when possible \u2705 Lazy load heavy components \u2705 Optimize images with <code>next/image</code> \u2705 Implement data caching \u2705 Monitor bundle size</p>"},{"location":"development/#security","title":"Security","text":"<p>\u2705 Validate all inputs \u2705 Use server-side API keys \u2705 Implement CSRF protection \u2705 Sanitize user content \u2705 Set proper CORS headers</p>"},{"location":"development/#accessibility","title":"Accessibility","text":"<p>\u2705 Use semantic HTML \u2705 Add ARIA labels \u2705 Support keyboard navigation \u2705 Test with screen readers \u2705 Maintain color contrast</p>"},{"location":"development/#development-tools","title":"Development Tools","text":""},{"location":"development/#recommended-vs-code-extensions","title":"Recommended VS Code Extensions","text":"<ul> <li>ESLint - Linting</li> <li>Prettier - Code formatting</li> <li>TypeScript and JavaScript Language Features - IntelliSense</li> <li>Tailwind CSS IntelliSense - CSS autocomplete</li> <li>MongoDB for VS Code - Database management</li> <li>GitLens - Git integration</li> </ul>"},{"location":"development/#browser-devtools","title":"Browser DevTools","text":"<ul> <li>React DevTools - Component inspection</li> <li>Network Tab - API debugging</li> <li>Console - Error logging</li> <li>Performance Tab - Profiling</li> </ul>"},{"location":"development/#cli-tools","title":"CLI Tools","text":"<pre><code># Generate Payload types\npnpm payload generate:types\n\n# Check for outdated dependencies\npnpm outdated\n\n# Analyze bundle size\npnpm build --analyze\n\n# Run security audit\npnpm audit\n</code></pre>"},{"location":"development/#debugging","title":"Debugging","text":""},{"location":"development/#server-side-debugging","title":"Server-Side Debugging","text":"<pre><code>// Enable detailed logging\nif (process.env.NODE_ENV === \"development\") {\n  console.log(\"Debug:\", data);\n}\n</code></pre>"},{"location":"development/#client-side-debugging","title":"Client-Side Debugging","text":"<pre><code>// Use React DevTools\nuseEffect(() =&gt; {\n  console.log(\"Component mounted\", props);\n}, []);\n</code></pre>"},{"location":"development/#database-debugging","title":"Database Debugging","text":"<pre><code># MongoDB shell\nmongosh legocity\n\n# Enable profiling\ndb.setProfilingLevel(2)\n</code></pre>"},{"location":"development/#testing","title":"Testing","text":"<p>Quick test:</p> <pre><code>import { render, screen } from \"@testing-library/react\";\nimport { MyComponent } from \"./Component\";\n\ndescribe(\"MyComponent\", () =&gt; {\n  it(\"renders title\", () =&gt; {\n    render(&lt;MyComponent title=\"Test\" /&gt;);\n    expect(screen.getByText(\"Test\")).toBeInTheDocument();\n  });\n});\n</code></pre>"},{"location":"development/#documentation","title":"Documentation","text":"<p>When adding features:</p> <ol> <li>Code Comments - Explain complex logic</li> <li>JSDoc - Document functions and types</li> <li>README - Update relevant READMEs</li> <li>Docs Site - Add to MkDocs documentation</li> </ol> <p>Example JSDoc:</p> <pre><code>/**\n * Fetches city data from NGSI-LD broker\n * @param cityId - Unique city identifier\n * @param options - Query options\n * @returns Promise resolving to city data\n * @throws Error if city not found\n */\nexport async function fetchCityData(\n  cityId: string,\n  options?: QueryOptions\n): Promise&lt;CityData&gt; {\n  // Implementation\n}\n</code></pre>"},{"location":"development/#contributing","title":"Contributing","text":"<p>See CONTRIBUTING.md for:</p> <ul> <li>Code of Conduct</li> <li>Git workflow</li> <li>PR guidelines</li> <li>Review process</li> </ul>"},{"location":"development/#resources","title":"Resources","text":"<ul> <li>\ud83d\udcd6 Next.js Documentation</li> <li>\ud83d\udcd6 PayloadCMS Documentation</li> <li>\ud83d\udcd6 React Documentation</li> <li>\ud83d\udcd6 TypeScript Handbook</li> <li>\ud83d\udcd6 Tailwind CSS</li> <li>\ud83d\udcd6 Mapbox GL JS</li> </ul> <p>Start developing: Choose your topic:</p> <ul> <li>Creating Blocks - Build UI components</li> <li>Writing Plugins - Extend functionality</li> <li>Seed Data - Populate test data</li> </ul>"},{"location":"development/blocks/","title":"Creating New Blocks","text":"<p>This page explains how to create new UI blocks in LegoCity.</p> <p>What are Blocks?</p> <p>Blocks are the building units of the dashboard UI that describe:</p> <pre><code>- What appears in the sidebar\n- What is shown in detail panels\n- How layers are toggled\n- How filters and controls are laid out\n</code></pre> <p>The goal is to let non-developers configure views and blocks in PayloadCMS, while developers provide the underlying building blocks in code.</p>"},{"location":"development/blocks/#conceptual-model","title":"Conceptual Model","text":"<p>A block in LegoCity has two sides:</p>"},{"location":"development/blocks/#content-model-payloadcms","title":"Content Model (PayloadCMS)","text":"<ul> <li>How the block is represented as data in PayloadCMS</li> <li>Which fields are configurable (titles, descriptions, layer references, parameters)</li> <li>How it is stored and versioned</li> </ul>"},{"location":"development/blocks/#render-logic-dashboard-react-component","title":"Render Logic (Dashboard React Component)","text":"<ul> <li>How the block looks and behaves in the UI</li> <li>How it interacts with Mapbox and other blocks</li> <li>How it reads runtime data (from the proxy, broker, or context)</li> </ul> <p>!!! tip \"Mapping Pattern\" - PayloadCMS: Block type string (e.g. <code>\"layerToggle\"</code>, <code>\"kpiCard\"</code>, <code>\"chart\"</code>) - Dashboard: React component registered for each block type</p>"},{"location":"development/blocks/#block-lifecycle","title":"Block Lifecycle","text":"<p>When you create a new block type, follow this lifecycle:</p>"},{"location":"development/blocks/#1-define-the-block-type-in-payloadcms","title":"1. Define the Block Type in PayloadCMS","text":"<ul> <li>Add a new block definition to the appropriate collection (e.g., \"Layouts\" or \"Blocks\")</li> <li>Specify fields required to configure the block (title, references to layers, thresholds, etc.)</li> </ul>"},{"location":"development/blocks/#2-expose-the-block-to-the-dashboard","title":"2. Expose the Block to the Dashboard","text":"<ul> <li>Ensure the API endpoint used by the dashboard includes block configurations</li> <li>Make sure block type names and shapes are consistent</li> </ul>"},{"location":"development/blocks/#3-implement-the-block-component","title":"3. Implement the Block Component","text":"<ul> <li>Create a React component for the block type</li> <li>Register it in a block registry or mapping</li> <li>Handle props carefully and avoid coupling to PayloadCMS internals</li> </ul>"},{"location":"development/blocks/#4-wire-to-map-and-data-sources","title":"4. Wire to Map and Data Sources","text":"<ul> <li>Use the proxy/API to fetch data if needed</li> <li>Interact with the map (toggle layers, zoom to features) as appropriate</li> </ul>"},{"location":"development/blocks/#5-test-in-a-real-view","title":"5. Test in a Real View","text":"<ul> <li>Configure a page or layout in PayloadCMS that uses your block</li> <li>Reload the dashboard and verify behaviour</li> </ul>"},{"location":"development/blocks/#defining-blocks-in-payloadcms","title":"Defining Blocks in PayloadCMS","text":"<p>In PayloadCMS, blocks are typically defined as part of a field that allows multiple block types.</p> <p>Example structure:</p> <pre><code>layout: array of blocks\n  \u2514\u2500 each block has a `blockType` and type-specific fields\n</code></pre>"},{"location":"development/blocks/#creating-a-new-block-type","title":"Creating a New Block Type","text":"Choose Block Type <p>Pick a unique <code>blockType</code> or slug:</p> <pre><code>- `layerToggle`\n- `kpiCard`\n- `mapLegend`\n- `chartWidget`\n</code></pre> Define Fields <p>Define fields that users can edit:</p> <pre><code>- `title` - Display name\n- `description` - Help text\n- `layerRefs` - Links to layer definitions\n- `thresholds` - Data ranges\n- Any other configuration needed by the UI\n</code></pre>"},{"location":"development/blocks/#field-design-principles","title":"Field Design Principles","text":"<p>!!! success \"Best Practices\" - \u2705 Expose only what is necessary for the block's behaviour - \u2705 Avoid hard-coding display strings or IDs in the code - \u2705 Prefer references to other collections (layers, views) - \u2705 Keep configuration simple and intuitive</p>"},{"location":"development/blocks/#exposing-block-data-to-dashboard","title":"Exposing Block Data to Dashboard","text":"<p>The dashboard fetches configuration from:</p> <ul> <li>PayloadCMS REST or GraphQL endpoint</li> <li>Custom API layer that transforms Payload data</li> </ul>"},{"location":"development/blocks/#data-structure-requirements","title":"Data Structure Requirements","text":"<p>!!! warning \"Required Fields\" - Data must include a <code>type</code> or <code>blockType</code> field for each block - Remaining fields (props) must follow a predictable shape</p> <p>Example JSON:</p> Block Configuration<pre><code>{\n  \"blocks\": [\n    {\n      \"type\": \"layerToggle\",\n      \"title\": \"Waterlogging risk\",\n      \"layers\": [\"env:flood-risk\", \"env:rain-intensity\"]\n    },\n    {\n      \"type\": \"kpiCard\",\n      \"title\": \"Active parking spots\",\n      \"metricKey\": \"mobility:parking:activeCount\"\n    }\n  ]\n}\n</code></pre> <p>Pattern:</p> <ul> <li><code>type</code> \u2192 Which React component to use</li> <li><code>props</code> \u2192 Configuration data for that component</li> </ul>"},{"location":"development/blocks/#implementing-react-block-components","title":"Implementing React Block Components","text":""},{"location":"development/blocks/#block-registry","title":"Block Registry","text":"<p>Create a mapping from block type to React component:</p> dashboard/src/blocks/registry.ts<pre><code>const BLOCK_REGISTRY: Record&lt;string, React.ComponentType&lt;BlockProps&gt;&gt; = {\n  layerToggle: LayerToggleBlock,\n  kpiCard: KpiCardBlock,\n  mapLegend: MapLegendBlock,\n  // Add your new blocks here\n};\n</code></pre>"},{"location":"development/blocks/#block-renderer","title":"Block Renderer","text":"<p>Create a component that:</p> <ol> <li>Receives an array of block definitions from PayloadCMS</li> <li>Loops through them</li> <li>Renders the corresponding component from the registry</li> </ol>"},{"location":"development/blocks/#adding-a-new-block","title":"Adding a New Block","text":"1. Create Component <p>Example: LayerToggleBlock</p> <pre><code>```typescript title=\"dashboard/src/blocks/LayerToggleBlock.tsx\"\ninterface LayerToggleProps {\n  title: string;\n  layers: string[];\n  initialState?: boolean;\n}\n\nexport const LayerToggleBlock: React.FC&lt;LayerToggleProps&gt; = ({\n  title,\n  layers,\n  initialState = false\n}) =&gt; {\n  const { showLayer, hideLayer } = useMapController();\n  const [isVisible, setIsVisible] = useState(initialState);\n\n  const handleToggle = () =&gt; {\n    layers.forEach(layerId =&gt; {\n      isVisible ? hideLayer(layerId) : showLayer(layerId);\n    });\n    setIsVisible(!isVisible);\n  };\n\n  return (\n    &lt;div className=\"layer-toggle-block\"&gt;\n      &lt;h3&gt;{title}&lt;/h3&gt;\n      &lt;button onClick={handleToggle}&gt;\n        {isVisible ? 'Hide' : 'Show'} Layers\n      &lt;/button&gt;\n    &lt;/div&gt;\n  );\n};\n```\n</code></pre> 2. Register Block <p>Add to the registry:</p> <pre><code>```typescript\nconst BLOCK_REGISTRY = {\n  // ... existing blocks\n  layerToggle: LayerToggleBlock,\n};\n```\n\nEnsure the type string matches what PayloadCMS sends.\n</code></pre> 3. Type Safety <p>Define specific props types:</p> <pre><code>```typescript\ninterface BlockProps {\n  type: string;\n  [key: string]: any;\n}\n\ninterface LayerToggleProps extends BlockProps {\n  type: 'layerToggle';\n  title: string;\n  layers: string[];\n  initialState?: boolean;\n}\n```\n</code></pre>"},{"location":"development/blocks/#interacting-with-map-and-blocks","title":"Interacting with Map and Blocks","text":"<p>Many blocks need to:</p> <ul> <li>Toggle Mapbox layers</li> <li>Zoom to bounding boxes</li> <li>Show/hide overlays</li> <li>Coordinate with other components</li> </ul>"},{"location":"development/blocks/#map-controller-pattern","title":"Map Controller Pattern","text":"<p>Create a map context or controller:</p> Map Controller Interface<pre><code>interface MapController {\n  showLayer: (id: string) =&gt; void;\n  hideLayer: (id: string) =&gt; void;\n  setLayerOpacity: (id: string, value: number) =&gt; void;\n  flyTo: (bounds: LngLatBoundsLike) =&gt; void;\n  setFilter: (layerId: string, filter: any) =&gt; void;\n}\n</code></pre>"},{"location":"development/blocks/#usage-example","title":"Usage Example","text":"<pre><code>const LayerToggleBlock: React.FC&lt;LayerToggleProps&gt; = ({ layers }) =&gt; {\n  const mapController = useMapController(); // From context\n\n  const handleShow = () =&gt; {\n    layers.forEach((id) =&gt; mapController.showLayer(id));\n  };\n\n  return &lt;button onClick={handleShow}&gt;Show Layers&lt;/button&gt;;\n};\n</code></pre>"},{"location":"development/blocks/#design-principles","title":"Design Principles","text":"<p>!!! tip \"Keep Blocks Focused\" - One block toggles a specific group of layers - Another block visualizes a KPI based on data - Another block selects a filter or time range</p> <pre><code>Avoid coupling blocks directly to raw Mapbox internals\u2014route interactions through the shared map controller.\n</code></pre>"},{"location":"development/blocks/#data-driven-blocks","title":"Data-Driven Blocks","text":"<p>Some blocks need runtime data, not just configuration:</p> Block Type Data Requirement KPI Cards Latest value for a metric Charts Time series, distribution Table Views Lists of entities matching filters"},{"location":"development/blocks/#configuration-in-payloadcms","title":"Configuration in PayloadCMS","text":"<p>Specify:</p> <ul> <li>Which domain or entity type to query</li> <li>Any key filters (e.g., \"environment\", \"mobility:parking\")</li> <li>Time windows or thresholds</li> </ul>"},{"location":"development/blocks/#react-component-implementation","title":"React Component Implementation","text":"KPI Card Example<pre><code>const KpiCardBlock: React.FC&lt;KpiCardProps&gt; = ({ title, metricKey }) =&gt; {\n  const [value, loading, error] = useMetric(metricKey);\n\n  if (loading) return &lt;Spinner /&gt;;\n  if (error) return &lt;ErrorMessage error={error} /&gt;;\n\n  return (\n    &lt;div className=\"kpi-card\"&gt;\n      &lt;h3&gt;{title}&lt;/h3&gt;\n      &lt;div className=\"value\"&gt;{value}&lt;/div&gt;\n    &lt;/div&gt;\n  );\n};\n</code></pre>"},{"location":"development/blocks/#api-design-considerations","title":"API Design Considerations","text":"<p>!!! success \"Keep UI Simple\" - Return aggregated results where possible - Avoid forcing the UI to implement heavy transformation logic - Provide loading and error states - Cache frequently accessed data</p>"},{"location":"development/blocks/#reusing-and-extending-blocks","title":"Reusing and Extending Blocks","text":"<p>Before creating a new block, check if an existing block can be:</p> <ul> <li>\u2705 Reused as-is</li> <li>\u2705 Extended via configuration</li> <li>\u2705 Composed with other blocks</li> </ul>"},{"location":"development/blocks/#generic-vs-specific-blocks","title":"Generic vs Specific Blocks","text":"<p>Good generic block:</p> <pre><code>// Generic metric card supports multiple domains by configuration\n&lt;MetricCard\n  title=\"Active Parking Spots\"\n  metricKey=\"mobility:parking:activeCount\"\n  unit=\"spots\"\n/&gt;\n</code></pre> <p>Avoid over-specialization:</p> <pre><code>// Bad: Too specific\n&lt;ParkingSpotCard /&gt;\n&lt;BusStopCard /&gt;\n&lt;BikeStationCard /&gt;\n\n// Good: One configurable block\n&lt;TransportMetricCard type=\"parking|bus|bike\" /&gt;\n</code></pre>"},{"location":"development/blocks/#extracting-shared-logic","title":"Extracting Shared Logic","text":"<p>If a new block is ~80% identical to an existing one:</p> <ul> <li>Extract shared logic into a hook or shared component</li> <li>Document the differences and why a new block type is necessary</li> </ul>"},{"location":"development/blocks/#documentation-and-examples","title":"Documentation and Examples","text":"<p>Whenever you add a new block type:</p>"},{"location":"development/blocks/#update-documentation","title":"Update Documentation","text":"<ul> <li>[ ] Add to the Entities and blocks section</li> <li>[ ] Add to block reference page (if exists)</li> <li>[ ] Update this page with new examples</li> </ul>"},{"location":"development/blocks/#include-details","title":"Include Details","text":"<p>Document:</p> Information Example Block type name <code>layerToggle</code> Description Toggles visibility of map layers PayloadCMS fields <code>title</code>, <code>layers[]</code>, <code>initialState</code> Data assumptions Expects layer IDs to exist in map config"},{"location":"development/blocks/#provide-examples","title":"Provide Examples","text":"Screenshots <p>Include screenshots of the block in use</p> Configuration <p><code>json     {       \"type\": \"layerToggle\",       \"title\": \"Flood Risk Layers\",       \"layers\": [         \"env:flood-risk-high\",         \"env:flood-risk-medium\"       ],       \"initialState\": true     }</code></p> Component Usage <p><code>typescript     &lt;LayerToggleBlock       title=\"Flood Risk Layers\"       layers={[\"env:flood-risk-high\", \"env:flood-risk-medium\"]}       initialState={true}     /&gt;</code></p>"},{"location":"development/blocks/#block-development-checklist","title":"Block Development Checklist","text":"<p>Creating a New Block</p> <p>PayloadCMS:</p> <pre><code>- [ ] Define block type and unique slug\n- [ ] Add configurable fields\n- [ ] Test block creation in admin panel\n- [ ] Document field purposes\n\n**Dashboard:**\n\n- [ ] Create React component\n- [ ] Add to block registry\n- [ ] Implement prop types (TypeScript)\n- [ ] Handle loading/error states\n- [ ] Connect to map controller (if needed)\n- [ ] Connect to data API (if needed)\n\n**Testing:**\n\n- [ ] Create test view in PayloadCMS\n- [ ] Verify block renders correctly\n- [ ] Test interactive features\n- [ ] Check mobile responsiveness\n\n**Documentation:**\n\n- [ ] Update block reference\n- [ ] Add usage examples\n- [ ] Include screenshots\n- [ ] Document known limitations\n</code></pre>"},{"location":"development/blocks/#summary","title":"Summary","text":"<p>Key Takeaways</p> <p>Blocks connect PayloadCMS configuration with React components</p> <pre><code>**To create a new block:**\n\n1. Define block type and fields in PayloadCMS\n2. Ensure API exposes block data with `type` and `props`\n3. Implement React component and register in block registry\n4. Wire to map controller or data APIs if needed\n5. Test in real views and document usage\n\n**Best practices:**\n\n- Keep blocks small, focused, and data-driven\n- Enable non-developers to compose complex dashboards from simple pieces\n- Always update documentation for other contributors\n</code></pre> <p>Related Pages:</p> <ul> <li>PayloadCMS Plugins</li> <li>Seed Data &amp; Scenarios</li> <li>Local Development Setup</li> </ul>"},{"location":"development/plugins/","title":"Writing Payload plugins","text":"<p>This page explains how to write PayloadCMS plugins for LegoCity.</p> <p>Plugins are how we package logic that:</p> <ul> <li>is reused across multiple collections or projects,</li> <li>integrates external tools (NGSI-LD helpers, AI, map config, etc.),</li> <li>we may want to publish later to the Payload plugin ecosystem.</li> </ul> <p>The idea: keep core LegoCity clean, and move shared behaviours into small, well-defined plugins.</p>"},{"location":"development/plugins/#1-when-should-you-create-a-plugin","title":"1. When should you create a plugin?","text":"<p>Use a plugin instead of inline code when:</p> <ul> <li> <p>The same fields / hooks are needed in many collections.   \u2192 e.g. NGSI-LD metadata (<code>entityType</code>, <code>entityIdPattern</code>, <code>geoLocation</code>).</p> </li> <li> <p>You integrate an external service or tool.   \u2192 e.g. AI helpers, monitoring, audit logging, external registries.</p> </li> <li> <p>You want the feature to be optional or reusable in other projects.   \u2192 plugin is easier to enable/disable via <code>plugins: []</code>.</p> </li> </ul> <p>If the logic is very specific to a single collection, keep it in that collection config. Otherwise, promote it to a plugin.</p>"},{"location":"development/plugins/#2-prerequisites","title":"2. Prerequisites","text":"<p>You should be comfortable with:</p> <ul> <li>basic TypeScript or modern JavaScript,</li> <li>Payload configuration structure (<code>payload.config.ts</code>),</li> <li>how collections and fields are defined.</li> </ul> <p>Official references (read later when needed):</p> <ul> <li>Payload docs: Plugins, Collections, Fields.</li> </ul>"},{"location":"development/plugins/#3-recommended-layout","title":"3. Recommended layout","text":"<p>In LegoCity we keep custom plugins in a dedicated folder so they can be reused easily. A common pattern is:</p> <pre><code>LegoCity/\n  payload/\n    payload.config.ts\n    plugins/\n      payload-ngsi-ld/\n        index.ts\n      payload-map-config/\n        index.ts\n      payload-ai-helpers/\n        index.ts\nYou can adapt the exact path to your repo, but the idea is:\n\none folder per plugin,\n\neach folder exports a plugin factory function (e.g. ngsiLdPlugin()).\n\n4. Minimal plugin example\nA Payload plugin is just a function that receives the existing config and\nreturns a modified config.\n\n4.1. Create the plugin file\nCreate `payload/plugins/payload-ngsi-ld/index.ts`:\n\n```ts\n// payload/plugins/payload-ngsi-ld/index.ts\n\nimport type { Config, Plugin } from 'payload';\n\n// Optional options type for this plugin\nexport type NgsiLdPluginOptions = {\n  /**\n   * Optional prefix for entity IDs, e.g. \"urn:ngsi-ld:LegoCity:\"\n   */\n  entityIdPrefix?: string;\n};\n\n/**\n * Factory that returns a Payload plugin.\n * Usage in payload.config.ts: ngsiLdPlugin({ entityIdPrefix: 'urn:...' })\n */\nexport const ngsiLdPlugin =\n  (options: NgsiLdPluginOptions = {}): Plugin&lt;Config&gt; =&gt;\n  (incomingConfig) =&gt; {\n    const config = { ...incomingConfig };\n\n    // Example: add a reusable \"ngsiLdFields\" field group to all collections\n    // that opt in via `ngsiLdEnabled: true` in their custom config.\n    config.collections = (config.collections || []).map((collection) =&gt; {\n      if (!collection.admin?.meta?.ngsiLdEnabled) {\n        return collection;\n      }\n\n      return {\n        ...collection,\n        fields: [\n          // Group of NGSI-LD helper fields\n          {\n            name: 'ngsiLd',\n            label: 'NGSI-LD metadata',\n            type: 'group',\n            fields: [\n              {\n                name: 'entityType',\n                type: 'text',\n                required: true,\n              },\n              {\n                name: 'entityIdSuffix',\n                type: 'text',\n                admin: {\n                  description:\n                    'Suffix appended to the global entity ID prefix (configured in plugin options).',\n                },\n              },\n              {\n                name: 'geo',\n                type: 'point',\n                label: 'Location (WGS84)',\n              },\n            ],\n          },\n\n          // keep existing fields after our group\n          ...(collection.fields || []),\n        ],\n      };\n    });\n\n    // You can store computed values in config for later use if needed\n    config.custom = {\n      ...(config.custom || {}),\n      ngsiLdEntityIdPrefix: options.entityIdPrefix ?? 'urn:ngsi-ld:LegoCity:',\n    };\n\n    return config;\n  };\n</code></pre> <p>Notes:</p> <p>The plugin does not know about LegoCity UI directly. It only extends the Payload config (fields, hooks, etc.). We use a small <code>NgsiLdPluginOptions</code> type to make configuration explicit.</p>"},{"location":"development/plugins/#5-registering-the-plugin","title":"5. Registering the plugin","text":"<p>In your <code>payload.config.ts</code> (path may differ), import and register the plugin:</p> <pre><code>// payload/payload.config.ts\n\nimport { buildConfig } from 'payload/config';\nimport { ngsiLdPlugin } from './plugins/payload-ngsi-ld';\n\nexport default buildConfig({\n  // ...existing config (collections, globals, etc.)\n\n  collections: [\n    {\n      slug: 'layers',\n      labels: { singular: 'Layer', plural: 'Layers' },\n      // Custom flag: this collection wants NGSI-LD helper fields\n      admin: {\n        meta: {\n          ngsiLdEnabled: true,\n        },\n      },\n      fields: [\n        {\n          name: 'name',\n          type: 'text',\n          required: true,\n        },\n        // other layer-specific fields...\n      ],\n    },\n    // other collections...\n  ],\n\n  plugins: [\n    ngsiLdPlugin({\n      entityIdPrefix: 'urn:ngsi-ld:LegoCity:',\n    }),\n    // other plugins (AI, map-config, etc.)\n  ],\n});\n\n\nWith this setup any collection where `admin.meta.ngsiLdEnabled === true`\nreceives the `ngsiLd` group auto-injected by the plugin. You can reuse the\nsame plugin in another project simply by installing and adding it to\n`plugins`.\n\n## 6. Adding hooks inside a plugin\n\nPlugins can also add hooks (for example, to enforce rules or emit events).\n\nIn the same plugin file:\n\n```ts\n// Inside the ngsiLdPlugin factory, after computing `config`\n\nconfig.collections = (config.collections || []).map((collection) =&gt; {\n  if (!collection.admin?.meta?.ngsiLdEnabled) return collection;\n\n  return {\n    ...collection,\n    // Keep existing hooks and add ours\n    hooks: {\n      ...(collection.hooks || {}),\n      beforeChange: [\n        // our hook\n        async ({ data, originalDoc, req }) =&gt; {\n          const prefix = config.custom?.ngsiLdEntityIdPrefix as string;\n\n          if (!data.ngsiLd?.entityIdSuffix) {\n            return data; // nothing to do\n          }\n\n          data.ngsiLd.entityId = `${prefix}${data.ngsiLd.entityIdSuffix}`;\n\n          return data;\n        },\n        // keep any existing hooks\n        ...(collection.hooks?.beforeChange || []),\n      ],\n    },\n  };\n});\n</code></pre> <p>This example:</p> <ul> <li>automatically computes a full <code>ngsiLd.entityId</code> before saving,</li> <li>uses a prefix from plugin options,</li> <li>keeps existing hooks intact.</li> </ul> <p>Use hooks carefully; avoid heavy external calls in <code>beforeChange</code> if not needed.</p>"},{"location":"development/plugins/#7-configuration-and-options","title":"7. Configuration and options","text":"<p>Design plugin options so that LegoCity (or any other project) can configure behaviour without editing plugin code. Good patterns:</p> <ul> <li>Booleans to toggle features (e.g. <code>enableHooks</code>)</li> <li>Lists of collection slugs to include/exclude (<code>includeCollections</code>)</li> <li>Strings for prefixes, base URLs, etc.</li> </ul> <p>Example options type:</p> <pre><code>export type NgsiLdPluginOptions = {\n  entityIdPrefix?: string;\n  includeCollections?: string[]; // if set, only apply plugin to these slugs\n};\n</code></pre> <p>In the plugin, check <code>options.includeCollections</code> when mapping collections and skip collections that are not listed.</p>"},{"location":"development/plugins/#8-local-development-testing","title":"8. Local development &amp; testing","text":"<p>When working on a plugin inside LegoCity:</p> <ol> <li>Start the Payload dev server:</li> </ol> <pre><code># inside the Payload project\npnpm dev\n</code></pre> <ol> <li>Open the Payload admin and navigate to a collection that uses the plugin.</li> <li> <p>Create/edit documents and verify:</p> </li> <li> <p>Plugin-injected fields appear as expected</p> </li> <li>Hooks run correctly (IDs or metadata are filled in)</li> <li>No TypeScript or console errors</li> </ol> <p>If you later extract the plugin into a separate package, create a small test project that installs it and verify the plugin works outside LegoCity.</p>"},{"location":"development/plugins/#9-packaging-publishing-optional","title":"9. Packaging &amp; publishing (optional)","text":"<p>If a plugin is generic, consider publishing it to npm or the Payload plugin directory. High-level checklist:</p> <ul> <li>Add a <code>package.json</code> in the plugin folder with <code>name</code>, <code>version</code>, <code>main</code>/<code>exports</code>, and <code>peerDependencies</code> (include <code>payload</code>).</li> <li>Add a build step (compile TypeScript to <code>dist/</code> if using TS).</li> <li>Create a <code>README.md</code> documenting installation and options.</li> <li>Publish with <code>npm publish</code> (follow org policy), and optionally register in the Payload plugin directory.</li> </ul> <p>For LegoCity itself, publishing is optional; keep plugins well scoped and reusable.</p>"},{"location":"development/plugins/#10-summary","title":"10. Summary","text":"<ul> <li>Plugins are functions that receive <code>incomingConfig</code> and return a modified <code>Config</code>.</li> <li>Use plugins for shared behaviours, integrations, and optional features.</li> <li>Keep options explicit, test locally, and preserve existing config/hook behaviour.</li> </ul> <p>If you want, I can:</p> <ul> <li>extract the <code>ngsiLdPlugin</code> example into <code>payload/plugins/payload-ngsi-ld/index.ts</code>,</li> <li>add a test harness or simple unit tests, or</li> <li>add a <code>README.md</code> template for new plugins.</li> </ul>"},{"location":"development/seed-data/","title":"Seed Data and Example Scenarios","text":"<p>This page describes how to create and use seed data in LegoCity for:</p> <ul> <li>The context broker (entities)</li> <li>PayloadCMS (views, blocks, layers)</li> <li>Repeatable demos and test cases</li> </ul> <p>Why Seed Data?</p> <p>Seed data allows you to:</p> <pre><code>- \ud83d\ude80 Set up a realistic smart city environment quickly\n- \ud83e\uddea Test new features against known scenarios\n- \ud83d\udcda Provide ready-made examples for new users\n</code></pre>"},{"location":"development/seed-data/#goals-of-seed-data","title":"Goals of Seed Data","text":"<p>Seed data should be:</p>"},{"location":"development/seed-data/#representative","title":"Representative","text":"<ul> <li>\u2705 Cover real smart city use cases (environment, water, mobility)</li> <li>\u2705 Include diverse entity types and scenarios</li> <li>\u2705 Demonstrate key platform features</li> </ul>"},{"location":"development/seed-data/#safe","title":"Safe","text":"<ul> <li>\u2705 No sensitive or real personal data</li> <li>\u2705 Fictional but realistic values</li> <li>\u2705 Safe for public demonstrations</li> </ul>"},{"location":"development/seed-data/#repeatable","title":"Repeatable","text":"<ul> <li>\u2705 Reset and reseed an environment easily</li> <li>\u2705 Stable identifiers for docs and tests</li> <li>\u2705 Consistent across environments</li> </ul> <p>Aim for Quality Over Quantity</p> <p>Don't model an entire city\u2014provide:</p> <pre><code>- A small number of districts or areas\n- A limited set of sensors and assets\n- A few well-chosen PayloadCMS configurations\n</code></pre>"},{"location":"development/seed-data/#types-of-seed-data","title":"Types of Seed Data","text":"<p>LegoCity uses three main categories of seed data:</p>"},{"location":"development/seed-data/#1-broker-entities","title":"1. Broker Entities","text":"NGSI-LD Entities <p>NGSI-LD entities representing city data:</p> <pre><code>- `WeatherObserved` - Weather stations\n- `AirQualityObserved` - Air quality sensors\n- `ParkingSpot` - Parking facilities\n- `FloodRiskZone` - Flood risk areas\n- `TrafficFlowObserved` - Traffic sensors\n</code></pre> Entity Structure <p><code>json     {       \"id\": \"urn:ngsi-ld:WeatherObserved:demo:ctu-campus\",       \"type\": \"WeatherObserved\",       \"temperature\": {         \"type\": \"Property\",         \"value\": 28.5,         \"unitCode\": \"CEL\"       },       \"location\": {         \"type\": \"GeoProperty\",         \"value\": {           \"type\": \"Point\",           \"coordinates\": [105.7698, 10.0301]         }       }     }</code></p>"},{"location":"development/seed-data/#2-payloadcms-configuration","title":"2. PayloadCMS Configuration","text":"<p>=== \"Collections\" - Layers - Data sources and styling - Views - Map dashboards and layouts - Blocks - UI components configuration - Users - Demo users and roles (if needed)</p> Example Layer <p><code>json     {       \"name\": \"Weather Stations\",       \"slug\": \"weather-stations\",       \"entityType\": \"WeatherObserved\",       \"domain\": \"environment\",       \"mapboxLayerId\": \"weather-layer\",       \"visible\": true     }</code></p>"},{"location":"development/seed-data/#3-supporting-reference-data","title":"3. Supporting Reference Data","text":"<ul> <li>\ud83d\udccd Lists of districts or wards</li> <li>\ud83d\uddfa\ufe0f Simplified district geometry (polygons)</li> <li>\ud83d\udcca Static lookup tables (codes to names)</li> <li>\ud83d\udd17 Entity relationships and hierarchies</li> </ul>"},{"location":"development/seed-data/#seeding-the-broker","title":"Seeding the Broker","text":""},{"location":"development/seed-data/#conceptual-approach","title":"Conceptual Approach","text":"<p>Broker seeds are typically:</p> <ul> <li>JSON files describing entities</li> <li>Scripts that construct and push entities via broker API</li> </ul>"},{"location":"development/seed-data/#entity-id-patterns","title":"Entity ID Patterns","text":"<p>Use stable, meaningful IDs:</p> <pre><code>urn:ngsi-ld:{EntityType}:demo:{location}\n</code></pre> <p>Examples:</p> Entity Type ID Example Weather <code>urn:ngsi-ld:WeatherObserved:demo:ctu-campus</code> Parking <code>urn:ngsi-ld:ParkingSpot:demo:downtown-p1</code> Flood Zone <code>urn:ngsi-ld:FloodRiskZone:demo:river-district</code>"},{"location":"development/seed-data/#suggested-seed-domains","title":"Suggested Seed Domains","text":""},{"location":"development/seed-data/#environment-domain","title":"Environment Domain","text":"Weather Stations <p>Create a few <code>WeatherObserved</code> entities:</p> <pre><code>- At points of interest (university, city center, suburbs)\n- With temperature, humidity, precipitation\n- Different times of day or weather conditions\n</code></pre> Air Quality <p>Create <code>AirQualityObserved</code> entities:</p> <pre><code>- Near major roads or industrial areas\n- With PM2.5, PM10, NO2 measurements\n- Various quality levels (good, moderate, unhealthy)\n</code></pre>"},{"location":"development/seed-data/#water-and-flooding-domain","title":"Water and Flooding Domain","text":"Flood Risk Zones <p>Create <code>FloodRiskZone</code> entities:</p> <pre><code>- Polygons representing vulnerable areas\n- Risk levels (low, medium, high)\n- Near rivers or low-lying areas\n</code></pre> Water Quality <p>Create <code>WaterQualityObserved</code> entities:</p> <pre><code>- At river monitoring points\n- pH, turbidity, dissolved oxygen\n- Upstream and downstream comparisons\n</code></pre>"},{"location":"development/seed-data/#mobility-domain","title":"Mobility Domain","text":"Parking <p>Create <code>ParkingSpot</code> or <code>ParkingArea</code> entities:</p> <pre><code>- Small number of parking areas (5-10)\n- Available vs total spot numbers\n- Different occupancy levels\n</code></pre> Traffic <p>Create <code>TrafficFlowObserved</code> entities:</p> <pre><code>- Major intersections\n- Vehicle count, average speed\n- Different time periods (rush hour, off-peak)\n</code></pre>"},{"location":"development/seed-data/#running-broker-seed-scripts","title":"Running Broker Seed Scripts","text":"<p>Common patterns for seeding:</p> Makefile Target <p><code>bash     make seed-broker</code></p> npm Script <p><code>bash     npm run seed:broker</code></p> Docker Container <p><code>bash     docker compose run --rm seed-broker</code></p>"},{"location":"development/seed-data/#seed-script-workflow","title":"Seed Script Workflow","text":"<p>Typical seed script process:</p> <pre><code>graph LR\n    A[Read Entity Files] --&gt; B[Validate Format]\n    B --&gt; C[Connect to Gateway&lt;br/&gt;with Auth]\n    C --&gt; D[POST to Broker&lt;br/&gt;via Gateway]\n    D --&gt; E[Broker Stores&lt;br/&gt;in MongoDB]\n    E --&gt; F[Log Results]</code></pre> <p>Script responsibilities:</p> <ol> <li>Read entity definitions from <code>seeds/broker/</code> directory</li> <li>Validate NGSI-LD format</li> <li>Call broker endpoints to create/upsert entities</li> <li>Log successes and failures</li> <li>Handle errors gracefully</li> </ol>"},{"location":"development/seed-data/#seeding-payloadcms","title":"Seeding PayloadCMS","text":"<p>PayloadCMS seed data covers configuration and content:</p>"},{"location":"development/seed-data/#layer-definitions","title":"Layer Definitions","text":"<p>Purpose: Connect broker domains to map visualization</p> <p>Fields:</p> <ul> <li>Entity type and domain</li> <li>Map layer IDs and styling</li> <li>Colors, legends, icons</li> <li>Visibility defaults</li> </ul> <p>Example:</p> seeds/payload/layers.ts<pre><code>{\n  name: \"Weather Stations\",\n  slug: \"weather-stations\",\n  entityType: \"WeatherObserved\",\n  domain: \"environment\",\n  mapboxLayerId: \"weather-layer\",\n  style: {\n    circleColor: \"#FF6B35\",\n    circleRadius: 8\n  },\n  visible: true\n}\n</code></pre>"},{"location":"development/seed-data/#views-and-layouts","title":"Views and Layouts","text":"<p>Purpose: Define high-level dashboards</p> <p>Fields:</p> <ul> <li>View name and slug</li> <li>Initial map bounds</li> <li>Layer references</li> <li>Block arrangements</li> </ul> <p>Example:</p> seeds/payload/views.ts<pre><code>{\n  name: \"City Overview\",\n  slug: \"city-overview\",\n  bounds: [105.7, 10.0, 105.8, 10.1],\n  layers: [\n    \"weather-stations\",\n    \"parking-areas\",\n    \"flood-zones\"\n  ],\n  sidebar: [\n    { type: \"layerToggle\", layers: [\"weather-stations\"] },\n    { type: \"kpiCard\", metric: \"parking:availability\" }\n  ]\n}\n</code></pre>"},{"location":"development/seed-data/#blocks-and-ui-components","title":"Blocks and UI Components","text":"<p>Purpose: Configure dashboard widgets</p> <p>Types:</p> Block Type Purpose <code>layerToggle</code> Show/hide map layers <code>kpiCard</code> Display key metrics <code>chart</code> Time series or distributions <code>legend</code> Map legend panel <code>filter</code> Data filtering controls"},{"location":"development/seed-data/#seeding-approach","title":"Seeding Approach","text":"JSON Fixtures <p>Import via PayloadCMS code:</p> <pre><code>```typescript\nimport { seed } from '@payloadcms/payload'\nimport layersData from './seeds/layers.json'\n\nawait seed('layers', layersData)\n```\n</code></pre> API Scripts <p>Call PayloadCMS REST API:</p> <pre><code>```typescript\nconst response = await fetch('/api/layers', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify(layerData)\n})\n```\n</code></pre> Database Direct <p>Insert directly to database (development only):</p> <pre><code>```typescript\nawait db.collection('layers').insertMany(layersData)\n```\n</code></pre>"},{"location":"development/seed-data/#coordinating-broker-and-payloadcms-seeds","title":"Coordinating Broker and PayloadCMS Seeds","text":"<p>To ensure seeds work together:</p>"},{"location":"development/seed-data/#broker-entity-requirements","title":"Broker Entity Requirements","text":"<p>!!! warning \"Critical Alignment\" - \u2705 Use entity types that PayloadCMS expects - \u2705 Use stable, documented IDs - \u2705 Place entities within map bounds of seeded views - \u2705 Use attribute names matching layer configurations</p>"},{"location":"development/seed-data/#payloadcms-configuration-requirements","title":"PayloadCMS Configuration Requirements","text":"<p>!!! warning \"Critical Alignment\" - \u2705 Refer to correct entity types and domains - \u2705 Use correct Mapbox layer IDs (if applicable) - \u2705 Define bounding boxes that include seeded entities - \u2705 Match attribute names in filters and displays</p>"},{"location":"development/seed-data/#demo-city-profile","title":"Demo City Profile","text":"<p>Good practice: Maintain a documented \"demo city profile\"</p> seeds/demo-profile.yml<pre><code>name: \"Demo Smart City\"\nlocation: \"Fictional City, Based on Can Tho\"\ncoordinates:\n  center: [105.7698, 10.0301]\n  bounds: [[105.75, 10.02], [105.79, 10.04]]\n\ndistricts:\n  - id: \"ninh-kieu\"\n    name: \"Ninh Kieu District\"\n    geometry: \"polygon...\"\n  - id: \"cai-rang\"\n    name: \"Cai Rang District\"\n    geometry: \"polygon...\"\n\nreference_points:\n  - name: \"CTU Campus\"\n    coordinates: [105.7698, 10.0301]\n  - name: \"City Center\"\n    coordinates: [105.7800, 10.0350]\n\nentities:\n  weather:\n    - id: \"weather:ctu-campus\"\n      location: \"CTU Campus\"\n      purpose: \"Demonstrate temperature visualization\"\n  parking:\n    - id: \"parking:downtown-p1\"\n      location: \"City Center\"\n      purpose: \"Show real-time availability\"\n</code></pre>"},{"location":"development/seed-data/#running-all-seeds-in-development","title":"Running All Seeds in Development","text":""},{"location":"development/seed-data/#single-command-seeding","title":"Single Command Seeding","text":"<p>Provide a convenient command to seed everything:</p> Makefile <p><code>bash     make seed-all</code></p> <pre><code>Internally runs:\n```makefile\nseed-all: clean-data seed-broker seed-payload\n    @echo \"All seeds complete!\"\n```\n</code></pre> npm Scripts <p><code>bash     npm run seed</code></p> <pre><code>In `package.json`:\n```json\n{\n  \"scripts\": {\n    \"seed\": \"npm run seed:clean &amp;&amp; npm run seed:broker &amp;&amp; npm run seed:payload\",\n    \"seed:clean\": \"node scripts/clean-data.js\",\n    \"seed:broker\": \"node scripts/seed-broker.js\",\n    \"seed:payload\": \"node scripts/seed-payload.js\"\n  }\n}\n```\n</code></pre> Docker Compose <p><code>bash     docker compose run --rm seed</code></p> <pre><code>In `docker-compose.yml`:\n```yaml\nservices:\n  seed:\n    image: legocity-seed\n    depends_on:\n      - broker\n      - mongodb\n    command: [\"sh\", \"-c\", \"npm run seed:all\"]\n```\n</code></pre>"},{"location":"development/seed-data/#seed-workflow","title":"Seed Workflow","text":"<pre><code>graph TD\n    A[Start] --&gt; B{Development Environment?}\n    B --&gt;|Yes| C[Clean Existing Data]\n    B --&gt;|No| D[Skip Clean]\n    C --&gt; E[Seed Broker Entities&lt;br/&gt;via Security Gateway]\n    D --&gt; E\n    E --&gt; F[Orion-LD stores&lt;br/&gt;in MongoDB]\n    F --&gt; G[Seed PayloadCMS Config&lt;br/&gt;to Dashboard DB]\n    G --&gt; H[Verify Seeds]\n    H --&gt; I[Log Results]\n    I --&gt; J[Complete]</code></pre>"},{"location":"development/seed-data/#developer-workflow","title":"Developer Workflow","text":"<p>Typical Usage</p> <p>After cloning the repo: <code>bash     git clone https://github.com/CTU-SematX/LegoCity.git     cd LegoCity     docker compose up -d     make seed-all  # or npm run seed</code></p> <pre><code>**When testing major changes:**\n```bash\nmake seed-all  # Re-seed clean environment\nnpm run dev    # Test changes\n```\n</code></pre>"},{"location":"development/seed-data/#keeping-seed-data-maintainable","title":"Keeping Seed Data Maintainable","text":""},{"location":"development/seed-data/#best-practices","title":"Best Practices","text":"Keep It Small <p>!!! success \"Focus on Quality\" - Only seed entities needed to demonstrate functionality - Avoid large datasets that are hard to understand - 5-10 entities per type is usually sufficient - Quality examples &gt; Quantity</p> Version Control <p>!!! success \"Treat as Code\" - Store seeds in version control - Review changes via pull requests - Use meaningful commit messages - Tag seeds with version numbers</p> Documentation <p>!!! success \"Keep Docs Updated\" - Document new entity types - Mention new example views - Update scenario descriptions - Link seeds to use cases</p> Versioning <p>!!! success \"Align with Releases\" - Tag seed sets with release versions - Maintain compatibility with docs - Provide migration guides for seed changes - Archive old seed versions</p>"},{"location":"development/seed-data/#seed-file-structure","title":"Seed File Structure","text":"<p>Recommended organization:</p> <pre><code>seeds/\n\u251c\u2500\u2500 broker/\n\u2502   \u251c\u2500\u2500 environment/\n\u2502   \u2502   \u251c\u2500\u2500 weather-stations.json\n\u2502   \u2502   \u2514\u2500\u2500 air-quality.json\n\u2502   \u251c\u2500\u2500 water/\n\u2502   \u2502   \u2514\u2500\u2500 flood-zones.json\n\u2502   \u2514\u2500\u2500 mobility/\n\u2502       \u251c\u2500\u2500 parking.json\n\u2502       \u2514\u2500\u2500 traffic.json\n\u251c\u2500\u2500 payload/\n\u2502   \u251c\u2500\u2500 layers.ts\n\u2502   \u251c\u2500\u2500 views.ts\n\u2502   \u2514\u2500\u2500 blocks.ts\n\u251c\u2500\u2500 reference/\n\u2502   \u251c\u2500\u2500 districts.json\n\u2502   \u2514\u2500\u2500 demo-profile.yml\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"development/seed-data/#example-scenarios-to-support","title":"Example Scenarios to Support","text":"<p>Design seeds around concrete scenarios:</p>"},{"location":"development/seed-data/#scenario-1-flooding-risk-during-heavy-rainfall","title":"Scenario 1: Flooding Risk During Heavy Rainfall","text":"Description <p>Question: \"How does flooding risk evolve during heavy rainfall?\"</p> <pre><code>**Data needed:**\n- Environment: Weather stations with precipitation data\n- Water: Flood risk zones with varying risk levels\n- Maps: Overlays showing risk zones and rainfall intensity\n</code></pre> Entities <pre><code>// WeatherObserved with heavy rain\n{\n\"id\": \"urn:ngsi-ld:WeatherObserved:demo:riverside\",\n\"type\": \"WeatherObserved\",\n\"precipitation\": { \"value\": 50, \"unitCode\": \"MMT\" },\n\"location\": { \"coordinates\": [105.77, 10.03] }\n}\n\n    // FloodRiskZone - high risk\n    {\n      \"id\": \"urn:ngsi-ld:FloodRiskZone:demo:riverside-district\",\n      \"type\": \"FloodRiskZone\",\n      \"riskLevel\": { \"value\": \"high\" },\n      \"location\": { \"type\": \"Polygon\", \"coordinates\": [...] }\n    }\n    ```\n\n=== \"PayloadCMS View\"\n`typescript\n    {\n      name: \"Flood Monitoring\",\n      slug: \"flood-monitoring\",\n      layers: [\n        \"weather-stations\",\n        \"flood-risk-zones\",\n        \"rainfall-intensity\"\n      ],\n      blocks: [\n        { type: \"legend\", layers: [\"flood-risk-zones\"] },\n        { type: \"kpiCard\", metric: \"rainfall:current\" }\n      ]\n    }\n    `\n\n### Scenario 2: Parking Availability at Peak Hours\n\n=== \"Description\"\n**Question:** \"Which parking areas are near capacity at peak hours?\"\n\n    **Data needed:**\n    - Mobility: Parking areas with occupancy data\n    - UI: KPI blocks and visual indicators\n    - Maps: Color-coded parking availability\n\n=== \"Entities\"\n```json\n// High occupancy parking\n{\n\"id\": \"urn:ngsi-ld:ParkingSpot:demo:downtown-p1\",\n\"type\": \"ParkingSpot\",\n\"availableSpotNumber\": { \"value\": 5 },\n\"totalSpotNumber\": { \"value\": 100 },\n\"location\": { \"coordinates\": [105.78, 10.035] }\n}\n\n    // Low occupancy parking\n    {\n      \"id\": \"urn:ngsi-ld:ParkingSpot:demo:suburb-p3\",\n      \"type\": \"ParkingSpot\",\n      \"availableSpotNumber\": { \"value\": 85 },\n      \"totalSpotNumber\": { \"value\": 100 },\n      \"location\": { \"coordinates\": [105.76, 10.025] }\n    }\n    ```\n\n=== \"PayloadCMS View\"\n`typescript\n    {\n      name: \"Parking Management\",\n      slug: \"parking-management\",\n      layers: [\"parking-areas\"],\n      blocks: [\n        {\n          type: \"kpiCard\",\n          title: \"Available Spots\",\n          metric: \"parking:total-available\"\n        },\n        {\n          type: \"chart\",\n          title: \"Occupancy by Hour\",\n          metric: \"parking:occupancy-rate\"\n        }\n      ]\n    }\n    `\n\n### Scenario 3: Air Quality Near Major Roads\n\n=== \"Description\"\n**Question:** \"What is the air quality near major roads?\"\n\n    **Data needed:**\n    - Environment: Air quality sensors with PM2.5, NO2\n    - Reference: Road network overlay\n    - UI: Color-coded quality indicators\n\n=== \"Entities\"\n```json\n// Poor air quality near highway\n{\n\"id\": \"urn:ngsi-ld:AirQualityObserved:demo:highway-junction\",\n\"type\": \"AirQualityObserved\",\n\"pm25\": { \"value\": 75, \"unitCode\": \"GQ\" },\n\"no2\": { \"value\": 120, \"unitCode\": \"GQ\" },\n\"airQualityLevel\": { \"value\": \"unhealthy\" },\n\"location\": { \"coordinates\": [105.78, 10.04] }\n}\n\n    // Good air quality in park\n    {\n      \"id\": \"urn:ngsi-ld:AirQualityObserved:demo:city-park\",\n      \"type\": \"AirQualityObserved\",\n      \"pm25\": { \"value\": 15, \"unitCode\": \"GQ\" },\n      \"no2\": { \"value\": 30, \"unitCode\": \"GQ\" },\n      \"airQualityLevel\": { \"value\": \"good\" },\n      \"location\": { \"coordinates\": [105.76, 10.03] }\n    }\n    ```\n\n=== \"PayloadCMS View\"\n`typescript\n    {\n      name: \"Air Quality Dashboard\",\n      slug: \"air-quality\",\n      layers: [\n        \"air-quality-sensors\",\n        \"road-network\"\n      ],\n      blocks: [\n        { type: \"legend\", layers: [\"air-quality-sensors\"] },\n        {\n          type: \"kpiCard\",\n          title: \"Average PM2.5\",\n          metric: \"airquality:pm25-avg\"\n        }\n      ]\n    }\n    `\n\n---\n\n## Seed Data Checklist\n\n!!! example \"Before Committing Seeds\"\n**Validation:**\n\n    - [ ] All entity IDs follow naming convention\n    - [ ] Coordinates are within demo city bounds\n    - [ ] Entity types match PayloadCMS layer configs\n    - [ ] Attribute names are consistent\n    - [ ] No sensitive or personal data included\n\n    **Testing:**\n\n    - [ ] Seeds run without errors\n    - [ ] All entities visible on map\n    - [ ] PayloadCMS views load correctly\n    - [ ] Blocks display expected data\n    - [ ] Scenarios are demonstrable\n\n    **Documentation:**\n\n    - [ ] Seed scenarios documented\n    - [ ] Entity IDs listed in reference\n    - [ ] Demo profile updated\n    - [ ] README.md includes seed instructions\n\n---\n\n## Summary\n\n!!! success \"Key Takeaways\"\n**Seed data enables rapid environment setup and testing**\n\n    **Three categories:**\n\n    1. **Broker entities** - NGSI-LD entities with stable IDs\n    2. **PayloadCMS config** - Layers, views, blocks\n    3. **Reference data** - Districts, geometry, lookups\n\n    **Best practices:**\n\n    - Keep seeds small, realistic, and scenario-based\n    - Provide single-command seeding (`make seed-all`)\n    - Maintain seeds in version control\n    - Document seed scenarios and use cases\n    - Align broker entities with PayloadCMS configuration\n\n**Related Pages:**\n\n- [Creating New Blocks](blocks.md)\n- [Entity Types and Management](../user-guide/entities.md)\n- [Local Development Setup](../installation/local.md)\n</code></pre>"},{"location":"getting-started/","title":"Getting Started with SematX","text":"<p>Welcome to SematX! This guide will help you get started with the platform, whether you want to run it locally for development or deploy it to your own infrastructure.</p>"},{"location":"getting-started/#choose-your-path","title":"Choose Your Path","text":"<p>There are two main ways to get started with SematX:</p>"},{"location":"getting-started/#1-start-a-local-server-recommended-for-beginners","title":"1. Start a Local Server (Recommended for Beginners)","text":"<p>Best for: Learning, development, experimentation</p> <p>Run SematX on your local machine using Docker Compose. This is the fastest way to get started and explore the platform.</p> <ul> <li>\u23f1\ufe0f Time: 10-15 minutes</li> <li>\ud83d\udcbb Requirements: Docker Desktop</li> <li>\ud83c\udfaf Goal: Explore SematX features locally</li> </ul> <p>Start Local Server \u2192</p>"},{"location":"getting-started/#2-bring-your-own-server","title":"2. Bring Your Own Server","text":"<p>Best for: Production deployments, cloud infrastructure, team collaboration</p> <p>Deploy SematX to your own server or cloud provider. This guide walks you through connecting your application to an existing SematX instance.</p> <ul> <li>\u23f1\ufe0f Time: 30-45 minutes</li> <li>\ud83d\udcbb Requirements: SematX instance URL, API key</li> <li>\ud83c\udfaf Goal: Integrate your app with SematX</li> </ul> <p>Bring Your Own Server \u2192</p>"},{"location":"getting-started/#what-youll-learn","title":"What You'll Learn","text":""},{"location":"getting-started/#start-server-tutorial","title":"Start Server Tutorial","text":"<p>In the local server tutorial, you'll learn how to:</p> <ol> <li>Install Docker and Docker Compose</li> <li>Clone the SematX repository</li> <li>Start all services with a single command</li> <li>Access the dashboard and create your first entity</li> <li>Query data using the NGSI-LD API</li> <li>Create visualizations and dashboards</li> </ol>"},{"location":"getting-started/#bring-your-own-server-tutorial","title":"Bring Your Own Server Tutorial","text":"<p>In the bring your own server tutorial, you'll learn how to:</p> <ol> <li>Create a SematX account and get API credentials</li> <li>Set up a service for your application</li> <li>Create your first NGSI-LD entity</li> <li>Push data from your application to SematX</li> <li>Create dashboard cards to visualize your data</li> <li>Set up subscriptions for real-time notifications</li> </ol>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, make sure you have:</p>"},{"location":"getting-started/#for-local-development","title":"For Local Development","text":"<ul> <li>Docker Desktop: Download</li> <li>Git: Download</li> <li>Code Editor: We recommend VS Code</li> <li>Modern Browser: Chrome, Firefox, or Edge</li> </ul>"},{"location":"getting-started/#for-production-deployment","title":"For Production Deployment","text":"<ul> <li>SematX Instance: Access to a running SematX server</li> <li>API Key: Obtained from the dashboard admin</li> <li>Basic CLI Skills: Comfortable with terminal/command line</li> <li>HTTP Client: curl, Postman, or your programming language's HTTP library</li> </ul>"},{"location":"getting-started/#architecture-overview","title":"Architecture Overview","text":"<p>Before diving in, it's helpful to understand how SematX components work together:</p> <pre><code>Your Application\n       \u2502\n       \u2502 HTTP/HTTPS + JWT\n       \u2502\n       \u25bc\n  Nginx Gateway \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  (Authentication)      \u2502\n       \u2502                \u2502\n       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n       \u2502                              \u2502\n       \u25bc                              \u25bc\n  Lego Dashboard              Orion-LD Context Broker\n  (Web UI + API)              (NGSI-LD Data Store)\n       \u2502                              \u2502\n       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n                  \u25bc\n              MongoDB\n          (Data Persistence)\n</code></pre> <p>Key Components: - Nginx Gateway: Handles authentication and routes requests - Lego Dashboard: Visual interface for managing data and creating dashboards - Orion-LD: Standards-based context broker for storing and querying entities - MongoDB: Database for persistent storage</p>"},{"location":"getting-started/#quick-concepts","title":"Quick Concepts","text":""},{"location":"getting-started/#entities","title":"Entities","text":"<p>In SematX, everything is an entity. An entity represents a real-world object like a sensor, device, vehicle, or building.</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Sensor:001\",\n  \"type\": \"Sensor\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 25.5,\n    \"unitCode\": \"CEL\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/#ngsi-ld","title":"NGSI-LD","text":"<p>SematX uses the NGSI-LD standard for representing data. This ensures: - Interoperability with other FIWARE systems - Standardized data models - Rich query capabilities - Built-in support for relationships and context</p>"},{"location":"getting-started/#api-keys","title":"API Keys","text":"<p>To access the SematX API, you need an API key (JWT token). This key: - Authenticates your requests - Controls what data you can access - Enforces rate limits - Can be revoked instantly</p>"},{"location":"getting-started/#subscriptions","title":"Subscriptions","text":"<p>Subscriptions allow you to receive real-time notifications when entities change:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"entities\": [{\"type\": \"Sensor\"}],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-app.com/webhook\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/#common-use-cases","title":"Common Use Cases","text":""},{"location":"getting-started/#iot-data-collection","title":"IoT Data Collection","text":"<p>Send sensor data from devices to SematX and visualize it in real-time dashboards.</p>"},{"location":"getting-started/#smart-city-applications","title":"Smart City Applications","text":"<p>Build applications for traffic monitoring, environmental sensing, public safety, and more.</p>"},{"location":"getting-started/#data-integration","title":"Data Integration","text":"<p>Connect multiple data sources and provide a unified API for querying.</p>"},{"location":"getting-started/#dashboard-creation","title":"Dashboard Creation","text":"<p>Create custom dashboards for monitoring and analysis without writing code.</p>"},{"location":"getting-started/#need-help","title":"Need Help?","text":"<ul> <li>Documentation: Browse the full documentation</li> <li>Community: Join GitHub Discussions</li> <li>Issues: Report bugs on GitHub Issues</li> <li>Examples: Check out code examples</li> </ul>"},{"location":"getting-started/#ready-to-start","title":"Ready to Start?","text":"<p>Choose your path and let's get building:</p> \ud83d\udda5\ufe0f Start Local Server <p>Run SematX on your machine for development and testing</p> \u2601\ufe0f Bring Your Own Server <p>Connect your app to an existing SematX instance</p>"},{"location":"getting-started/#legacy-quick-start-guide","title":"Legacy Quick Start Guide","text":"<p>The following section contains the original quick start guide for local development. For the new step-by-step tutorials, see the links above.</p>"},{"location":"getting-started/#prerequisites_1","title":"Prerequisites","text":"<p>Before you begin, ensure you have:</p> <ul> <li>Node.js 18.x or later</li> <li>pnpm 8.x or later (package manager)</li> <li>MongoDB 6.x or later</li> <li>Git for version control</li> </ul>"},{"location":"getting-started/#installation-steps","title":"Installation Steps","text":"<ol> <li>Clone the repository</li> </ol> <pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity/dashboard\n</code></pre> <ol> <li>Install dependencies</li> </ol> <pre><code>pnpm install\n</code></pre> <ol> <li>Configure environment</li> </ol> <pre><code>cp .env.example .env\n</code></pre> <p>Edit <code>.env</code> and set:</p> <pre><code>DATABASE_URI=mongodb://127.0.0.1/legocity\nPAYLOAD_SECRET=your-secret-key-here\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n</code></pre> <ol> <li>Start development server</li> </ol> <pre><code>pnpm dev\n</code></pre> <ol> <li>Access the dashboard</li> <li>Dashboard: http://localhost:3000</li> <li>Admin Panel: http://localhost:3000/admin</li> </ol>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<p>After completing the quick start:</p> <ol> <li>Complete Installation Guide - Detailed setup instructions</li> <li>User Guide - Learn how to use LegoCity</li> <li>Configuration - Configure data sources and APIs</li> <li>Development Guide - Start building custom features</li> </ol>"},{"location":"getting-started/#architecture-overview_1","title":"Architecture Overview","text":"<p>LegoCity is built on three main layers:</p>"},{"location":"getting-started/#1-context-data-layer-fiware","title":"1. Context &amp; Data Layer (FIWARE)","text":"<ul> <li>NGSI-LD context brokers</li> <li>Smart Data Models</li> <li>Real-time sensor data</li> </ul>"},{"location":"getting-started/#2-ui-layer-nextjs-payloadcms","title":"2. UI Layer (Next.js + PayloadCMS)","text":"<ul> <li>Interactive map views (Mapbox)</li> <li>Dynamic dashboard configuration</li> <li>Content management</li> </ul>"},{"location":"getting-started/#3-integration-layer","title":"3. Integration Layer","text":"<ul> <li>API proxies and security</li> <li>AI assistants (optional)</li> <li>External services</li> </ul>"},{"location":"getting-started/#community-support","title":"Community &amp; Support","text":"<ul> <li>\ud83d\udcd6 Documentation: https://ctu-sematx.github.io/LegoCity</li> <li>\ud83d\udc1b Issues: GitHub Issues</li> <li>\ud83d\udcac Discussions: GitHub Discussions</li> <li>\ud83d\udce7 Contact: CTU-SematX Team</li> </ul>"},{"location":"getting-started/#design-principles","title":"Design Principles","text":""},{"location":"getting-started/#context-centric-design","title":"Context-Centric Design","text":"<p>City information is modeled as NGSI-LD entities in context brokers - the single source of truth.</p>"},{"location":"getting-started/#configuration-driven-ui","title":"Configuration-Driven UI","text":"<p>Dashboards are constructed from configurable blocks in PayloadCMS, not hard-coded.</p>"},{"location":"getting-started/#reusability","title":"Reusability","text":"<p>The same codebase works across multiple cities by changing configuration, not code.</p>"},{"location":"getting-started/#ai-as-optional","title":"AI as Optional","text":"<p>LegoCity works fully without AI. AI integration is a secondary feature for content authoring.</p> <p>Ready to dive deeper? Continue to the Installation Guide for detailed setup instructions.</p>"},{"location":"getting-started/architecture/","title":"Architecture Overview","text":"<p>Understanding LegoCity's architecture helps you make informed decisions about customization and deployment.</p>"},{"location":"getting-started/architecture/#system-architecture","title":"System Architecture","text":"<p>Three-layer architecture: Data Sources \u2192 Smart City Context Broker \u2192 Dashboard &amp; Management</p>"},{"location":"getting-started/architecture/#three-layer-design","title":"Three-Layer Design","text":""},{"location":"getting-started/architecture/#1-context-data-layer","title":"1. Context &amp; Data Layer","text":"<p>Purpose: Single source of truth for city information</p> <p>Components:</p> <ul> <li>NGSI-LD Context Broker (Orion-LD)</li> <li>Smart Data Models - Standardized schemas</li> <li>Real-time Updates - Subscriptions and notifications</li> </ul> <p>Key Concepts:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Sensor:001\",\n  \"type\": \"AirQualitySensor\",\n  \"location\": {\n    \"type\": \"Point\",\n    \"coordinates\": [105.7851, 10.0303]\n  },\n  \"pm25\": {\n    \"type\": \"Property\",\n    \"value\": 35.2,\n    \"observedAt\": \"2024-01-15T10:30:00Z\"\n  }\n}\n</code></pre> <p>Responsibilities:</p> <ul> <li>Store city entities (sensors, zones, services)</li> <li>Manage relationships between entities</li> <li>Handle temporal queries</li> <li>Provide standardized API (NGSI-LD)</li> </ul>"},{"location":"getting-started/architecture/#2-ui-content-layer","title":"2. UI &amp; Content Layer","text":"<p>Purpose: Configure and render dashboard interfaces</p> <p>Components:</p> <ul> <li>Next.js 15 - React framework with App Router</li> <li>PayloadCMS 3.x - Headless CMS</li> <li>MongoDB - Content database</li> <li>Mapbox GL JS - Interactive maps</li> </ul> <p>Key Features:</p> <p>a) Block-Based UI</p> <pre><code>// Pages composed from blocks\ninterface Page {\n  title: string;\n  blocks: Array&lt;ArchiveBlock | MediaBlock | CallToActionBlock | ContentBlock&gt;;\n}\n</code></pre> <p>b) Dynamic Configuration</p> <ul> <li>Pages, map views, layers stored in PayloadCMS</li> <li>No hard-coded dashboards</li> <li>Runtime configuration changes</li> </ul> <p>c) Responsive Design</p> <ul> <li>Mobile-first approach</li> <li>Tailwind CSS styling</li> <li>Accessible components</li> </ul>"},{"location":"getting-started/architecture/#3-integration-layer","title":"3. Integration Layer","text":"<p>Purpose: Connect external services and enhance functionality</p> <p>Components:</p> <ul> <li>API Proxies - Secure external API access</li> <li>Authentication - JWT-based auth</li> <li>AI Assistants - Optional content helpers</li> <li>Search - Full-text search integration</li> </ul> <p>Security Patterns:</p> <pre><code>// API keys stored server-side\n// Frontend proxies requests\nfetch(\"/api/proxy/geocode\", {\n  body: JSON.stringify({ address }),\n  headers: { \"Content-Type\": \"application/json\" },\n});\n</code></pre>"},{"location":"getting-started/architecture/#data-flow","title":"Data Flow","text":""},{"location":"getting-started/architecture/#pushing-data-from-iot-sources","title":"Pushing Data from IoT Sources","text":"<pre><code>sequenceDiagram\n    participant Source as Source Server&lt;br/&gt;(IoT/Sensor/Camera)\n    participant Gateway as Security Gateway&lt;br/&gt;(Nginx)\n    participant Broker as Orion-LD&lt;br/&gt;(Context Broker)\n    participant MongoDB\n    participant OtherNodes as Other Broker Nodes\n\n    Source-&gt;&gt;Gateway: HTTP POST&lt;br/&gt;(NGSI-LD Payload)&lt;br/&gt;Push Data + Auth Header\n    Gateway-&gt;&gt;Gateway: Validate Auth Header\n    Gateway-&gt;&gt;Broker: Forward entity data\n    Broker-&gt;&gt;MongoDB: Store/Update entity\n    MongoDB--&gt;&gt;Broker: Confirm\n    Broker-&gt;&gt;OtherNodes: Replicate state (optional)\n    Broker--&gt;&gt;Gateway: 201 Created / 204 Updated\n    Gateway--&gt;&gt;Source: Success response</code></pre>"},{"location":"getting-started/architecture/#reading-city-data","title":"Reading City Data","text":"<pre><code>sequenceDiagram\n    participant User\n    participant AppServer as Application Server&lt;br/&gt;(NextJS + PayloadCMS)\n    participant Gateway as Security Gateway&lt;br/&gt;(Nginx)\n    participant Broker as Orion-LD&lt;br/&gt;(Context Broker)\n    participant MongoDB\n\n    User-&gt;&gt;AppServer: Load dashboard page\n    AppServer-&gt;&gt;AppServer: Fetch page config from PayloadCMS\n    AppServer-&gt;&gt;Gateway: HTTP GET/SUB&lt;br/&gt;(NGSI-LD Query)&lt;br/&gt;+ Auth Header\n    Gateway-&gt;&gt;Gateway: Validate JWT\n    Gateway-&gt;&gt;Broker: Forward query\n    Broker-&gt;&gt;MongoDB: Get entity data\n    MongoDB--&gt;&gt;Broker: Return entities\n    Broker--&gt;&gt;Gateway: NGSI-LD Response\n    Gateway--&gt;&gt;AppServer: Return sensor data\n    AppServer-&gt;&gt;AppServer: NextJS renders with data\n    AppServer--&gt;&gt;User: Display dashboard</code></pre>"},{"location":"getting-started/architecture/#updating-content","title":"Updating Content","text":"<pre><code>sequenceDiagram\n    participant Admin\n    participant AppServer as Application Server&lt;br/&gt;(PayloadCMS)\n    participant DashDB as Dashboard Database&lt;br/&gt;(MongoDB/Postgres/SQLite)\n    participant NextJS\n\n    Admin-&gt;&gt;AppServer: Edit page/block via Admin UI\n    AppServer-&gt;&gt;DashDB: CRUD Data&lt;br/&gt;(Save changes)\n    DashDB--&gt;&gt;AppServer: Confirm save\n    AppServer-&gt;&gt;NextJS: Trigger revalidation\n    NextJS-&gt;&gt;NextJS: Rebuild pages (ISR)\n    NextJS--&gt;&gt;Admin: Updated page live</code></pre>"},{"location":"getting-started/architecture/#technology-stack","title":"Technology Stack","text":""},{"location":"getting-started/architecture/#frontend","title":"Frontend","text":"<ul> <li>Next.js 15 - React framework with App Router and Server Components</li> <li>TypeScript - Type safety</li> <li>Tailwind CSS - Utility-first styling</li> <li>Mapbox GL JS - WebGL-powered maps</li> </ul>"},{"location":"getting-started/architecture/#backend","title":"Backend","text":"<ul> <li>PayloadCMS 3.x - Headless CMS with admin UI</li> <li>MongoDB 6.x - Document database</li> <li>Node.js 18+ - JavaScript runtime</li> </ul>"},{"location":"getting-started/architecture/#infrastructure","title":"Infrastructure","text":"<ul> <li>FIWARE Orion-LD - NGSI-LD context broker</li> <li>MongoDB - Context and content storage</li> <li>Reverse Proxy - Nginx or similar</li> </ul>"},{"location":"getting-started/architecture/#optional-services","title":"Optional Services","text":"<ul> <li>OpenRouter - AI model gateway</li> <li>Mapbox - Map tiles and geocoding</li> <li>Redis - Caching layer</li> </ul>"},{"location":"getting-started/architecture/#scalability-considerations","title":"Scalability Considerations","text":""},{"location":"getting-started/architecture/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>Next.js Application:</p> <ul> <li>Stateless application servers</li> <li>Load balancer distribution</li> <li>Edge caching (CDN)</li> </ul> <p>MongoDB:</p> <ul> <li>Replica sets for high availability</li> <li>Sharding for large datasets</li> </ul> <p>NGSI-LD Broker:</p> <ul> <li>Multiple broker instances</li> <li>Federation for multi-region</li> </ul>"},{"location":"getting-started/architecture/#vertical-scaling","title":"Vertical Scaling","text":"<p>Memory:</p> <ul> <li>Next.js: 2-4 GB per instance</li> <li>MongoDB: Based on dataset size</li> <li>Broker: Based on entity count</li> </ul> <p>CPU:</p> <ul> <li>Map rendering is CPU-intensive</li> <li>Consider GPU acceleration for complex visualizations</li> </ul>"},{"location":"getting-started/architecture/#caching-strategy","title":"Caching Strategy","text":"<pre><code>// Next.js caching\nexport const revalidate = 60; // ISR every 60s\n\n// API response caching\ncache.set('entities:sensors', data, { ttl: 300 });\n\n// CDN caching\nCache-Control: public, s-maxage=3600\n</code></pre>"},{"location":"getting-started/architecture/#security-architecture","title":"Security Architecture","text":""},{"location":"getting-started/architecture/#authentication-authorization","title":"Authentication &amp; Authorization","text":"<pre><code>flowchart LR\n    subgraph Layer1[\"LAYER 1: DATA SOURCES\"]\n        IoT[IoT Device]\n    end\n\n    subgraph Layer2[\"LAYER 2: BROKER\"]\n        Gateway[Security Gateway&lt;br/&gt;Nginx + Auth]\n        Broker[Orion-LD]\n    end\n\n    subgraph Layer3[\"LAYER 3: DASHBOARD\"]\n        Auth[PayloadCMS Auth]\n        MW[Next.js Middleware]\n        Routes[Protected Routes]\n        Admin[Admin Panel]\n    end\n\n    IoT --&gt;|Auth Header| Gateway\n    Gateway --&gt;|Validate| Broker\n\n    Auth --&gt;|JWT| MW\n    MW --&gt;|Verify| Routes\n    MW --&gt;|Check Role| Admin\n    MW --&gt;|API Call + JWT| Gateway</code></pre>"},{"location":"getting-started/architecture/#api-security","title":"API Security","text":"<p>Server-Side Proxies:</p> <pre><code>// /app/api/proxy/route.ts\nexport async function POST(req: Request) {\n  // Validate request\n  const { apiKey } = getServerConfig();\n\n  // Forward to external API\n  return fetch(externalAPI, {\n    headers: { Authorization: `Bearer ${apiKey}` },\n  });\n}\n</code></pre> <p>Rate Limiting:</p> <ul> <li>Per-IP limits</li> <li>Per-user quotas</li> <li>Token bucket algorithm</li> </ul>"},{"location":"getting-started/architecture/#data-protection","title":"Data Protection","text":"<ul> <li>Encryption at Rest: MongoDB encryption</li> <li>Encryption in Transit: HTTPS/TLS</li> <li>Secrets Management: Environment variables, not in code</li> <li>Input Validation: Zod schemas, payload validators</li> </ul>"},{"location":"getting-started/architecture/#deployment-architecture","title":"Deployment Architecture","text":""},{"location":"getting-started/architecture/#development","title":"Development","text":"<pre><code>Developer Machine\n\u251c\u2500\u2500 Next.js (localhost:3000)\n\u251c\u2500\u2500 MongoDB (localhost:27017)\n\u2514\u2500\u2500 Orion-LD (localhost:1026)\n</code></pre>"},{"location":"getting-started/architecture/#production-single-server","title":"Production (Single Server)","text":"<pre><code>Virtual Machine\n\u251c\u2500\u2500 Nginx (Reverse Proxy)\n\u251c\u2500\u2500 Next.js (PM2)\n\u251c\u2500\u2500 MongoDB (Service)\n\u2514\u2500\u2500 Orion-LD (Docker)\n</code></pre>"},{"location":"getting-started/architecture/#production-distributed","title":"Production (Distributed)","text":"<pre><code>Cloud Infrastructure\n\u251c\u2500\u2500 CDN (Cloudflare)\n\u251c\u2500\u2500 Load Balancer\n\u251c\u2500\u2500 Next.js Cluster (3+ instances)\n\u251c\u2500\u2500 MongoDB Replica Set\n\u2514\u2500\u2500 NGSI-LD Federation\n</code></pre>"},{"location":"getting-started/architecture/#extension-points","title":"Extension Points","text":""},{"location":"getting-started/architecture/#1-custom-blocks","title":"1. Custom Blocks","text":"<p>Add new UI components:</p> <pre><code>// src/blocks/CustomBlock/config.ts\nexport const CustomBlock: Block = {\n  slug: \"custom-block\",\n  fields: [\n    /* ... */\n  ],\n  // Block configuration\n};\n</code></pre>"},{"location":"getting-started/architecture/#2-payloadcms-plugins","title":"2. PayloadCMS Plugins","text":"<p>Extend CMS functionality:</p> <pre><code>// src/plugins/customPlugin.ts\nexport const customPlugin = (): Plugin =&gt; ({\n  name: \"custom-plugin\",\n  // Plugin logic\n});\n</code></pre>"},{"location":"getting-started/architecture/#3-api-routes","title":"3. API Routes","text":"<p>Add custom endpoints:</p> <pre><code>// app/api/custom/route.ts\nexport async function GET(req: Request) {\n  // Custom logic\n}\n</code></pre>"},{"location":"getting-started/architecture/#4-data-adapters","title":"4. Data Adapters","text":"<p>Connect new data sources:</p> <pre><code>// lib/adapters/CustomAdapter.ts\nexport class CustomAdapter implements DataAdapter {\n  async fetchEntities() {\n    // Fetch from external source\n  }\n}\n</code></pre>"},{"location":"getting-started/architecture/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/architecture/#configuration-management","title":"Configuration Management","text":"<p>\u2705 Store config in PayloadCMS, not code \u2705 Use environment variables for secrets \u2705 Version control schema definitions</p>"},{"location":"getting-started/architecture/#performance","title":"Performance","text":"<p>\u2705 Enable Next.js caching (ISR, SWR) \u2705 Optimize images (next/image) \u2705 Lazy load map layers \u2705 Use database indexes</p>"},{"location":"getting-started/architecture/#security","title":"Security","text":"<p>\u2705 Never expose API keys to frontend \u2705 Validate all user inputs \u2705 Implement rate limiting \u2705 Use HTTPS in production</p>"},{"location":"getting-started/architecture/#monitoring","title":"Monitoring","text":"<p>\u2705 Log errors to external service \u2705 Track performance metrics \u2705 Monitor broker health \u2705 Set up alerts</p> <p>Next: Installation Guide to set up your development environment.</p>"},{"location":"getting-started/quickstart/","title":"Quick Start Guide","text":"<p>Get LegoCity running in 5 minutes.</p>"},{"location":"getting-started/quickstart/#1-prerequisites-check","title":"1. Prerequisites Check","text":"<p>Verify you have the required tools:</p> <pre><code># Check Node.js version (need 18+)\nnode --version\n\n# Check pnpm (install if needed)\npnpm --version\n\n# If pnpm not installed:\nnpm install -g pnpm\n\n# Check MongoDB is running\nmongosh --eval \"db.version()\"\n</code></pre>"},{"location":"getting-started/quickstart/#2-clone-install","title":"2. Clone &amp; Install","text":"<pre><code># Clone repository\ngit clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity/dashboard\n\n# Install dependencies\npnpm install\n</code></pre>"},{"location":"getting-started/quickstart/#3-configure-environment","title":"3. Configure Environment","text":"<p>Create <code>.env</code> file:</p> <pre><code>cp .env.example .env\n</code></pre> <p>Minimal configuration:</p> <pre><code># Database\nDATABASE_URI=mongodb://127.0.0.1/legocity\n\n# Security\nPAYLOAD_SECRET=your-secret-key-min-32-chars\n\n# Server\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n</code></pre> <p>Generate Secret</p> <p><code>bash     node -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"</code></p>"},{"location":"getting-started/quickstart/#4-start-development-server","title":"4. Start Development Server","text":"<pre><code>pnpm dev\n</code></pre> <p>You should see:</p> <pre><code>\u2713 Ready in 3.2s\n\u25cb Local:   http://localhost:3000\n</code></pre>"},{"location":"getting-started/quickstart/#5-access-dashboard","title":"5. Access Dashboard","text":"<p>Open your browser:</p> <ul> <li>Frontend: http://localhost:3000</li> <li>Admin Panel: http://localhost:3000/admin</li> </ul>"},{"location":"getting-started/quickstart/#first-login","title":"First Login","text":"<p>On first access, you'll be prompted to create an admin account:</p> <ol> <li>Email: <code>admin@example.com</code></li> <li>Password: Choose a secure password</li> <li>Click \"Create First User\"</li> </ol>"},{"location":"getting-started/quickstart/#6-load-sample-data-optional","title":"6. Load Sample Data (Optional)","text":"<pre><code># Seed database with sample city data\npnpm seed\n</code></pre> <p>This creates:</p> <ul> <li>\u2705 Sample sensors and zones</li> <li>\u2705 Example dashboard pages</li> <li>\u2705 Demo map views and layers</li> </ul>"},{"location":"getting-started/quickstart/#whats-next","title":"What's Next?","text":""},{"location":"getting-started/quickstart/#explore-the-dashboard","title":"Explore the Dashboard","text":"<ol> <li>Navigate to Admin Panel - http://localhost:3000/admin</li> <li>View Collections:</li> <li>Pages - Dashboard layouts</li> <li>Media - Images and assets</li> <li>Posts - Content articles</li> <li>Categories - Content organization</li> </ol>"},{"location":"getting-started/quickstart/#configure-your-city","title":"Configure Your City","text":"<ol> <li>Connect Data Sources - Link NGSI-LD brokers</li> <li>Set Up Map Views - Configure Mapbox layers (see User Guide)</li> <li>Create Dashboard Pages - Build custom layouts with blocks</li> </ol>"},{"location":"getting-started/quickstart/#start-development","title":"Start Development","text":"<ol> <li>Development Setup - Complete dev environment</li> <li>Create Custom Blocks - Build UI components</li> <li>Write Plugins - Extend functionality</li> </ol>"},{"location":"getting-started/quickstart/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/quickstart/#port-already-in-use","title":"Port Already in Use","text":"<pre><code># Kill process on port 3000\nnpx kill-port 3000\n\n# Or use different port\nPORT=3001 pnpm dev\n</code></pre>"},{"location":"getting-started/quickstart/#mongodb-connection-failed","title":"MongoDB Connection Failed","text":"<pre><code># Start MongoDB (Windows)\nnet start MongoDB\n\n# Or start manually\nmongod --dbpath C:\\data\\db\n</code></pre>"},{"location":"getting-started/quickstart/#build-errors","title":"Build Errors","text":"<pre><code># Clear cache and reinstall\nrm -rf node_modules .next\npnpm install\npnpm dev\n</code></pre>"},{"location":"getting-started/quickstart/#need-help","title":"Need Help?","text":"<ul> <li>\ud83d\udcd6 Full Installation Guide</li> <li>\ud83d\udc1b Common Issues</li> <li>\ud83d\udcac GitHub Discussions</li> </ul> <p>Up and running? Continue to the User Guide to learn how to use LegoCity.</p>"},{"location":"getting-started/bring-your-own-server/","title":"Bring Your Own Server","text":"<p>This tutorial guides you through connecting your application to an existing SematX instance. You'll learn how to authenticate, create entities, push data, and build visualizations on a remote SematX server.</p> <p>\u23f1\ufe0f Estimated Time: 30-45 minutes \ud83d\udcbb Requirements: SematX instance URL, API credentials \ud83c\udfaf Goal: Integrate your app with a production SematX server</p>"},{"location":"getting-started/bring-your-own-server/#what-youll-learn","title":"What You'll Learn","text":"<p>By the end of this tutorial, you'll be able to: - Create a SematX account and obtain API credentials - Set up a service configuration for your application - Create and manage NGSI-LD entities - Push real-time data from your application - Build dashboard cards to visualize your data - Configure subscriptions for real-time notifications</p>"},{"location":"getting-started/bring-your-own-server/#tutorial-overview","title":"Tutorial Overview","text":"<p>This tutorial is divided into 6 steps:</p> <ol> <li>Create Your Account - Sign up and get access credentials</li> <li>Create a Service - Set up a service for your application</li> <li>Create Your First Entity - Define data structures</li> <li>Push Data - Send data from your application</li> <li>Create Dashboard Cards - Visualize your data</li> <li>Set Up Subscriptions - Receive real-time notifications</li> </ol>"},{"location":"getting-started/bring-your-own-server/#prerequisites","title":"Prerequisites","text":""},{"location":"getting-started/bring-your-own-server/#required","title":"Required","text":"<ul> <li>SematX Instance URL: The base URL of your SematX server</li> <li>Example: <code>https://sematx.example.com</code></li> <li>Access Credentials: Email and password for your SematX account</li> <li>If you don't have an account, you'll need an invitation from your administrator</li> </ul>"},{"location":"getting-started/bring-your-own-server/#recommended","title":"Recommended","text":"<ul> <li>HTTP Client: For testing API calls</li> <li>curl (command line)</li> <li>Postman (GUI)</li> <li>HTTPie (command line, user-friendly)</li> <li>Code Editor: For writing integration code</li> <li>VS Code</li> <li>Programming Language: Any language with HTTP support</li> <li>JavaScript/TypeScript (Node.js, browser)</li> <li>Python</li> <li>Java</li> <li>Go</li> <li>Rust</li> <li>PHP</li> </ul>"},{"location":"getting-started/bring-your-own-server/#architecture","title":"Architecture","text":"<p>When using a remote SematX server, your application communicates with the platform via HTTPS:</p> <p></p> <p>Key Points: - All communication is over HTTPS (secure) - JWT tokens authenticate your requests - You can use any programming language - The server handles data storage and processing</p>"},{"location":"getting-started/bring-your-own-server/#use-cases","title":"Use Cases","text":""},{"location":"getting-started/bring-your-own-server/#iot-data-collection","title":"IoT Data Collection","text":"<p>Send sensor readings from devices to SematX: - Environmental sensors (temperature, humidity, air quality) - Industrial equipment monitoring - Smart building systems - Vehicle tracking</p>"},{"location":"getting-started/bring-your-own-server/#web-application-integration","title":"Web Application Integration","text":"<p>Connect your web application to SematX data: - Display real-time sensor data - Create custom analytics dashboards - Build location-based services - Integrate with existing systems</p>"},{"location":"getting-started/bring-your-own-server/#mobile-app-backend","title":"Mobile App Backend","text":"<p>Use SematX as your mobile app backend: - Store user-generated data - Sync data across devices - Push notifications for events - Location-based queries</p>"},{"location":"getting-started/bring-your-own-server/#data-pipeline-integration","title":"Data Pipeline Integration","text":"<p>Incorporate SematX into your data pipeline: - Ingest data from multiple sources - Transform and normalize data - Trigger webhooks for downstream processing - Export data for analytics</p>"},{"location":"getting-started/bring-your-own-server/#authentication-flow","title":"Authentication Flow","text":"<p>Understanding how authentication works will help you integrate successfully:</p> <pre><code>1. User logs in to Dashboard\n   \u2193\n2. Dashboard generates JWT token (API Key)\n   \u2193\n3. User copies API Key\n   \u2193\n4. Application includes API Key in requests\n   \u2193\n5. Nginx validates JWT token\n   \u2193\n6. Request forwarded to Orion-LD or Dashboard API\n   \u2193\n7. Response returned to application\n</code></pre> <p>JWT Token Structure: <pre><code>{\n  \"userId\": \"user_123\",\n  \"email\": \"user@example.com\",\n  \"permissions\": [\"read:entities\", \"write:entities\"],\n  \"exp\": 1735689600,\n  \"iat\": 1704153600\n}\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/#api-endpoints","title":"API Endpoints","text":"<p>You'll use these main API endpoints:</p>"},{"location":"getting-started/bring-your-own-server/#ngsi-ld-api-orion-ld","title":"NGSI-LD API (Orion-LD)","text":"<p>Base URL: <code>https://your-sematx-server.com/ngsi-ld/v1</code></p> Endpoint Method Purpose <code>/entities</code> POST Create entity <code>/entities</code> GET Query entities <code>/entities/{id}</code> GET Get entity by ID <code>/entities/{id}/attrs</code> PATCH Update entity attributes <code>/entities/{id}</code> DELETE Delete entity <code>/subscriptions</code> POST Create subscription <code>/subscriptions</code> GET List subscriptions"},{"location":"getting-started/bring-your-own-server/#dashboard-api","title":"Dashboard API","text":"<p>Base URL: <code>https://your-sematx-server.com/api</code></p> Endpoint Method Purpose <code>/api-keys</code> POST Create API key <code>/api-keys</code> GET List API keys <code>/cards</code> POST Create dashboard card <code>/cards</code> GET List cards <code>/users/login</code> POST User login"},{"location":"getting-started/bring-your-own-server/#rate-limits","title":"Rate Limits","text":"<p>Most SematX instances enforce rate limits:</p> <ul> <li>Default: 100 requests per minute per API key</li> <li>Burst: 20 requests per second for short bursts</li> <li>Headers: Rate limit info in response headers   <pre><code>X-RateLimit-Limit: 100\nX-RateLimit-Remaining: 95\nX-RateLimit-Reset: 1704153660\n</code></pre></li> </ul> <p>Tips for Rate Limiting: - Cache frequently accessed data - Use subscriptions instead of polling - Batch updates when possible - Implement exponential backoff for retries</p>"},{"location":"getting-started/bring-your-own-server/#code-examples","title":"Code Examples","text":"<p>We provide code examples in multiple languages throughout the tutorial:</p> <ul> <li>JavaScript/TypeScript: Node.js and browser examples</li> <li>Python: Using <code>requests</code> library</li> <li>curl: Command-line examples</li> <li>Postman: Collection files for import</li> </ul>"},{"location":"getting-started/bring-your-own-server/#getting-help","title":"Getting Help","text":"<p>If you get stuck during this tutorial:</p> <ul> <li>Check logs: Most errors include helpful messages</li> <li>Verify credentials: Ensure API keys are valid and not expired</li> <li>Test connectivity: Use curl to verify server accessibility</li> <li>Review docs: Check the Troubleshooting Guide if you encounter issues</li> <li>Ask for help: Join GitHub Discussions</li> </ul>"},{"location":"getting-started/bring-your-own-server/#ready-to-start","title":"Ready to Start?","text":"<p>Let's begin by creating your account:</p> <p>Step 1: Create Your Account \u2192</p>"},{"location":"getting-started/bring-your-own-server/#alternative-start-local-first","title":"Alternative: Start Local First","text":"<p>If you don't have access to a SematX server yet, you can:</p> <ol> <li>Start a local server for development</li> <li>Complete this tutorial using your local instance</li> <li>Deploy to production when ready</li> </ol> <p>The API is identical whether using local or remote servers!</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/","title":"Step 1: Create Your Account","text":"<p>The first step in using SematX is creating an account on your organization's SematX instance.</p> <p>\u23f1\ufe0f Time: 5 minutes \ud83c\udfaf Goal: Get access to the SematX dashboard and generate API credentials</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#before-you-begin","title":"Before You Begin","text":""},{"location":"getting-started/bring-your-own-server/1-create-account/#get-your-sematx-server-url","title":"Get Your SematX Server URL","text":"<p>You'll need the URL of your organization's SematX server. This typically looks like:</p> <ul> <li><code>https://sematx.example.com</code></li> <li><code>https://dashboard.your-company.com</code></li> <li><code>https://smart-city.example.org</code></li> </ul> <p>Don't have a server? You can: - Ask your system administrator for the URL - Deploy your own instance - Start a local server for development</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#check-access-requirements","title":"Check Access Requirements","text":"<p>Some SematX instances require: - Invitation: Administrator must create your account - Domain restriction: Email must match organization domain - VPN: May require VPN access for private networks</p> <p>Contact your administrator if you're unsure about access requirements.</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#create-your-account","title":"Create Your Account","text":""},{"location":"getting-started/bring-your-own-server/1-create-account/#navigate-to-the-dashboard","title":"Navigate to the Dashboard","text":"<ol> <li>Open your web browser</li> <li>Go to your SematX instance URL</li> <li>Add <code>/admin</code> to access the dashboard:    <pre><code>https://your-sematx-server.com/admin\n</code></pre></li> </ol>"},{"location":"getting-started/bring-your-own-server/1-create-account/#sign-up-self-registration","title":"Sign Up (Self-Registration)","text":"<p>If self-registration is enabled, you'll see a Create First User or Sign Up form:</p> <ol> <li> <p>Email: Enter your email address    <pre><code>user@example.com\n</code></pre></p> </li> <li> <p>Password: Create a strong password</p> </li> <li>Minimum 8 characters</li> <li>Mix of uppercase, lowercase, numbers, symbols</li> <li> <p>Example: <code>Sm@rtC1ty2025!</code></p> </li> <li> <p>Confirm Password: Re-enter your password</p> </li> <li> <p>Name (optional): Your full name    <pre><code>John Doe\n</code></pre></p> </li> <li> <p>Click Create Account or Sign Up</p> </li> </ol>"},{"location":"getting-started/bring-your-own-server/1-create-account/#administrator-created-account","title":"Administrator-Created Account","text":"<p>If your account was created by an administrator:</p> <ol> <li>Check your email for invitation</li> <li>Click the activation link</li> <li>Set your password</li> <li>Log in with your credentials</li> </ol>"},{"location":"getting-started/bring-your-own-server/1-create-account/#log-in","title":"Log In","text":"<p>After creating your account, log in to the dashboard:</p> <ol> <li> <p>Navigate to the login page:    <pre><code>https://your-sematx-server.com/admin/login\n</code></pre></p> </li> <li> <p>Enter your credentials:</p> </li> <li>Email: Your registered email</li> <li> <p>Password: Your account password</p> </li> <li> <p>Click Log In</p> </li> </ol> <p>You should now see the SematX dashboard!</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#key-sections","title":"Key Sections","text":"<ul> <li>Dashboard: View your data visualizations</li> <li>Maps: Geospatial data visualization</li> <li>Entities: Browse and manage NGSI-LD entities</li> <li>API Keys: Generate tokens for API access</li> <li>Cards: Create and configure dashboard cards</li> <li>Subscriptions: Set up real-time notifications</li> <li>Users: Manage team members (admin only)</li> <li>Settings: Configure your preferences</li> </ul>"},{"location":"getting-started/bring-your-own-server/1-create-account/#generate-your-first-api-key","title":"Generate Your First API Key","text":"<p>To interact with the SematX API from your application, you'll need an API key (JWT token).</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#navigate-to-api-keys","title":"Navigate to API Keys","text":"<ol> <li>Click API Keys in the left sidebar</li> <li>Click Create New button</li> </ol>"},{"location":"getting-started/bring-your-own-server/1-create-account/#configure-api-key","title":"Configure API Key","text":"<p>Fill in the API key details:</p> <ol> <li>Name: Give your API key a descriptive name    <pre><code>My Application - Production\n</code></pre></li> </ol> <p>Tip: Use meaningful names to identify keys later:    - <code>IoT Sensors - Building A</code>    - <code>Mobile App - iOS</code>    - <code>Data Pipeline - Staging</code></p> <ol> <li> <p>Description (optional): Add notes about usage    <pre><code>API key for production IoT sensor data collection\n</code></pre></p> </li> <li> <p>Expires: Set an expiration date</p> </li> <li>Recommended: 90 days for production</li> <li>Short-term: 7-30 days for testing</li> <li> <p>No expiration: Only for development (not recommended for production)</p> </li> <li> <p>Permissions: Select access level</p> </li> <li>Read Only: Can only query data</li> <li>Read/Write: Can create and update entities</li> <li>Full Access: Can manage all resources</li> </ol> <p>For this tutorial: Select Read/Write or Full Access</p> <ol> <li>Rate Limit (if available): Set request limits</li> <li>Default: 100 requests per minute</li> <li>High volume: 1000 requests per minute</li> <li> <p>Low volume: 10 requests per minute</p> </li> <li> <p>Click Create</p> </li> </ol>"},{"location":"getting-started/bring-your-own-server/1-create-account/#save-your-api-key","title":"Save Your API Key","text":"<p>Important: You'll only see the API key once!</p> <ol> <li> <p>Copy the entire token:    <pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2NTg3ZjJhMTIzNDU2Nzg5IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwicGVybWlzc2lvbnMiOlsicmVhZDplbnRpdGllcyIsIndyaXRlOmVudGl0aWVzIl0sImlhdCI6MTcwNDE1MzYwMCwiZXhwIjoxNzEyMDE1NjAwfQ.xGZHY8PK2yWQJ3uT6E9hxK4rN7mV8lB0nQ5sA1wF2cD\n</code></pre></p> </li> <li> <p>Store it securely:</p> </li> <li>For development: Save in <code>.env</code> file (never commit to git!)</li> <li>For production: Store in secrets manager (AWS Secrets Manager, Azure Key Vault, etc.)</li> <li> <p>Never: Share via email, Slack, or public channels</p> </li> <li> <p>Click Done</p> </li> </ol>"},{"location":"getting-started/bring-your-own-server/1-create-account/#test-your-connection","title":"Test Your Connection","text":"<p>Let's verify you can connect to the SematX API using your new API key.</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#using-curl","title":"Using curl","text":"<p>Open a terminal and run:</p> <pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?limit=1\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre> <p>Replace: - <code>your-sematx-server.com</code> with your actual server URL - <code>YOUR_API_KEY_HERE</code> with your API key</p> <p>Expected Response:</p> <pre><code>[]\n</code></pre> <p>Or if entities exist:</p> <pre><code>[\n  {\n    \"id\": \"urn:ngsi-ld:Sensor:001\",\n    \"type\": \"Sensor\",\n    ...\n  }\n]\n</code></pre>"},{"location":"getting-started/bring-your-own-server/1-create-account/#using-javascript","title":"Using JavaScript","text":"<pre><code>const SEMATX_URL = 'https://your-sematx-server.com';\nconst API_KEY = 'YOUR_API_KEY_HERE';\n\nasync function testConnection() {\n  const response = await fetch(\n    `${SEMATX_URL}/ngsi-ld/v1/entities?limit=1`,\n    {\n      headers: {\n        'Authorization': `Bearer ${API_KEY}`,\n        'Accept': 'application/ld+json'\n      }\n    }\n  );\n\n  if (response.ok) {\n    const data = await response.json();\n    console.log('\u2705 Connected successfully!');\n    console.log('Entities:', data);\n  } else {\n    console.error('\u274c Connection failed:', response.status);\n  }\n}\n\ntestConnection();\n</code></pre>"},{"location":"getting-started/bring-your-own-server/1-create-account/#using-python","title":"Using Python","text":"<pre><code>import requests\n\nSEMATX_URL = 'https://your-sematx-server.com'\nAPI_KEY = 'YOUR_API_KEY_HERE'\n\ndef test_connection():\n    response = requests.get(\n        f'{SEMATX_URL}/ngsi-ld/v1/entities',\n        params={'limit': 1},\n        headers={\n            'Authorization': f'Bearer {API_KEY}',\n            'Accept': 'application/ld+json'\n        }\n    )\n\n    if response.ok:\n        print('\u2705 Connected successfully!')\n        print('Entities:', response.json())\n    else:\n        print(f'\u274c Connection failed: {response.status_code}')\n        print(response.text)\n\ntest_connection()\n</code></pre>"},{"location":"getting-started/bring-your-own-server/1-create-account/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/bring-your-own-server/1-create-account/#401-unauthorized","title":"401 Unauthorized","text":"<p>Problem: API returns 401 status code</p> <p>Solutions: 1. Check API key: Ensure you copied it completely 2. Check expiration: Key may have expired 3. Check format: Header should be <code>Authorization: Bearer &lt;token&gt;</code> 4. Regenerate: Create a new API key if needed</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#403-forbidden","title":"403 Forbidden","text":"<p>Problem: API returns 403 status code</p> <p>Solutions: 1. Check permissions: API key may lack required permissions 2. Check account: Your account may be disabled 3. Contact admin: May need elevated permissions</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#network-error-timeout","title":"Network Error / Timeout","text":"<p>Problem: Cannot reach server</p> <p>Solutions: 1. Check URL: Verify server address is correct 2. Check network: Ensure you're connected to internet 3. Check VPN: May need VPN for private networks 4. Check firewall: Firewall may block connection 5. Check DNS: Try IP address instead of domain name</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#ssltls-error","title":"SSL/TLS Error","text":"<p>Problem: Certificate verification failed</p> <p>Solutions: 1. Self-signed cert: Your admin may use self-signed certificates 2. Development only: Disable SSL verification (not for production!)    <pre><code>curl -k https://your-sematx-server.com/...\n</code></pre> 3. Production: Install proper SSL certificate</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#cannot-access-dashboard","title":"Cannot Access Dashboard","text":"<p>Problem: Dashboard page doesn't load</p> <p>Solutions: 1. Check URL: Should include <code>/admin</code> path 2. Check browser: Try different browser or incognito mode 3. Clear cache: Clear browser cache and cookies 4. Check server: Server may be down - contact admin</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#security-best-practices","title":"Security Best Practices","text":""},{"location":"getting-started/bring-your-own-server/1-create-account/#api-key-management","title":"API Key Management","text":"<p>\u2705 Do: - Use environment variables for API keys - Rotate keys regularly (every 90 days) - Use different keys for different environments - Revoke keys when no longer needed - Set expiration dates on all keys - Use least-privilege permissions</p> <p>\u274c Don't: - Commit API keys to version control - Share keys via email or chat - Use production keys in development - Give full access when read-only is sufficient - Create keys without expiration dates - Reuse keys across multiple projects</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#password-security","title":"Password Security","text":"<p>\u2705 Do: - Use strong, unique passwords - Enable 2FA if available - Use a password manager - Change password if compromised</p> <p>\u274c Don't: - Reuse passwords across services - Share your account credentials - Use simple or common passwords - Write passwords in plain text</p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#what-you-learned","title":"What You Learned","text":"<p>\u2705 How to access the SematX dashboard \u2705 How to create a user account \u2705 How to generate API keys \u2705 How to test API connectivity \u2705 Security best practices for API keys  </p>"},{"location":"getting-started/bring-your-own-server/1-create-account/#next-step","title":"Next Step","text":"<p>Now that you have your account and API key, let's create a service for your application:</p> <p>Step 2: Create a Service \u2192</p> <p>Need to go back? Return to the tutorial overview</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/","title":"Step 2: Create a Service","text":"<p>In SematX, a service represents a logical grouping of entities from your application. This helps organize your data and manage access control.</p> <p>\u23f1\ufe0f Time: 5-10 minutes \ud83c\udfaf Goal: Set up a service configuration for your application</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#what-is-a-service","title":"What is a Service?","text":"<p>A service in SematX is a namespace for your entities. Think of it as:</p> <ul> <li>IoT Project: \"Smart Building Sensors\"</li> <li>Department: \"Environmental Monitoring Team\"</li> <li>Application: \"Mobile App Backend\"</li> <li>Location: \"Downtown Campus\"</li> </ul> <p>Services help you: - Organize entities by project or application - Apply access control policies - Filter data in queries - Manage entity lifecycles</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#understanding-ngsi-ld-multi-tenancy","title":"Understanding NGSI-LD Multi-Tenancy","text":"<p>SematX uses the NGSI-LD-Tenant header for multi-tenancy:</p> <pre><code>GET /ngsi-ld/v1/entities\nAuthorization: Bearer &lt;api-key&gt;\nNGSILD-Tenant: my-service\n</code></pre> <p>All entities created with a specific tenant header are isolated to that tenant.</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#create-your-service","title":"Create Your Service","text":""},{"location":"getting-started/bring-your-own-server/2-create-service/#option-1-implicit-service-recommended-for-beginners","title":"Option 1: Implicit Service (Recommended for Beginners)","text":"<p>The simplest approach is to not use a tenant header at all. All your entities will be created in the default tenant.</p> <p>Pros: - No configuration needed - Simple to get started - Good for single-application deployments</p> <p>Cons: - All entities share the same namespace - Harder to organize multi-project data</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#option-2-explicit-service","title":"Option 2: Explicit Service","text":"<p>For better organization, create a named service for your application.</p> <p>Choose a Service Name:</p> <pre><code>my-iot-project\nsmart-building-a\nenvironmental-sensors\nmobile-app-backend\n</code></pre> <p>Rules: - Lowercase letters, numbers, hyphens only - No spaces or special characters - Max 64 characters - Descriptive and unique</p> <p>Store your service name:</p> <pre><code># In your .env file\nSEMATX_SERVICE=my-iot-project\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#configure-your-application","title":"Configure Your Application","text":""},{"location":"getting-started/bring-your-own-server/2-create-service/#environment-variables","title":"Environment Variables","text":"<p>Set up your application configuration:</p> <pre><code># .env file\nSEMATX_URL=https://your-sematx-server.com\nSEMATX_API_KEY=eyJhbGciOiJIUzI1NiIsInR...\nSEMATX_SERVICE=my-iot-project\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#javascripttypescript-configuration","title":"JavaScript/TypeScript Configuration","text":"<pre><code>// config.js\nexport const sematxConfig = {\n  url: process.env.SEMATX_URL || 'https://your-sematx-server.com',\n  apiKey: process.env.SEMATX_API_KEY,\n  service: process.env.SEMATX_SERVICE || 'default',\n  headers: {\n    'Authorization': `Bearer ${process.env.SEMATX_API_KEY}`,\n    'Content-Type': 'application/ld+json',\n    'Accept': 'application/ld+json',\n    'NGSILD-Tenant': process.env.SEMATX_SERVICE || 'default'\n  }\n};\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#python-configuration","title":"Python Configuration","text":"<pre><code># config.py\nimport os\nfrom dataclasses import dataclass\n\n@dataclass\nclass SematXConfig:\n    url: str = os.getenv('SEMATX_URL', 'https://your-sematx-server.com')\n    api_key: str = os.getenv('SEMATX_API_KEY')\n    service: str = os.getenv('SEMATX_SERVICE', 'default')\n\n    @property\n    def headers(self):\n        return {\n            'Authorization': f'Bearer {self.api_key}',\n            'Content-Type': 'application/ld+json',\n            'Accept': 'application/ld+json',\n            'NGSILD-Tenant': self.service\n        }\n\nconfig = SematXConfig()\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#create-a-helper-function","title":"Create a Helper Function","text":"<p>Create a reusable function for making API requests:</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#javascripttypescript","title":"JavaScript/TypeScript","text":"<pre><code>// sematx-client.js\nimport { sematxConfig } from './config.js';\n\nclass SematXClient {\n  constructor(config) {\n    this.baseUrl = config.url;\n    this.headers = config.headers;\n  }\n\n  async request(endpoint, options = {}) {\n    const url = `${this.baseUrl}${endpoint}`;\n    const response = await fetch(url, {\n      ...options,\n      headers: {\n        ...this.headers,\n        ...options.headers\n      }\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`API Error ${response.status}: ${error}`);\n    }\n\n    return response.json();\n  }\n\n  // Entity operations\n  async getEntities(params = {}) {\n    const query = new URLSearchParams(params).toString();\n    return this.request(`/ngsi-ld/v1/entities?${query}`);\n  }\n\n  async getEntity(id) {\n    return this.request(`/ngsi-ld/v1/entities/${encodeURIComponent(id)}`);\n  }\n\n  async createEntity(entity) {\n    return this.request('/ngsi-ld/v1/entities', {\n      method: 'POST',\n      body: JSON.stringify(entity)\n    });\n  }\n\n  async updateEntity(id, attributes) {\n    return this.request(`/ngsi-ld/v1/entities/${encodeURIComponent(id)}/attrs`, {\n      method: 'PATCH',\n      body: JSON.stringify(attributes)\n    });\n  }\n\n  async deleteEntity(id) {\n    return this.request(`/ngsi-ld/v1/entities/${encodeURIComponent(id)}`, {\n      method: 'DELETE'\n    });\n  }\n}\n\nexport const client = new SematXClient(sematxConfig);\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#python","title":"Python","text":"<pre><code># sematx_client.py\nimport requests\nfrom typing import Dict, List, Optional\nfrom urllib.parse import urlencode\nfrom config import config\n\nclass SematXClient:\n    def __init__(self, config):\n        self.base_url = config.url\n        self.headers = config.headers\n\n    def request(self, endpoint: str, method: str = 'GET', json: Optional[Dict] = None):\n        url = f'{self.base_url}{endpoint}'\n        response = requests.request(\n            method=method,\n            url=url,\n            headers=self.headers,\n            json=json\n        )\n        response.raise_for_status()\n        return response.json() if response.content else None\n\n    # Entity operations\n    def get_entities(self, params: Dict = None) -&gt; List[Dict]:\n        query = f'?{urlencode(params)}' if params else ''\n        return self.request(f'/ngsi-ld/v1/entities{query}')\n\n    def get_entity(self, entity_id: str) -&gt; Dict:\n        return self.request(f'/ngsi-ld/v1/entities/{entity_id}')\n\n    def create_entity(self, entity: Dict) -&gt; None:\n        return self.request('/ngsi-ld/v1/entities', method='POST', json=entity)\n\n    def update_entity(self, entity_id: str, attributes: Dict) -&gt; None:\n        return self.request(\n            f'/ngsi-ld/v1/entities/{entity_id}/attrs',\n            method='PATCH',\n            json=attributes\n        )\n\n    def delete_entity(self, entity_id: str) -&gt; None:\n        return self.request(f'/ngsi-ld/v1/entities/{entity_id}', method='DELETE')\n\nclient = SematXClient(config)\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#test-your-service-configuration","title":"Test Your Service Configuration","text":"<p>Let's verify your service configuration works:</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#test-1-query-empty-service","title":"Test 1: Query Empty Service","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre> <p>Expected: Empty array <code>[]</code> (no entities yet)</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#test-2-use-helper-function","title":"Test 2: Use Helper Function","text":""},{"location":"getting-started/bring-your-own-server/2-create-service/#javascript","title":"JavaScript","text":"<pre><code>import { client } from './sematx-client.js';\n\nasync function testService() {\n  try {\n    const entities = await client.getEntities({ limit: 10 });\n    console.log('\u2705 Service configured successfully!');\n    console.log(`Found ${entities.length} entities`);\n  } catch (error) {\n    console.error('\u274c Service configuration failed:', error.message);\n  }\n}\n\ntestService();\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#python_1","title":"Python","text":"<pre><code>from sematx_client import client\n\ndef test_service():\n    try:\n        entities = client.get_entities({'limit': 10})\n        print('\u2705 Service configured successfully!')\n        print(f'Found {len(entities)} entities')\n    except Exception as error:\n        print(f'\u274c Service configuration failed: {error}')\n\ntest_service()\n</code></pre>"},{"location":"getting-started/bring-your-own-server/2-create-service/#service-organization-patterns","title":"Service Organization Patterns","text":""},{"location":"getting-started/bring-your-own-server/2-create-service/#pattern-1-single-service-simple","title":"Pattern 1: Single Service (Simple)","text":"<pre><code>Service: my-app\n  \u251c\u2500\u2500 Sensor:001\n  \u251c\u2500\u2500 Sensor:002\n  \u251c\u2500\u2500 Building:001\n  \u2514\u2500\u2500 Vehicle:001\n</code></pre> <p>Use when: - Single application - Small number of entities - No multi-tenancy needed</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#pattern-2-service-per-environment","title":"Pattern 2: Service Per Environment","text":"<pre><code>Service: my-app-dev\n  \u2514\u2500\u2500 Test entities\n\nService: my-app-staging\n  \u2514\u2500\u2500 Staging entities\n\nService: my-app-prod\n  \u2514\u2500\u2500 Production entities\n</code></pre> <p>Use when: - Need isolated environments - Testing before production - Different access control per environment</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#pattern-3-service-per-location","title":"Pattern 3: Service Per Location","text":"<pre><code>Service: building-a\n  \u2514\u2500\u2500 Building A entities\n\nService: building-b\n  \u2514\u2500\u2500 Building B entities\n\nService: downtown-campus\n  \u2514\u2500\u2500 Campus entities\n</code></pre> <p>Use when: - Geographic separation - Location-based access control - Regional deployments</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#pattern-4-service-per-teamdepartment","title":"Pattern 4: Service Per Team/Department","text":"<pre><code>Service: facilities-team\n  \u2514\u2500\u2500 Facilities entities\n\nService: security-team\n  \u2514\u2500\u2500 Security entities\n\nService: iot-team\n  \u2514\u2500\u2500 IoT sensors\n</code></pre> <p>Use when: - Multiple teams sharing infrastructure - Department-level access control - Organizational boundaries</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/bring-your-own-server/2-create-service/#naming-conventions","title":"Naming Conventions","text":"<p>\u2705 Good Names: <pre><code>smart-building-sensors\nenvironmental-monitoring\nmobile-app-backend\niot-dev-environment\n</code></pre></p> <p>\u274c Bad Names: <pre><code>test\nmyService\nService1\nabc123\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#service-lifecycle","title":"Service Lifecycle","text":"<ol> <li>Create: Set up service when project starts</li> <li>Use: All entities use same service name consistently</li> <li>Monitor: Track entity count and API usage</li> <li>Archive: Export data before deleting service</li> <li>Delete: Remove service when project ends</li> </ol>"},{"location":"getting-started/bring-your-own-server/2-create-service/#security-considerations","title":"Security Considerations","text":"<ul> <li>Access Control: Services can have different access policies</li> <li>API Keys: Create separate keys per service</li> <li>Isolation: Services are logically isolated</li> <li>Audit: Service name appears in logs for tracking</li> </ul>"},{"location":"getting-started/bring-your-own-server/2-create-service/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/bring-your-own-server/2-create-service/#entities-not-found","title":"Entities Not Found","text":"<p>Problem: Can't see entities you created earlier</p> <p>Solution: Check that you're using the same <code>NGSILD-Tenant</code> header: <pre><code># List all tenants (admin only)\ncurl -X GET \"https://your-sematx-server.com/admin/tenants\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\"\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#invalid-service-name","title":"Invalid Service Name","text":"<p>Problem: API rejects service name</p> <p>Solution: Use only lowercase letters, numbers, and hyphens: <pre><code>Valid:   my-service-123\nInvalid: My Service!, my_service, MyService\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#permission-denied","title":"Permission Denied","text":"<p>Problem: 403 Forbidden when accessing service</p> <p>Solution: Your API key may not have access to this service. Contact admin or use correct key.</p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#what-you-learned","title":"What You Learned","text":"<p>\u2705 What services are and why they're useful \u2705 How to choose a service name \u2705 How to configure service in your application \u2705 How to create helper functions for API calls \u2705 Service organization patterns \u2705 Security best practices for services  </p>"},{"location":"getting-started/bring-your-own-server/2-create-service/#next-step","title":"Next Step","text":"<p>Now that your service is configured, let's create your first entity:</p> <p>Step 3: Create Your First Entity \u2192</p> <p>Need to go back? Return to Step 1: Create Your Account</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/","title":"Step 3: Create Your First Entity","text":"<p>Now that your service is configured, let's create your first NGSI-LD entity. Entities are the core data structures in SematX.</p> <p>\u23f1\ufe0f Time: 10-15 minutes \ud83c\udfaf Goal: Create and query your first NGSI-LD entity</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#what-is-an-entity","title":"What is an Entity?","text":"<p>An entity represents a real-world object in your application:</p> <ul> <li>Physical Objects: Sensors, devices, vehicles, buildings</li> <li>Conceptual Objects: Alerts, events, observations</li> <li>Locations: Cities, rooms, parking spaces</li> <li>Organizations: Departments, teams, companies</li> </ul>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#ngsi-ld-entity-structure","title":"NGSI-LD Entity Structure","text":"<p>Every entity has three required components:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:EntityType:uniqueId\",\n  \"type\": \"EntityType\",\n  \"@context\": [\"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"]\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#1-entity-id-id","title":"1. Entity ID (<code>id</code>)","text":"<p>A unique identifier following the URN format:</p> <pre><code>urn:ngsi-ld:EntityType:uniqueIdentifier\n</code></pre> <p>Examples: <pre><code>urn:ngsi-ld:Sensor:temperature-001\nurn:ngsi-ld:Building:main-campus\nurn:ngsi-ld:Vehicle:bus-42\nurn:ngsi-ld:AirQualityObserved:station-downtown-2025-12-02\n</code></pre></p> <p>Rules: - Must be unique across your service - Should be descriptive - Use hyphens to separate words - Include entity type for clarity</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#2-entity-type-type","title":"2. Entity Type (<code>type</code>)","text":"<p>The category or class of the entity:</p> <pre><code>Sensor\nBuilding\nVehicle\nAirQualityObserved\nTemperatureObservation\n</code></pre> <p>Rules: - Use PascalCase (capitalize each word) - Be specific (prefer <code>TemperatureSensor</code> over <code>Sensor</code>) - Follow standard data models when possible (FIWARE, SmartDataModels)</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#3-context-context","title":"3. Context (<code>@context</code>)","text":"<p>Defines the semantic meaning of your data:</p> <pre><code>\"@context\": [\n  \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n]\n</code></pre> <p>For this tutorial, we'll use the standard NGSI-LD context.</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#entity-attributes","title":"Entity Attributes","text":"<p>Entities can have three types of attributes:</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#properties","title":"Properties","text":"<p>Simple data values:</p> <pre><code>\"temperature\": {\n  \"type\": \"Property\",\n  \"value\": 23.5,\n  \"unitCode\": \"CEL\"\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#geoproperties","title":"GeoProperties","text":"<p>Geographic locations:</p> <pre><code>\"location\": {\n  \"type\": \"GeoProperty\",\n  \"value\": {\n    \"type\": \"Point\",\n    \"coordinates\": [105.7800, 10.0300]\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#relationships","title":"Relationships","text":"<p>Links to other entities:</p> <pre><code>\"refBuilding\": {\n  \"type\": \"Relationship\",\n  \"object\": \"urn:ngsi-ld:Building:001\"\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#create-a-temperature-sensor-entity","title":"Create a Temperature Sensor Entity","text":"<p>Let's create a real-world example: a temperature sensor.</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#entity-design","title":"Entity Design","text":"<p>What we're modeling: - A temperature sensor in Room 101 - Located at specific coordinates - Measures temperature in Celsius - Last reading: 23.5\u00b0C</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#complete-entity-json","title":"Complete Entity JSON","text":"<pre><code>{\n  \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n  \"type\": \"TemperatureSensor\",\n  \"@context\": [\n    \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n  ],\n  \"name\": {\n    \"type\": \"Property\",\n    \"value\": \"Temperature Sensor - Room 101\"\n  },\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 23.5,\n    \"unitCode\": \"CEL\",\n    \"observedAt\": \"2025-12-02T10:00:00Z\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"status\": {\n    \"type\": \"Property\",\n    \"value\": \"active\"\n  },\n  \"batteryLevel\": {\n    \"type\": \"Property\",\n    \"value\": 85,\n    \"unitCode\": \"P1\"\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#create-entity-via-api","title":"Create Entity via API","text":""},{"location":"getting-started/bring-your-own-server/3-create-entity/#using-curl","title":"Using curl","text":"<pre><code>curl -X POST \"https://your-sematx-server.com/ngsi-ld/v1/entities\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n    \"type\": \"TemperatureSensor\",\n    \"@context\": [\n      \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n    ],\n    \"name\": {\n      \"type\": \"Property\",\n      \"value\": \"Temperature Sensor - Room 101\"\n    },\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 23.5,\n      \"unitCode\": \"CEL\",\n      \"observedAt\": \"2025-12-02T10:00:00Z\"\n    },\n    \"location\": {\n      \"type\": \"GeoProperty\",\n      \"value\": {\n        \"type\": \"Point\",\n        \"coordinates\": [105.7800, 10.0300]\n      }\n    },\n    \"status\": {\n      \"type\": \"Property\",\n      \"value\": \"active\"\n    },\n    \"batteryLevel\": {\n      \"type\": \"Property\",\n      \"value\": 85,\n      \"unitCode\": \"P1\"\n    }\n  }'\n</code></pre> <p>Expected Response: <pre><code>HTTP/1.1 201 Created\nLocation: /ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#using-javascript","title":"Using JavaScript","text":"<pre><code>import { client } from './sematx-client.js';\n\nasync function createSensor() {\n  const entity = {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-101',\n    type: 'TemperatureSensor',\n    '@context': [\n      'https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld'\n    ],\n    name: {\n      type: 'Property',\n      value: 'Temperature Sensor - Room 101'\n    },\n    temperature: {\n      type: 'Property',\n      value: 23.5,\n      unitCode: 'CEL',\n      observedAt: new Date().toISOString()\n    },\n    location: {\n      type: 'GeoProperty',\n      value: {\n        type: 'Point',\n        coordinates: [105.7800, 10.0300]\n      }\n    },\n    status: {\n      type: 'Property',\n      value: 'active'\n    },\n    batteryLevel: {\n      type: 'Property',\n      value: 85,\n      unitCode: 'P1'\n    }\n  };\n\n  try {\n    await client.createEntity(entity);\n    console.log('\u2705 Entity created successfully!');\n  } catch (error) {\n    console.error('\u274c Failed to create entity:', error.message);\n  }\n}\n\ncreateSensor();\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#using-python","title":"Using Python","text":"<pre><code>from sematx_client import client\nfrom datetime import datetime\n\ndef create_sensor():\n    entity = {\n        'id': 'urn:ngsi-ld:TemperatureSensor:room-101',\n        'type': 'TemperatureSensor',\n        '@context': [\n            'https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld'\n        ],\n        'name': {\n            'type': 'Property',\n            'value': 'Temperature Sensor - Room 101'\n        },\n        'temperature': {\n            'type': 'Property',\n            'value': 23.5,\n            'unitCode': 'CEL',\n            'observedAt': datetime.utcnow().isoformat() + 'Z'\n        },\n        'location': {\n            'type': 'GeoProperty',\n            'value': {\n                'type': 'Point',\n                'coordinates': [105.7800, 10.0300]\n            }\n        },\n        'status': {\n            'type': 'Property',\n            'value': 'active'\n        },\n        'batteryLevel': {\n            'type': 'Property',\n            'value': 85,\n            'unitCode': 'P1'\n        }\n    }\n\n    try:\n        client.create_entity(entity)\n        print('\u2705 Entity created successfully!')\n    except Exception as error:\n        print(f'\u274c Failed to create entity: {error}')\n\ncreate_sensor()\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#query-your-entity","title":"Query Your Entity","text":""},{"location":"getting-started/bring-your-own-server/3-create-entity/#get-entity-by-id","title":"Get Entity by ID","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#query-entities-by-type","title":"Query Entities by Type","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?type=TemperatureSensor\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#query-with-filters","title":"Query with Filters","text":"<p>Filter entities by property values:</p> <pre><code># Sensors with temperature &gt; 25\ncurl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?type=TemperatureSensor&amp;q=temperature&gt;25\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#query-by-location","title":"Query by Location","text":"<p>Find entities near a point:</p> <pre><code># Sensors within 1km of coordinates\ncurl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?type=TemperatureSensor&amp;geometry=Point&amp;coordinates=[105.7800,10.0300]&amp;georel=near;maxDistance==1000\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#understanding-unit-codes","title":"Understanding Unit Codes","text":"<p>NGSI-LD uses standard unit codes from UN/CEFACT:</p> Unit Code Example Celsius <code>CEL</code> Temperature Fahrenheit <code>FAH</code> Temperature Percent <code>P1</code> Battery, humidity Meters <code>MTR</code> Distance Kilometers <code>KMT</code> Distance Kilograms <code>KGM</code> Weight Liters <code>LTR</code> Volume Watts <code>WTT</code> Power Lux <code>LUX</code> Light intensity Pascal <code>PAL</code> Pressure Parts per million <code>59</code> Air quality"},{"location":"getting-started/bring-your-own-server/3-create-entity/#common-entity-patterns","title":"Common Entity Patterns","text":""},{"location":"getting-started/bring-your-own-server/3-create-entity/#observation-entity","title":"Observation Entity","text":"<p>For sensor readings:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:AirQualityObserved:station-01-20251202\",\n  \"type\": \"AirQualityObserved\",\n  \"dateObserved\": {\n    \"type\": \"Property\",\n    \"value\": {\"@type\": \"DateTime\", \"@value\": \"2025-12-02T10:00:00Z\"}\n  },\n  \"PM25\": {\n    \"type\": \"Property\",\n    \"value\": 35,\n    \"unitCode\": \"GQ\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\"type\": \"Point\", \"coordinates\": [105.78, 10.03]}\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#device-entity","title":"Device Entity","text":"<p>For IoT devices:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Device:sensor-001\",\n  \"type\": \"Device\",\n  \"name\": {\"type\": \"Property\", \"value\": \"Environmental Sensor\"},\n  \"serialNumber\": {\"type\": \"Property\", \"value\": \"SN12345678\"},\n  \"hardwareVersion\": {\"type\": \"Property\", \"value\": \"v2.1\"},\n  \"firmwareVersion\": {\"type\": \"Property\", \"value\": \"v1.5.2\"},\n  \"batteryLevel\": {\"type\": \"Property\", \"value\": 85, \"unitCode\": \"P1\"},\n  \"rssi\": {\"type\": \"Property\", \"value\": -75, \"unitCode\": \"DBM\"}\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#building-entity","title":"Building Entity","text":"<p>For structures:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Building:campus-main\",\n  \"type\": \"Building\",\n  \"name\": {\"type\": \"Property\", \"value\": \"Main Campus Building\"},\n  \"address\": {\n    \"type\": \"Property\",\n    \"value\": {\n      \"streetAddress\": \"123 University Ave\",\n      \"addressLocality\": \"Can Tho\",\n      \"postalCode\": \"900000\",\n      \"addressCountry\": \"VN\"\n    }\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\"type\": \"Point\", \"coordinates\": [105.78, 10.03]}\n  },\n  \"category\": {\"type\": \"Property\", \"value\": [\"educational\"]},\n  \"floorsAboveGround\": {\"type\": \"Property\", \"value\": 5}\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/bring-your-own-server/3-create-entity/#entity-id-design","title":"Entity ID Design","text":"<p>\u2705 Good IDs: <pre><code>urn:ngsi-ld:Sensor:temperature-room-101\nurn:ngsi-ld:Vehicle:bus-line-3-unit-42\nurn:ngsi-ld:AirQualityObserved:station-downtown-2025-12-02T10:00:00Z\n</code></pre></p> <p>\u274c Bad IDs: <pre><code>123\ntemp_sensor\nsensor1\nurn:ngsi-ld:Entity:001  (too generic)\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#attribute-naming","title":"Attribute Naming","text":"<p>\u2705 Good Names: - <code>temperature</code> (lowercase, descriptive) - <code>batteryLevel</code> (camelCase) - <code>PM25</code> (standard abbreviation)</p> <p>\u274c Bad Names: - <code>temp</code> (abbreviation) - <code>Temperature</code> (should be lowercase) - <code>battery_level</code> (use camelCase, not snake_case)</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#use-standard-data-models","title":"Use Standard Data Models","text":"<p>Whenever possible, use FIWARE Smart Data Models:</p> <ul> <li>Air Quality: <code>AirQualityObserved</code></li> <li>Weather: <code>WeatherObserved</code></li> <li>Parking: <code>ParkingSpot</code>, <code>ParkingLot</code></li> <li>Traffic: <code>TrafficFlowObserved</code></li> <li>Waste: <code>WasteContainer</code></li> </ul>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/bring-your-own-server/3-create-entity/#409-conflict-entity-already-exists","title":"409 Conflict - Entity Already Exists","text":"<p>Problem: Entity with same ID already exists</p> <p>Solutions: 1. Use different ID 2. Delete existing entity first 3. Update existing entity instead of creating</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#400-bad-request-invalid-entity","title":"400 Bad Request - Invalid Entity","text":"<p>Problem: Entity format is invalid</p> <p>Solutions: 1. Check JSON syntax (use JSON validator) 2. Verify required fields (<code>id</code>, <code>type</code>, <code>@context</code>) 3. Check attribute structure (<code>type</code>, <code>value</code>) 4. Validate coordinates format <code>[longitude, latitude]</code></p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#422-unprocessable-entity","title":"422 Unprocessable Entity","text":"<p>Problem: Valid JSON but invalid NGSI-LD format</p> <p>Solutions: 1. Check entity type capitalization 2. Verify URN format for entity ID 3. Ensure properties have <code>type</code> and <code>value</code> 4. Check GeoJSON format for locations</p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#what-you-learned","title":"What You Learned","text":"<p>\u2705 NGSI-LD entity structure and components \u2705 How to design entity IDs and types \u2705 Property, GeoProperty, and Relationship attributes \u2705 How to create entities via API \u2705 How to query entities with filters \u2705 Standard unit codes and data models \u2705 Common entity patterns and best practices  </p>"},{"location":"getting-started/bring-your-own-server/3-create-entity/#next-step","title":"Next Step","text":"<p>Now that you can create entities, let's learn how to push data from your application:</p> <p>Step 4: Push Data \u2192</p> <p>Need to go back? Return to Step 2: Create a Service</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/","title":"Step 4: Push Data","text":"<p>Now that you have entities created, let's learn how to push real-time data from your application to SematX. This is where your application comes alive!</p> <p>\u23f1\ufe0f Time: 15-20 minutes \ud83c\udfaf Goal: Send continuous data updates from your application</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#update-vs-create","title":"Update vs Create","text":"<p>There are two ways to send data to SematX:</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#update-entity-attributes-patch","title":"Update Entity Attributes (PATCH)","text":"<p>Use when: Entity already exists, just updating values</p> <pre><code>PATCH /ngsi-ld/v1/entities/{entityId}/attrs\n</code></pre> <p>Advantages: - Faster (no full entity needed) - Updates only specified attributes - Preserves other attributes - Idempotent (safe to retry)</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#upsert-entity-post","title":"Upsert Entity (POST)","text":"<p>Use when: Entity may or may not exist</p> <pre><code>POST /ngsi-ld/v1/entityOperations/upsert\n</code></pre> <p>Advantages: - Creates entity if missing - Updates if exists - Good for batch operations - Simplified error handling</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#simple-data-push","title":"Simple Data Push","text":""},{"location":"getting-started/bring-your-own-server/4-push-data/#update-temperature-reading","title":"Update Temperature Reading","text":"<p>Let's update our temperature sensor with a new reading:</p> <pre><code>curl -X PATCH \"https://your-sematx-server.com/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101/attrs\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 24.8,\n      \"unitCode\": \"CEL\",\n      \"observedAt\": \"2025-12-02T10:15:00Z\"\n    }\n  }'\n</code></pre> <p>Response: <code>204 No Content</code> (success)</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#javascript-implementation","title":"JavaScript Implementation","text":"<pre><code>import { client } from './sematx-client.js';\n\nasync function updateTemperature(entityId, temperature) {\n  const attributes = {\n    temperature: {\n      type: 'Property',\n      value: temperature,\n      unitCode: 'CEL',\n      observedAt: new Date().toISOString()\n    }\n  };\n\n  try {\n    await client.updateEntity(entityId, attributes);\n    console.log(`\u2705 Updated ${entityId}: ${temperature}\u00b0C`);\n    return true;\n  } catch (error) {\n    console.error(`\u274c Failed to update: ${error.message}`);\n    return false;\n  }\n}\n\n// Example usage\nawait updateTemperature('urn:ngsi-ld:TemperatureSensor:room-101', 24.8);\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#python-implementation","title":"Python Implementation","text":"<pre><code>from sematx_client import client\nfrom datetime import datetime\n\ndef update_temperature(entity_id: str, temperature: float) -&gt; bool:\n    attributes = {\n        'temperature': {\n            'type': 'Property',\n            'value': temperature,\n            'unitCode': 'CEL',\n            'observedAt': datetime.utcnow().isoformat() + 'Z'\n        }\n    }\n\n    try:\n        client.update_entity(entity_id, attributes)\n        print(f'\u2705 Updated {entity_id}: {temperature}\u00b0C')\n        return True\n    except Exception as error:\n        print(f'\u274c Failed to update: {error}')\n        return False\n\n# Example usage\nupdate_temperature('urn:ngsi-ld:TemperatureSensor:room-101', 24.8)\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#continuous-data-streaming","title":"Continuous Data Streaming","text":""},{"location":"getting-started/bring-your-own-server/4-push-data/#polling-sensor-data","title":"Polling Sensor Data","text":"<p>Read from a sensor and push to SematX continuously:</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#javascript","title":"JavaScript","text":"<pre><code>import { client } from './sematx-client.js';\n\nclass SensorDataPusher {\n  constructor(entityId, intervalMs = 60000) {\n    this.entityId = entityId;\n    this.intervalMs = intervalMs;\n    this.isRunning = false;\n    this.intervalId = null;\n  }\n\n  // Simulate reading from actual sensor\n  async readSensor() {\n    // Replace with actual sensor reading logic\n    return {\n      temperature: 20 + Math.random() * 10, // 20-30\u00b0C\n      humidity: 40 + Math.random() * 30,    // 40-70%\n      pressure: 1000 + Math.random() * 30   // 1000-1030 hPa\n    };\n  }\n\n  async pushData() {\n    try {\n      const reading = await this.readSensor();\n\n      const attributes = {\n        temperature: {\n          type: 'Property',\n          value: reading.temperature,\n          unitCode: 'CEL',\n          observedAt: new Date().toISOString()\n        },\n        humidity: {\n          type: 'Property',\n          value: reading.humidity,\n          unitCode: 'P1',\n          observedAt: new Date().toISOString()\n        },\n        pressure: {\n          type: 'Property',\n          value: reading.pressure,\n          unitCode: 'PAL',\n          observedAt: new Date().toISOString()\n        }\n      };\n\n      await client.updateEntity(this.entityId, attributes);\n\n      console.log(`[${new Date().toISOString()}] Pushed data:`, {\n        temp: reading.temperature.toFixed(1),\n        humidity: reading.humidity.toFixed(1),\n        pressure: reading.pressure.toFixed(0)\n      });\n\n      return true;\n    } catch (error) {\n      console.error(`[${new Date().toISOString()}] Error:`, error.message);\n      return false;\n    }\n  }\n\n  start() {\n    if (this.isRunning) {\n      console.log('\u26a0\ufe0f Data pusher already running');\n      return;\n    }\n\n    this.isRunning = true;\n    console.log(`\ud83d\ude80 Starting data pusher (interval: ${this.intervalMs}ms)`);\n\n    // Push immediately\n    this.pushData();\n\n    // Then push at regular intervals\n    this.intervalId = setInterval(() =&gt; {\n      this.pushData();\n    }, this.intervalMs);\n  }\n\n  stop() {\n    if (!this.isRunning) {\n      return;\n    }\n\n    clearInterval(this.intervalId);\n    this.isRunning = false;\n    console.log('\ud83d\uded1 Data pusher stopped');\n  }\n}\n\n// Usage\nconst pusher = new SensorDataPusher(\n  'urn:ngsi-ld:TemperatureSensor:room-101',\n  60000  // Push every 60 seconds\n);\n\npusher.start();\n\n// Stop after 5 minutes (for demo)\nsetTimeout(() =&gt; pusher.stop(), 5 * 60 * 1000);\n\n// Graceful shutdown\nprocess.on('SIGINT', () =&gt; {\n  console.log('\\\\n\ud83d\uded1 Shutting down...');\n  pusher.stop();\n  process.exit(0);\n});\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#python","title":"Python","text":"<pre><code>import time\nimport signal\nimport random\nfrom datetime import datetime\nfrom sematx_client import client\n\nclass SensorDataPusher:\n    def __init__(self, entity_id: str, interval_seconds: int = 60):\n        self.entity_id = entity_id\n        self.interval_seconds = interval_seconds\n        self.is_running = False\n\n    def read_sensor(self) -&gt; dict:\n        \"\"\"Simulate reading from actual sensor\"\"\"\n        # Replace with actual sensor reading logic\n        return {\n            'temperature': 20 + random.random() * 10,  # 20-30\u00b0C\n            'humidity': 40 + random.random() * 30,     # 40-70%\n            'pressure': 1000 + random.random() * 30    # 1000-1030 hPa\n        }\n\n    def push_data(self) -&gt; bool:\n        \"\"\"Read sensor and push to SematX\"\"\"\n        try:\n            reading = self.read_sensor()\n\n            attributes = {\n                'temperature': {\n                    'type': 'Property',\n                    'value': reading['temperature'],\n                    'unitCode': 'CEL',\n                    'observedAt': datetime.utcnow().isoformat() + 'Z'\n                },\n                'humidity': {\n                    'type': 'Property',\n                    'value': reading['humidity'],\n                    'unitCode': 'P1',\n                    'observedAt': datetime.utcnow().isoformat() + 'Z'\n                },\n                'pressure': {\n                    'type': 'Property',\n                    'value': reading['pressure'],\n                    'unitCode': 'PAL',\n                    'observedAt': datetime.utcnow().isoformat() + 'Z'\n                }\n            }\n\n            client.update_entity(self.entity_id, attributes)\n\n            timestamp = datetime.utcnow().isoformat()\n            print(f'[{timestamp}] Pushed data:', {\n                'temp': f\"{reading['temperature']:.1f}\",\n                'humidity': f\"{reading['humidity']:.1f}\",\n                'pressure': f\"{reading['pressure']:.0f}\"\n            })\n\n            return True\n        except Exception as error:\n            timestamp = datetime.utcnow().isoformat()\n            print(f'[{timestamp}] Error: {error}')\n            return False\n\n    def start(self):\n        \"\"\"Start pushing data at regular intervals\"\"\"\n        if self.is_running:\n            print('\u26a0\ufe0f Data pusher already running')\n            return\n\n        self.is_running = True\n        print(f'\ud83d\ude80 Starting data pusher (interval: {self.interval_seconds}s)')\n\n        # Set up signal handler for graceful shutdown\n        signal.signal(signal.SIGINT, lambda s, f: self.stop())\n\n        # Push immediately\n        self.push_data()\n\n        # Then push at regular intervals\n        try:\n            while self.is_running:\n                time.sleep(self.interval_seconds)\n                if self.is_running:\n                    self.push_data()\n        except KeyboardInterrupt:\n            self.stop()\n\n    def stop(self):\n        \"\"\"Stop pushing data\"\"\"\n        if not self.is_running:\n            return\n\n        self.is_running = False\n        print('\\\\n\ud83d\uded1 Data pusher stopped')\n\n# Usage\nif __name__ == '__main__':\n    pusher = SensorDataPusher(\n        'urn:ngsi-ld:TemperatureSensor:room-101',\n        interval_seconds=60  # Push every 60 seconds\n    )\n\n    pusher.start()\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#batch-updates","title":"Batch Updates","text":"<p>For multiple entities, use batch operations:</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#update-multiple-entities","title":"Update Multiple Entities","text":"<pre><code>async function batchUpdate(updates) {\n  const payload = {\n    actionType: 'update',\n    entities: updates\n  };\n\n  const response = await fetch(\n    `${sematxConfig.url}/ngsi-ld/v1/entityOperations/upsert`,\n    {\n      method: 'POST',\n      headers: sematxConfig.headers,\n      body: JSON.stringify(payload)\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error(`Batch update failed: ${response.status}`);\n  }\n\n  const result = await response.json();\n  console.log(`\u2705 Updated ${result.success?.length || 0} entities`);\n\n  if (result.errors?.length &gt; 0) {\n    console.error(`\u274c Failed ${result.errors.length} entities`);\n  }\n}\n\n// Example: Update multiple sensors\nconst updates = [\n  {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-101',\n    type: 'TemperatureSensor',\n    temperature: { type: 'Property', value: 24.5, unitCode: 'CEL' }\n  },\n  {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-102',\n    type: 'TemperatureSensor',\n    temperature: { type: 'Property', value: 23.8, unitCode: 'CEL' }\n  },\n  {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-103',\n    type: 'TemperatureSensor',\n    temperature: { type: 'Property', value: 25.2, unitCode: 'CEL' }\n  }\n];\n\nawait batchUpdate(updates);\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#error-handling","title":"Error Handling","text":""},{"location":"getting-started/bring-your-own-server/4-push-data/#retry-with-exponential-backoff","title":"Retry with Exponential Backoff","text":"<pre><code>class DataPusher {\n  async pushWithRetry(entityId, attributes, maxRetries = 3) {\n    for (let attempt = 0; attempt &lt; maxRetries; attempt++) {\n      try {\n        await client.updateEntity(entityId, attributes);\n        return true;\n      } catch (error) {\n        if (attempt === maxRetries - 1) {\n          console.error(`\u274c Failed after ${maxRetries} attempts`);\n          throw error;\n        }\n\n        const delay = Math.pow(2, attempt) * 1000; // 1s, 2s, 4s\n        console.log(`\u26a0\ufe0f Attempt ${attempt + 1} failed, retrying in ${delay}ms...`);\n        await new Promise(resolve =&gt; setTimeout(resolve, delay));\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#queue-failed-updates","title":"Queue Failed Updates","text":"<pre><code>class DataPusher {\n  constructor(entityId) {\n    this.entityId = entityId;\n    this.failedQueue = [];\n  }\n\n  async pushData(attributes) {\n    try {\n      await client.updateEntity(this.entityId, attributes);\n\n      // If successful and queue has items, try to flush queue\n      if (this.failedQueue.length &gt; 0) {\n        await this.flushQueue();\n      }\n\n      return true;\n    } catch (error) {\n      console.error('\u274c Push failed, queueing for retry:', error.message);\n      this.failedQueue.push({ attributes, timestamp: Date.now() });\n      return false;\n    }\n  }\n\n  async flushQueue() {\n    console.log(`\ud83d\udd04 Flushing ${this.failedQueue.length} queued updates...`);\n\n    const queue = [...this.failedQueue];\n    this.failedQueue = [];\n\n    for (const item of queue) {\n      try {\n        await client.updateEntity(this.entityId, item.attributes);\n        console.log('\u2705 Queued update successful');\n      } catch (error) {\n        console.error('\u274c Queued update still failing');\n        this.failedQueue.push(item);\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#data-validation","title":"Data Validation","text":""},{"location":"getting-started/bring-your-own-server/4-push-data/#validate-before-pushing","title":"Validate Before Pushing","text":"<pre><code>function validateReading(reading) {\n  const errors = [];\n\n  // Check temperature range\n  if (reading.temperature &lt; -50 || reading.temperature &gt; 100) {\n    errors.push(`Invalid temperature: ${reading.temperature}`);\n  }\n\n  // Check humidity range\n  if (reading.humidity &lt; 0 || reading.humidity &gt; 100) {\n    errors.push(`Invalid humidity: ${reading.humidity}`);\n  }\n\n  // Check pressure range\n  if (reading.pressure &lt; 900 || reading.pressure &gt; 1100) {\n    errors.push(`Invalid pressure: ${reading.pressure}`);\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n}\n\nasync function pushValidatedData(entityId, reading) {\n  const validation = validateReading(reading);\n\n  if (!validation.isValid) {\n    console.error('\u274c Invalid reading:', validation.errors);\n    return false;\n  }\n\n  return await client.updateEntity(entityId, {\n    temperature: {\n      type: 'Property',\n      value: reading.temperature,\n      unitCode: 'CEL',\n      observedAt: new Date().toISOString()\n    },\n    humidity: {\n      type: 'Property',\n      value: reading.humidity,\n      unitCode: 'P1',\n      observedAt: new Date().toISOString()\n    },\n    pressure: {\n      type: 'Property',\n      value: reading.pressure,\n      unitCode: 'PAL',\n      observedAt: new Date().toISOString()\n    }\n  });\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/bring-your-own-server/4-push-data/#update-frequency","title":"Update Frequency","text":"<p>Guidelines: - Fast-changing data: Every 1-5 seconds (vehicle location, real-time monitoring) - Normal updates: Every 30-60 seconds (sensor readings) - Slow-changing data: Every 5-15 minutes (weather, air quality) - Rare updates: On change only (device status, configuration)</p> <p>Consider: - Rate limits on your API key - Network bandwidth - Battery life (for battery-powered devices) - Storage costs</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#timestamp-management","title":"Timestamp Management","text":"<p>Always include <code>observedAt</code> timestamp:</p> <pre><code>{\n  temperature: {\n    type: 'Property',\n    value: 24.5,\n    unitCode: 'CEL',\n    observedAt: new Date().toISOString()  // \u2705 Include timestamp\n  }\n}\n</code></pre> <p>This allows: - Temporal queries (historical data) - Out-of-order data handling - Data quality analysis - Time-series visualization</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#connection-management","title":"Connection Management","text":"<pre><code>// \u2705 Good: Reuse connections\nconst client = new SematXClient(config);\n\n// \u274c Bad: Create new connection each time\nfunction updateData() {\n  const client = new SematXClient(config); // Don't do this!\n  client.updateEntity(...)\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#monitor-performance","title":"Monitor Performance","text":"<pre><code>class DataPusher {\n  constructor() {\n    this.stats = {\n      totalPushes: 0,\n      successCount: 0,\n      errorCount: 0,\n      avgLatency: 0\n    };\n  }\n\n  async pushData(entityId, attributes) {\n    const startTime = Date.now();\n\n    try {\n      await client.updateEntity(entityId, attributes);\n\n      const latency = Date.now() - startTime;\n      this.stats.totalPushes++;\n      this.stats.successCount++;\n      this.stats.avgLatency = \n        (this.stats.avgLatency * (this.stats.totalPushes - 1) + latency) / \n        this.stats.totalPushes;\n\n      return true;\n    } catch (error) {\n      this.stats.totalPushes++;\n      this.stats.errorCount++;\n      return false;\n    }\n  }\n\n  printStats() {\n    console.log('\ud83d\udcca Statistics:');\n    console.log(`  Total pushes: ${this.stats.totalPushes}`);\n    console.log(`  Success rate: ${(this.stats.successCount / this.stats.totalPushes * 100).toFixed(1)}%`);\n    console.log(`  Avg latency: ${this.stats.avgLatency.toFixed(0)}ms`);\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/4-push-data/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/bring-your-own-server/4-push-data/#404-not-found","title":"404 Not Found","text":"<p>Problem: Entity doesn't exist</p> <p>Solution: Create entity first, or use upsert operation</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#429-too-many-requests","title":"429 Too Many Requests","text":"<p>Problem: Exceeded rate limit</p> <p>Solution: 1. Reduce update frequency 2. Implement exponential backoff 3. Request higher rate limit 4. Use batch operations</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#network-errors","title":"Network Errors","text":"<p>Problem: Connection timeout or network issues</p> <p>Solution: 1. Implement retry logic 2. Queue failed updates 3. Use circuit breaker pattern 4. Monitor network connectivity</p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#what-you-learned","title":"What You Learned","text":"<p>\u2705 How to update entity attributes \u2705 Continuous data streaming patterns \u2705 Batch update operations \u2705 Error handling and retry logic \u2705 Data validation techniques \u2705 Performance monitoring \u2705 Best practices for data pushing  </p>"},{"location":"getting-started/bring-your-own-server/4-push-data/#next-step","title":"Next Step","text":"<p>Now that data is flowing, let's create dashboard cards to visualize it:</p> <p>Step 5: Create Dashboard Cards \u2192</p> <p>Need to go back? Return to Step 3: Create Your First Entity</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/","title":"Step 5: Create Dashboard Cards","text":"<p>Now that your data is flowing into SematX, let's create visual dashboard cards to display it beautifully.</p> <p>\u23f1\ufe0f Time: 15-20 minutes \ud83c\udfaf Goal: Build interactive cards to visualize your entity data</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#what-are-dashboard-cards","title":"What are Dashboard Cards?","text":"<p>Dashboard cards are visual components that display your NGSI-LD entity data in various formats:</p> <ul> <li>\ud83d\udcca Charts: Line charts, bar charts, pie charts for trends</li> <li>\ud83d\uddfa\ufe0f Maps: Geographic visualization of GeoProperty data</li> <li>\ud83d\udcc8 Metrics: Single value display with thresholds</li> <li>\ud83d\udccb Tables: Tabular data with sorting and filtering</li> <li>\ud83c\udf9b\ufe0f Gauges: Progress bars, speedometers for ranges</li> <li>\ud83d\udcdd Lists: Entity listings with custom formatting</li> </ul>"},{"location":"getting-started/bring-your-own-server/5-create-card/#access-the-dashboard","title":"Access the Dashboard","text":"<ol> <li> <p>Log in to your SematX dashboard:    <pre><code>https://your-sematx-server.com/admin\n</code></pre></p> </li> <li> <p>Navigate to Cards in the left sidebar</p> </li> <li> <p>Click Create New button</p> </li> </ol>"},{"location":"getting-started/bring-your-own-server/5-create-card/#create-a-metric-card","title":"Create a Metric Card","text":"<p>Let's create a simple metric card to display the current temperature.</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-1-basic-information","title":"Step 1: Basic Information","text":"<p>Fill in the card details:</p> <p>Name: <code>Room 101 Temperature</code> Description (optional): <code>Current temperature reading from Room 101 sensor</code> Type: Select Metric</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-2-data-source","title":"Step 2: Data Source","text":"<p>Configure which entity to display:</p> <p>Entity Type: <code>TemperatureSensor</code> Entity ID: <code>urn:ngsi-ld:TemperatureSensor:room-101</code> Attribute: <code>temperature</code></p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-3-display-configuration","title":"Step 3: Display Configuration","text":"<p>Configure how the metric is displayed:</p> <pre><code>{\n  \"label\": \"Current Temperature\",\n  \"unit\": \"\u00b0C\",\n  \"decimals\": 1,\n  \"color\": \"#FF6B6B\",\n  \"icon\": \"thermometer\",\n  \"threshold\": {\n    \"normal\": { \"min\": 18, \"max\": 26, \"color\": \"#51CF66\" },\n    \"warning\": { \"min\": 26, \"max\": 30, \"color\": \"#FFA500\" },\n    \"critical\": { \"min\": 30, \"max\": 50, \"color\": \"#FF0000\" }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-4-layout","title":"Step 4: Layout","text":"<p>Width: Full (12 columns) Height: Medium (200px) Order: 1</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-5-save","title":"Step 5: Save","text":"<p>Click Create to save your card.</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#view-your-dashboard","title":"View Your Dashboard","text":"<ol> <li>Click Dashboard in the top navigation</li> <li>You should see your temperature card displaying the current value</li> <li>The color will change based on the threshold configuration</li> </ol> <p>Example display:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Current Temperature             \u2502\n\u2502                                  \u2502\n\u2502         24.5\u00b0C                   \u2502\n\u2502     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501         \u2502\n\u2502                                  \u2502\n\u2502  \ud83c\udf21\ufe0f Normal Range                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#create-a-chart-card","title":"Create a Chart Card","text":"<p>Now let's create a line chart to show temperature trends over time.</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-1-basic-information_1","title":"Step 1: Basic Information","text":"<p>Name: <code>Temperature Trend</code> Type: Select Chart Chart Type: Line Chart</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-2-data-source_1","title":"Step 2: Data Source","text":"<p>Entity Type: <code>TemperatureSensor</code> Entity ID: <code>urn:ngsi-ld:TemperatureSensor:room-101</code> Attributes: <code>temperature</code></p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-3-chart-configuration","title":"Step 3: Chart Configuration","text":"<pre><code>{\n  \"timeRange\": \"24h\",\n  \"refreshInterval\": 60,\n  \"xAxis\": {\n    \"label\": \"Time\",\n    \"type\": \"time\"\n  },\n  \"yAxis\": {\n    \"label\": \"Temperature (\u00b0C)\",\n    \"min\": 15,\n    \"max\": 35\n  },\n  \"series\": [\n    {\n      \"name\": \"Temperature\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#FF6B6B\",\n      \"lineWidth\": 2,\n      \"showPoints\": true\n    }\n  ],\n  \"legend\": {\n    \"show\": true,\n    \"position\": \"bottom\"\n  },\n  \"tooltip\": {\n    \"enabled\": true,\n    \"format\": \"{value}\u00b0C at {time}\"\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-4-layout_1","title":"Step 4: Layout","text":"<p>Width: Full (12 columns) Height: Large (400px) Order: 2</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#result","title":"Result","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Temperature Trend (Last 24 Hours)          \u2502\n\u2502                                              \u2502\n\u2502  35\u00b0C \u2524                                      \u2502\n\u2502       \u2502              \u2571\u2572                      \u2502\n\u2502  30\u00b0C \u2524            \u2571    \u2572   \u2571\u2572              \u2502\n\u2502       \u2502          \u2571        \u2572\u2571  \u2572             \u2502\n\u2502  25\u00b0C \u2524      \u2571\u2572\u2571                \u2572           \u2502\n\u2502       \u2502    \u2571                      \u2572         \u2502\n\u2502  20\u00b0C \u2524  \u2571                          \u2572       \u2502\n\u2502       \u2502\u2571                              \u2572     \u2502\n\u2502  15\u00b0C \u2534\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2534\u2500\u2500   \u2502\n\u2502         00:00  06:00  12:00  18:00  24:00   \u2502\n\u2502                                              \u2502\n\u2502  \u2501\u2501 Temperature                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#create-a-map-card","title":"Create a Map Card","text":"<p>If your entities have location data, create a map to visualize them.</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-1-basic-information_2","title":"Step 1: Basic Information","text":"<p>Name: <code>Sensor Locations</code> Type: Select Map</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-2-data-source_2","title":"Step 2: Data Source","text":"<p>Entity Type: <code>TemperatureSensor</code> GeoProperty: <code>location</code> Filter (optional): <code>status==\"active\"</code></p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-3-map-configuration","title":"Step 3: Map Configuration","text":"<pre><code>{\n  \"center\": {\n    \"lat\": 10.0300,\n    \"lng\": 105.7800\n  },\n  \"zoom\": 15,\n  \"style\": \"streets\",\n  \"markers\": {\n    \"icon\": \"temperature\",\n    \"color\": \"dynamic\",\n    \"colorAttribute\": \"temperature\",\n    \"colorScale\": [\n      { \"value\": 20, \"color\": \"#0000FF\" },\n      { \"value\": 25, \"color\": \"#00FF00\" },\n      { \"value\": 30, \"color\": \"#FF0000\" }\n    ],\n    \"popup\": {\n      \"template\": \"&lt;b&gt;{name}&lt;/b&gt;&lt;br/&gt;Temperature: {temperature}\u00b0C&lt;br/&gt;Battery: {batteryLevel}%\"\n    }\n  },\n  \"clustering\": {\n    \"enabled\": true,\n    \"maxZoom\": 16\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#result_1","title":"Result","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \ud83d\uddfa\ufe0f  Sensor Locations                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502        \ud83d\udfe2 (5 sensors)                \u2502    \u2502\n\u2502  \u2502                                      \u2502    \u2502\n\u2502  \u2502              \ud83d\udd34                      \u2502    \u2502\n\u2502  \u2502         \ud83d\udfe1                           \u2502    \u2502\n\u2502  \u2502                   \ud83d\udfe2                 \u2502    \u2502\n\u2502  \u2502                                      \u2502    \u2502\n\u2502  \u2502    \ud83d\udfe1                                \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502  \ud83d\udd34 &gt; 30\u00b0C  \ud83d\udfe1 25-30\u00b0C  \ud83d\udfe2 &lt; 25\u00b0C           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#create-a-table-card","title":"Create a Table Card","text":"<p>Display multiple sensors in a sortable table.</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-1-basic-information_3","title":"Step 1: Basic Information","text":"<p>Name: <code>All Sensors Status</code> Type: Select Table</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-2-data-source_3","title":"Step 2: Data Source","text":"<p>Entity Type: <code>TemperatureSensor</code> Limit: 100 Sort By: <code>name</code></p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#step-3-table-configuration","title":"Step 3: Table Configuration","text":"<pre><code>{\n  \"columns\": [\n    {\n      \"field\": \"name\",\n      \"header\": \"Sensor Name\",\n      \"width\": \"40%\",\n      \"sortable\": true\n    },\n    {\n      \"field\": \"temperature\",\n      \"header\": \"Temperature\",\n      \"width\": \"20%\",\n      \"sortable\": true,\n      \"format\": \"{value}\u00b0C\",\n      \"align\": \"right\"\n    },\n    {\n      \"field\": \"batteryLevel\",\n      \"header\": \"Battery\",\n      \"width\": \"20%\",\n      \"sortable\": true,\n      \"format\": \"{value}%\",\n      \"align\": \"right\",\n      \"colorize\": {\n        \"&lt; 20\": \"#FF0000\",\n        \"&lt; 50\": \"#FFA500\",\n        \"&gt;= 50\": \"#51CF66\"\n      }\n    },\n    {\n      \"field\": \"status\",\n      \"header\": \"Status\",\n      \"width\": \"20%\",\n      \"badge\": {\n        \"active\": { \"text\": \"Active\", \"color\": \"green\" },\n        \"inactive\": { \"text\": \"Inactive\", \"color\": \"red\" },\n        \"maintenance\": { \"text\": \"Maintenance\", \"color\": \"orange\" }\n      }\n    }\n  ],\n  \"pagination\": {\n    \"enabled\": true,\n    \"pageSize\": 20\n  },\n  \"search\": {\n    \"enabled\": true,\n    \"placeholder\": \"Search sensors...\"\n  },\n  \"actions\": [\n    {\n      \"label\": \"View Details\",\n      \"icon\": \"eye\",\n      \"link\": \"/entities/{id}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#result_2","title":"Result","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  All Sensors Status                 \ud83d\udd0d Search...       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Sensor Name     \u2502 Temperature\u2502 Battery \u2502 Status      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Room 101        \u2502    24.5\u00b0C  \u2502   85%   \u2502 \ud83d\udfe2 Active   \u2502\n\u2502 Room 102        \u2502    23.8\u00b0C  \u2502   42%   \u2502 \ud83d\udfe2 Active   \u2502\n\u2502 Room 103        \u2502    25.2\u00b0C  \u2502   15%   \u2502 \ud83d\udfe0 Active   \u2502\n\u2502 Lobby           \u2502    22.1\u00b0C  \u2502   78%   \u2502 \ud83d\udfe2 Active   \u2502\n\u2502 Parking         \u2502    28.5\u00b0C  \u2502    5%   \u2502 \ud83d\udd34 Active   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502 Showing 1-5 of 12                        &lt; 1 2 3 &gt;   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#create-multi-series-chart","title":"Create Multi-Series Chart","text":"<p>Compare multiple sensors on one chart.</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#configuration","title":"Configuration","text":"<pre><code>{\n  \"title\": \"Temperature Comparison\",\n  \"timeRange\": \"24h\",\n  \"yAxis\": {\n    \"label\": \"Temperature (\u00b0C)\",\n    \"min\": 15,\n    \"max\": 35\n  },\n  \"series\": [\n    {\n      \"name\": \"Room 101\",\n      \"entityId\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#FF6B6B\"\n    },\n    {\n      \"name\": \"Room 102\",\n      \"entityId\": \"urn:ngsi-ld:TemperatureSensor:room-102\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#4ECDC4\"\n    },\n    {\n      \"name\": \"Room 103\",\n      \"entityId\": \"urn:ngsi-ld:TemperatureSensor:room-103\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#95E1D3\"\n    }\n  ],\n  \"legend\": {\n    \"show\": true,\n    \"position\": \"bottom\"\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#real-time-updates","title":"Real-Time Updates","text":""},{"location":"getting-started/bring-your-own-server/5-create-card/#enable-auto-refresh","title":"Enable Auto-Refresh","text":"<p>Configure cards to update automatically:</p> <pre><code>{\n  \"autoRefresh\": {\n    \"enabled\": true,\n    \"interval\": 30,\n    \"showIndicator\": true\n  }\n}\n</code></pre> <p>Intervals: - 10 seconds: Real-time critical data - 30 seconds: Active monitoring - 60 seconds: Normal updates - 5 minutes: Slow-changing data</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#websocket-subscriptions","title":"WebSocket Subscriptions","text":"<p>For instant updates, enable WebSocket subscriptions:</p> <pre><code>{\n  \"realtime\": {\n    \"enabled\": true,\n    \"transport\": \"websocket\",\n    \"fallbackInterval\": 60\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#card-layouts","title":"Card Layouts","text":""},{"location":"getting-started/bring-your-own-server/5-create-card/#grid-system","title":"Grid System","text":"<p>Dashboard uses a 12-column grid:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Card A (12 cols)                         \u2502  Full width\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Card B (6 cols)      \u2502 Card C (6 cols)   \u2502  Half width each\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Card D (4 cols) \u2502 E (4 cols) \u2502 F (4)     \u2502  Third width each\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"getting-started/bring-your-own-server/5-create-card/#responsive-layouts","title":"Responsive Layouts","text":"<p>Cards adapt to screen size:</p> <ul> <li>Desktop: Full grid layout</li> <li>Tablet: 6-12 columns</li> <li>Mobile: Stacked (all 12 columns)</li> </ul>"},{"location":"getting-started/bring-your-own-server/5-create-card/#dashboard-organization","title":"Dashboard Organization","text":""},{"location":"getting-started/bring-your-own-server/5-create-card/#create-multiple-dashboards","title":"Create Multiple Dashboards","text":"<p>Organize cards into different dashboards:</p> <ul> <li>Overview: High-level metrics and KPIs</li> <li>Monitoring: Detailed charts and tables</li> <li>Locations: Map-based views</li> <li>Alerts: Status and notification cards</li> </ul>"},{"location":"getting-started/bring-your-own-server/5-create-card/#share-dashboards","title":"Share Dashboards","text":"<p>Share dashboards with team members:</p> <ol> <li>Click Share button on dashboard</li> <li>Set permissions: View only or Edit</li> <li>Generate share link</li> <li>Set expiration date (optional)</li> </ol>"},{"location":"getting-started/bring-your-own-server/5-create-card/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/bring-your-own-server/5-create-card/#performance","title":"Performance","text":"<p>\u2705 Do: - Limit entities per card (&lt; 100 for tables) - Use reasonable refresh intervals (\u2265 30s) - Enable pagination for large datasets - Cache frequently accessed data</p> <p>\u274c Don't: - Load thousands of entities in one card - Refresh every second (causes high load) - Create too many real-time subscriptions - Use complex queries in high-frequency cards</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#user-experience","title":"User Experience","text":"<p>\u2705 Do: - Use consistent color schemes - Provide clear labels and units - Show loading states - Handle errors gracefully - Use appropriate chart types for data</p> <p>\u274c Don't: - Use too many colors (&lt; 5 per chart) - Overcrowd dashboards (&lt; 10 cards) - Use misleading visualizations - Ignore mobile responsiveness</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#data-visualization","title":"Data Visualization","text":"<p>Choose the right card type:</p> Data Type Best Card Type Single value Metric Trend over time Line chart Comparison Bar chart Proportion Pie chart Geographic Map Multiple entities Table Ranges Gauge"},{"location":"getting-started/bring-your-own-server/5-create-card/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/bring-your-own-server/5-create-card/#card-shows-no-data","title":"Card Shows \"No Data\"","text":"<p>Problem: Card displays \"No data available\"</p> <p>Solutions: 1. Check entity exists: Verify entity ID is correct 2. Check permissions: Ensure API key has read access 3. Check service: Verify correct NGSILD-Tenant 4. Check attribute: Ensure attribute name matches entity</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#card-not-updating","title":"Card Not Updating","text":"<p>Problem: Card shows old data</p> <p>Solutions: 1. Check refresh interval: May be too long 2. Check entity updates: Verify data is being pushed 3. Clear cache: Refresh browser or clear cache 4. Check WebSocket: Connection may be dropped</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#performance-issues","title":"Performance Issues","text":"<p>Problem: Dashboard loads slowly</p> <p>Solutions: 1. Reduce entity count: Limit queries with pagination 2. Increase refresh interval: Reduce update frequency 3. Optimize queries: Use filters to reduce data 4. Split dashboards: Create multiple focused dashboards</p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#what-you-learned","title":"What You Learned","text":"<p>\u2705 How to create different types of dashboard cards \u2705 How to configure card data sources \u2705 How to customize card appearance \u2705 Real-time update patterns \u2705 Dashboard organization strategies \u2705 Performance optimization techniques \u2705 Best practices for data visualization  </p>"},{"location":"getting-started/bring-your-own-server/5-create-card/#next-step","title":"Next Step","text":"<p>Now let's set up subscriptions to receive real-time notifications:</p> <p>Step 6: Set Up Subscriptions \u2192</p> <p>Need to go back? Return to Step 4: Push Data</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/","title":"Step 6: Set Up Subscriptions","text":"<p>Subscriptions allow your application to receive real-time notifications when entities change. Instead of constantly polling for updates, SematX will push changes to you!</p> <p>\u23f1\ufe0f Time: 15-20 minutes \ud83c\udfaf Goal: Set up webhooks to receive real-time entity notifications</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#what-are-subscriptions","title":"What are Subscriptions?","text":"<p>NGSI-LD Subscriptions are a powerful feature that:</p> <ul> <li>Monitor entity changes automatically</li> <li>Send HTTP POST notifications to your endpoint</li> <li>Filter by entity type, attributes, or conditions</li> <li>Support multiple notification formats</li> <li>Enable event-driven architectures</li> </ul>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#use-cases","title":"Use Cases","text":"<ul> <li>Alert Systems: Notify when sensor exceeds threshold</li> <li>Data Pipelines: Trigger processing when data arrives</li> <li>Integrations: Sync with external systems</li> <li>Dashboards: Real-time updates without polling</li> <li>Logging: Audit trail of all changes</li> </ul>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#how-subscriptions-work","title":"How Subscriptions Work","text":"<pre><code>1. Create Subscription\n   \u2514\u2500&gt; Define what to watch (entity type, attributes)\n   \u2514\u2500&gt; Specify webhook URL\n   \u2514\u2500&gt; Set conditions (optional)\n\n2. Entity Changes\n   \u2514\u2500&gt; User/Device updates entity\n   \u2514\u2500&gt; Orion-LD detects change\n\n3. Notification Sent\n   \u2514\u2500&gt; HTTP POST to your webhook\n   \u2514\u2500&gt; Contains entity data\n   \u2514\u2500&gt; Includes change information\n\n4. Your Application\n   \u2514\u2500&gt; Receives notification\n   \u2514\u2500&gt; Processes data\n   \u2514\u2500&gt; Takes action\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#prerequisites","title":"Prerequisites","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#set-up-webhook-endpoint","title":"Set Up Webhook Endpoint","text":"<p>You need a publicly accessible HTTPS endpoint to receive notifications.</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#option-1-use-webhooksite-testing","title":"Option 1: Use webhook.site (Testing)","text":"<p>For testing, use webhook.site:</p> <ol> <li>Go to https://webhook.site</li> <li>You'll get a unique URL like:    <pre><code>https://webhook.site/12345678-1234-1234-1234-123456789abc\n</code></pre></li> <li>Use this URL for your subscription</li> <li>View received notifications in real-time</li> </ol>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#option-2-ngrok-local-development","title":"Option 2: ngrok (Local Development)","text":"<p>Expose your local server to the internet:</p> <pre><code># Install ngrok\n# Download from https://ngrok.com/download\n\n# Start your local server\nnode server.js  # Port 3000\n\n# In another terminal, expose it\nngrok http 3000\n\n# Use the HTTPS URL provided:\n# https://abc123.ngrok.io/webhook\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#option-3-production-webhook","title":"Option 3: Production Webhook","text":"<p>Deploy a webhook endpoint on your server:</p> <pre><code>// webhook-server.js\nconst express = require('express');\nconst app = express();\n\napp.use(express.json());\n\napp.post('/webhook', (req, res) =&gt; {\n  console.log('Received notification:', JSON.stringify(req.body, null, 2));\n\n  // Process the notification\n  const notification = req.body;\n  notification.data.forEach(entity =&gt; {\n    console.log(`Entity ${entity.id} changed`);\n    // Your logic here\n  });\n\n  // Always respond quickly (within 5 seconds)\n  res.status(200).send('OK');\n});\n\napp.listen(3000, () =&gt; {\n  console.log('Webhook server listening on port 3000');\n});\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#create-a-simple-subscription","title":"Create a Simple Subscription","text":"<p>Let's create a subscription to monitor temperature sensors.</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#subscription-structure","title":"Subscription Structure","text":"<pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Notify on temperature sensor changes\",\n  \"entities\": [\n    {\n      \"type\": \"TemperatureSensor\"\n    }\n  ],\n  \"watchedAttributes\": [\"temperature\"],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook-url.com/webhook\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#create-via-api","title":"Create via API","text":"<pre><code>curl -X POST \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"@context\": \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\",\n    \"type\": \"Subscription\",\n    \"description\": \"Temperature sensor monitoring\",\n    \"entities\": [\n      {\n        \"type\": \"TemperatureSensor\"\n      }\n    ],\n    \"watchedAttributes\": [\"temperature\"],\n    \"notification\": {\n      \"endpoint\": {\n        \"uri\": \"https://webhook.site/your-unique-id\",\n        \"accept\": \"application/json\"\n      }\n    }\n  }'\n</code></pre> <p>Response: <pre><code>HTTP/1.1 201 Created\nLocation: /ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#save-subscription-id","title":"Save Subscription ID","text":"<p>Extract the subscription ID from the <code>Location</code> header: <pre><code>urn:ngsi-ld:Subscription:12345\n</code></pre></p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#test-your-subscription","title":"Test Your Subscription","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#trigger-a-notification","title":"Trigger a Notification","text":"<p>Update an entity to trigger the subscription:</p> <pre><code>curl -X PATCH \"https://your-sematx-server.com/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101/attrs\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 27.5,\n      \"unitCode\": \"CEL\"\n    }\n  }'\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#check-webhook","title":"Check Webhook","text":"<p>Your webhook should receive a notification like:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Notification:123456\",\n  \"type\": \"Notification\",\n  \"subscriptionId\": \"urn:ngsi-ld:Subscription:12345\",\n  \"notifiedAt\": \"2025-12-02T10:30:00.000Z\",\n  \"data\": [\n    {\n      \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n      \"type\": \"TemperatureSensor\",\n      \"temperature\": {\n        \"type\": \"Property\",\n        \"value\": 27.5,\n        \"unitCode\": \"CEL\",\n        \"observedAt\": \"2025-12-02T10:30:00Z\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#advanced-subscriptions","title":"Advanced Subscriptions","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#condition-based-notifications","title":"Condition-Based Notifications","text":"<p>Only notify when temperature exceeds 30\u00b0C:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"High temperature alert\",\n  \"entities\": [{\"type\": \"TemperatureSensor\"}],\n  \"watchedAttributes\": [\"temperature\"],\n  \"q\": \"temperature&gt;30\",\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/high-temp-alert\",\n      \"accept\": \"application/json\"\n    },\n    \"attributes\": [\"temperature\", \"location\", \"name\"]\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#multiple-entity-types","title":"Multiple Entity Types","text":"<p>Monitor different entity types:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Environmental monitoring\",\n  \"entities\": [\n    {\"type\": \"TemperatureSensor\"},\n    {\"type\": \"HumiditySensor\"},\n    {\"type\": \"AirQualityObserved\"}\n  ],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/environmental\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#specific-entity","title":"Specific Entity","text":"<p>Monitor a single entity:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Room 101 monitoring\",\n  \"entities\": [\n    {\n      \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\"\n    }\n  ],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/room-101\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#geographic-subscription","title":"Geographic Subscription","text":"<p>Notify for entities in a specific area:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Downtown area sensors\",\n  \"entities\": [{\"type\": \"TemperatureSensor\"}],\n  \"geoQ\": {\n    \"georel\": \"within\",\n    \"geometry\": \"Polygon\",\n    \"coordinates\": [\n      [\n        [105.7700, 10.0200],\n        [105.7900, 10.0200],\n        [105.7900, 10.0400],\n        [105.7700, 10.0400],\n        [105.7700, 10.0200]\n      ]\n    ]\n  },\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/downtown\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#throttling","title":"Throttling","text":"<p>Limit notification frequency:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"throttling\": 60,\n  \"entities\": [{\"type\": \"TemperatureSensor\"}],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/throttled\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre> <p>This limits notifications to once per 60 seconds, even if entities change more frequently.</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#process-notifications","title":"Process Notifications","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#javascriptnodejs-webhook","title":"JavaScript/Node.js Webhook","text":"<pre><code>const express = require('express');\nconst app = express();\n\napp.use(express.json());\n\n// Notification handler\napp.post('/webhook', async (req, res) =&gt; {\n  try {\n    const notification = req.body;\n\n    console.log(`Received notification: ${notification.id}`);\n    console.log(`Subscription: ${notification.subscriptionId}`);\n    console.log(`Time: ${notification.notifiedAt}`);\n\n    // Process each entity in the notification\n    for (const entity of notification.data) {\n      await processEntity(entity);\n    }\n\n    // IMPORTANT: Respond quickly (&lt; 5 seconds)\n    res.status(200).send('OK');\n\n  } catch (error) {\n    console.error('Error processing notification:', error);\n    res.status(500).send('Error');\n  }\n});\n\nasync function processEntity(entity) {\n  console.log(`Processing entity: ${entity.id}`);\n\n  // Example: Temperature alert\n  if (entity.type === 'TemperatureSensor') {\n    const temp = entity.temperature?.value;\n\n    if (temp &gt; 30) {\n      await sendAlert({\n        level: 'warning',\n        message: `High temperature: ${temp}\u00b0C`,\n        entityId: entity.id\n      });\n    }\n  }\n\n  // Store in database\n  await saveToDatabase(entity);\n\n  // Trigger other actions\n  await updateDashboard(entity);\n}\n\nasync function sendAlert(alert) {\n  // Send email, SMS, push notification, etc.\n  console.log('ALERT:', alert.message);\n}\n\nasync function saveToDatabase(entity) {\n  // Save to your database\n  console.log('Saving entity to database');\n}\n\nasync function updateDashboard(entity) {\n  // Update real-time dashboard\n  console.log('Updating dashboard');\n}\n\napp.listen(3000, () =&gt; {\n  console.log('Webhook server running on port 3000');\n});\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#python-webhook-flask","title":"Python Webhook (Flask)","text":"<pre><code>from flask import Flask, request, jsonify\nimport logging\n\napp = Flask(__name__)\nlogging.basicConfig(level=logging.INFO)\n\n@app.route('/webhook', methods=['POST'])\ndef webhook():\n    try:\n        notification = request.json\n\n        logging.info(f\"Received notification: {notification['id']}\")\n        logging.info(f\"Subscription: {notification['subscriptionId']}\")\n        logging.info(f\"Time: {notification['notifiedAt']}\")\n\n        # Process each entity\n        for entity in notification['data']:\n            process_entity(entity)\n\n        # IMPORTANT: Respond quickly (&lt; 5 seconds)\n        return jsonify({'status': 'ok'}), 200\n\n    except Exception as error:\n        logging.error(f\"Error processing notification: {error}\")\n        return jsonify({'status': 'error'}), 500\n\ndef process_entity(entity):\n    logging.info(f\"Processing entity: {entity['id']}\")\n\n    # Example: Temperature alert\n    if entity['type'] == 'TemperatureSensor':\n        temp = entity.get('temperature', {}).get('value')\n\n        if temp and temp &gt; 30:\n            send_alert({\n                'level': 'warning',\n                'message': f\"High temperature: {temp}\u00b0C\",\n                'entity_id': entity['id']\n            })\n\n    # Store in database\n    save_to_database(entity)\n\n    # Trigger other actions\n    update_dashboard(entity)\n\ndef send_alert(alert):\n    # Send email, SMS, push notification, etc.\n    logging.warning(f\"ALERT: {alert['message']}\")\n\ndef save_to_database(entity):\n    # Save to your database\n    logging.info(\"Saving entity to database\")\n\ndef update_dashboard(entity):\n    # Update real-time dashboard\n    logging.info(\"Updating dashboard\")\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=3000)\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#manage-subscriptions","title":"Manage Subscriptions","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#list-all-subscriptions","title":"List All Subscriptions","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#get-subscription-details","title":"Get Subscription Details","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#update-subscription","title":"Update Subscription","text":"<pre><code>curl -X PATCH \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"throttling\": 120,\n    \"description\": \"Updated subscription with 2-minute throttling\"\n  }'\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#delete-subscription","title":"Delete Subscription","text":"<pre><code>curl -X DELETE \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#webhook-design","title":"Webhook Design","text":"<p>\u2705 Do: - Respond within 5 seconds - Return 200 OK even if processing fails - Process notifications asynchronously - Implement idempotency (handle duplicates) - Log all notifications - Monitor webhook health</p> <p>\u274c Don't: - Do heavy processing in webhook handler - Return errors for transient issues - Assume notifications arrive in order - Ignore notification IDs - Block the response</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#security","title":"Security","text":"<p>Verify Notifications:</p> <pre><code>// Add custom header verification\napp.post('/webhook', (req, res) =&gt; {\n  const secret = req.headers['x-subscription-secret'];\n\n  if (secret !== process.env.WEBHOOK_SECRET) {\n    return res.status(401).send('Unauthorized');\n  }\n\n  // Process notification\n});\n</code></pre> <p>Use HTTPS: Always use HTTPS for webhook endpoints</p> <p>Implement Authentication: Add Bearer token or API key</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#error-handling","title":"Error Handling","text":"<p>Retry Logic: SematX will retry failed notifications:</p> <ul> <li>1st retry: After 5 seconds</li> <li>2nd retry: After 30 seconds</li> <li>3rd retry: After 2 minutes</li> <li>Then gives up</li> </ul> <p>Handle Failures Gracefully:</p> <pre><code>app.post('/webhook', async (req, res) =&gt; {\n  // Respond immediately\n  res.status(200).send('OK');\n\n  // Process asynchronously\n  processNotification(req.body)\n    .catch(error =&gt; {\n      console.error('Processing failed:', error);\n      // Store for manual retry\n      saveFailedNotification(req.body);\n    });\n});\n</code></pre>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#performance","title":"Performance","text":"<p>Use Throttling: Prevent notification flooding</p> <p>Filter Aggressively: Only subscribe to what you need</p> <p>Batch Processing: Process multiple notifications together</p> <p>Scale Webhooks: Use load balancers for high volume</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#not-receiving-notifications","title":"Not Receiving Notifications","text":"<p>Problem: Webhook never receives notifications</p> <p>Solutions: 1. Check webhook URL: Must be publicly accessible 2. Check HTTPS: Must use HTTPS (or HTTP for localhost) 3. Test webhook: Use curl to POST manually 4. Check firewall: May block incoming requests 5. Check subscription: Verify it's active 6. Trigger changes: Update an entity to test</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#duplicate-notifications","title":"Duplicate Notifications","text":"<p>Problem: Receiving same notification multiple times</p> <p>Solutions: 1. Implement idempotency: Check notification ID 2. Expected behavior: Retries can cause duplicates 3. Store processed IDs: Track what you've processed</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#missing-notifications","title":"Missing Notifications","text":"<p>Problem: Some notifications not received</p> <p>Solutions: 1. Check throttling: May be limiting notifications 2. Check webhook response: Must return 200 OK 3. Check timeout: Respond within 5 seconds 4. Check conditions: May not match entity changes</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#what-you-learned","title":"What You Learned","text":"<p>\u2705 How NGSI-LD subscriptions work \u2705 How to create subscriptions via API \u2705 How to build webhook endpoints \u2705 Advanced subscription patterns \u2705 How to process notifications \u2705 Error handling and retry logic \u2705 Best practices for production webhooks  </p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#congratulations","title":"Congratulations! \ud83c\udf89","text":"<p>You've completed the \"Bring Your Own Server\" tutorial!</p> <p>You now know how to: - \u2705 Create a SematX account and generate API keys - \u2705 Configure services for your application - \u2705 Create and manage NGSI-LD entities - \u2705 Push real-time data from your application - \u2705 Build beautiful dashboard cards - \u2705 Set up subscriptions for event-driven architecture</p>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#next-steps","title":"Next Steps","text":""},{"location":"getting-started/bring-your-own-server/6-subscriptions/#learn-more","title":"Learn More","text":"<ul> <li>Core Concepts - Deep dive into SematX architecture</li> <li>Troubleshooting - Common issues and solutions</li> <li>Deployment Guide - Deploy SematX to production</li> </ul>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#build-something","title":"Build Something","text":"<ul> <li>Development Guide - Extend and customize LegoCity</li> <li>Custom Blocks - Extend the dashboard</li> <li>Plugins - Add custom features</li> </ul>"},{"location":"getting-started/bring-your-own-server/6-subscriptions/#get-help","title":"Get Help","text":"<ul> <li>GitHub Discussions: Ask questions</li> <li>GitHub Issues: Report bugs</li> <li>Documentation: Browse docs</li> </ul> <p>Happy building with SematX! \ud83d\ude80</p> <p>Need to go back? Return to Step 5: Create Dashboard Cards</p>"},{"location":"getting-started/start-server/","title":"Start a Local Server","text":"<p>This tutorial will guide you through running SematX on your local machine using Docker. This is the fastest way to get started and explore the platform.</p> <p>\u23f1\ufe0f Estimated Time: 10-15 minutes \ud83d\udcbb Requirements: Docker Desktop \ud83c\udfaf Goal: Run SematX locally and create your first entity</p>"},{"location":"getting-started/start-server/#what-youll-build","title":"What You'll Build","text":"<p>By the end of this tutorial, you'll have: - A fully functional SematX instance running locally - Access to the Lego Dashboard web interface - Your first NGSI-LD entity created - A dashboard card visualizing your data</p>"},{"location":"getting-started/start-server/#prerequisites","title":"Prerequisites","text":""},{"location":"getting-started/start-server/#install-docker-desktop","title":"Install Docker Desktop","text":"<p>Docker Desktop includes Docker Engine and Docker Compose, which you'll need to run SematX.</p> <p>Download Docker Desktop: - Windows: Download Docker Desktop for Windows - Mac: Download Docker Desktop for Mac - Linux: Install Docker Engine and Docker Compose</p> <p>Verify Installation:</p> <p>Open a terminal and run:</p> <pre><code>docker --version\ndocker compose version\n</code></pre> <p>You should see output like: <pre><code>Docker version 24.0.0\nDocker Compose version v2.20.0\n</code></pre></p>"},{"location":"getting-started/start-server/#install-git","title":"Install Git","text":"<p>You'll need Git to clone the SematX repository.</p> <p>Download Git: https://git-scm.com/downloads</p> <p>Verify Installation:</p> <pre><code>git --version\n</code></pre>"},{"location":"getting-started/start-server/#step-1-clone-the-repository","title":"Step 1: Clone the Repository","text":"<p>Open a terminal and clone the SematX repository:</p> <pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity\n</code></pre>"},{"location":"getting-started/start-server/#step-2-configure-environment-variables","title":"Step 2: Configure Environment Variables","text":"<p>Create a <code>.env</code> file in the root directory:</p> <pre><code># Copy the example environment file\ncp .env.example .env\n</code></pre> <p>Edit the <code>.env</code> file with your preferred text editor:</p> <pre><code># For VS Code\ncode .env\n\n# For nano\nnano .env\n\n# For vim\nvim .env\n</code></pre> <p>Minimum Required Configuration:</p> <pre><code># Database\nDATABASE_URI=mongodb://mongodb:27017/payload\nMONGODB_URL=mongodb://mongodb:27017\n\n# Payload CMS\nPAYLOAD_SECRET=your-secret-key-here-change-this\nPAYLOAD_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Orion-LD\nORION_URL=http://orion:1026\n\n# Optional: AI Features\nOPENROUTER_API_KEY=your-api-key-if-using-ai\n</code></pre> <p>Important: Change <code>PAYLOAD_SECRET</code> to a random string. You can generate one with:</p> <pre><code># On Linux/Mac\nopenssl rand -base64 32\n\n# On Windows (PowerShell)\n[Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Minimum 0 -Maximum 255 }))\n</code></pre>"},{"location":"getting-started/start-server/#step-3-start-the-services","title":"Step 3: Start the Services","text":"<p>Start all SematX services using Docker Compose:</p> <pre><code>docker compose up -d\n</code></pre> <p>This command will: 1. Pull the required Docker images (first time only) 2. Create and start containers for:    - MongoDB (database)    - Orion-LD (context broker)    - Nginx (API gateway)    - Dashboard (PayloadCMS)</p> <p>Expected Output: <pre><code>[+] Running 5/5\n \u2714 Network legocity_default      Created\n \u2714 Container legocity-mongodb-1  Started\n \u2714 Container legocity-orion-1    Started\n \u2714 Container legocity-dashboard-1 Started\n \u2714 Container legocity-nginx-1    Started\n</code></pre></p> <p>Check Service Status:</p> <pre><code>docker compose ps\n</code></pre> <p>All services should show \"Up\" status:</p> <pre><code>NAME                    STATUS\nlegocity-mongodb-1      Up\nlegocity-orion-1        Up\nlegocity-dashboard-1    Up\nlegocity-nginx-1        Up\n</code></pre>"},{"location":"getting-started/start-server/#step-4-access-the-dashboard","title":"Step 4: Access the Dashboard","text":"<p>Open your browser and navigate to:</p> <pre><code>http://localhost:3000/admin\n</code></pre>"},{"location":"getting-started/start-server/#create-your-admin-account","title":"Create Your Admin Account","text":"<p>On first visit, you'll see the account creation screen:</p> <ol> <li>Email: Enter your email address</li> <li>Password: Create a secure password (min 8 characters)</li> <li>Confirm Password: Re-enter your password</li> <li>Name (optional): Your full name</li> </ol> <p>Click Create First User to create your admin account.</p>"},{"location":"getting-started/start-server/#log-in","title":"Log In","text":"<p>After creating your account, log in with your credentials:</p> <pre><code>http://localhost:3000/admin/login\n</code></pre>"},{"location":"getting-started/start-server/#step-5-create-your-first-entity","title":"Step 5: Create Your First Entity","text":"<p>Now that you're logged in, let's create your first NGSI-LD entity using the API.</p>"},{"location":"getting-started/start-server/#generate-an-api-key","title":"Generate an API Key","text":"<ol> <li>In the dashboard, click API Keys in the left sidebar</li> <li>Click Create New</li> <li>Fill in the details:</li> <li>Name: \"My First API Key\"</li> <li>Expires: Select an expiration date (or leave blank for no expiration)</li> <li>Permissions: Select \"Full Access\" for now</li> <li>Click Create</li> <li>Copy the API key - you won't be able to see it again!</li> </ol>"},{"location":"getting-started/start-server/#create-an-entity-via-api","title":"Create an Entity via API","text":"<p>Open a new terminal and use curl to create an entity:</p> <pre><code>curl -X POST http://localhost:1026/ngsi-ld/v1/entities \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"id\": \"urn:ngsi-ld:TemperatureSensor:001\",\n    \"type\": \"TemperatureSensor\",\n    \"@context\": [\n      \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n    ],\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 23.5,\n      \"unitCode\": \"CEL\"\n    },\n    \"location\": {\n      \"type\": \"GeoProperty\",\n      \"value\": {\n        \"type\": \"Point\",\n        \"coordinates\": [105.7800, 10.0300]\n      }\n    },\n    \"name\": {\n      \"type\": \"Property\",\n      \"value\": \"Temperature Sensor - Room 101\"\n    }\n  }'\n</code></pre> <p>Replace <code>YOUR_API_KEY_HERE</code> with the API key you copied earlier.</p> <p>Expected Response:</p> <pre><code>HTTP/1.1 201 Created\nLocation: /ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:001\n</code></pre>"},{"location":"getting-started/start-server/#verify-the-entity","title":"Verify the Entity","text":"<p>Query the entity to verify it was created:</p> <pre><code>curl -X GET http://localhost:1026/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:001 \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\"\n</code></pre> <p>Expected Response:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:TemperatureSensor:001\",\n  \"type\": \"TemperatureSensor\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 23.5,\n    \"unitCode\": \"CEL\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"name\": {\n    \"type\": \"Property\",\n    \"value\": \"Temperature Sensor - Room 101\"\n  }\n}\n</code></pre>"},{"location":"getting-started/start-server/#step-6-create-a-dashboard-card","title":"Step 6: Create a Dashboard Card","text":"<p>Now let's visualize this data in the dashboard.</p>"},{"location":"getting-started/start-server/#navigate-to-cards","title":"Navigate to Cards","text":"<ol> <li>In the dashboard, click Cards in the left sidebar</li> <li>Click Create New</li> </ol>"},{"location":"getting-started/start-server/#configure-the-card","title":"Configure the Card","text":"<p>Fill in the card details:</p> <ol> <li>Name: \"Room 101 Temperature\"</li> <li>Type: Select \"Metric\" (for displaying a single value)</li> <li>Entity Type: \"TemperatureSensor\"</li> <li>Entity ID: \"urn:ngsi-ld:TemperatureSensor:001\"</li> <li>Property: \"temperature\"</li> <li> <p>Configuration (JSON):    <pre><code>{\n  \"unit\": \"\u00b0C\",\n  \"label\": \"Current Temperature\",\n  \"color\": \"#FF6B6B\",\n  \"threshold\": {\n    \"warning\": 30,\n    \"critical\": 35\n  }\n}\n</code></pre></p> </li> <li> <p>Click Create</p> </li> </ol>"},{"location":"getting-started/start-server/#view-your-dashboard","title":"View Your Dashboard","text":"<ol> <li>Click Dashboard in the top navigation</li> <li>You should see your temperature card displaying \"23.5\u00b0C\"</li> </ol>"},{"location":"getting-started/start-server/#step-7-update-entity-data","title":"Step 7: Update Entity Data","text":"<p>Let's simulate a temperature change:</p> <pre><code>curl -X PATCH http://localhost:1026/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:001/attrs \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 28.3,\n      \"unitCode\": \"CEL\"\n    }\n  }'\n</code></pre> <p>Refresh your dashboard - the card should now show \"28.3\u00b0C\"!</p>"},{"location":"getting-started/start-server/#common-commands","title":"Common Commands","text":""},{"location":"getting-started/start-server/#view-logs","title":"View Logs","text":"<pre><code># All services\ndocker compose logs -f\n\n# Specific service\ndocker compose logs -f dashboard\ndocker compose logs -f orion\n</code></pre>"},{"location":"getting-started/start-server/#stop-services","title":"Stop Services","text":"<pre><code># Stop all services (keeps data)\ndocker compose stop\n\n# Stop and remove containers (keeps data)\ndocker compose down\n\n# Stop and remove everything including data\ndocker compose down -v\n</code></pre>"},{"location":"getting-started/start-server/#restart-services","title":"Restart Services","text":"<pre><code># Restart all services\ndocker compose restart\n\n# Restart specific service\ndocker compose restart dashboard\n</code></pre>"},{"location":"getting-started/start-server/#access-mongodb","title":"Access MongoDB","text":"<pre><code># Open MongoDB shell\ndocker compose exec mongodb mongosh\n\n# List databases\nshow dbs\n\n# Use Orion database\nuse orion\n\n# List collections\nshow collections\n\n# Query entities\ndb.entities.find().pretty()\n</code></pre>"},{"location":"getting-started/start-server/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/start-server/#port-already-in-use","title":"Port Already in Use","text":"<p>If you see an error like \"port is already allocated\":</p> <pre><code># Find which process is using port 3000\n# On Linux/Mac\nlsof -i :3000\n\n# On Windows\nnetstat -ano | findstr :3000\n\n# Change the port in docker-compose.yml\n# Or stop the conflicting service\n</code></pre>"},{"location":"getting-started/start-server/#services-wont-start","title":"Services Won't Start","text":"<pre><code># Check service logs\ndocker compose logs\n\n# Remove and recreate containers\ndocker compose down\ndocker compose up -d\n\n# Rebuild images if needed\ndocker compose build --no-cache\ndocker compose up -d\n</code></pre>"},{"location":"getting-started/start-server/#cant-access-dashboard","title":"Can't Access Dashboard","text":"<ol> <li>Check services are running: <code>docker compose ps</code></li> <li>Check logs: <code>docker compose logs dashboard</code></li> <li>Verify port mapping: Dashboard should be on <code>localhost:3000</code></li> <li>Try different browser: Clear cache or use incognito mode</li> </ol>"},{"location":"getting-started/start-server/#api-returns-401-unauthorized","title":"API Returns 401 Unauthorized","text":"<ol> <li>Check API key: Make sure you copied it correctly</li> <li>Check expiration: API key might have expired</li> <li>Create new key: Generate a fresh API key from dashboard</li> </ol>"},{"location":"getting-started/start-server/#next-steps","title":"Next Steps","text":"<p>Congratulations! You now have SematX running locally. Here's what to explore next:</p>"},{"location":"getting-started/start-server/#learn-core-concepts","title":"Learn Core Concepts","text":"<ul> <li>Understanding Orion Nginx</li> <li>Lego Dashboard Internals</li> </ul>"},{"location":"getting-started/start-server/#build-something","title":"Build Something","text":"<ul> <li>Create More Entities</li> <li>Set Up Subscriptions</li> <li>Build Custom Dashboards</li> </ul>"},{"location":"getting-started/start-server/#deploy-to-production","title":"Deploy to Production","text":"<ul> <li>Bring Your Own Server</li> <li>Deployment Guide</li> </ul>"},{"location":"getting-started/start-server/#what-you-learned","title":"What You Learned","text":"<p>\u2705 How to install Docker and Docker Compose \u2705 How to start SematX services locally \u2705 How to access the Lego Dashboard \u2705 How to create NGSI-LD entities via API \u2705 How to build dashboard cards for visualization \u2705 How to update entity data in real-time \u2705 Basic Docker Compose commands for managing services  </p>"},{"location":"getting-started/start-server/#clean-up","title":"Clean Up","text":"<p>When you're done experimenting, you can stop and remove all services:</p> <pre><code># Stop services but keep data\ndocker compose down\n\n# Remove everything including data volumes\ndocker compose down -v\n\n# Remove downloaded images (optional)\ndocker rmi $(docker images -q fiware/orion-ld)\ndocker rmi $(docker images -q mongo)\n</code></pre> <p>Happy building with SematX! \ud83d\ude80</p>"},{"location":"installation/","title":"Installation Overview","text":"<p>LegoCity can be installed in different environments depending on your needs.</p>"},{"location":"installation/#installation-paths","title":"Installation Paths","text":""},{"location":"installation/#for-users-operators","title":"For Users &amp; Operators","text":"<p>If you want to deploy and use LegoCity:</p> <ol> <li>Quick Start - Get running in 5 minutes</li> <li>Local Installation - Full local development setup</li> <li>Production Deployment - Deploy to servers</li> </ol>"},{"location":"installation/#for-developers-contributors","title":"For Developers &amp; Contributors","text":"<p>If you want to develop and contribute to LegoCity:</p> <ol> <li>Development Environment - Complete dev setup</li> <li>Local Installation - Set up local environment</li> <li>Development Guide - Start building</li> </ol>"},{"location":"installation/#choose-your-setup","title":"Choose Your Setup","text":""},{"location":"installation/#local-development-recommended-for-development","title":"Local Development (Recommended for Development)","text":"<p>Best for: Developers, contributors, testing changes</p> <p>What you get:</p> <ul> <li>\u2705 Full control over codebase</li> <li>\u2705 Hot reload during development</li> <li>\u2705 Easy debugging</li> <li>\u2705 Run tests locally</li> </ul> <p>Requirements:</p> <ul> <li>Node.js 18+</li> <li>pnpm package manager</li> <li>MongoDB 6+</li> <li>Git</li> </ul> <p>Time to setup: ~15 minutes</p> <p>\ud83d\udc49 Local Installation Guide</p>"},{"location":"installation/#docker-compose-quickest-setup","title":"Docker Compose (Quickest Setup)","text":"<p>Best for: Quick testing, demonstrations, isolated environments</p> <p>What you get:</p> <ul> <li>\u2705 One-command setup</li> <li>\u2705 All services containerized</li> <li>\u2705 Easy cleanup</li> <li>\u2705 Reproducible environment</li> </ul> <p>Requirements:</p> <ul> <li>Docker Desktop or Docker Engine</li> <li>Docker Compose</li> </ul> <p>Time to setup: ~5 minutes</p> <p>\ud83d\udc49 Docker Setup Guide</p>"},{"location":"installation/#production-server-for-deployment","title":"Production Server (For Deployment)","text":"<p>Best for: Staging, production, public deployments</p> <p>What you get:</p> <ul> <li>\u2705 Optimized builds</li> <li>\u2705 Scalable architecture</li> <li>\u2705 Production-ready config</li> <li>\u2705 SSL/HTTPS support</li> </ul> <p>Requirements:</p> <ul> <li>Linux server (Ubuntu/Debian recommended)</li> <li>Node.js, MongoDB, Nginx</li> <li>Domain name (optional)</li> </ul> <p>Time to setup: ~30 minutes</p> <p>\ud83d\udc49 Production Deployment Guide</p>"},{"location":"installation/#system-requirements","title":"System Requirements","text":""},{"location":"installation/#minimum-requirements","title":"Minimum Requirements","text":"Component Requirement CPU 2 cores RAM 4 GB Storage 10 GB free space OS Windows 10+, macOS 11+, Linux"},{"location":"installation/#recommended-requirements","title":"Recommended Requirements","text":"Component Requirement CPU 4+ cores RAM 8+ GB Storage 20+ GB SSD Network Stable internet connection"},{"location":"installation/#software-dependencies","title":"Software Dependencies","text":""},{"location":"installation/#required","title":"Required","text":"<ul> <li>Node.js: 18.x or 20.x (LTS versions)</li> <li>pnpm: 8.x or later</li> <li>MongoDB: 6.x or later</li> <li>Git: 2.x or later</li> </ul>"},{"location":"installation/#optional","title":"Optional","text":"<ul> <li>Docker: 24.x or later (for containerized setup)</li> <li>Nginx: 1.18+ (for production proxy)</li> <li>Redis: 7.x (for caching)</li> </ul>"},{"location":"installation/#installation-methods-comparison","title":"Installation Methods Comparison","text":"Feature Local Dev Docker Compose Production Setup Time 15 min 5 min 30 min Difficulty Medium Easy Hard Customization High Medium High Performance Best Good Best Scalability Low Low High For Development \u2705 \u26a0\ufe0f \u274c For Production \u274c \u26a0\ufe0f \u2705"},{"location":"installation/#pre-installation-checklist","title":"Pre-Installation Checklist","text":"<p>Before starting installation:</p> <ul> <li>[ ] Verify system requirements met</li> <li>[ ] Install required software (Node.js, pnpm, MongoDB)</li> <li>[ ] Have Mapbox access token ready (for maps)</li> <li>[ ] Prepare domain name (for production only)</li> <li>[ ] Review Architecture Overview</li> </ul>"},{"location":"installation/#common-installation-issues","title":"Common Installation Issues","text":""},{"location":"installation/#nodejs-version-mismatch","title":"Node.js Version Mismatch","text":"<p>Problem: Using unsupported Node.js version</p> <p>Solution:</p> <pre><code># Install nvm (Node Version Manager)\n# Then use project's node version\nnvm install 18\nnvm use 18\n</code></pre>"},{"location":"installation/#mongodb-connection-failed","title":"MongoDB Connection Failed","text":"<p>Problem: MongoDB not running or wrong connection string</p> <p>Solution:</p> <pre><code># Windows\nnet start MongoDB\n\n# Linux/macOS\nsudo systemctl start mongod\n\n# Or use Docker\ndocker run -d -p 27017:27017 mongo:6\n</code></pre>"},{"location":"installation/#port-already-in-use","title":"Port Already in Use","text":"<p>Problem: Port 3000 already occupied</p> <p>Solution:</p> <pre><code># Find and kill process\nnpx kill-port 3000\n\n# Or use different port\nPORT=3001 pnpm dev\n</code></pre>"},{"location":"installation/#pnpm-not-found","title":"pnpm Not Found","text":"<p>Problem: pnpm not installed globally</p> <p>Solution:</p> <pre><code>npm install -g pnpm\n</code></pre>"},{"location":"installation/#post-installation","title":"Post-Installation","text":"<p>After successful installation:</p> <ol> <li> <p>Verify Setup</p> </li> <li> <p>[ ] Dashboard loads at http://localhost:3000</p> </li> <li>[ ] Admin panel accessible at /admin</li> <li>[ ] Can create first user account</li> <li> <p>[ ] Maps render correctly</p> </li> <li> <p>Initial Configuration</p> </li> <li> <p>[ ] Set up admin account</p> </li> <li>[ ] Configure data sources (Configuration Guide)</li> <li> <p>[ ] Load sample data (optional)</p> </li> <li> <p>Next Steps</p> </li> <li>Read User Guide to learn features</li> <li>Explore Development Guide to customize</li> <li>Check Configuration for advanced setup</li> </ol>"},{"location":"installation/#getting-help","title":"Getting Help","text":"<p>If you encounter issues:</p> <ul> <li>\ud83d\udcd6 Troubleshooting Guide</li> <li>\ud83d\udc1b GitHub Issues</li> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udce7 Contact: CTU-SematX Team</li> </ul> <p>Ready to install? Choose your installation method:</p> <ul> <li>Local Development Setup - For developers</li> <li>Docker Setup - Quick start with containers</li> <li>Production Deployment - For staging/production</li> </ul>"},{"location":"installation/development/","title":"Development Environment Setup","text":"<p>Complete guide for setting up a development environment to contribute to LegoCity.</p>"},{"location":"installation/development/#overview","title":"Overview","text":"<p>This guide is for developers who want to:</p> <ul> <li>\ud83d\udee0\ufe0f Build new features</li> <li>\ud83d\udc1b Fix bugs and issues</li> <li>\ud83e\uddea Write and run tests</li> <li>\ud83d\udce6 Create custom blocks and plugins</li> <li>\ud83d\udd0d Debug and profile code</li> </ul>"},{"location":"installation/development/#prerequisites","title":"Prerequisites","text":""},{"location":"installation/development/#required-tools","title":"Required Tools","text":"<p>Install these before proceeding:</p> Node.js &amp; pnpmGitMongoDBVS Code (Recommended) <pre><code># Check Node.js version (need 18.x or 20.x)\nnode --version\n\n# Install pnpm globally\nnpm install -g pnpm\n\n# Verify pnpm\npnpm --version\n</code></pre> <pre><code># Check Git installation\ngit --version\n\n# Configure Git\ngit config --global user.name \"Your Name\"\ngit config --global user.email \"your.email@example.com\"\n</code></pre> <p>Option 1: Local Installation <pre><code># Windows (via Chocolatey)\nchoco install mongodb\n\n# macOS (via Homebrew)\nbrew install mongodb-community\n\n# Linux (Ubuntu/Debian)\nsudo apt install mongodb\n</code></pre></p> <p>Option 2: Docker <pre><code>docker run -d -p 27017:27017 --name mongodb mongo:6\n</code></pre></p> <p>Install Visual Studio Code with extensions:</p> <ul> <li>ESLint</li> <li>Prettier</li> <li>TypeScript and JavaScript Language Features</li> <li>Tailwind CSS IntelliSense</li> <li>MongoDB for VS Code</li> </ul>"},{"location":"installation/development/#optional-tools","title":"Optional Tools","text":"<p>Enhance your development experience:</p> <ul> <li>Docker Desktop - For containerized services</li> <li>Postman or Insomnia - API testing</li> <li>MongoDB Compass - Database GUI</li> <li>Redux DevTools - State debugging</li> </ul>"},{"location":"installation/development/#initial-setup","title":"Initial Setup","text":""},{"location":"installation/development/#1-fork-clone-repository","title":"1. Fork &amp; Clone Repository","text":"<pre><code># Fork on GitHub first, then:\ngit clone https://github.com/YOUR_USERNAME/LegoCity.git\ncd LegoCity\n\n# Add upstream remote\ngit remote add upstream https://github.com/CTU-SematX/LegoCity.git\n\n# Verify remotes\ngit remote -v\n</code></pre>"},{"location":"installation/development/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code>cd dashboard\npnpm install\n</code></pre> <p>This installs:</p> <ul> <li>Next.js framework</li> <li>PayloadCMS and plugins</li> <li>React and UI libraries</li> <li>Development tools</li> </ul>"},{"location":"installation/development/#3-set-up-environment","title":"3. Set Up Environment","text":"<pre><code># Copy example env file\ncp .env.example .env\n</code></pre> <p>Edit <code>.env</code> with development settings:</p> <pre><code># Database\nDATABASE_URI=mongodb://127.0.0.1/legocity-dev\n\n# Security (generate with: openssl rand -hex 32)\nPAYLOAD_SECRET=dev-secret-min-32-characters-long-replace-in-production\n\n# Server\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Mapbox (get token from mapbox.com)\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_token\n\n# NGSI-LD Context Broker (if running locally)\nNGSI_LD_BROKER_URL=http://localhost:1026\n\n# Development\nNODE_ENV=development\n</code></pre>"},{"location":"installation/development/#4-start-development-server","title":"4. Start Development Server","text":"<pre><code># Start with hot reload\npnpm dev\n\n# Or with turbopack (faster)\npnpm dev --turbo\n</code></pre> <p>Access at:</p> <ul> <li>Frontend: http://localhost:3000</li> <li>Admin: http://localhost:3000/admin</li> <li>API: http://localhost:3000/api</li> </ul>"},{"location":"installation/development/#5-create-admin-account","title":"5. Create Admin Account","text":"<p>On first visit to <code>/admin</code>, you'll create the first user:</p> <pre><code>Email: dev@example.com\nPassword: [choose strong password]\n</code></pre>"},{"location":"installation/development/#development-workflow","title":"Development Workflow","text":""},{"location":"installation/development/#branch-strategy","title":"Branch Strategy","text":"<pre><code># Always start from latest main\ngit checkout main\ngit pull upstream main\n\n# Create feature branch\ngit checkout -b feature/your-feature-name\n\n# Or bug fix branch\ngit checkout -b fix/issue-123\n</code></pre>"},{"location":"installation/development/#making-changes","title":"Making Changes","text":"<ol> <li>Edit Code - Make your changes in <code>dashboard/src/</code></li> <li>Hot Reload - Changes appear automatically</li> <li>Check Console - Watch for errors</li> <li>Test Changes - Verify functionality works</li> </ol>"},{"location":"installation/development/#code-style","title":"Code Style","text":"<p>LegoCity uses ESLint and Prettier:</p> <pre><code># Check linting\npnpm lint\n\n# Auto-fix issues\npnpm lint:fix\n\n# Format code\npnpm format\n</code></pre>"},{"location":"installation/development/#type-checking","title":"Type Checking","text":"<pre><code># Check TypeScript types\npnpm type-check\n\n# Build to verify no errors\npnpm build\n</code></pre>"},{"location":"installation/development/#project-structure","title":"Project Structure","text":"<pre><code>dashboard/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/              # Next.js App Router\n\u2502   \u2502   \u251c\u2500\u2500 (frontend)/   # Public pages\n\u2502   \u2502   \u2514\u2500\u2500 (payload)/    # Admin routes\n\u2502   \u251c\u2500\u2500 blocks/           # PayloadCMS blocks\n\u2502   \u251c\u2500\u2500 collections/      # Content types\n\u2502   \u251c\u2500\u2500 components/       # React components\n\u2502   \u251c\u2500\u2500 fields/           # Custom fields\n\u2502   \u251c\u2500\u2500 hooks/            # React hooks\n\u2502   \u251c\u2500\u2500 plugins/          # PayloadCMS plugins\n\u2502   \u251c\u2500\u2500 providers/        # Context providers\n\u2502   \u2514\u2500\u2500 utilities/        # Helper functions\n\u251c\u2500\u2500 public/               # Static assets\n\u251c\u2500\u2500 payload.config.ts     # CMS configuration\n\u2514\u2500\u2500 next.config.js        # Next.js config\n</code></pre>"},{"location":"installation/development/#development-tasks","title":"Development Tasks","text":""},{"location":"installation/development/#adding-a-new-block","title":"Adding a New Block","text":"<ol> <li>Create block directory:</li> </ol> <pre><code>mkdir -p src/blocks/MyBlock\n</code></pre> <ol> <li>Create config:</li> </ol> <pre><code>// src/blocks/MyBlock/config.ts\nimport { Block } from \"payload/types\";\n\nexport const MyBlock: Block = {\n  slug: \"myBlock\",\n  fields: [\n    {\n      name: \"title\",\n      type: \"text\",\n      required: true,\n    },\n  ],\n};\n</code></pre> <ol> <li>Create component:</li> </ol> <pre><code>// src/blocks/MyBlock/Component.tsx\nexport const MyBlockComponent = ({ title }) =&gt; &lt;div&gt;{title}&lt;/div&gt;;\n</code></pre> <ol> <li>Register in <code>RenderBlocks.tsx</code></li> </ol> <p>See Creating Blocks Guide for details.</p>"},{"location":"installation/development/#creating-a-collection","title":"Creating a Collection","text":"<pre><code>// src/collections/MyCollection.ts\nimport { CollectionConfig } from \"payload/types\";\n\nexport const MyCollection: CollectionConfig = {\n  slug: \"my-collection\",\n  admin: {\n    useAsTitle: \"name\",\n  },\n  fields: [\n    {\n      name: \"name\",\n      type: \"text\",\n      required: true,\n    },\n  ],\n};\n</code></pre> <p>Register in <code>payload.config.ts</code>:</p> <pre><code>collections: [\n  // ... existing\n  MyCollection,\n],\n</code></pre>"},{"location":"installation/development/#writing-tests","title":"Writing Tests","text":"<pre><code># Run all tests\npnpm test\n\n# Run specific test\npnpm test blocks\n\n# Watch mode\npnpm test:watch\n\n# Coverage report\npnpm test:coverage\n</code></pre> <p>Example test:</p> <pre><code>// src/blocks/MyBlock/MyBlock.test.ts\nimport { render } from \"@testing-library/react\";\nimport { MyBlockComponent } from \"./Component\";\n\ndescribe(\"MyBlock\", () =&gt; {\n  it(\"renders title\", () =&gt; {\n    const { getByText } = render(&lt;MyBlockComponent title=\"Test\" /&gt;);\n    expect(getByText(\"Test\")).toBeInTheDocument();\n  });\n});\n</code></pre>"},{"location":"installation/development/#debugging","title":"Debugging","text":""},{"location":"installation/development/#vs-code-debug-configuration","title":"VS Code Debug Configuration","text":"<p>Create <code>.vscode/launch.json</code>:</p> <pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Next.js: debug server-side\",\n      \"type\": \"node-terminal\",\n      \"request\": \"launch\",\n      \"command\": \"pnpm dev\"\n    },\n    {\n      \"name\": \"Next.js: debug client-side\",\n      \"type\": \"chrome\",\n      \"request\": \"launch\",\n      \"url\": \"http://localhost:3000\"\n    }\n  ]\n}\n</code></pre>"},{"location":"installation/development/#browser-devtools","title":"Browser DevTools","text":"<ul> <li>React DevTools - Inspect component tree</li> <li>Network Tab - Debug API calls</li> <li>Console - View logs and errors</li> </ul>"},{"location":"installation/development/#logging","title":"Logging","text":"<pre><code>// Development logging\nif (process.env.NODE_ENV === \"development\") {\n  console.log(\"Debug info:\", data);\n}\n\n// PayloadCMS logging\npayload.logger.info(\"Info message\");\npayload.logger.error(\"Error message\");\n</code></pre>"},{"location":"installation/development/#working-with-mongodb","title":"Working with MongoDB","text":""},{"location":"installation/development/#mongodb-compass","title":"MongoDB Compass","text":"<p>Connect to: <code>mongodb://127.0.0.1:27017/legocity-dev</code></p> <p>View and edit:</p> <ul> <li>Collections (Pages, Posts, Media, etc.)</li> <li>Documents</li> <li>Indexes</li> </ul>"},{"location":"installation/development/#command-line","title":"Command Line","text":"<pre><code># Connect to database\nmongosh legocity-dev\n\n# List collections\nshow collections\n\n# Find documents\ndb.pages.find().pretty()\n\n# Clear collection\ndb.pages.deleteMany({})\n</code></pre>"},{"location":"installation/development/#seed-data","title":"Seed Data","text":"<pre><code># Load sample data\npnpm seed\n\n# Custom seed script\npnpm seed:custom\n</code></pre>"},{"location":"installation/development/#building-testing","title":"Building &amp; Testing","text":""},{"location":"installation/development/#development-build","title":"Development Build","text":"<pre><code># Build for development\npnpm build\n\n# Start production server\npnpm start\n</code></pre>"},{"location":"installation/development/#production-build","title":"Production Build","text":"<pre><code># Build optimized for production\nNODE_ENV=production pnpm build\n\n# Analyze bundle size\npnpm build --analyze\n</code></pre>"},{"location":"installation/development/#quality-checks","title":"Quality Checks","text":"<pre><code># Run all checks before committing\npnpm lint        # ESLint\npnpm type-check  # TypeScript\npnpm test        # Jest tests\npnpm build       # Production build\n</code></pre>"},{"location":"installation/development/#git-workflow","title":"Git Workflow","text":""},{"location":"installation/development/#commit-changes","title":"Commit Changes","text":"<pre><code># Stage changes\ngit add .\n\n# Commit with descriptive message\ngit commit -m \"feat: add new block component\"\n\n# Follow conventional commits:\n# feat: new feature\n# fix: bug fix\n# docs: documentation\n# style: formatting\n# refactor: code restructuring\n# test: adding tests\n# chore: maintenance\n</code></pre>"},{"location":"installation/development/#push-create-pr","title":"Push &amp; Create PR","text":"<pre><code># Push to your fork\ngit push origin feature/your-feature\n\n# Create Pull Request on GitHub\n# Fill out PR template\n# Wait for review\n</code></pre>"},{"location":"installation/development/#keep-fork-updated","title":"Keep Fork Updated","text":"<pre><code># Fetch upstream changes\ngit fetch upstream\n\n# Update main branch\ngit checkout main\ngit merge upstream/main\ngit push origin main\n\n# Rebase feature branch\ngit checkout feature/your-feature\ngit rebase main\n</code></pre>"},{"location":"installation/development/#common-issues","title":"Common Issues","text":""},{"location":"installation/development/#port-3000-already-in-use","title":"Port 3000 Already in Use","text":"<pre><code># Kill process\nnpx kill-port 3000\n\n# Or use different port\nPORT=3001 pnpm dev\n</code></pre>"},{"location":"installation/development/#build-errors","title":"Build Errors","text":"<pre><code># Clear cache\nrm -rf .next node_modules\npnpm install\npnpm dev\n</code></pre>"},{"location":"installation/development/#mongodb-connection-issues","title":"MongoDB Connection Issues","text":"<pre><code># Check MongoDB is running\nmongosh --eval \"db.version()\"\n\n# Restart MongoDB\n# Windows: net restart MongoDB\n# Linux: sudo systemctl restart mongod\n</code></pre>"},{"location":"installation/development/#type-errors","title":"Type Errors","text":"<pre><code># Regenerate Payload types\npnpm payload generate:types\n\n# Check tsconfig.json paths\n</code></pre>"},{"location":"installation/development/#best-practices","title":"Best Practices","text":""},{"location":"installation/development/#code-quality","title":"Code Quality","text":"<p>\u2705 Write TypeScript, avoid <code>any</code> \u2705 Follow ESLint rules \u2705 Write tests for new features \u2705 Document complex logic</p>"},{"location":"installation/development/#performance","title":"Performance","text":"<p>\u2705 Use React Server Components when possible \u2705 Optimize images with <code>next/image</code> \u2705 Lazy load heavy components \u2705 Monitor bundle size</p>"},{"location":"installation/development/#security","title":"Security","text":"<p>\u2705 Never commit secrets \u2705 Validate user inputs \u2705 Use environment variables \u2705 Keep dependencies updated</p>"},{"location":"installation/development/#git","title":"Git","text":"<p>\u2705 Write clear commit messages \u2705 Keep PRs focused and small \u2705 Rebase before pushing \u2705 Review your own PR first</p>"},{"location":"installation/development/#resources","title":"Resources","text":"<ul> <li>\ud83d\udcd6 Next.js Documentation</li> <li>\ud83d\udcd6 PayloadCMS Documentation</li> <li>\ud83d\udcd6 TypeScript Handbook</li> <li>\ud83d\udcd6 React Documentation</li> </ul>"},{"location":"installation/development/#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udc1b Report Issues</li> <li>\ud83d\udce7 Email: CTU-SematX Team</li> </ul> <p>Environment ready? Start building with the Development Guide.</p>"},{"location":"installation/docker/","title":"Docker Setup Guide","text":"<p>Run LegoCity in containers with Docker Compose - the fastest way to get started.</p>"},{"location":"installation/docker/#overview","title":"Overview","text":"<p>Advantages:</p> <ul> <li>\u2705 One-command setup</li> <li>\u2705 All services containerized (Next.js, MongoDB, Orion-LD)</li> <li>\u2705 Consistent across environments</li> <li>\u2705 Easy to clean up</li> </ul> <p>Disadvantages:</p> <ul> <li>\u26a0\ufe0f Less flexible for development</li> <li>\u26a0\ufe0f Requires Docker Desktop (Windows/Mac) or Docker Engine (Linux)</li> </ul>"},{"location":"installation/docker/#prerequisites","title":"Prerequisites","text":""},{"location":"installation/docker/#install-docker","title":"Install Docker","text":"WindowsmacOSLinux <p>Download and install Docker Desktop for Windows</p> <pre><code># Verify installation\ndocker --version\ndocker compose version\n</code></pre> <p>Download and install Docker Desktop for Mac</p> <pre><code># Verify installation\ndocker --version\ndocker compose version\n</code></pre> <pre><code># Install Docker Engine\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n\n# Install Docker Compose\nsudo apt install docker-compose-plugin\n\n# Add user to docker group\nsudo usermod -aG docker $USER\nnewgrp docker\n\n# Verify\ndocker --version\ndocker compose version\n</code></pre>"},{"location":"installation/docker/#system-requirements","title":"System Requirements","text":"<ul> <li>RAM: 4 GB minimum, 8 GB recommended</li> <li>Storage: 10 GB free space</li> <li>CPU: 2 cores minimum</li> </ul>"},{"location":"installation/docker/#quick-start","title":"Quick Start","text":""},{"location":"installation/docker/#1-clone-repository","title":"1. Clone Repository","text":"<pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity\n</code></pre>"},{"location":"installation/docker/#2-configure-environment","title":"2. Configure Environment","text":"<pre><code># Copy example environment file\ncp dashboard/.env.example dashboard/.env\n</code></pre> <p>Edit <code>dashboard/.env</code>:</p> <pre><code># Database (use Docker service name)\nDATABASE_URI=mongodb://mongodb:27017/legocity\n\n# Security\nPAYLOAD_SECRET=your-secret-key-min-32-chars\n\n# Server (expose to host)\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Mapbox\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_token\n\n# NGSI-LD Broker (use Docker service name)\nNGSI_LD_BROKER_URL=http://orion:1026\n</code></pre>"},{"location":"installation/docker/#3-start-all-services","title":"3. Start All Services","text":"<pre><code># Start in detached mode\ndocker compose up -d\n\n# Or with logs visible\ndocker compose up\n</code></pre> <p>This starts:</p> <ul> <li>dashboard: Next.js + PayloadCMS (port 3000)</li> <li>mongodb: MongoDB 6.x (port 27017)</li> <li>orion: Orion-LD context broker (port 1026)</li> </ul>"},{"location":"installation/docker/#4-wait-for-services","title":"4. Wait for Services","text":"<pre><code># Check status\ndocker compose ps\n\n# Follow logs\ndocker compose logs -f dashboard\n</code></pre> <p>Wait until you see:</p> <pre><code>dashboard | \u2713 Ready in 3.5s\ndashboard | \u25cb Local:   http://0.0.0.0:3000\n</code></pre>"},{"location":"installation/docker/#5-access-dashboard","title":"5. Access Dashboard","text":"<p>Open browser:</p> <ul> <li>Dashboard: http://localhost:3000</li> <li>Admin Panel: http://localhost:3000/admin</li> <li>Orion-LD API: http://localhost:1026/ngsi-ld/v1/entities</li> </ul>"},{"location":"installation/docker/#docker-compose-configuration","title":"Docker Compose Configuration","text":""},{"location":"installation/docker/#default-docker-composeyml","title":"Default <code>docker-compose.yml</code>","text":"<pre><code>version: \"3.8\"\n\nservices:\n  # Next.js Dashboard\n  dashboard:\n    build:\n      context: ./dashboard\n      dockerfile: Dockerfile\n    ports:\n      - \"3000:3000\"\n    environment:\n      - DATABASE_URI=mongodb://mongodb:27017/legocity\n      - PAYLOAD_SECRET=${PAYLOAD_SECRET}\n      - NEXT_PUBLIC_SERVER_URL=http://localhost:3000\n    depends_on:\n      - mongodb\n    volumes:\n      - ./dashboard:/app\n      - /app/node_modules\n    command: pnpm dev\n\n  # MongoDB Database\n  mongodb:\n    image: mongo:6\n    ports:\n      - \"27017:27017\"\n    volumes:\n      - mongodb_data:/data/db\n    environment:\n      - MONGO_INITDB_DATABASE=legocity\n\n  # NGSI-LD Context Broker\n  orion:\n    image: fiware/orion-ld:latest\n    ports:\n      - \"1026:1026\"\n    depends_on:\n      - mongodb\n    command: -dbhost mongodb\n\nvolumes:\n  mongodb_data:\n</code></pre>"},{"location":"installation/docker/#custom-configuration","title":"Custom Configuration","text":"<p>Create <code>docker-compose.override.yml</code> for local changes:</p> <pre><code>version: \"3.8\"\n\nservices:\n  dashboard:\n    environment:\n      - NODE_ENV=development\n      - DEBUG=payload:*\n    ports:\n      - \"3001:3000\" # Use different port\n</code></pre>"},{"location":"installation/docker/#docker-commands","title":"Docker Commands","text":""},{"location":"installation/docker/#starting-stopping","title":"Starting &amp; Stopping","text":"<pre><code># Start all services\ndocker compose up -d\n\n# Stop all services\ndocker compose stop\n\n# Stop and remove containers\ndocker compose down\n\n# Stop and remove containers + volumes\ndocker compose down -v\n</code></pre>"},{"location":"installation/docker/#viewing-logs","title":"Viewing Logs","text":"<pre><code># All services\ndocker compose logs -f\n\n# Specific service\ndocker compose logs -f dashboard\n\n# Last 100 lines\ndocker compose logs --tail=100 dashboard\n</code></pre>"},{"location":"installation/docker/#rebuilding","title":"Rebuilding","text":"<pre><code># Rebuild images\ndocker compose build\n\n# Rebuild and start\ndocker compose up -d --build\n\n# Rebuild specific service\ndocker compose build dashboard\n</code></pre>"},{"location":"installation/docker/#accessing-containers","title":"Accessing Containers","text":"<pre><code># Execute command in running container\ndocker compose exec dashboard sh\n\n# Or bash if available\ndocker compose exec dashboard bash\n\n# Run one-off command\ndocker compose run dashboard pnpm lint\n</code></pre>"},{"location":"installation/docker/#development-with-docker","title":"Development with Docker","text":""},{"location":"installation/docker/#hot-reload","title":"Hot Reload","text":"<p>The default setup mounts your code as a volume, enabling hot reload:</p> <pre><code>volumes:\n  - ./dashboard:/app # Your code\n  - /app/node_modules # Don't overwrite\n</code></pre> <p>Edit files locally \u2192 changes appear in container \u2192 browser auto-refreshes.</p>"},{"location":"installation/docker/#installing-dependencies","title":"Installing Dependencies","text":"<pre><code># Add new package\ndocker compose exec dashboard pnpm add package-name\n\n# Install dev dependency\ndocker compose exec dashboard pnpm add -D package-name\n\n# Rebuild after package.json changes\ndocker compose down\ndocker compose up -d --build\n</code></pre>"},{"location":"installation/docker/#running-scripts","title":"Running Scripts","text":"<pre><code># Lint code\ndocker compose exec dashboard pnpm lint\n\n# Run tests\ndocker compose exec dashboard pnpm test\n\n# Generate Payload types\ndocker compose exec dashboard pnpm payload generate:types\n\n# Seed database\ndocker compose exec dashboard pnpm seed\n</code></pre>"},{"location":"installation/docker/#database-management","title":"Database Management","text":""},{"location":"installation/docker/#access-mongodb-shell","title":"Access MongoDB Shell","text":"<pre><code># Connect to MongoDB\ndocker compose exec mongodb mongosh legocity\n\n# List collections\nshow collections\n\n# Query data\ndb.pages.find().pretty()\n</code></pre>"},{"location":"installation/docker/#backup-database","title":"Backup Database","text":"<pre><code># Export database\ndocker compose exec mongodb mongodump --db legocity --out /data/backup\n\n# Copy backup to host\ndocker compose cp mongodb:/data/backup ./backup\n</code></pre>"},{"location":"installation/docker/#restore-database","title":"Restore Database","text":"<pre><code># Copy backup to container\ndocker compose cp ./backup mongodb:/data/backup\n\n# Restore\ndocker compose exec mongodb mongorestore --db legocity /data/backup/legocity\n</code></pre>"},{"location":"installation/docker/#reset-database","title":"Reset Database","text":"<pre><code># Drop all data\ndocker compose exec mongodb mongosh legocity --eval \"db.dropDatabase()\"\n\n# Or remove volume\ndocker compose down -v\ndocker compose up -d\n</code></pre>"},{"location":"installation/docker/#troubleshooting","title":"Troubleshooting","text":""},{"location":"installation/docker/#services-wont-start","title":"Services Won't Start","text":"<p>Check ports are free:</p> <pre><code># Windows\nnetstat -ano | findstr :3000\nnetstat -ano | findstr :27017\n\n# Linux/macOS\nlsof -i :3000\nlsof -i :27017\n</code></pre> <p>Kill conflicting processes or change ports in <code>docker-compose.yml</code>.</p>"},{"location":"installation/docker/#container-keeps-restarting","title":"Container Keeps Restarting","text":"<pre><code># Check logs for errors\ndocker compose logs dashboard\n\n# Common issues:\n# - Missing environment variables\n# - MongoDB not ready\n# - Port conflicts\n</code></pre>"},{"location":"installation/docker/#cant-connect-to-database","title":"Can't Connect to Database","text":"<p>Verify MongoDB is running:</p> <pre><code>docker compose ps mongodb\n\n# Should show \"Up\"\n</code></pre> <p>Check connection string in <code>.env</code>:</p> <pre><code># Use service name, not localhost\nDATABASE_URI=mongodb://mongodb:27017/legocity\n</code></pre>"},{"location":"installation/docker/#build-fails","title":"Build Fails","text":"<pre><code># Clear build cache\ndocker compose build --no-cache\n\n# Remove old images\ndocker image prune -a\n\n# Check Dockerfile syntax\ndocker compose config\n</code></pre>"},{"location":"installation/docker/#slow-performance","title":"Slow Performance","text":"<p>Increase Docker resources:</p> <ul> <li>Docker Desktop \u2192 Settings \u2192 Resources</li> <li>Allocate more CPU and RAM</li> </ul> <p>Use production build:</p> <pre><code># docker-compose.override.yml\nservices:\n  dashboard:\n    command: pnpm start # Instead of pnpm dev\n</code></pre>"},{"location":"installation/docker/#permission-issues-linux","title":"Permission Issues (Linux)","text":"<pre><code># Fix file permissions\nsudo chown -R $USER:$USER ./dashboard\n\n# Or run as current user\ndocker compose run --user \"$(id -u):$(id -g)\" dashboard pnpm dev\n</code></pre>"},{"location":"installation/docker/#production-deployment","title":"Production Deployment","text":"<p>For production, use optimized configuration:</p>"},{"location":"installation/docker/#docker-composeprodyml","title":"<code>docker-compose.prod.yml</code>","text":"<pre><code>version: \"3.8\"\n\nservices:\n  dashboard:\n    build:\n      context: ./dashboard\n      dockerfile: Dockerfile\n      args:\n        - NODE_ENV=production\n    environment:\n      - NODE_ENV=production\n    command: pnpm start\n    restart: unless-stopped\n\n  mongodb:\n    restart: unless-stopped\n    volumes:\n      - mongodb_data:/data/db\n\n  orion:\n    restart: unless-stopped\n\nvolumes:\n  mongodb_data:\n    driver: local\n</code></pre> <p>Deploy:</p> <pre><code>docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d\n</code></pre>"},{"location":"installation/docker/#cleanup","title":"Cleanup","text":""},{"location":"installation/docker/#remove-everything","title":"Remove Everything","text":"<pre><code># Stop and remove all containers, networks, volumes\ndocker compose down -v\n\n# Remove images\ndocker compose down --rmi all\n\n# Prune Docker system\ndocker system prune -a --volumes\n</code></pre>"},{"location":"installation/docker/#keep-data-remove-containers","title":"Keep Data, Remove Containers","text":"<pre><code># Stop and remove containers (keep volumes)\ndocker compose down\n</code></pre>"},{"location":"installation/docker/#next-steps","title":"Next Steps","text":"<ul> <li>Configure: Configuration Guide</li> <li>Use: User Guide</li> <li>Deploy: Production Deployment</li> </ul>"},{"location":"installation/docker/#resources","title":"Resources","text":"<ul> <li>\ud83d\udcd6 Docker Documentation</li> <li>\ud83d\udcd6 Docker Compose Reference</li> <li>\ud83d\udc1b Report Issues</li> </ul> <p>Docker setup complete? Continue to the Configuration Guide.</p>"},{"location":"installation/local/","title":"Local Development Setup","text":"<p>This guide explains how to set up a local development environment for LegoCity.</p> <p>Target Audience</p> <p>This guide is for contributors who want to:</p> <pre><code>- Run the dashboard and PayloadCMS locally\n- Experiment with new blocks and views\n- Develop update servers and proxy behaviour\n</code></pre> <p>The instructions are generic and can be applied whether you run everything with Docker, on a VM, or directly on your laptop.</p>"},{"location":"installation/local/#prerequisites","title":"Prerequisites","text":""},{"location":"installation/local/#required-tools","title":"Required Tools","text":"Git <p>Clone the repository and manage branches</p> <pre><code>```bash\ngit --version\n```\n</code></pre> Node.js <p>Use a version compatible with the dashboard and PayloadCMS</p> <pre><code>- Check `.nvmrc` or `engines` field in `package.json`\n- Otherwise, use a recent LTS version\n\n```bash\nnode --version\n```\n</code></pre> Package Manager <p>Use the package manager indicated by the repository:</p> <pre><code>- `pnpm-lock.yaml` present \u2192 use **pnpm**\n- `yarn.lock` present \u2192 use **yarn**\n- Otherwise \u2192 use **npm**\n</code></pre> Docker (Optional) <p>Recommended for running supporting services</p> <pre><code>- Context broker\n- Databases\n- Simplifies matching deployment configuration\n\n```bash\ndocker --version\ndocker compose version\n```\n</code></pre>"},{"location":"installation/local/#mapbox-access-token","title":"Mapbox Access Token","text":"<p>Required for Map Rendering</p> <p>You'll need a Mapbox access token to render maps in the dashboard.</p> <pre><code>Get one at [mapbox.com](https://www.mapbox.com/) and provide it via:\n```\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_token_here\n```\n</code></pre>"},{"location":"installation/local/#repository-structure","title":"Repository Structure","text":"<pre><code>LegoCity/\n\u251c\u2500\u2500 dashboard/          # Next.js application\n\u2502   \u251c\u2500\u2500 src/           # Source code\n\u2502   \u251c\u2500\u2500 public/        # Static assets\n\u2502   \u2514\u2500\u2500 package.json   # Dependencies\n\u251c\u2500\u2500 docs/              # MkDocs documentation\n\u2502   \u251c\u2500\u2500 index.md      # This site\n\u2502   \u2514\u2500\u2500 mkdocs.yml    # Config\n\u251c\u2500\u2500 orion-ld/         # NGSI-LD broker config\n\u251c\u2500\u2500 proto/            # Prototypes\n\u2514\u2500\u2500 README.md         # Project overview\n</code></pre> <p>Core pattern: <code>dashboard</code> + <code>docs</code> + <code>broker</code> + <code>support</code></p>"},{"location":"installation/local/#quick-start","title":"Quick Start","text":""},{"location":"installation/local/#1-clone-repository","title":"1. Clone Repository","text":"<pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity\n</code></pre>"},{"location":"installation/local/#2-create-feature-branch","title":"2. Create Feature Branch","text":"<pre><code>git checkout -b feature/my-change\n</code></pre>"},{"location":"installation/local/#3-install-dependencies","title":"3. Install Dependencies","text":"Using pnpm <p><code>bash     cd dashboard     pnpm install</code></p> Using npm <p><code>bash     cd dashboard     npm install</code></p> Using yarn <p><code>bash     cd dashboard     yarn install</code></p>"},{"location":"installation/local/#environment-configuration","title":"Environment Configuration","text":""},{"location":"installation/local/#create-environment-file","title":"Create Environment File","text":"<p>Create <code>.env</code> or <code>.env.local</code> in the <code>dashboard/</code> directory:</p> dashboard/.env<pre><code># API Configuration\nNEXT_PUBLIC_API_BASE_URL=http://localhost:4000\n\n# Mapbox\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_token_here\n\n# PayloadCMS Database\nDATABASE_URI=mongodb://localhost:27017/legocity\n\n# PayloadCMS Secret (min 32 chars)\nPAYLOAD_SECRET=your-secret-key-here-min-32-chars\n\n# NGSI-LD Broker\nBROKER_URL=http://localhost:1026\n\n# Optional: Domain-specific write keys\nBROKER_WRITE_KEY_ENVIRONMENT=key_env\nBROKER_WRITE_KEY_MOBILITY=key_mobility\n</code></pre> <p>Security Note</p> <p>Never commit <code>.env</code> files containing real secrets to version control!</p>"},{"location":"installation/local/#running-the-application","title":"Running the Application","text":""},{"location":"installation/local/#option-1-docker-compose-recommended","title":"Option 1: Docker Compose (Recommended)","text":"<p>Start all services at once:</p> <pre><code># From repository root\ndocker compose up\n</code></pre> <p>Or using Makefile:</p> <pre><code>make dev\n</code></pre> <p>This starts:</p> <ul> <li>Context broker</li> <li>MongoDB database</li> <li>PayloadCMS</li> <li>Dashboard</li> <li>Proxy (if configured)</li> <li>Update servers (if configured)</li> </ul> <p>Access URLs:</p> Service URL Dashboard http://localhost:3000 PayloadCMS Admin http://localhost:3000/admin Context Broker http://localhost:1026"},{"location":"installation/local/#option-2-manual-mode","title":"Option 2: Manual Mode","text":"<p>Run services individually:</p>"},{"location":"installation/local/#start-dashboard","title":"Start Dashboard","text":"pnpm <p><code>bash     cd dashboard     pnpm dev</code></p> npm <p><code>bash     cd dashboard     npm run dev</code></p> yarn <p><code>bash     cd dashboard     yarn dev</code></p>"},{"location":"installation/local/#start-payloadcms","title":"Start PayloadCMS","text":"<p>If separate from dashboard:</p> <pre><code>cd cms  # or relevant directory\nnpm run dev\n</code></pre> <p>Database Connection</p> <p>Ensure MongoDB is accessible before starting PayloadCMS</p>"},{"location":"installation/local/#initial-setup","title":"Initial Setup","text":""},{"location":"installation/local/#1-create-admin-account","title":"1. Create Admin Account","text":"<ol> <li>Navigate to http://localhost:3000/admin</li> <li>Fill in registration form:</li> <li>Email</li> <li>Password (min 8 characters)</li> <li>Confirm account creation</li> </ol>"},{"location":"installation/local/#2-seed-data-optional","title":"2. Seed Data (Optional)","text":"<p>Run seed scripts to populate sample data:</p> <pre><code># Example command (check package.json for actual script)\nnpm run seed\n</code></pre> <p>See Seed Database guide for details.</p>"},{"location":"installation/local/#development-commands","title":"Development Commands","text":"<p>Common commands from <code>dashboard/</code> directory:</p> Command Description <code>npm run dev</code> Start dev server with hot reload <code>npm run build</code> Build production bundle <code>npm run start</code> Start production server <code>npm run lint</code> Lint codebase <code>npm run test</code> Run tests <p>Check package.json</p> <p>Actual commands may vary. Always check <code>package.json</code> for available scripts.</p>"},{"location":"installation/local/#git-workflow","title":"Git Workflow","text":""},{"location":"installation/local/#best-practices","title":"Best Practices","text":"<ol> <li>Work on feature branches (not <code>main</code>)</li> <li>Keep commits focused and coherent</li> <li>Run tests before PR (if configured)</li> <li>Update docs when adding features</li> <li>Follow CONTRIBUTING.md guidelines (if exists)</li> </ol>"},{"location":"installation/local/#example-workflow","title":"Example Workflow","text":"<pre><code># Create feature branch\ngit checkout -b feature/new-block\n\n# Make changes\n# ... edit files ...\n\n# Stage and commit\ngit add .\ngit commit -m \"feat: add weather block component\"\n\n# Push to remote\ngit push origin feature/new-block\n\n# Create Pull Request on GitHub\n</code></pre>"},{"location":"installation/local/#troubleshooting","title":"Troubleshooting","text":""},{"location":"installation/local/#port-already-in-use","title":"Port Already in Use","text":"<pre><code>Error: listen EADDRINUSE: address already in use :::3000\n</code></pre> <p>Solution: Change port or kill process:</p> <pre><code># Windows\nnetstat -ano | findstr :3000\ntaskkill /PID &lt;PID&gt; /F\n\n# Linux/Mac\nlsof -ti:3000 | xargs kill -9\n</code></pre>"},{"location":"installation/local/#mongodb-connection-failed","title":"MongoDB Connection Failed","text":"<pre><code>Error: connect ECONNREFUSED 127.0.0.1:27017\n</code></pre> <p>Solution: Ensure MongoDB is running:</p> <pre><code># With Docker\ndocker compose up mongodb\n\n# Or check service status\ndocker ps | grep mongo\n</code></pre>"},{"location":"installation/local/#missing-environment-variables","title":"Missing Environment Variables","text":"<pre><code>Error: NEXT_PUBLIC_MAPBOX_TOKEN is not defined\n</code></pre> <p>Solution: Check <code>.env</code> file exists and contains required variables.</p>"},{"location":"installation/local/#summary","title":"Summary","text":"<p>Development Environment Ready</p> <p>You should now have:</p> <pre><code>-  Repository cloned and dependencies installed\n-  Environment variables configured\n-  Services running (Docker or manual)\n-  Admin account created\n-  Understanding of development workflow\n</code></pre> <p>Next Steps:</p> <ul> <li>Create custom blocks</li> <li>Write PayloadCMS plugins</li> <li>Add seed data</li> </ul>"},{"location":"reference/troubleshooting/","title":"Troubleshooting Guide","text":"<p>Common issues and their solutions when working with LegoCity.</p>"},{"location":"reference/troubleshooting/#quick-diagnostics","title":"Quick Diagnostics","text":"<p>Run these checks first:</p> <pre><code># Check all services\npnpm run check:all\n\n# Or check individually:\nnode --version        # Should be 18+\npnpm --version        # Should be 8+\nmongosh --eval \"db.version()\"  # MongoDB running?\ncurl http://localhost:3000/api/health  # App running?\n</code></pre>"},{"location":"reference/troubleshooting/#installation-issues","title":"Installation Issues","text":""},{"location":"reference/troubleshooting/#nodejs-version-mismatch","title":"Node.js Version Mismatch","text":"<p>Problem: <code>error:0308010C:digital envelope routines::unsupported</code></p> <p>Cause: Node.js version incompatibility</p> <p>Solution:</p> <pre><code># Check required version\ncat .nvmrc\n\n# Install correct version\nnvm install 18\nnvm use 18\n\n# Verify\nnode --version\n</code></pre>"},{"location":"reference/troubleshooting/#pnpm-not-found","title":"pnpm Not Found","text":"<p>Problem: <code>pnpm: command not found</code></p> <p>Solution:</p> <pre><code># Install pnpm globally\nnpm install -g pnpm\n\n# Or use Corepack (Node.js 16+)\ncorepack enable\ncorepack prepare pnpm@latest --activate\n</code></pre>"},{"location":"reference/troubleshooting/#mongodb-connection-failed","title":"MongoDB Connection Failed","text":"<p>Problem: <code>MongoServerError: connect ECONNREFUSED 127.0.0.1:27017</code></p> <p>Cause: MongoDB not running or wrong connection string</p> <p>Solutions:</p> Windows <p>```powershell # Start MongoDB service net start MongoDB</p> <pre><code># Check status\nsc query MongoDB\n\n# Or start manually\nmongod --dbpath C:\\data\\db\n```\n</code></pre> macOS <p>```bash # Start with Homebrew brew services start mongodb-community</p> <pre><code># Or manually\nmongod --config /usr/local/etc/mongod.conf\n```\n</code></pre> Linux <p>```bash # Start service sudo systemctl start mongod</p> <pre><code># Enable on boot\nsudo systemctl enable mongod\n\n# Check status\nsudo systemctl status mongod\n```\n</code></pre> Docker <p>```bash # Start MongoDB container docker run -d -p 27017:27017 --name mongodb mongo:6</p> <pre><code># Or with Docker Compose\ndocker compose up -d mongodb\n```\n</code></pre>"},{"location":"reference/troubleshooting/#port-already-in-use","title":"Port Already in Use","text":"<p>Problem: <code>Error: listen EADDRINUSE: address already in use :::3000</code></p> <p>Solutions:</p> Windows <p>```powershell # Find process using port netstat -ano | findstr :3000</p> <pre><code># Kill process (replace PID)\ntaskkill /PID [PID] /F\n\n# Or use npx\nnpx kill-port 3000\n```\n</code></pre> macOS/Linux <p>```bash # Find and kill process lsof -ti:3000 | xargs kill -9</p> <pre><code># Or use npx\nnpx kill-port 3000\n```\n</code></pre> <p>Alternative: Use different port</p> <pre><code>PORT=3001 pnpm dev\n</code></pre>"},{"location":"reference/troubleshooting/#development-issues","title":"Development Issues","text":""},{"location":"reference/troubleshooting/#hot-reload-not-working","title":"Hot Reload Not Working","text":"<p>Problem: Changes not reflecting in browser</p> <p>Solutions:</p> <ol> <li>Clear Next.js cache:</li> </ol> <pre><code>rm -rf .next\npnpm dev\n</code></pre> <ol> <li>Check file watcher limits (Linux):</li> </ol> <pre><code># Increase limit\necho fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n</code></pre> <ol> <li>Restart dev server:    <pre><code># Kill server (Ctrl+C)\npnpm dev\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#typescript-errors-after-update","title":"TypeScript Errors After Update","text":"<p>Problem: Type errors after updating dependencies</p> <p>Solution:</p> <pre><code># Regenerate Payload types\npnpm payload generate:types\n\n# Clear TypeScript cache\nrm -rf node_modules/.cache\n\n# Reinstall dependencies\nrm -rf node_modules\npnpm install\n</code></pre>"},{"location":"reference/troubleshooting/#build-fails","title":"Build Fails","text":"<p>Problem: <code>Build failed with errors</code></p> <p>Common causes and solutions:</p> <ol> <li>Type errors:</li> </ol> <pre><code>pnpm type-check\n# Fix reported errors\n</code></pre> <ol> <li>Lint errors:</li> </ol> <pre><code>pnpm lint:fix\n</code></pre> <ol> <li>Out of memory:</li> </ol> <pre><code># Increase Node memory\nNODE_OPTIONS=\"--max-old-space-size=4096\" pnpm build\n</code></pre> <ol> <li>Module not found:    <pre><code># Reinstall dependencies\nrm -rf node_modules pnpm-lock.yaml\npnpm install\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#runtime-issues","title":"Runtime Issues","text":""},{"location":"reference/troubleshooting/#white-screen-blank-page","title":"White Screen / Blank Page","text":"<p>Problem: Page loads but shows nothing</p> <p>Debugging steps:</p> <ol> <li> <p>Check browser console for JavaScript errors</p> </li> <li> <p>Check Network tab for failed requests</p> </li> <li> <p>Verify environment variables:</p> </li> </ol> <pre><code># Required variables set?\necho $DATABASE_URI\necho $PAYLOAD_SECRET\necho $NEXT_PUBLIC_SERVER_URL\n</code></pre> <ol> <li>Check server logs:    <pre><code>pnpm dev\n# Look for errors in terminal\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#map-not-rendering","title":"Map Not Rendering","text":"<p>Problem: Map area is blank or shows error</p> <p>Solutions:</p> <ol> <li>Verify Mapbox token:</li> </ol> <pre><code># Check token is set\necho $NEXT_PUBLIC_MAPBOX_TOKEN\n\n# Test token\ncurl \"https://api.mapbox.com/v4/mapbox.mapbox-streets-v8.json?access_token=$NEXT_PUBLIC_MAPBOX_TOKEN\"\n</code></pre> <ol> <li> <p>Check console for errors:</p> </li> <li> <p>Open browser DevTools \u2192 Console</p> </li> <li> <p>Look for Mapbox errors</p> </li> <li> <p>Verify token scope:</p> </li> <li>Token must have <code>styles:read</code> and <code>fonts:read</code> scopes</li> <li>Create new token at mapbox.com</li> </ol>"},{"location":"reference/troubleshooting/#admin-panel-404","title":"Admin Panel 404","text":"<p>Problem: <code>/admin</code> route not found</p> <p>Solutions:</p> <ol> <li>Rebuild application:</li> </ol> <pre><code>rm -rf .next\npnpm build\npnpm start\n</code></pre> <ol> <li>Check Payload config:</li> </ol> <pre><code>// payload.config.ts\nadmin: {\n  autoLogin: false,  // Should be false in production\n}\n</code></pre> <ol> <li>Verify admin routes exist:    <pre><code>ls src/app/\\(payload\\)/admin\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#api-route-returns-500","title":"API Route Returns 500","text":"<p>Problem: API endpoint throws server error</p> <p>Debugging:</p> <ol> <li> <p>Check server logs for error details</p> </li> <li> <p>Test with curl:</p> </li> </ol> <pre><code>curl -v http://localhost:3000/api/your-endpoint\n</code></pre> <ol> <li>Add logging:    <pre><code>export async function GET(req: Request) {\n  try {\n    console.log(\"Request:\", req.url);\n    // ... your code\n  } catch (error) {\n    console.error(\"Error:\", error);\n    return Response.json({ error: error.message }, { status: 500 });\n  }\n}\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#database-issues","title":"Database Issues","text":""},{"location":"reference/troubleshooting/#database-connection-slow","title":"Database Connection Slow","text":"<p>Problem: Slow queries or timeouts</p> <p>Solutions:</p> <ol> <li>Add indexes:</li> </ol> <pre><code>// In MongoDB shell\ndb.pages.createIndex({ slug: 1 });\ndb.posts.createIndex({ publishedAt: -1 });\n</code></pre> <ol> <li>Monitor slow queries:</li> </ol> <pre><code>db.setProfilingLevel(2);\ndb.system.profile.find().sort({ ts: -1 }).limit(10);\n</code></pre> <ol> <li>Check database stats:    <pre><code>mongosh legocity --eval \"db.stats()\"\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#collection-not-found","title":"Collection Not Found","text":"<p>Problem: <code>Collection 'pages' not found</code></p> <p>Solutions:</p> <ol> <li>Check collection name matches config:</li> </ol> <pre><code>// collections/Pages.ts\nslug: \"pages\"; // Must match\n</code></pre> <ol> <li>Verify database:</li> </ol> <pre><code>mongosh legocity --eval \"show collections\"\n</code></pre> <ol> <li>Seed database:    <pre><code>pnpm seed\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#database-migration-failed","title":"Database Migration Failed","text":"<p>Problem: Schema changes not applied</p> <p>Solution:</p> <pre><code># Backup first!\nmongodump --db legocity --out ./backup\n\n# Drop and recreate\nmongosh legocity --eval \"db.dropDatabase()\"\npnpm seed\n\n# Or restore backup\nmongorestore --db legocity ./backup/legocity\n</code></pre>"},{"location":"reference/troubleshooting/#docker-issues","title":"Docker Issues","text":""},{"location":"reference/troubleshooting/#container-exits-immediately","title":"Container Exits Immediately","text":"<p>Problem: Docker container starts then stops</p> <p>Debug:</p> <pre><code># Check logs\ndocker compose logs dashboard\n\n# Check for errors in build\ndocker compose build --no-cache dashboard\n\n# Run interactively\ndocker compose run --rm dashboard sh\n</code></pre>"},{"location":"reference/troubleshooting/#cannot-connect-to-service","title":"Cannot Connect to Service","text":"<p>Problem: Frontend can't reach MongoDB/Orion</p> <p>Solutions:</p> <ol> <li>Use service names, not localhost:</li> </ol> <pre><code># \u274c Wrong\nDATABASE_URI=mongodb://localhost:27017/legocity\n\n# \u2705 Correct\nDATABASE_URI=mongodb://mongodb:27017/legocity\n</code></pre> <ol> <li>Check network:</li> </ol> <pre><code>docker compose ps\ndocker network ls\n</code></pre> <ol> <li>Test connectivity:    <pre><code>docker compose exec dashboard ping mongodb\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#volume-permission-issues","title":"Volume Permission Issues","text":"<p>Problem: Permission denied errors (Linux)</p> <p>Solution:</p> <pre><code># Fix ownership\nsudo chown -R $USER:$USER ./dashboard\n\n# Or run as current user\ndocker compose run --user \"$(id -u):$(id -g)\" dashboard pnpm dev\n</code></pre>"},{"location":"reference/troubleshooting/#production-issues","title":"Production Issues","text":""},{"location":"reference/troubleshooting/#502-bad-gateway","title":"502 Bad Gateway","text":"<p>Problem: Nginx shows 502 error</p> <p>Solutions:</p> <ol> <li>Check app is running:</li> </ol> <pre><code>pm2 status\n# Or\nsystemctl status legocity\n</code></pre> <ol> <li>Check Nginx config:</li> </ol> <pre><code>sudo nginx -t\nsudo systemctl reload nginx\n</code></pre> <ol> <li>Check logs:</li> </ol> <pre><code># App logs\npm2 logs\n\n# Nginx logs\nsudo tail -f /var/log/nginx/error.log\n</code></pre>"},{"location":"reference/troubleshooting/#memory-leak","title":"Memory Leak","text":"<p>Problem: Application memory usage grows over time</p> <p>Solutions:</p> <ol> <li>Monitor memory:</li> </ol> <pre><code># PM2 monitoring\npm2 monit\n\n# Or use htop\nhtop\n</code></pre> <ol> <li>Set memory limit:</li> </ol> <pre><code>// ecosystem.config.js\nmodule.exports = {\n  apps: [\n    {\n      name: \"legocity\",\n      script: \"node_modules/next/dist/bin/next\",\n      args: \"start\",\n      max_memory_restart: \"1G\",\n    },\n  ],\n};\n</code></pre> <ol> <li>Profile memory:    <pre><code>node --inspect node_modules/next/dist/bin/next start\n# Use Chrome DevTools to profile\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#ssl-certificate-issues","title":"SSL Certificate Issues","text":"<p>Problem: HTTPS not working or certificate errors</p> <p>Solutions:</p> <ol> <li>Check certificate validity:</li> </ol> <pre><code>sudo certbot certificates\n</code></pre> <ol> <li>Renew certificate:</li> </ol> <pre><code>sudo certbot renew\nsudo systemctl reload nginx\n</code></pre> <ol> <li>Test SSL config:    <pre><code>curl -vI https://your-domain.com\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"reference/troubleshooting/#slow-page-load","title":"Slow Page Load","text":"<p>Problem: Pages take too long to load</p> <p>Solutions:</p> <ol> <li>Enable caching:</li> </ol> <pre><code>// app/page.tsx\nexport const revalidate = 60; // ISR every 60s\n</code></pre> <ol> <li>Optimize images:</li> </ol> <pre><code>import Image from \"next/image\";\n\n&lt;Image src=\"/image.jpg\" width={800} height={600} alt=\"Description\" /&gt;;\n</code></pre> <ol> <li>Use dynamic imports:</li> </ol> <pre><code>const HeavyComponent = dynamic(() =&gt; import(\"./HeavyComponent\"), {\n  loading: () =&gt; &lt;p&gt;Loading...&lt;/p&gt;,\n});\n</code></pre> <ol> <li>Analyze bundle:    <pre><code>pnpm build --analyze\n</code></pre></li> </ol>"},{"location":"reference/troubleshooting/#high-cpu-usage","title":"High CPU Usage","text":"<p>Problem: CPU spikes during normal operation</p> <p>Check:</p> <ol> <li>Profile application:</li> </ol> <pre><code>node --prof node_modules/next/dist/bin/next start\nnode --prof-process isolate-*.log &gt; profile.txt\n</code></pre> <ol> <li> <p>Check for infinite loops in code</p> </li> <li> <p>Monitor processes:    <pre><code>top -p $(pgrep node)\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#getting-more-help","title":"Getting More Help","text":""},{"location":"reference/troubleshooting/#collect-diagnostic-info","title":"Collect Diagnostic Info","text":"<p>Before asking for help, collect:</p> <pre><code># System info\nnode --version\npnpm --version\nmongosh --version\n\n# App info\ncat package.json | grep version\n\n# Environment\necho $NODE_ENV\nenv | grep -E '(DATABASE|PAYLOAD|NEXT_PUBLIC)'\n\n# Logs\npnpm dev &gt; debug.log 2&gt;&amp;1\n\n# Health check\ncurl http://localhost:3000/api/health\n</code></pre>"},{"location":"reference/troubleshooting/#where-to-get-help","title":"Where to Get Help","text":"<ul> <li>\ud83d\udc1b Bug Reports: GitHub Issues</li> <li>\ud83d\udcac Questions: GitHub Discussions</li> <li>\ud83d\udcd6 Documentation: LegoCity Docs</li> <li>\ud83d\udce7 Email: CTU-SematX Team</li> </ul>"},{"location":"reference/troubleshooting/#issue-template","title":"Issue Template","text":"<p>When reporting issues:</p> <pre><code>**Describe the issue**\nClear description of what's wrong\n\n**Steps to reproduce**\n\n1. Do this\n2. Then this\n3. See error\n\n**Expected behavior**\nWhat should happen\n\n**Environment**\n\n- OS: [e.g., Windows 11]\n- Node: [e.g., 18.17.0]\n- pnpm: [e.g., 8.6.0]\n- Browser: [e.g., Chrome 115]\n\n**Logs**\n</code></pre> <p>Paste relevant logs here</p> <pre><code>**Screenshots**\nIf applicable\n</code></pre> <p>Still stuck? Ask in GitHub Discussions - we're here to help!</p>"},{"location":"user-guide/","title":"Usage overview","text":"<p>This section explains how to work with the data layer in LegoCity and how it connects to the dashboard.</p> <p>It is intended for people who:</p> <ul> <li>operate or configure context brokers,</li> <li>build or maintain update servers that push data into the broker,</li> <li>need to understand how data becomes visible as map layers and blocks in the UI.</li> </ul> <p>The Usage section is organised into the following pages.</p>"},{"location":"user-guide/#data-brokers","title":"Data &amp; brokers","text":"<p>Describes the overall data flow and the roles of:</p> <ul> <li>the context broker, which stores all NGSI-LD entities, and</li> <li>update servers, which fetch external data, transform it into entities, and write to the broker.</li> </ul> <p>This page focuses on:</p> <ul> <li>typical broker setups (single vs multiple brokers),</li> <li>how responsibilities are split between broker and update servers,</li> <li>why the dashboard reads but does not write to the broker.</li> </ul>"},{"location":"user-guide/#entities","title":"Entities","text":"<p>Describes how city information is represented as NGSI-LD entities and how Smart Data Models are used.</p> <p>This page covers:</p> <ul> <li>common entity types in a LegoCity deployment,</li> <li>how Smart Data Models influence attribute naming and structure,</li> <li>conventions for identifiers, types and geospatial attributes,</li> <li>guidelines for defining new entity types when requirements change.</li> </ul>"},{"location":"user-guide/#api-keys-access","title":"API keys &amp; access","text":"<p>Describes how write access to the context broker is controlled.</p> <p>This page explains:</p> <ul> <li>how update servers obtain write access,</li> <li>patterns for sharing or separating write keys across servers,</li> <li>where keys and tokens should be stored,</li> <li>basic expectations for key rotation and incident response.</li> </ul> <p>Read access and the role of read-only proxies are also introduced at a high level.</p>"},{"location":"user-guide/#sample-update-server","title":"Sample update server","text":"<p>Describes the sample update server included with LegoCity.</p> <p>This page clarifies:</p> <ul> <li>the purpose and scope of the sample,</li> <li>how it is configured (environment variables, external API, broker access),</li> <li>the typical workflow to run it end-to-end,</li> <li>how teams can extend it to build their own update servers.</li> </ul>"},{"location":"user-guide/#how-to-use-this-section","title":"How to use this section","text":"<p>A typical reading order is:</p> <ol> <li>Data &amp; brokers \u2013 to understand the overall data flow.</li> <li>Entities \u2013 to learn how city concepts are modeled.</li> <li>API keys &amp; access \u2013 to see how write access is controlled.</li> <li>Sample update server \u2013 to run a minimal, practical example.</li> </ol> <p>After working through these pages, you should have a clear picture of how data enters the broker and how it is expected to be structured before it is used by the dashboard.</p>"},{"location":"user-guide/api-keys/","title":"API keys and access control","text":"<p>This page describes how write access to the context broker is controlled in a LegoCity deployment and how API keys or tokens are shared with update servers and read clients.</p> <p>It is intended for people who:</p> <ul> <li>configure security on the broker and proxy,</li> <li>operate update servers,</li> <li>need to understand how credentials are managed across environments.</li> </ul>"},{"location":"user-guide/api-keys/#access-patterns","title":"Access patterns","text":"<p>In LegoCity, there are three main classes of access to the broker and related APIs:</p> <ul> <li> <p>Write access to the broker   Granted only to update servers and administrative tools. Used to create and update NGSI-LD entities.</p> </li> <li> <p>Internal read access to the broker   Used by the proxy and internal services to query entities. May have broader permissions but is not exposed to browsers.</p> </li> <li> <p>Public read access via the proxy   Used by the dashboard and any external clients. Constrained to specific endpoints, often with rate limits.</p> </li> </ul> <p>LegoCity recommends:</p> <ul> <li>limiting write access to a small set of controlled services,</li> <li>exposing read access to the UI through a proxy layer, not directly to the broker.</li> </ul>"},{"location":"user-guide/api-keys/#configuration-variables","title":"Configuration variables","text":"<p>A deployment should standardise how broker endpoints and credentials are passed into services.</p> <p>Typical variables:</p> <ul> <li> <p><code>BROKER_URL</code>   Base URL of the NGSI-LD context broker, for example: <code>https://broker.example.com/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_KEY</code> or <code>BROKER_WRITE_TOKEN</code>   Credential (token, API key, etc.) for write access.</p> </li> <li> <p><code>BROKER_READ_KEY</code> (optional)   Credential for read access, if the broker enforces read authentication.</p> </li> </ul> <p>These variables are:</p> <ul> <li>defined per environment (development, staging, production),</li> <li>set as environment variables or stored in a secret manager,</li> <li>never committed to the source repository.</li> </ul> <p>Example <code>.env</code> for local development:</p> <pre><code>BROKER_URL=https://dev-broker.example.com/ngsi-ld/v1\nBROKER_WRITE_KEY=dev-broker-write-key\nBROKER_READ_KEY=dev-broker-read-key\n</code></pre> <p><code>.env</code> files should be ignored by version control.</p>"},{"location":"user-guide/api-keys/#authentication-mechanisms","title":"Authentication mechanisms","text":"<p>The actual authentication mechanism depends on the chosen broker and infrastructure. Common options:</p> <ul> <li> <p>Static API keys or tokens   Keys sent in a header such as <code>Authorization</code> or <code>X-API-Key</code>. Simple to configure.</p> </li> <li> <p>Mutual TLS (mTLS)   Client certificates used to authenticate services. Stronger security, more complex management.</p> </li> <li> <p>OAuth2 / OpenID Connect   Tokens issued by an identity provider. Useful when the broker is part of a larger identity-aware platform.</p> </li> </ul> <p>LegoCity expects that:</p> <ul> <li>update servers use non-interactive methods (no manual logins),</li> <li>credentials are configurable, not hard-coded,</li> <li>the chosen mechanism and required headers are documented for the deployment.</li> </ul>"},{"location":"user-guide/api-keys/#patterns-for-write-keys","title":"Patterns for write keys","text":"<p>There are multiple ways to assign write keys to update servers. The deployment must choose one and document it.</p>"},{"location":"user-guide/api-keys/#single-shared-write-key","title":"Single shared write key","text":"<p>All update servers use the same key or token to write to the broker.</p> <p>Characteristics</p> <ul> <li>one write key per broker or per environment.</li> </ul> <p>Advantages</p> <ul> <li>simple to reason about,</li> <li>low administrative overhead.</li> </ul> <p>Drawbacks</p> <ul> <li>if one server is compromised, the same key can be abused from anywhere,</li> <li>revoking the key requires updating all servers at once.</li> </ul> <p>Suitable for small deployments or prototypes.</p>"},{"location":"user-guide/api-keys/#separate-keys-per-update-server","title":"Separate keys per update server","text":"<p>Each update server has its own write key or token.</p> <p>Characteristics</p> <ul> <li>different credentials for each domain server (<code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>, etc.).</li> </ul> <p>Advantages</p> <ul> <li>compromise of one server does not expose write access from others,</li> <li>access can be revoked for a single server without affecting the rest,</li> <li>possible to assign different scopes per key.</li> </ul> <p>Drawbacks</p> <ul> <li>more credentials to manage,</li> <li>more documentation required to track ownership.</li> </ul> <p>Recommended for serious deployments.</p>"},{"location":"user-guide/api-keys/#hybrid-patterns","title":"Hybrid patterns","text":"<p>Some deployments may use one key per domain:</p> <ul> <li>one key for environment-related servers,</li> <li>one key for water and flooding,</li> <li>one key for mobility.</li> </ul> <p>The important point is that the pattern is stable, documented, and reflected in monitoring and incident response.</p>"},{"location":"user-guide/api-keys/#storage-and-distribution","title":"Storage and distribution","text":"<p>Regardless of the pattern, keys must be stored and distributed securely.</p>"},{"location":"user-guide/api-keys/#acceptable-storage","title":"Acceptable storage","text":"<ul> <li>environment variables injected at deployment time,</li> <li>secret managers provided by cloud platforms,</li> <li>secure configuration stores, separate from the application image.</li> </ul>"},{"location":"user-guide/api-keys/#unacceptable-storage","title":"Unacceptable storage","text":"<ul> <li>hard-coded keys in source code,</li> <li>keys committed to git repositories,</li> <li>keys shared informally over unencrypted channels.</li> </ul>"},{"location":"user-guide/api-keys/#example-configuration","title":"Example configuration","text":"<p>For three update servers:</p> <ul> <li> <p><code>env-weather-server</code></p> </li> <li> <p><code>BROKER_URL</code></p> </li> <li> <p><code>BROKER_WRITE_KEY_ENV</code></p> </li> <li> <p><code>water-flood-server</code></p> </li> <li> <p><code>BROKER_URL</code></p> </li> <li> <p><code>BROKER_WRITE_KEY_WATER</code></p> </li> <li> <p><code>mobility-parking-server</code></p> </li> <li><code>BROKER_URL</code></li> <li><code>BROKER_WRITE_KEY_MOBILITY</code></li> </ul> <p>Each service reads its configuration from the environment or a secret manager at startup.</p>"},{"location":"user-guide/api-keys/#key-rotation","title":"Key rotation","text":"<p>Key rotation replaces existing keys with new ones without long service interruption.</p> <p>A simple rotation process:</p> <ol> <li> <p>Generate new keys    Create new keys or tokens at the broker or gateway. Store them in the secret manager or configuration system.</p> </li> <li> <p>Update services    Update environment variables or config for each update server to use the new key. Restart or reload the servers.</p> </li> <li> <p>Verify operation    Check that update servers continue to write entities successfully. Monitor logs and metrics for write failures.</p> </li> <li> <p>Revoke old keys    Once all services are confirmed to use the new keys, remove or disable the old keys.</p> </li> </ol> <p>The documentation should state:</p> <ul> <li>where keys are defined,</li> <li>who is allowed to rotate them,</li> <li>which monitoring signals indicate a failed rotation.</li> </ul>"},{"location":"user-guide/api-keys/#read-access-and-the-proxy","title":"Read access and the proxy","text":"<p>Write access and read access must be treated differently.</p>"},{"location":"user-guide/api-keys/#internal-read-access","title":"Internal read access","text":"<p>Internal services (proxy, analytics) may read directly from the broker. Depending on configuration, read operations may be:</p> <ul> <li>unrestricted inside a trusted network, or</li> <li>protected by a read-only key or token.</li> </ul> <p>If a read-only key is used, it should be:</p> <ul> <li>distinct from write keys,</li> <li>not exposed to browsers.</li> </ul>"},{"location":"user-guide/api-keys/#public-read-access-via-proxy","title":"Public read access via proxy","text":"<p>The dashboard and public clients should call the proxy, not the broker directly. The proxy:</p> <ul> <li>issues read queries to the broker,</li> <li>transforms responses into simpler structures,</li> <li>enforces caching, rate limits and access control.</li> </ul> <p>Broker credentials (read or write) are never embedded in frontend code. Browsers only see the proxy URL and any proxy-level keys or user authentication mechanisms.</p>"},{"location":"user-guide/api-keys/#example-scenario","title":"Example scenario","text":"<p>Consider a deployment with:</p> <ul> <li>a broker at <code>https://broker.city.example/ngsi-ld/v1</code>,</li> <li>three update servers: <code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>,</li> <li>one proxy at <code>https://api.city.example</code>.</li> </ul>"},{"location":"user-guide/api-keys/#broker","title":"Broker","text":"<p>Write tokens configured at the broker or gateway:</p> <ul> <li><code>TOKEN_ENV</code> for environment entities,</li> <li><code>TOKEN_WATER</code> for water and flooding entities,</li> <li><code>TOKEN_MOBILITY</code> for mobility entities.</li> </ul>"},{"location":"user-guide/api-keys/#update-servers","title":"Update servers","text":"<ul> <li> <p><code>env-weather-server</code></p> </li> <li> <p><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_TOKEN=TOKEN_ENV</code></p> </li> <li> <p><code>water-flood-server</code></p> </li> <li> <p><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_TOKEN=TOKEN_WATER</code></p> </li> <li> <p><code>mobility-parking-server</code></p> </li> <li><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></li> <li><code>BROKER_WRITE_TOKEN=TOKEN_MOBILITY</code></li> </ul> <p>Each server sends its token in the appropriate header when writing entities.</p>"},{"location":"user-guide/api-keys/#proxy","title":"Proxy","text":"<ul> <li>runs at <code>https://api.city.example</code>,</li> <li>uses internal credentials or network trust to query the broker,</li> <li>exposes endpoints such as:</li> <li><code>/map/weather</code></li> <li><code>/map/flood-zones</code></li> <li><code>/map/parking-facilities</code></li> </ul> <p>The dashboard calls these endpoints and never sees broker-level tokens.</p>"},{"location":"user-guide/api-keys/#incident-handling","title":"Incident handling","text":"<p>If a key is exposed or suspected to be compromised:</p> <ul> <li>identify which key was exposed and which services use it,</li> <li>revoke or disable the key at the broker or gateway,</li> <li>generate and distribute a replacement key where necessary,</li> <li>update configuration and restart affected services,</li> <li>review logs for unauthorised write attempts or suspicious patterns.</li> </ul> <p>The documentation should indicate:</p> <ul> <li>where keys can be revoked,</li> <li>which logs or dashboards show broker access,</li> <li>how to verify that entities have not been corrupted.</li> </ul>"},{"location":"user-guide/api-keys/#summary","title":"Summary","text":"<ul> <li>Update servers are the only components with write access to the broker and use keys or tokens defined via configuration, not in code.</li> <li>A deployment must choose and document a clear pattern for write keys (shared, per-server, or hybrid).</li> <li>Keys must be stored securely, rotated regularly, and revoked immediately if compromised.</li> <li>The dashboard and public clients obtain data through the proxy; broker credentials are never exposed to browsers.</li> <li>Internal read access, external read access, and write access should be configured and monitored separately.</li> </ul>"},{"location":"user-guide/data-and-brokers/","title":"Data and brokers","text":"<p>This page explains in detail how the data layer of LegoCity is organised around NGSI-LD context brokers and update servers.</p> <p>It focuses on:</p> <ul> <li>what the broker is expected to store and provide,</li> <li>how data is grouped into domains,</li> <li>how update servers are designed and operated,</li> <li>how decisions about history, quality and source-of-truth are made.</li> </ul> <p>It does not cover deployment commands or infrastructure automation; those are documented in the Deployment section.</p>"},{"location":"user-guide/data-and-brokers/#1-overall-data-flow","title":"1. Overall data flow","text":"<p>The basic data flow in a LegoCity deployment is:</p> <ol> <li>An external system (for example, a weather API, a sensor gateway, a flood model, a transport feed) exposes raw data.</li> <li>An update server for that domain reads the raw data on a schedule.</li> <li>The update server converts the raw data into NGSI-LD entities that follow the agreed models and conventions.</li> <li>The update server writes those entities into a context broker.</li> <li>The dashboard and other application services read entities from the broker (usually via a proxy) and turn them into map layers and UI elements.</li> </ol> <p>The important constraints are:</p> <ul> <li>update servers are the only components that write to the broker in normal operation,</li> <li>the broker is the only source where the dashboard reads city context,</li> <li>if something is not in the broker, it does not exist from LegoCity\u2019s point of view.</li> </ul>"},{"location":"user-guide/data-and-brokers/#2-context-broker-role","title":"2. Context broker role","text":"<p>The context broker is responsible for:</p> <ul> <li>storing all current state of city entities that LegoCity needs,</li> <li>exposing a standard NGSI-LD API for create, update, query and subscription,</li> <li>providing a consistent, canonical view of \u201cwhat the city looks like right now\u201d.</li> </ul> <p>From LegoCity\u2019s perspective, the broker must:</p> <ul> <li>store entities for all domains in scope (for example, environment, flooding, mobility, public services),</li> <li>support geospatial queries and filtering on attributes that the UI will need,</li> <li>handle the expected volume and update frequency of the entities.</li> </ul> <p>The broker is not expected to:</p> <ul> <li>perform heavy analytics,</li> <li>render maps,</li> <li>be aware of UI concepts like pages, blocks or permissions inside the dashboard.</li> </ul> <p>Those concerns are external to the broker.</p>"},{"location":"user-guide/data-and-brokers/#21-what-is-stored-in-the-broker","title":"2.1 What is stored in the broker","text":"<p>For each domain, the broker stores:</p> <ul> <li>entity identifiers that represent real-world objects or observations,</li> <li>current values of attributes (status, measurements, capacities, etc.),</li> <li>geospatial attributes (locations, geometries, coverage areas),</li> <li>timestamps that indicate when the information was observed or last updated.</li> </ul> <p>Examples of what is in scope for the broker:</p> <ul> <li>\u201cThere is a flood zone with this polygon and this current risk level.\u201d</li> <li>\u201cThere is a parking facility with this capacity and this current occupancy.\u201d</li> <li>\u201cThere is a weather observation at this location with this temperature and humidity.\u201d</li> </ul> <p>If the dashboard needs to show a value for the user, that value should be present or derivable from entities in the broker.</p>"},{"location":"user-guide/data-and-brokers/#22-what-is-not-stored-in-the-broker","title":"2.2 What is not stored in the broker","text":"<p>The broker is not required to store:</p> <ul> <li>UI configuration (map styles, layer visibility defaults, panel layouts),</li> <li>user accounts, roles or permissions,</li> <li>documentation or descriptive text that is only relevant for the admin UI.</li> </ul> <p>These items belong to PayloadCMS or other parts of the LegoCity stack.</p>"},{"location":"user-guide/data-and-brokers/#3-broker-topology","title":"3. Broker topology","text":"<p>A LegoCity deployment must choose how many brokers to run and what each one is responsible for. This is a structural decision that affects every other part of the system.</p>"},{"location":"user-guide/data-and-brokers/#31-single-broker-deployments","title":"3.1 Single-broker deployments","text":"<p>In a single-broker deployment:</p> <ul> <li>one broker instance stores all entities for the deployment (all domains, all city areas),</li> <li>all update servers write to that broker,</li> <li>all dashboards and application services read from that broker.</li> </ul> <p>This is usually the default for:</p> <ul> <li>proofs of concept,</li> <li>small to medium deployments,</li> <li>a single city or campus.</li> </ul> <p>Advantages:</p> <ul> <li>fewer endpoints to configure,</li> <li>simpler monitoring and logging,</li> <li>easier for new team members to understand.</li> </ul> <p>Risks and constraints:</p> <ul> <li>if the broker is unavailable, all domains are affected,</li> <li>all domains share the same performance and scaling limits,</li> <li>careful naming and scoping is needed to avoid conflicts between domains.</li> </ul> <p>In practice, a single-broker deployment should still separate environments (for example, one broker for development and one for production).</p>"},{"location":"user-guide/data-and-brokers/#32-multi-broker-deployments","title":"3.2 Multi-broker deployments","text":"<p>In a multi-broker deployment, different brokers are used for different scopes. Common patterns:</p> <ul> <li>one broker per environment (development, staging, production),</li> <li>one broker per city or administrative region,</li> <li>one broker for high-frequency telemetry and another for more static reference data.</li> </ul> <p>Advantages:</p> <ul> <li>clearer separation between environments or cities,</li> <li>different tuning and retention policies per broker,</li> <li>failures in one broker do not immediately affect all domains.</li> </ul> <p>Costs and constraints:</p> <ul> <li>more endpoints and credentials to manage,</li> <li>update servers must know which broker to write to,</li> <li>dashboards and proxies must be configured to query the correct broker for each context.</li> </ul> <p>The documentation of a LegoCity deployment should explicitly list:</p> <ul> <li>each broker instance (name and base URL),</li> <li>which domains and entity types each broker owns,</li> <li>which update servers and applications are allowed to access each broker.</li> </ul>"},{"location":"user-guide/data-and-brokers/#4-domains-and-ownership","title":"4. Domains and ownership","text":"<p>Without structure, a broker can become a random collection of entities. LegoCity encourages grouping entities into domains and assigning clear responsibility.</p> <p>Typical domains are:</p> <ul> <li>Environment (weather, air quality, noise),</li> <li>Water and flooding,</li> <li>Mobility and transport,</li> <li>Public services (health, education, administration),</li> <li>Infrastructure assets (parking, charging stations, cameras).</li> </ul> <p>For each domain, the documentation should state:</p> <ul> <li>which entity types belong to it (by <code>type</code> name),</li> <li>which update server(s) are responsible for creating and updating those entities,</li> <li>which broker instance stores those entities,</li> <li>which dashboards or map views consume that domain.</li> </ul> <p>This gives a clear answer to questions like:</p> <ul> <li>\u201cIf flood data is wrong, which server should we check?\u201d</li> <li>\u201cWhere does the air quality data come from?\u201d</li> <li>\u201cIf we add a new city, which domains need new brokers or new servers?\u201d</li> </ul> <p>Domains are a documentation and ownership concept; they are not a new technical component.</p>"},{"location":"user-guide/data-and-brokers/#5-update-servers","title":"5. Update servers","text":"<p>Update servers are integration services. They connect external systems to the context broker and are the only regular writers of entities.</p>"},{"location":"user-guide/data-and-brokers/#51-responsibilities","title":"5.1 Responsibilities","text":"<p>An update server is responsible for a complete loop:</p> <ol> <li>Configuration    It reads all its configuration from environment variables or configuration files, including:</li> <li>broker URL and credentials,</li> <li>external API endpoints and keys,</li> <li> <p>update frequency and any domain-specific parameters (for example, list of locations to monitor).</p> </li> <li> <p>Data ingestion    It contacts external data sources:</p> </li> <li>fetches raw data,</li> <li>handles paging, rate limits and temporary errors,</li> <li> <p>validates that the received data is structurally sound.</p> </li> <li> <p>Transformation    It converts raw data into the internal entity representation:</p> </li> <li>chooses the entity type,</li> <li>sets identifiers according to the project\u2019s conventions,</li> <li>fills attributes that match the chosen Smart Data Model,</li> <li> <p>sets locations and timestamps.</p> </li> <li> <p>Publishing    It writes entities to the broker:</p> </li> <li>creates entities that do not exist yet,</li> <li>updates attributes for existing entities,</li> <li> <p>handles partial failures and retries where appropriate.</p> </li> <li> <p>Reporting and health    It logs key events:</p> </li> <li>how many entities were created or updated,</li> <li>when the last successful update occurred,</li> <li>whether there were errors and of what kind.</li> </ol> <p>This loop can be implemented as a continuously running service with a timer or as a scheduled job.</p>"},{"location":"user-guide/data-and-brokers/#52-granularity-and-scope","title":"5.2 Granularity and scope","text":"<p>The recommended approach is to keep update servers narrow in scope:</p> <ul> <li>one server per external data source,</li> <li>or one server per domain when sources are tightly related.</li> </ul> <p>This avoids:</p> <ul> <li>mixing unrelated concerns in a single codebase,</li> <li>making one failure affect many domains,</li> <li>creating hidden couplings that are hard to debug.</li> </ul> <p>Each server should have a clear name and documented scope, for example:</p> <ul> <li><code>env-weather-server</code> \u2013 reads weather API, writes <code>WeatherObserved</code>,</li> <li><code>water-flood-server</code> \u2013 reads flood model outputs, writes <code>FloodZone</code>,</li> <li><code>mobility-parking-server</code> \u2013 reads parking backend, writes <code>ParkingFacility</code> and <code>ParkingSpot</code>.</li> </ul>"},{"location":"user-guide/data-and-brokers/#53-idempotency-and-conflict-handling","title":"5.3 Idempotency and conflict handling","text":"<p>Update servers should be designed to be idempotent:</p> <ul> <li>running the same update twice in a row should not create duplicate entities,</li> <li>updates should always converge to the correct state.</li> </ul> <p>This has implications for:</p> <ul> <li>how IDs are generated (stable IDs vs new random IDs),</li> <li>how updates are applied (replace vs patch),</li> <li>how deleted or obsolete entities are handled (explicit deletion, or marking as inactive).</li> </ul> <p>The project should define how deletions and deactivations are represented, so the UI can interpret them correctly (for example, whether inactive entities are hidden or styled differently).</p>"},{"location":"user-guide/data-and-brokers/#6-current-state-and-history","title":"6. Current state and history","text":"<p>NGSI-LD brokers can support both current context and temporal queries, but LegoCity must define how it uses this capability.</p>"},{"location":"user-guide/data-and-brokers/#61-current-state","title":"6.1 Current state","text":"<p>For many dashboards, only the current state matters. For example:</p> <ul> <li>current water level,</li> <li>current parking occupancy,</li> <li>current flood risk level.</li> </ul> <p>In this mode:</p> <ul> <li>the broker holds one entity per real-world object,</li> <li>each update overwrites relevant attributes,</li> <li>old values are not kept in the broker.</li> </ul> <p>This is simpler to operate and often sufficient for monitoring-style use cases.</p>"},{"location":"user-guide/data-and-brokers/#62-history-and-trends","title":"6.2 History and trends","text":"<p>For some use cases, LegoCity may need short-term history, for example:</p> <ul> <li>charts of the last 24 hours of weather or air quality,</li> <li>recent evolution of water levels during a flood event.</li> </ul> <p>Two approaches are possible:</p> <ul> <li>use the broker\u2019s temporal features (if available and enabled) to store attribute history,</li> <li>forward data to a specialised time-series database while keeping only the latest values in the broker.</li> </ul> <p>The choice should be documented for each domain:</p> <ul> <li>which domains store only current state,</li> <li>which domains retain a limited history,</li> <li>where long-term analytics data is stored if not in the broker.</li> </ul> <p>The dashboard and proxy must be aligned with this decision so that queries are realistic and efficient.</p>"},{"location":"user-guide/data-and-brokers/#7-data-contracts-and-conventions","title":"7. Data contracts and conventions","text":"<p>To keep the data layer coherent, LegoCity relies on explicit data contracts between update servers, brokers and the UI.</p> <p>These contracts cover:</p> <ul> <li>which entity types are used,</li> <li>which attributes must be present,</li> <li>which naming conventions are followed.</li> </ul>"},{"location":"user-guide/data-and-brokers/#71-entity-types-and-models","title":"7.1 Entity types and models","text":"<p>For each entity type used in LegoCity, the documentation should specify:</p> <ul> <li>the name of the entity type (for example, <code>WeatherObserved</code>),</li> <li>whether it follows a FIWARE Smart Data Model directly, an extended version, or a custom schema,</li> <li>which attributes are mandatory (must always be present),</li> <li>which attributes are optional and under which conditions they appear.</li> </ul> <p>Update servers must respect these definitions when creating or updating entities.</p>"},{"location":"user-guide/data-and-brokers/#72-identifiers","title":"7.2 Identifiers","text":"<p>Identifiers (<code>id</code>) need to be:</p> <ul> <li>stable over time for the same real-world object or location,</li> <li>predictable enough that systems can refer to entities by ID if needed,</li> <li>unique across the broker, or at least across a domain.</li> </ul> <p>The documentation should state:</p> <ul> <li>how IDs are constructed (for example, URN patterns that include domain and location),</li> <li>whether IDs are derived from external identifiers or generated internally,</li> <li>how ID changes are handled if an external system renames something.</li> </ul>"},{"location":"user-guide/data-and-brokers/#73-geospatial-attributes","title":"7.3 Geospatial attributes","text":"<p>Because LegoCity is map-centric, geospatial attributes must be consistent:</p> <ul> <li>which attribute name is used for location (for example, always <code>location</code>),</li> <li>which types of geometries are expected for each entity type (point, line, polygon),</li> <li>how coordinate reference systems are handled (typically WGS84).</li> </ul> <p>This consistency allows:</p> <ul> <li>generic map layers that can handle many entity types,</li> <li>simple filtering by bounding box or area of interest.</li> </ul>"},{"location":"user-guide/data-and-brokers/#74-time-attributes","title":"7.4 Time attributes","text":"<p>Time is critical for context:</p> <ul> <li>each observation-type entity should have a clear observation timestamp,</li> <li>entities representing static objects (for example, a public facility) may have creation or last-update timestamps.</li> </ul> <p>The documentation should list:</p> <ul> <li>which attributes carry time information,</li> <li>how they are used in the UI (for example, to mark stale data).</li> </ul>"},{"location":"user-guide/data-and-brokers/#8-multiple-sources-for-the-same-entity-type","title":"8. Multiple sources for the same entity type","text":"<p>Sometimes more than one external source can provide data for the same conceptual entity type. For example, different agencies might publish partially overlapping flood maps.</p> <p>In such cases, LegoCity needs explicit rules to avoid confusion:</p> <ul> <li>whether one source is considered the authoritative source and others are ignored,</li> <li>whether entities from different sources are kept separate by ID and metadata,</li> <li>whether a dedicated aggregation service combines data from multiple sources into a single set of entities.</li> </ul> <p>If multiple sources are used, the documentation should specify for each entity type:</p> <ul> <li>which sources feed this type,</li> <li>how conflicts are resolved,</li> <li>which attributes indicate the origin or quality of each entity.</li> </ul>"},{"location":"user-guide/data-and-brokers/#9-subscriptions-and-reactive-flows","title":"9. Subscriptions and reactive flows","text":"<p>NGSI-LD supports subscriptions so that services can be notified when entities change. LegoCity may use subscriptions to drive backend workflows, but not as a primary mechanism for the dashboard.</p> <p>Possible uses include:</p> <ul> <li>a service that updates aggregated indicators when sensor entities change,</li> <li>a monitoring component that alerts when certain thresholds are crossed.</li> </ul> <p>If subscriptions are used:</p> <ul> <li>the components that create and manage subscriptions should be identified,</li> <li>the scopes of subscriptions (which entity types, which conditions) should be documented,</li> <li>error handling and recovery strategies should be defined (what happens when notification delivery fails).</li> </ul> <p>The dashboard is expected to continue using normal queries; any \u201cpush\u201d logic should be mediated by application services.</p>"},{"location":"user-guide/data-and-brokers/#10-relationship-to-the-dashboard-and-proxy","title":"10. Relationship to the dashboard and proxy","text":"<p>The data layer and the UI layer communicate through a narrow interface.</p> <p>In a typical setup:</p> <ul> <li>the proxy layer exposes a small set of HTTP endpoints tailored to the UI,</li> <li>these endpoints internally query the broker using NGSI-LD and project the results into simpler structures,</li> <li>the dashboard calls these endpoints to obtain the data it needs for map views and blocks.</li> </ul> <p>Consequences:</p> <ul> <li>the broker\u2019s internal details are not exposed directly to browsers or untrusted clients,</li> <li>changes in entity structures can be absorbed by the proxy without immediately breaking the UI,</li> <li>security policies (who can read what) can be implemented in one place.</li> </ul> <p>The design of these proxy endpoints is documented in the Development section; from the data-layer perspective, it is enough to understand that:</p> <ul> <li>read access is centralised,</li> <li>write access remains with update servers,</li> <li>the broker remains the single source of truth.</li> </ul>"},{"location":"user-guide/data-and-brokers/#11-summary","title":"11. Summary","text":"<ul> <li>The context broker stores the current representation of the city as NGSI-LD entities and is treated as the source of truth.</li> <li>A deployment must choose and document its broker topology (single or multiple brokers) and domain structure.</li> <li>Domains group related entity types and update servers; each domain has clear ownership and responsibilities.</li> <li>Update servers are the only regular writers to the broker and must follow shared data contracts for entity structure, identifiers, geospatial attributes and timestamps.</li> <li>Decisions about history, retention and multiple data sources must be explicit so that the dashboard and analytics behave predictably.</li> <li>The dashboard reads from the broker through a proxy, keeping UI concerns clearly separated from data ingestion and storage.</li> </ul>"},{"location":"user-guide/entities/","title":"Entities","text":"<p>This page describes how LegoCity represents city information as NGSI-LD entities, how Smart Data Models are used, and what conventions apply to identifiers, attributes and domains.</p> <p>It is intended for people who:</p> <ul> <li>design the data model for a LegoCity deployment,</li> <li>implement update servers that create and update entities,</li> <li>build proxy endpoints or UI layers that query entities.</li> </ul>"},{"location":"user-guide/entities/#1-role-of-entities-in-legocity","title":"1. Role of entities in LegoCity","text":"<p>In LegoCity, almost everything that appears on the map or in the dashboard is backed by one or more entities.</p> <p>Examples:</p> <ul> <li>a sensor measuring temperature and humidity   \u2192 one <code>WeatherObserved</code> entity per observation point;</li> <li>a flood-prone area   \u2192 one <code>FloodZone</code> entity with a polygon geometry;</li> <li>a public hospital   \u2192 a <code>HealthFacility</code> entity with service attributes and a point location;</li> <li>a parking garage   \u2192 a <code>ParkingFacility</code> entity with capacity, occupancy and status.</li> </ul> <p>The rules are:</p> <ul> <li>if a concept needs to appear in the UI or be queried, it should have a corresponding entity type,</li> <li>update servers create and update entities according to domain-specific logic,</li> <li>the broker stores these entities and provides a consistent view of the city.</li> </ul>"},{"location":"user-guide/entities/#11-anatomy-of-an-entity-example","title":"1.1 Anatomy of an Entity (Example)","text":"<ul> <li>Before diving into details, here is what a concrete entity looks like in LegoCity (represented in JSON-LD).</li> <li>Notice the <code>type</code>, the <code>id</code>, and how properties are structured with <code>value</code> and <code>unitCode</code>.</li> </ul> <pre><code>{\n  \"id\": \"urn:ngsi-ld:WeatherObserved:ctu:station:STATION_001\",\n  \"type\": \"WeatherObserved\",\n  \"@context\": \"[https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld](https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld)\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 30.5,\n    \"unitCode\": \"CEL\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.78, 10.04]\n    }\n  },\n  \"observedAt\": {\n    \"type\": \"Property\",\n    \"value\": \"2023-11-29T10:00:00Z\"\n  }\n}\n## 2. Entity types and domains\n\nA LegoCity deployment should maintain a clear list of **entity types** in use, grouped by **domain**.\n\n### 2.1 Example domain structure\n\nThe exact domains depend on the project, but a typical breakdown is:\n\n- **Environment**\n  - `WeatherObserved` \u2013 point observations of weather at specific locations.\n  - `AirQualityObserved` \u2013 air quality measurements from fixed or mobile sensors.\n\n- **Water and flooding**\n  - `FloodZone` \u2013 polygons representing areas at risk or currently flooded.\n  - `WaterLevel` \u2013 current water levels at specific stations.\n\n- **Mobility and transport**\n  - `ParkingFacility` \u2013 off-street parking structures (garages, lots).\n  - `ParkingSpot` \u2013 individual parking spaces (optional, if needed).\n  - `PublicTransportStop` \u2013 bus or transit stops with location and lines served.\n\n- **Public services**\n  - `HealthFacility` \u2013 hospitals, clinics and related services.\n  - `EducationalFacility` \u2013 schools and universities.\n  - `PublicService` \u2013 administrative or general-purpose public services.\n\n- **Infrastructure and assets**\n  - `ChargingStation` \u2013 EV charging points.\n  - `Camera` \u2013 monitoring cameras.\n\n&gt; Example:\n&gt; A flood dashboard might use `FloodZone` and `WaterLevel` entities, while a mobility dashboard uses `ParkingFacility` and `PublicTransportStop`.\n&gt; Both dashboards read from the same broker but focus on different entity types.\n\n### 2.2 Entity catalogue\n\nFor each entity type in the deployment, the documentation should maintain a catalogue entry.\n\n---\n\n## 3. Smart Data Models\n\nWhere possible, LegoCity should base entity definitions on **FIWARE Smart Data Models**.\n\n### 3.1 Why use Smart Data Models\n\nUsing Smart Data Models provides:\n\n- consistent attribute names across deployments,\n- a clear starting point for new domains,\n- easier reuse of community examples and tools,\n- less ambiguity when multiple teams work on the same domain.\n\n### 3.2 Adoption strategies\n\nFor each entity type, decide one of the following:\n\n- **Direct adoption**\n  Use the Smart Data Model as defined.\n  Example: use `WeatherObserved` exactly as defined in the Smart Data Models documentation.\n\n- **Adoption with extensions**\n  Use the Smart Data Model as a base, but add project-specific attributes.\n  Example:\n  - `WeatherObserved` with an extra attribute `localAlertCode` used only in this city.\n\n- **Custom model**\n  Define a project-specific entity type when no suitable Smart Data Model exists.\n  Example:\n  - `FloodZone` defined around a custom flood risk map that has attributes `riskLevel`, `sourceDataset`, `validUntil`.\n\nFor each type, the entity catalogue should state which strategy was chosen.\n\n### 3.3 The JSON-LD Context (`@context`)\n\nIn NGSI-LD, every entity must include (or link to) a `@context`. This tells the system how to interpret attribute names (e.g., that `temperature` refers to a specific definition in the Smart Data Models dictionary).\n\nIn LegoCity:\n- Update servers must append the correct `@context` URL when sending data.\n- Proxies and dashboards usually work with expanded data or a default context.\n\n---\n\n## 4. Identifiers (`id`)\n\nEntity identifiers must be:\n\n- unique within the broker (or at least within the relevant domain),\n- stable for the lifetime of the entity,\n- predictable enough to support linking between systems.\n\n### 4.1 Identifier patterns\n\nA LegoCity deployment should choose a pattern and document it.\n\nExample patterns:\n\n- For static assets (parking facilities, hospitals):\n  `urn:ngsi-ld:ParkingFacility:ctu:parking:CTU_PARK_A`\n  `urn:ngsi-ld:HealthFacility:ctu:hospital:CTU_HOSP_01`\n\n- For observation entities where one entity represents a **time series at a location**:\n  `urn:ngsi-ld:WeatherObserved:ctu:station:STATION_001`\n  (attributes updated over time, no timestamp in ID)\n\n- For observation entities where each entity represents a **single point in time**:\n  `urn:ngsi-ld:WeatherObserved:ctu:station:STATION_001:2025-11-29T10:00:00Z`\n\nThe choice between the last two patterns affects:\n\n- whether you keep only the latest state in the broker, or\n- whether you want many entities over time for temporal queries.\n\n### 4.2 ID lifecycle\n\nThe docs should clarify for each type:\n\n- whether IDs are permanent (never reused) or can be reassigned,\n- how deletions are handled.\n\nExample:\n\n- `ParkingFacility` entities: IDs are permanent. If a facility closes, a `status` attribute changes to `closed` instead of deleting the entity.\n- `WeatherObserved` (latest-only model): entity persists, attributes are updated; old values are not separately addressed.\n\n---\n\n## 5. Geospatial attributes\n\nBecause LegoCity is map-centric, geospatial attributes must be handled consistently.\n\n### 5.1 Common conventions\n\nA typical convention is:\n\n- use `location` as the main geospatial attribute,\n- represent:\n  - sensors and facilities as **Points**,\n  - zones (flood, administrative) as **Polygons**.\n\nExamples:\n\n- `WeatherObserved.location` \u2192 Point at sensor coordinates.\n- `ParkingFacility.location` \u2192 Point at entrance or centroid.\n- `FloodZone.location` \u2192 Polygon representing the area at risk.\n\nAll coordinates should use the same coordinate reference system, typically WGS84 (`[longitude, latitude]`).\n\n### 5.2 Geospatial expectations per type\n\nFor each entity type, the entity catalogue should specify:\n\n- whether `location` is mandatory,\n- which geometry types are valid.\n\nExample:\n\n- `WeatherObserved` \u2013 `location` required, geometry type: Point.\n- `FloodZone` \u2013 `location` required, geometry type: Polygon.\n- `PublicTransportStop` \u2013 `location` required, geometry type: Point.\n- `PublicService` \u2013 `location` required, geometry type: Point; may also include an address as a separate attribute.\n\n---\n\n## 6. Time attributes\n\nTime attributes indicate when data was observed or last updated.\n\n### 6.1 Observation vs system timestamps\n\nExamples:\n\n- `WeatherObserved`:\n  - `observedAt` \u2013 when the measurement was taken at the station,\n  - `lastUpdate` \u2013 when the update server last wrote this entity (optional).\n\n- `WaterLevel`:\n  - `observedAt` \u2013 time of the water level reading.\n\n- `FloodZone`:\n  - `validFrom` and `validTo` \u2013 interval during which the flood map is valid, or\n  - `lastAssessment` \u2013 when the zone was last assessed.\n\nFor static entities (e.g. `HealthFacility`):\n\n- `createdAt` \u2013 when the entity was created in the system,\n- `modifiedAt` \u2013 when key attributes were last updated.\n\n### 6.2 Usage in LegoCity\n\nThe documentation should specify, per entity type:\n\n- which time attribute the UI uses to decide whether data is \u201cfresh\u201d,\n- whether entries older than a certain threshold should be highlighted or hidden.\n\nExample:\n\n- For `WeatherObserved`, if `observedAt` is older than 3 hours, the UI might:\n  - show a warning icon, or\n  - de-emphasise the marker on the map.\n\n---\n\n## 7. Core attributes and quality\n\nBeyond IDs, location and time, each entity type has domain-specific attributes.\n\n### 7.1 Core attributes\n\nEach entity type should have a small set of **core attributes** that:\n\n- are required for meaningful display,\n- are expected in normal operations,\n- are used for styling and filtering.\n\nExamples:\n\n- `WeatherObserved` (Environment):\n  - `temperature`, `relativeHumidity`, `pressure`, `observedAt`, `location`.\n\n- `FloodZone` (Water &amp; flooding):\n  - `riskLevel` (e.g. low / medium / high),\n  - `status` (e.g. active / inactive),\n  - `location` (Polygon).\n\n- `ParkingFacility` (Mobility):\n  - `totalCapacity`,\n  - `currentOccupancy`,\n  - `status` (open / closed),\n  - `location`.\n\nThe entity catalogue should list these core attributes explicitly.\n\n### 7.2 Data quality and status\n\nSome domains require quality indicators.\n\nExamples:\n\n- `WeatherObserved`:\n  - `qualityIndex` or `validity` flag for sensor readings.\n\n- `AirQualityObserved`:\n  - `aqi` (air quality index),\n  - `source` (provider name),\n  - `confidence` (optional).\n\n- `FloodZone`:\n  - `sourceDataset`,\n  - `confidenceLevel`.\n\nThese attributes can be used to:\n\n- filter out low-quality data in the proxy or UI,\n- display warnings or confidence indicators to users.\n\n---\n\n## 8. Relationships between entities\n\nNGSI-LD relationships explicitly link entities.\n\n### 8.1 Relationship examples\n\nCommon relationship patterns in a smart city context:\n\n- `ParkingSpot` \u2192 `ParkingFacility`\n  Relationship: `belongsToFacility` (spot belongs to facility).\n\n- `PublicService` \u2192 `FloodZone`\n  Relationship: `locatedWithin` (service lies inside a flood zone).\n\n- `WeatherObserved` \u2192 `WeatherStation` (if stations are modelled as separate entities).\n\nThese relationships allow:\n\n- querying all parking spots for a given facility,\n- finding all public services currently within high-risk flood zones,\n- linking observations to their physical stations.\n\n### 8.2 Design guidelines\n\nWhen deciding whether to use a relationship or just duplicate information:\n\n- use relationships when:\n  - multiple entities refer to the same object (e.g. many `ParkingSpot` to one `ParkingFacility`),\n  - you need to keep the central object\u2019s attributes in one place (e.g. facility name, address).\n\n- use duplicated attributes when:\n  - linking is not required,\n  - or when simplicity is more important than normalisation.\n\nFor each relationship used, the docs should specify:\n\n- the source type,\n- the target type,\n- the attribute name for the relationship,\n- cardinality (one-to-one, one-to-many).\n\n### 8.3 Implementation details\n\nTechnically, a relationship in NGSI-LD is different from a regular property. It must uses `\"type\": \"Relationship\"` and stores the target ID in `\"object\"` (not `\"value\"`).\n\nExample of a Parking Spot linked to a Facility:\n\n```json\n\"refParkingFacility\": {\n  \"type\": \"Relationship\",\n  \"object\": \"urn:ngsi-ld:ParkingFacility:ctu:parking:CTU_PARK_A\"\n}\n\n---\n\n## 9. Designing new entity types\n\nWhen new requirements appear, additional entity types may be needed. A consistent process should be followed.\n\n### 9.1 Step-by-step process\n\n1. **Clarify the use case**\n\n   Example:\n   \u201cWe need to show temporary road closures due to construction.\u201d\n\n2. **Check existing models**\n\n   - See if Smart Data Models already have an entity type for this (e.g. road segments, events).\n   - If yes, adapt or extend it.\n\n3. **Define basic properties**\n\n   - Choose a type name, e.g. `RoadClosure`.\n   - Decide if it is static (one entity per road segment) or event-based (one entity per closure event).\n   - Decide which attributes are required:\n     - `location` (line or polygon),\n     - `reason`,\n     - `startTime`, `endTime`,\n     - `affectedTransportModes`.\n\n4. **Choose an ID pattern**\n\n   - Example: `urn:ngsi-ld:RoadClosure:ctu:RC_2025_0001`.\n\n5. **Document the type**\n\n   - Add it to the entity catalogue with domain \u201cMobility\u201d,\n   - Specify which update server will manage it,\n   - Describe attribute semantics briefly.\n\n6. **Implement and test**\n\n   - Update server generates a small number of entities in a test environment,\n   - Dashboard team checks that data appears correctly and the attributes are sufficient.\n\n### 9.2 Example entity definition (summary style)\n\nFor documentation, a concise summary per entity type is often enough:\n\n&gt; **Entity: ParkingFacility**\n&gt; Domain: Mobility\n&gt; Model: FIWARE Smart Data Model (extended with `localCode`)\n&gt; ID pattern: `urn:ngsi-ld:ParkingFacility:&lt;city&gt;:&lt;facilityCode&gt;`\n&gt; Geometry: `location` (Point)\n&gt; Core attributes:\n&gt; - `name`\n&gt; - `totalCapacity`\n&gt; - `currentOccupancy`\n&gt; - `status` (open / closed)\n&gt; - `localCode` (internal identifier)\n\nThis level of detail is usually sufficient for developers and integrators.\n\n---\n\n## 10. Documentation responsibilities\n\nEntity definitions are shared contracts between:\n\n- integration teams (update servers),\n- backend teams (proxy and APIs),\n- frontend teams (dashboard and blocks).\n\nTo avoid divergence:\n\n- keep the entity catalogue under version control alongside the code,\n- treat changes to entity types as changes to a public contract,\n- require that new or modified types are documented before they are used in production data.\n\nEven if a full JSON schema is not maintained, the documentation should always include:\n\n- type name and domain,\n- ID pattern,\n- geospatial and time attributes,\n- core attributes,\n- any important relationships.\n\n---\n\n## 11. Summary\n\n- Entities are the fundamental units of city context in LegoCity; almost everything visible in the UI is backed by entities in the broker.\n- Each deployment should maintain an entity catalogue that lists types, domains, sources, and core attributes, with small concrete examples.\n- Smart Data Models should be used wherever possible; when custom models are needed, they must be described clearly.\n- Identifier patterns, geospatial attributes, time attributes and relationships must follow shared conventions so that queries and visualisations behave predictably.\n- When new entity types are introduced, they should follow a consistent design process, be documented, and be tested end-to-end before adoption.\n</code></pre>"},{"location":"user-guide/sample-update-server/","title":"Sample update server","text":"<p>This page describes the sample update server that should be included with LegoCity. The sample is a small, self-contained service that shows how to:</p> <ul> <li>read configuration (broker URL, tokens, external API keys),</li> <li>fetch data from an external source,</li> <li>transform it into NGSI-LD entities,</li> <li>write entities to the context broker.</li> </ul> <p>It is intended for:</p> <ul> <li>new users who want to verify their broker and data flow,</li> <li>developers who need a starting point for building real update servers.</li> </ul>"},{"location":"user-guide/sample-update-server/#purpose-and-scope","title":"Purpose and scope","text":"<p>The sample update server is not a production component. Its goals are:</p> <ul> <li> <p>Demonstration   Show an end-to-end path from an external data source to entities in the broker.</p> </li> <li> <p>Template   Provide a minimal structure that can be copied and extended for real integrations.</p> </li> <li> <p>Verification   Allow operators to quickly confirm that:</p> </li> <li>the broker is reachable,</li> <li>authentication is configured correctly,</li> <li>entities become visible in the dashboard.</li> </ul> <p>The sample server should be:</p> <ul> <li>small enough to read in one sitting,</li> <li>focused on one domain (typically environment),</li> <li>safe to run in a development environment.</li> </ul>"},{"location":"user-guide/sample-update-server/#example-domain-and-entity-type","title":"Example domain and entity type","text":"<p>To keep the sample concrete, it is recommended to focus on a simple domain such as weather observations.</p> <p>Typical choice:</p> <ul> <li>Domain: Environment  </li> <li>Entity type: <code>WeatherObserved</code> </li> <li>Data source: public weather API or static test data</li> </ul> <p>Expected behaviour:</p> <ul> <li>fetch current weather for one or a few locations,</li> <li>map the response to one or more <code>WeatherObserved</code> entities,</li> <li>write the entities into the broker,</li> <li>optionally repeat this on a timer (e.g. every 5\u201310 minutes).</li> </ul> <p>The entity model should follow the same conventions described in the Entities section:</p> <ul> <li>stable IDs for each location,</li> <li><code>location</code> attribute (Point),</li> <li><code>observedAt</code> timestamp,</li> <li>core attributes such as <code>temperature</code> and <code>relativeHumidity</code>.</li> </ul>"},{"location":"user-guide/sample-update-server/#repository-location","title":"Repository location","text":"<p>The LegoCity repository should contain the sample update server in a clearly named directory, for example:</p> <ul> <li><code>services/sample-update-server/</code></li> <li>or <code>examples/update-server-weather/</code></li> </ul> <p>The directory should include:</p> <ul> <li>the application code,</li> <li>a minimal README specific to the server,</li> <li>configuration examples (e.g. <code>.env.example</code>),</li> <li>any scripts or Dockerfiles used to run it.</li> </ul> <p>This documentation page describes the intended behaviour; the repository holds the actual implementation details.</p>"},{"location":"user-guide/sample-update-server/#configuration","title":"Configuration","text":"<p>The sample update server must be configurable only through environment variables or configuration files, not by editing source code.</p> <p>Typical configuration variables:</p> <ul> <li>broker connection:</li> <li> <p><code>BROKER_URL</code>     Base URL of the NGSI-LD context broker.</p> </li> <li> <p><code>BROKER_WRITE_KEY</code> or <code>BROKER_WRITE_TOKEN</code>     Credential used to authenticate write operations.</p> </li> <li> <p>external data source:</p> </li> <li> <p><code>WEATHER_API_URL</code>     Base URL of the weather data API (or endpoint).</p> </li> <li> <p><code>WEATHER_API_KEY</code> (optional)     API key or token, if required by the external service.</p> </li> <li> <p>application behaviour:</p> </li> <li><code>UPDATE_INTERVAL_SECONDS</code>     How often the server fetches data and updates entities.</li> <li><code>LOCATIONS</code>     List of locations or station identifiers to be monitored (format decided by the implementation).</li> </ul> <p>Example <code>.env</code> for development:</p> <pre><code>BROKER_URL=https://dev-broker.example.com/ngsi-ld/v1\nBROKER_WRITE_KEY=dev-broker-write-key\nWEATHER_API_URL=https://api.example.com/weather\nWEATHER_API_KEY=dev-weather-api-key\nUPDATE_INTERVAL_SECONDS=300\nLOCATIONS=CTU_CAMPUS,CTU_CITY_CENTER\n</code></pre> <p>The actual names and formats may differ, but they must be documented clearly in the sample server README.</p>"},{"location":"user-guide/sample-update-server/#high-level-workflow","title":"High-level workflow","text":"<p>The sample update server follows a simple loop:</p> <ol> <li>Load configuration </li> <li>read broker settings,</li> <li>read external API settings,</li> <li>read list of locations or stations,</li> <li> <p>read update interval.</p> </li> <li> <p>Fetch external data </p> </li> <li>for each location in <code>LOCATIONS</code>, call the weather API,</li> <li>handle basic errors (network issues, invalid response),</li> <li> <p>log failures without crashing immediately.</p> </li> <li> <p>Transform to entities </p> </li> <li> <p>for each location and corresponding response:</p> <ul> <li>choose an entity ID (e.g. <code>urn:ngsi-ld:WeatherObserved:ctu:station:CTU_CAMPUS</code>),</li> <li>build an entity with:</li> <li><code>type = \"WeatherObserved\"</code>,</li> <li><code>location</code> as a geospatial attribute (Point),</li> <li><code>observedAt</code> time,</li> <li>core attributes (e.g. <code>temperature</code>, <code>relativeHumidity</code>, <code>pressure</code>),</li> <li>follow the project\u2019s entity conventions.</li> </ul> </li> <li> <p>Write entities to the broker </p> </li> <li>send create or update requests to the broker\u2019s entities endpoint,</li> <li>handle HTTP errors and log them,</li> <li> <p>confirm success with basic logging (e.g. \u201cupdated 2 entities\u201d).</p> </li> <li> <p>Wait and repeat </p> </li> <li>sleep for <code>UPDATE_INTERVAL_SECONDS</code>,</li> <li>repeat the loop while the process is running.</li> </ol> <p>In a development environment, a single iteration (no loop) may be sufficient to confirm configuration.</p>"},{"location":"user-guide/sample-update-server/#running-the-sample-server","title":"Running the sample server","text":"<p>The exact commands depend on the stack used (for example Go, Node.js, or another language), but the general process is:</p> <ol> <li> <p>Prepare the environment</p> </li> <li> <p>ensure that a context broker is running and reachable at the URL you plan to use,</p> </li> <li> <p>ensure that a write key or token is configured and valid.</p> </li> <li> <p>Clone the repository</p> </li> <li> <p>clone the LegoCity repository,</p> </li> <li> <p>change into the sample server directory:</p> <ul> <li>e.g. <code>cd services/sample-update-server</code>    or <code>cd examples/update-server-weather</code>.</li> </ul> </li> <li> <p>Create configuration</p> </li> <li> <p>copy the example configuration file, for example:</p> <ul> <li>copy <code>.env.example</code> to <code>.env</code>,</li> <li>fill in:</li> <li><code>BROKER_URL</code>,</li> <li><code>BROKER_WRITE_KEY</code> or token,</li> <li><code>WEATHER_API_URL</code>,</li> <li><code>WEATHER_API_KEY</code> if needed,</li> <li><code>LOCATIONS</code> and <code>UPDATE_INTERVAL_SECONDS</code>.</li> </ul> </li> <li> <p>Install dependencies</p> </li> <li> <p>install dependencies according to the implementation (for example, <code>npm install</code>, or build a Go binary).</p> </li> <li> <p>Run the server</p> </li> <li> <p>start the application (for example, <code>npm run start</code> or <code>./sample-update-server</code>),</p> </li> <li> <p>check logs to ensure that:</p> <ul> <li>configuration was loaded,</li> <li>requests to the external API succeeded,</li> <li>entities were written to the broker.</li> </ul> </li> <li> <p>Verify in the broker and dashboard</p> </li> <li> <p>query the broker or use its management UI to confirm that:</p> <ul> <li><code>WeatherObserved</code> entities exist,</li> <li>attributes and locations have reasonable values.</li> </ul> </li> <li>if the LegoCity dashboard is running:<ul> <li>open the corresponding map view,</li> <li>confirm that weather markers appear in the expected locations.</li> </ul> </li> </ol>"},{"location":"user-guide/sample-update-server/#expected-behaviour-and-logs","title":"Expected behaviour and logs","text":"<p>The sample server should produce clear, minimal logs. Examples of log messages (conceptually):</p> <ul> <li>on startup:</li> <li> <p>\u201cLoaded configuration: 2 locations, update interval 300 seconds.\u201d</p> </li> <li> <p>on successful update:</p> </li> <li>\u201cFetched weather data for CTU_CAMPUS (temperature 30.1 \u00b0C).\u201d</li> <li>\u201cUpdated entity urn:ngsi-ld:WeatherObserved:ctu:station:CTU_CAMPUS.\u201d</li> <li> <p>\u201cUpdate cycle completed: 2 entities updated.\u201d</p> </li> <li> <p>on error:</p> </li> <li>\u201cFailed to fetch weather data for CTU_CITY_CENTER: HTTP 500 from API.\u201d</li> <li>\u201cFailed to write entity urn:... to broker: HTTP 401 (unauthorized).\u201d</li> </ul> <p>The aim is to make it easy for operators to see:</p> <ul> <li>whether external data is available,</li> <li>whether authentication with the broker works,</li> <li>whether the data contract (entity structure) is being respected.</li> </ul>"},{"location":"user-guide/sample-update-server/#extending-the-sample-server","title":"Extending the sample server","text":"<p>Once the sample server works in development, teams can:</p> <ul> <li>duplicate the project and adapt it for other domains (e.g. flood or parking),</li> <li>or extend the same server to handle additional entity types.</li> </ul> <p>Recommended practices when extending:</p> <ul> <li>keep configuration domain-specific:</li> <li>new environment variables for new sources,</li> <li> <p>structured configuration for multiple domains if using a single process.</p> </li> <li> <p>keep transformation logic separate per entity type:</p> </li> <li>one function or module per type (<code>WeatherObserved</code>, <code>FloodZone</code>, etc.),</li> <li> <p>avoid mixing unrelated transformations into one large block.</p> </li> <li> <p>keep logging and error handling consistent:</p> </li> <li>similar log messages across servers,</li> <li>clear error codes and descriptions.</li> </ul>"},{"location":"user-guide/sample-update-server/#relationship-to-other-documentation","title":"Relationship to other documentation","text":"<p>This page focuses on the conceptual behaviour and configuration of the sample update server.</p> <p>Related documents:</p> <ul> <li> <p>Data and brokers   Explains the overall data flow and the roles of brokers and update servers.</p> </li> <li> <p>Entities   Describes entity types, domains, and data contracts that the sample must follow.</p> </li> <li> <p>API keys and access control   Explains how write tokens and broker URLs are configured and managed.</p> </li> </ul> <p>The sample update server should implement the patterns described in these documents, so that it serves as a realistic example for future integrations.</p>"},{"location":"user-guide/sample-update-server/#summary","title":"Summary","text":"<ul> <li>The sample update server is a small, self-contained service that demonstrates how to fetch external data, transform it into NGSI-LD entities, and write those entities to the broker.</li> <li>It is designed to be easy to run in development to verify configuration and data flow.</li> <li>Configuration is handled through environment variables, including broker connection details, external API settings, locations, and update intervals.</li> <li>The sample focuses on one entity type (typically <code>WeatherObserved</code> in the Environment domain) but can be extended or duplicated for other domains.</li> <li>Logs should make it clear whether external data, broker access, and entity creation are working as expected.</li> <li>The implementation must align with the data contracts and security patterns defined in the rest of the LegoCity documentation.</li> </ul>"},{"location":"vi/","title":"T\u00e0i li\u1ec7u LegoCity","text":"<p>Ch\u00e0o m\u1eebng b\u1ea1n \u0111\u1ebfn v\u1edbi LegoCity \u2014 n\u1ec1n t\u1ea3ng Smart City Builder cho c\u00e1c dashboard \u0111\u00f4 th\u1ecb hi\u1ec7n \u0111\u1ea1i, d\u1ef1a tr\u00ean b\u1ea3n \u0111\u1ed3.</p>"},{"location":"vi/#legocity-la-gi","title":"LegoCity l\u00e0 g\u00ec?","text":"<p>LegoCity l\u00e0 m\u1ed9t n\u1ec1n t\u1ea3ng c\u00f3 th\u1ec3 t\u00e1i s\u1eed d\u1ee5ng v\u00e0 c\u1ea5u h\u00ecnh \u0111\u01b0\u1ee3c \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c dashboard v\u00e0 \u1ee9ng d\u1ee5ng th\u00e0nh ph\u1ed1 th\u00f4ng minh tr\u00ean n\u1ec1n t\u1ea3ng ti\u00eau chu\u1ea9n FIWARE / NGSI-LD v\u00e0 c\u00e1c c\u00f4ng ngh\u1ec7 web hi\u1ec7n \u0111\u1ea1i.</p> <p>T\u00ednh n\u0103ng ch\u00ednh</p> <ul> <li>\ud83c\udfd9\ufe0f T\u00edch h\u1ee3p FIWARE / NGSI-LD \u2013 qu\u1ea3n l\u00fd context v\u00e0 entity d\u1ef1a tr\u00ean ti\u00eau chu\u1ea9n</li> <li>\ud83d\uddfa\ufe0f B\u1ea3n \u0111\u1ed3 t\u01b0\u01a1ng t\u00e1c \u2013 Mapbox GL JS v\u1edbi c\u00e1c l\u1edbp v\u00e0 style c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh</li> <li>\ud83d\udcca Dashboard c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh \u2013 layouts v\u00e0 blocks \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd qua PayloadCMS</li> <li>\ud83d\udd0c Ki\u1ebfn tr\u00fac m\u1edf r\u1ed9ng \u0111\u01b0\u1ee3c \u2013 plugins, proxy services v\u00e0 t\u00edch h\u1ee3p t\u00f9y ch\u1ec9nh</li> <li>\ud83e\udd16 AI helpers t\u00f9y ch\u1ecdn \u2013 h\u1ed7 tr\u1ee3 n\u1ed9i dung trong Payload admin (OpenAI / Anthropic / OpenRouter)</li> <li>\ud83c\udf0d S\u1eb5n s\u00e0ng multi-tenant \u2013 c\u00f3 th\u1ec3 t\u00e1i s\u1eed d\u1ee5ng cho c\u00e1c th\u00e0nh ph\u1ed1 v\u00e0 k\u1ecbch b\u1ea3n kh\u00e1c nhau</li> </ul>"},{"location":"vi/#ieu-huong-nhanh","title":"\u0110i\u1ec1u h\u01b0\u1edbng nhanh","text":""},{"location":"vi/#moi-voi-legocity","title":"\ud83d\ude80 M\u1edbi v\u1edbi LegoCity?","text":"<p>B\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u00e2y n\u1ebfu b\u1ea1n l\u1ea7n \u0111\u1ea7u ti\u1ebfp x\u00fac v\u1edbi LegoCity.</p> <ul> <li>\ud83d\ude80 B\u1eaft \u0111\u1ea7u</li> </ul> <p>Hi\u1ec3u c\u00e1c kh\u00e1i ni\u1ec7m c\u1ed1t l\u00f5i v\u00e0 ch\u1ea1y LegoCity l\u1ea7n \u0111\u1ea7u ti\u00ean.</p> <p>B\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u00e2y</p> <ul> <li>\u2b07\ufe0f C\u00e0i \u0111\u1eb7t</li> </ul> <p>Ch\u1ecdn ph\u01b0\u01a1ng th\u1ee9c c\u00e0i \u0111\u1eb7t: local, Docker, ho\u1eb7c m\u00f4i tr\u01b0\u1eddng ph\u00e1t tri\u1ec3n.</p> <p>C\u00e0i \u0111\u1eb7t LegoCity</p> <ul> <li>\ud83c\udf93 H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng</li> </ul> <p>H\u1ecdc c\u00e1ch s\u1eed d\u1ee5ng maps, layers, dashboards v\u00e0 entities nh\u01b0 m\u1ed9t ng\u01b0\u1eddi d\u00f9ng cu\u1ed1i.</p> <p>\u0110\u1ecdc h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng</p> <ul> <li>\u2699\ufe0f C\u1ea5u h\u00ecnh</li> </ul> <p>C\u1ea5u h\u00ecnh data sources, Mapbox, brokers, APIs v\u00e0 t\u00edch h\u1ee3p AI t\u00f9y ch\u1ecdn.</p> <p>C\u1ea5u h\u00ecnh LegoCity</p>"},{"location":"vi/#danh-cho-developers","title":"\ud83d\udee0\ufe0f D\u00e0nh cho developers","text":"<p>S\u1eed d\u1ee5ng c\u00e1c ph\u1ea7n n\u00e0y n\u1ebfu b\u1ea1n mu\u1ed1n m\u1edf r\u1ed9ng ho\u1eb7c \u0111\u00f3ng g\u00f3p cho LegoCity.</p> <ul> <li>\ud83d\udcbb H\u01b0\u1edbng d\u1eabn ph\u00e1t tri\u1ec3n</li> </ul> <p>Thi\u1ebft l\u1eadp m\u00f4i tr\u01b0\u1eddng dev, t\u1ea1o blocks v\u00e0 m\u1edf r\u1ed9ng n\u1ec1n t\u1ea3ng.</p> <p>B\u1eaft \u0111\u1ea7u ph\u00e1t tri\u1ec3n</p> <ul> <li>\ud83e\udd16 T\u00edch h\u1ee3p AI</li> </ul> <p>C\u1ea5u h\u00ecnh Payload AI plugin v\u00e0 c\u00e1c m\u00f4 h\u00ecnh d\u1ef1a tr\u00ean OpenRouter.</p> <p>C\u1ea5u h\u00ecnh AI</p> <ul> <li>\u2601\ufe0f Tri\u1ec3n khai</li> </ul> <p>Tri\u1ec3n khai LegoCity s\u1eed d\u1ee5ng Docker, AWS, VMs, Cloudflare, ho\u1eb7c Coolify.</p> <p>C\u00e1c t\u00f9y ch\u1ecdn tri\u1ec3n khai</p> <ul> <li>\ud83d\udcda T\u00e0i li\u1ec7u tham kh\u1ea3o</li> </ul> <p>Kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1, chi ti\u1ebft API v\u00e0 t\u00e0i li\u1ec7u k\u1ef9 thu\u1eadt tham kh\u1ea3o.</p> <p>Xem t\u00e0i li\u1ec7u tham kh\u1ea3o</p>"},{"location":"vi/#khoi-ong-nhanh","title":"Kh\u1edfi \u0111\u1ed9ng nhanh","text":"<pre><code># Clone repository\ngit clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity/dashboard\n\n# C\u00e0i \u0111\u1eb7t dependencies\npnpm install\n\n# C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng\ncp .env.example .env\n# Ch\u1ec9nh s\u1eeda .env v\u1edbi c\u00e1c c\u00e0i \u0111\u1eb7t c\u1ee7a b\u1ea1n\n\n# Kh\u1edfi \u0111\u1ed9ng development server\npnpm dev\n</code></pre> <p>Truy c\u1eadp t\u1ea1i: http://localhost:3000</p> <p>\ud83d\udc49 Xem H\u01b0\u1edbng d\u1eabn Kh\u1edfi \u0111\u1ed9ng Nhanh \u0111\u1ec3 bi\u1ebft h\u01b0\u1edbng d\u1eabn chi ti\u1ebft.</p>"},{"location":"vi/#tong-quan-kien-truc","title":"T\u1ed5ng quan Ki\u1ebfn tr\u00fac","text":"<p>LegoCity s\u1eed d\u1ee5ng ki\u1ebfn tr\u00fac ba l\u1edbp:</p> <ol> <li>L\u1edbp Context &amp; Data - FIWARE/NGSI-LD brokers v\u1edbi d\u1eef li\u1ec7u th\u00e0nh ph\u1ed1 \u0111\u01b0\u1ee3c chu\u1ea9n h\u00f3a</li> <li>L\u1edbp Content &amp; UI - PayloadCMS + Next.js cho dashboards c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh</li> <li>L\u1edbp Integration - API proxies, AI helpers, c\u00e1c d\u1ecbch v\u1ee5 b\u00ean ngo\u00e0i</li> </ol> <p>\ud83d\udc49 Xem H\u01b0\u1edbng d\u1eabn Ki\u1ebfn tr\u00fac \u0111\u1ec3 bi\u1ebft s\u01a1 \u0111\u1ed3 v\u00e0 gi\u1ea3i th\u00edch chi ti\u1ebft.</p>"},{"location":"vi/#cong-ong-ho-tro","title":"C\u1ed9ng \u0111\u1ed3ng &amp; H\u1ed7 tr\u1ee3","text":""},{"location":"vi/#nhan-tro-giup","title":"Nh\u1eadn tr\u1ee3 gi\u00fap","text":"<ul> <li>\ud83d\udcd6 T\u00e0i li\u1ec7u: B\u1ea1n \u0111ang \u0111\u1ecdc n\u00f3!</li> <li>\ud83d\udcac Th\u1ea3o lu\u1eadn: GitHub Discussions</li> <li>\ud83d\udc1b Issues: GitHub Issues</li> <li>\ud83d\udce7 Li\u00ean h\u1ec7: CTU-SematX Team</li> </ul>"},{"location":"vi/#ong-gop","title":"\u0110\u00f3ng g\u00f3p","text":"<p>Ch\u00fang t\u00f4i hoan ngh\u00eanh c\u00e1c \u0111\u00f3ng g\u00f3p! Xem:</p> <ul> <li>H\u01b0\u1edbng d\u1eabn Ph\u00e1t tri\u1ec3n - C\u00e1ch \u0111\u00f3ng g\u00f3p</li> <li>CONTRIBUTING.md - H\u01b0\u1edbng d\u1eabn</li> <li>CODE_OF_CONDUCT.md - Ti\u00eau chu\u1ea9n c\u1ed9ng \u0111\u1ed3ng</li> </ul>"},{"location":"vi/#tai-nguyen","title":"T\u00e0i nguy\u00ean","text":"<ul> <li>Repository: github.com/CTU-SematX/LegoCity</li> <li>Demo: [S\u1eafp ra m\u1eaft]</li> <li>License: Ki\u1ec3m tra repository \u0111\u1ec3 bi\u1ebft chi ti\u1ebft license</li> </ul>"},{"location":"vi/#tiep-theo-la-gi","title":"Ti\u1ebfp theo l\u00e0 g\u00ec?","text":"<p>Ch\u1ecdn con \u0111\u01b0\u1eddng c\u1ee7a b\u1ea1n:</p> T\u00f4i l\u00e0 ng\u01b0\u1eddi m\u1edbiT\u00f4i mu\u1ed1n s\u1eed d\u1ee5ng n\u00f3T\u00f4i mu\u1ed1n x\u00e2y d\u1ef1ngT\u00f4i mu\u1ed1n tri\u1ec3n khai <p>B\u1eaft \u0111\u1ea7u t\u1ea1i \u0111\u00e2y:</p> <ol> <li>\u0110\u1ecdc B\u1eaft \u0111\u1ea7u</li> <li>L\u00e0m theo Kh\u1edfi \u0111\u1ed9ng Nhanh</li> <li>Kh\u00e1m ph\u00e1 H\u01b0\u1edbng d\u1eabn S\u1eed d\u1ee5ng</li> </ol> <p>Thi\u1ebft l\u1eadp Th\u00e0nh ph\u1ed1 c\u1ee7a b\u1ea1n:</p> <ol> <li>C\u00e0i \u0111\u1eb7t LegoCity</li> <li>C\u1ea5u h\u00ecnh Data Sources</li> <li>T\u1ea1o Dashboard Pages</li> </ol> <p>B\u1eaft \u0111\u1ea7u Ph\u00e1t tri\u1ec3n:</p> <ol> <li>M\u00f4i tr\u01b0\u1eddng Ph\u00e1t tri\u1ec3n</li> <li>H\u01b0\u1edbng d\u1eabn Ph\u00e1t tri\u1ec3n</li> <li>T\u1ea1o Custom Blocks</li> </ol> <p>Tri\u1ec3n khai l\u00ean Production:</p> <ol> <li>T\u1ed5ng quan Tri\u1ec3n khai</li> <li>Ch\u1ecdn ph\u01b0\u01a1ng th\u1ee9c tri\u1ec3n khai</li> <li>H\u01b0\u1edbng d\u1eabn V\u1eadn h\u00e0nh</li> </ol> <p>S\u1eb5n s\u00e0ng b\u1eaft \u0111\u1ea7u? \u0110i \u0111\u1ebfn H\u01b0\u1edbng d\u1eabn B\u1eaft \u0111\u1ea7u \u2192</p>"},{"location":"vi/Open_Source_Checklist/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>D\u1ec5 d\u00e0ng b\u1ecf s\u00f3t c\u00e1c nhi\u1ec7m v\u1ee5 quan tr\u1ecdng khi release v\u00e0 maintain m\u1ed9t d\u1ef1 \u00e1n open source. Checklist n\u00e0y gi\u00fap \u0111\u1ea3m b\u1ea3o d\u1ef1 \u00e1n c\u1ee7a b\u1ea1n tu\u00e2n theo best practices v\u1ec1 s\u1ee9c kh\u1ecfe, ph\u00e1t tri\u1ec3n v\u00e0 b\u1ea3o m\u1eadt.</p> <p>S\u1eed d\u1ee5ng checklist n\u00e0y nh\u01b0 m\u1ed9t \u0111i\u1ec3m kh\u1edfi \u0111\u1ea7u th\u1ea3o lu\u1eadn cho team v\u00e0 n\u1ec1n t\u1ea3ng cho c\u1ea3i thi\u1ec7n li\u00ean t\u1ee5c.</p>"},{"location":"vi/Open_Source_Checklist/#archiving-va-deprecating-project","title":"Archiving v\u00e0 Deprecating Project","text":"<ul> <li>N\u00ean s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng \"Archival\" c\u1ee7a platform. Theo c\u00e1ch n\u00e0y, n\u00f3 tr\u1edf th\u00e0nh read-only, bao g\u1ed3m issues board, v\u00e0 \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u l\u00e0 inactive.</li> <li>N\u00ean ghi trong README r\u1eb1ng d\u1ef1 \u00e1n kh\u00f4ng c\u00f2n \u0111\u01b0\u1ee3c maintain.</li> <li>N\u00ean \u0111\u01b0\u1ee3c archived n\u1ebfu kh\u00f4ng c\u00f3 maintainers.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#documentation","title":"Documentation","text":"<ul> <li> <p>Ph\u1ea3i \u0111\u1ea3m b\u1ea3o d\u1ef1 \u00e1n bao g\u1ed3m c\u00e1c Community Health Files chu\u1ea9n (CHANGELOG, CONTRIBUTING, CODE_OF_CONDUCT, v.v.).   Xem README.md Template Files section \u0111\u1ec3 bi\u1ebft danh s\u00e1ch \u0111\u1ea7y \u0111\u1ee7.</p> </li> <li> <p>N\u00ean bao g\u1ed3m usage documentation v\u00e0 architecture descriptions li\u00ean quan \u0111\u1ebfn d\u1ef1 \u00e1n.</p> </li> </ul>"},{"location":"vi/Open_Source_Checklist/#legal-va-licensing","title":"Legal v\u00e0 Licensing","text":"<ul> <li>Ph\u1ea3i \u0111\u1ea3m b\u1ea3o license c\u1ee7a d\u1ef1 \u00e1n kh\u00f4ng xung \u0111\u1ed9t v\u1edbi third-party licenses.</li> <li>License declarations ph\u1ea3i tu\u00e2n theo REUSE licensing specification, \u0111\u1ea3m b\u1ea3o t\u1ea5t c\u1ea3 materials c\u00f3 th\u00f4ng tin copyright r\u00f5 r\u00e0ng.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#naming-va-trademarks-check","title":"Naming v\u00e0 Trademarks Check","text":"<ul> <li>N\u00ean \u0111\u1ea3m b\u1ea3o t\u00ean d\u1ef1 \u00e1n kh\u00f4ng xung \u0111\u1ed9t v\u1edbi d\u1ef1 \u00e1n hi\u1ec7n c\u00f3 ho\u1eb7c vi ph\u1ea1m trademarks.</li> <li>Th\u1ef1c hi\u1ec7n ki\u1ec3m tra search engine chung cho t\u00ean d\u1ef1 \u00e1n \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t.</li> <li>Th\u1ef1c hi\u1ec7n Trademark Search.</li> </ul> <p>L\u01b0u \u00fd: C\u00f3 th\u1ec3 ho\u00e0n to\u00e0n ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c khi s\u1eed d\u1ee5ng t\u00ean g\u1ee3i nh\u1edb \u0111\u1ebfn trademark hi\u1ec7n c\u00f3 - n\u1ebfu trademark hi\u1ec7n c\u00f3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho c\u00e1c d\u1ecbch v\u1ee5/l\u0129nh v\u1ef1c kh\u00e1c v\u00e0 kh\u00f4ng \u0111\u01b0\u1ee3c c\u00f4ng nh\u1eadn l\u00e0 well-known trademark.</p>"},{"location":"vi/Open_Source_Checklist/#people-maintenance","title":"People &amp; Maintenance","text":"<ul> <li>Ph\u1ea3i \u0111\u1ea3m b\u1ea3o maintainers c\u00f3 gi\u00e1o d\u1ee5c ho\u1eb7c kinh nghi\u1ec7m v\u1edbi open source. V\u00ed d\u1ee5, \u0111\u1ecdc guides t\u1ea1i https://opensource.guide.</li> <li>Ph\u1ea3i \u0111\u1ea3m b\u1ea3o maintainers c\u00f3 k\u1ebf ho\u1ea1ch x\u1eed l\u00fd merge/pull requests (code reviews, v.v.).</li> <li>Ph\u1ea3i \u0111\u1ea3m b\u1ea3o maintainers c\u00f3 k\u1ebf ho\u1ea1ch community engagement (responding to issues, reviewing pull requests).</li> <li>Ph\u1ea3i \u0111\u1ea3m b\u1ea3o ai \u0111\u00f3 ch\u1ecbu tr\u00e1ch nhi\u1ec7m v\u1ec1 security issues.</li> <li> <p>Ph\u1ea3i bao g\u1ed3m m\u1ed9t section <code>Maintainer</code> trong m\u1ecdi project README (team, individual, ho\u1eb7c role).</p> </li> <li> <p>N\u00ean thi\u1ebft l\u1eadp m\u1ed9t release plan v\u1edbi chi\u1ebfn l\u01b0\u1ee3c announcement v\u00e0 promotion r\u00f5 r\u00e0ng.</p> </li> <li>N\u00ean s\u1eed d\u1ee5ng file CODEOWNERS cho m\u00f4 t\u1ea3 maintenance chi ti\u1ebft (b\u1ed5 sung cho general Maintainer section c\u1ee7a README).</li> </ul>"},{"location":"vi/Open_Source_Checklist/#project-quality","title":"Project Quality","text":"<ul> <li>Ph\u1ea3i verify r\u1eb1ng d\u1ef1 \u00e1n \u0111\u00e3 tr\u1ea3i qua code review.</li> <li>N\u00ean th\u1ea3o lu\u1eadn v\u00e0 thi\u1ebft l\u1eadp testing goals v\u00e0 ambitions c\u1ee7a d\u1ef1 \u00e1n.</li> <li>N\u00ean l\u00e0m cho d\u1ec5 s\u1eed d\u1ee5ng d\u1ef1 \u00e1n - documentation, examples, pre-built releases, v.v.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#release-va-versioning","title":"Release v\u00e0 Versioning","text":"<ul> <li>N\u00ean s\u1eed d\u1ee5ng Semantic Versioning 2.0.0 v\u00e0 release tags.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#security","title":"Security","text":"<p>Ph\u1ea7n n\u00e0y c\u1ee7a checklist d\u1ef1a tr\u00ean Open Source Security Foundation (OpenSSF) guide for more secure open source development, phi\u00ean b\u1ea3n: 2023-06-14, (v\u00e0 companion post).</p>"},{"location":"vi/Open_Source_Checklist/#general","title":"General","text":"<ul> <li>Ph\u1ea3i s\u1eed d\u1ee5ng two-factor authentication (2FA) ho\u1eb7c multifactor authentication (MFA) \u0111\u1ec3 l\u00e0m kh\u00f3 h\u01a1n cho account takeovers.</li> <li>Ph\u1ea3i gi\u1edbi h\u1ea1n merge v\u00e0 push rights cho c\u00e1c branches c\u1ee5 th\u1ec3.</li> <li>Ph\u1ea3i \u0111\u00e3 enabled branch protection.</li> <li> <p>Ph\u1ea3i c\u00f3 th\u1ef1c h\u00e0nh signed commits.</p> </li> <li> <p>N\u00ean c\u00f3 ki\u1ebfn th\u1ee9c c\u01a1 b\u1ea3n v\u1ec1 committers v\u00e0 maintainers, v\u00e0 ph\u1ea3i th\u1ef1c hi\u1ec7n periodic review c\u1ee7a nh\u1eefng ng\u01b0\u1eddi \u0111\u00f3.</p> </li> <li>N\u00ean c\u00f3 automated testing v\u00e0 test coverage practices, bao g\u1ed3m tests cho negative cases, \u0111\u1ec3 detect bugs v\u00e0 secure d\u1ef1 \u00e1n.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#contribution","title":"Contribution","text":"<ul> <li>N\u00ean c\u00f3 th\u1ef1c h\u00e0nh code reviews.</li> <li>N\u00ean c\u00f3 y\u00eau c\u1ea7u readability v\u00e0 scope t\u1ed1t \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o PRs m\u1edbi kh\u00f4ng b\u1ecb obfuscated, v\u00e0 vi\u1ec7c s\u1eed d\u1ee5ng opaque binaries \u0111\u01b0\u1ee3c minimize.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#dependencies-va-vulnerabilities-detection","title":"Dependencies v\u00e0 Vulnerabilities Detection","text":"<ul> <li>Ph\u1ea3i s\u1eed d\u1ee5ng SCA-tools trong CI pipeline \u0111\u1ec3 detect vulnerabilities v\u00e0 license incompatibilities.</li> <li>Ph\u1ea3i s\u1eed d\u1ee5ng linter tools trong CI pipeline \u0111\u1ec3 detect vulnerabilities v\u00e0 bad development practices.</li> <li>Ph\u1ea3i s\u1eed d\u1ee5ng secret scanning tools \u0111\u1ec3 detect secrets (passwords, logs, tokens).</li> <li>Ph\u1ea3i s\u1eed d\u1ee5ng automated tooling \u0111\u1ec3 monitor dependency updates cho critical vulnerabilities.</li> <li> <p>Ph\u1ea3i c\u00f3 maintenance \u0111\u1ec3 nhanh ch\u00f3ng x\u1eed l\u00fd updating vulnerabilities.</p> </li> <li> <p>N\u00ean s\u1eed d\u1ee5ng SAST-tools trong CI pipeline \u0111\u1ec3 detect potential vulnerabilities v\u00e0 bad software practices.</p> </li> <li>N\u00ean evaluate health c\u1ee7a m\u1ecdi direct project dependency m\u1edbi \u0111\u01b0\u1ee3c th\u00eam v\u00e0o d\u1ef1 \u00e1n.</li> <li>N\u00ean prefer s\u1eed d\u1ee5ng package managers (\u1edf system, language, v\u00e0 container level) cho automatic v\u00e0 consistent dependency updates.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#publishing","title":"Publishing","text":"<ul> <li>Ph\u1ea3i t\u1ea1o SBOM (Software Bill of Materials) cho d\u1ef1 \u00e1n \u0111\u1ec3 end-users v\u00e0 systems c\u00f3 th\u1ec3 verify vulnerabilities v\u00e0 license incompatibilities.</li> <li> <p>Ph\u1ea3i gi\u1edbi h\u1ea1n software publishing rights c\u1ee7a artifacts.</p> </li> <li> <p>N\u00ean sign b\u1ea5t k\u1ef3 project releases n\u00e0o.</p> </li> <li>N\u00ean l\u00e0m cho d\u1ec5 d\u00e0ng cho end-users upgrade l\u00ean releases m\u1edbi. S\u1eed d\u1ee5ng semantic versioning, h\u1ed7 tr\u1ee3 stable APIs, v\u00e0 flag deprecation s\u1edbm.</li> </ul>"},{"location":"vi/Open_Source_Checklist/#policy","title":"Policy","text":"<ul> <li>Ph\u1ea3i c\u00f3 security policy - n\u00f3 n\u00ean ch\u1ee9a th\u00f4ng tin v\u1ec1 n\u01a1i b\u00e1o c\u00e1o non-disclosure vulnerabilities v\u00e0 process li\u00ean quan \u0111\u1ebfn report.</li> </ul> <p>Secure software practices v\u00e0 tooling t\u1eeb OpenSSF v\u00e0 OWASP:</p>"},{"location":"vi/Open_Source_Checklist/#workflows","title":"Workflows","text":"<ul> <li>C\u00f3 th\u1ec3 th\u1ea3o lu\u1eadn GitHub workflow c\u1ee7a b\u1ea1n - m\u1ed9t t\u00f3m t\u1eaft ng\u1eafn g\u1ecdn v\u00e0 suggestion c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong CONTRIBUTING - Pull Request Lifecycle</li> </ul>"},{"location":"vi/Open_Source_Checklist/#specifications-va-standards-can-tuan-theo","title":"Specifications v\u00e0 Standards c\u1ea7n tu\u00e2n theo","text":"<p>Nh\u1eefng \u0111i\u1ec1u sau s\u1ebd gi\u00fap Open Source Project c\u1ee7a b\u1ea1n collaborative, reusable, accessible, v\u00e0 up-to-date.</p> <ul> <li> <p>REUSE License specification</p> </li> <li> <p>\u0110\u1ea3m b\u1ea3o license compliance r\u00f5 r\u00e0ng v\u00e0 chu\u1ea9n h\u00f3a tr\u00ean to\u00e0n d\u1ef1 \u00e1n.</p> </li> <li> <p>Conventional Commits format</p> </li> <li> <p>Cung c\u1ea5p project history r\u00f5 r\u00e0ng v\u00e0 c\u00f3 c\u1ea5u tr\u00fac th\u00f4ng qua standardized commit messages.</p> </li> <li> <p>Keep-A-Changelog format</p> </li> <li> <p>Duy tr\u00ec release history r\u00f5 r\u00e0ng v\u00e0 user-friendly.</p> </li> <li> <p>Semantic Versioning 2.0.0</p> </li> <li> <p>Cung c\u1ea5p version numbering nh\u1ea5t qu\u00e1n cho releases.</p> </li> <li> <p>Contributor Covenant guidelines</p> </li> <li> <p>Thi\u1ebft l\u1eadp social contract cho collaboration respectful v\u00e0 inclusive.</p> </li> <li> <p>OpenSSF Scorecard</p> </li> <li> <p>Gi\u00fap assess v\u00e0 improve security health c\u1ee7a d\u1ef1 \u00e1n.</p> </li> <li> <p>PublicCode.yml</p> </li> <li> <p>T\u1ea1o \u0111i\u1ec1u ki\u1ec7n easy metadata indexing cho better discoverability c\u1ee7a d\u1ef1 \u00e1n.</p> </li> <li> <p>Standard for Public Code</p> </li> <li>\u0110\u1ea3m b\u1ea3o d\u1ef1 \u00e1n \u0111\u00e1p \u1ee9ng criteria cho public code quality v\u00e0 sustainability.</li> </ul>"},{"location":"vi/about-sematx/","title":"Gi\u1edbi thi\u1ec7u v\u1ec1 SematX","text":"<p>SematX l\u00e0 m\u1ed9t n\u1ec1n t\u1ea3ng Smart City m\u00e3 ngu\u1ed3n m\u1edf \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 gi\u00fap \u0111\u01a1n gi\u1ea3n h\u00f3a vi\u1ec7c thu th\u1eadp, qu\u1ea3n l\u00fd v\u00e0 tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u IoT t\u1eeb c\u00e1c c\u1ea3m bi\u1ebfn, thi\u1ebft b\u1ecb v\u00e0 d\u1ecbch v\u1ee5 \u0111a d\u1ea1ng.</p>"},{"location":"vi/about-sematx/#sematx-la-gi","title":"SematX l\u00e0 g\u00ec?","text":"<p>SematX cung c\u1ea5p m\u1ed9t gi\u1ea3i ph\u00e1p to\u00e0n di\u1ec7n cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng th\u00e0nh ph\u1ed1 th\u00f4ng minh, k\u1ebft h\u1ee3p ba th\u00e0nh ph\u1ea7n ch\u00ednh:</p> <ol> <li>NGSI-LD Context Broker (Orion-LD) - L\u01b0u tr\u1eef v\u00e0 truy v\u1ea5n d\u1eef li\u1ec7u theo ti\u00eau chu\u1ea9n</li> <li>Orion Nginx Gateway - X\u00e1c th\u1ef1c API, gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 v\u00e0 \u0111\u1ecbnh tuy\u1ebfn  </li> <li>Lego Dashboard - T\u1ea1o dashboard th\u1eddi gian th\u1ef1c v\u00e0 qu\u1ea3n l\u00fd d\u1eef li\u1ec7u</li> </ol> <p>B\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng c\u00e1c ti\u00eau chu\u1ea9n m\u1edf nh\u01b0 NGSI-LD v\u00e0 FIWARE, SematX \u0111\u1ea3m b\u1ea3o t\u00ednh t\u01b0\u01a1ng th\u00edch v\u1edbi c\u00e1c h\u1ec7 sinh th\u00e1i th\u00e0nh ph\u1ed1 th\u00f4ng minh v\u00e0 d\u1eef li\u1ec7u IoT hi\u1ec7n c\u00f3 tr\u00ean to\u00e0n c\u1ea7u.</p>"},{"location":"vi/about-sematx/#tai-sao-lai-la-sematx","title":"T\u1ea1i sao l\u1ea1i l\u00e0 SematX?","text":""},{"location":"vi/about-sematx/#tuan-thu-tieu-chuan","title":"Tu\u00e2n th\u1ee7 ti\u00eau chu\u1ea9n","text":"<p>SematX \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng d\u1ef1a tr\u00ean NGSI-LD v1.6.1 - m\u1ed9t th\u00f4ng s\u1ed1 k\u1ef9 thu\u1eadt ETSI \u0111\u1ec3 trao \u0111\u1ed5i d\u1eef li\u1ec7u ng\u1eef c\u1ea3nh. \u0110i\u1ec1u n\u00e0y \u0111\u1ea3m b\u1ea3o:</p> <ul> <li>T\u01b0\u01a1ng th\u00e1c v\u1edbi c\u00e1c n\u1ec1n t\u1ea3ng tu\u00e2n th\u1ee7 FIWARE kh\u00e1c</li> <li>M\u00f4 h\u00ecnh h\u00f3a d\u1eef li\u1ec7u theo m\u00f4 h\u00ecnh Smart Data Models</li> <li>T\u00edch h\u1ee3p li\u1ec1n m\u1ea1ch v\u1edbi c\u00e1c d\u1ecbch v\u1ee5 th\u00e0nh ph\u1ed1 th\u00f4ng minh hi\u1ec7n c\u00f3</li> </ul>"},{"location":"vi/about-sematx/#ma-nguon-mo-va-mo-rong-uoc","title":"M\u00e3 ngu\u1ed3n m\u1edf v\u00e0 m\u1edf r\u1ed9ng \u0111\u01b0\u1ee3c","text":"<ul> <li>Ho\u00e0n to\u00e0n mi\u1ec5n ph\u00ed \u0111\u1ec3 s\u1eed d\u1ee5ng v\u00e0 ch\u1ec9nh s\u1eeda</li> <li>Code base TypeScript/React hi\u1ec7n \u0111\u1ea1i</li> <li>Ki\u1ebfn tr\u00fac plugin \u0111\u1ec3 t\u00f9y ch\u1ec9nh</li> <li>C\u1ed9ng \u0111\u1ed3ng t\u00edch c\u1ef1c v\u00e0 h\u1ed7 tr\u1ee3 t\u00e0i li\u1ec7u</li> </ul>"},{"location":"vi/about-sematx/#san-sang-san-xuat","title":"S\u1eb5n s\u00e0ng s\u1ea3n xu\u1ea5t","text":"<ul> <li>X\u00e1c th\u1ef1c JWT v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp d\u1ef1a tr\u00ean vai tr\u00f2</li> <li>Gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 v\u00e0 b\u1ea3o v\u1ec7 DDoS</li> <li>Gi\u00e1m s\u00e1t hi\u1ec7u su\u1ea5t v\u00e0 ghi logs</li> <li>H\u1ed7 tr\u1ee3 \u0111a tenant cho kh\u00e1ch h\u00e0ng nhi\u1ec1u t\u1ed5 ch\u1ee9c</li> </ul>"},{"location":"vi/about-sematx/#trai-nghiem-nha-phat-trien","title":"Tr\u1ea3i nghi\u1ec7m nh\u00e0 ph\u00e1t tri\u1ec3n","text":"<ul> <li>Thi\u1ebft l\u1eadp local Docker m\u1ed9t l\u1ec7nh</li> <li>RESTful API v\u1edbi t\u00e0i li\u1ec7u OpenAPI</li> <li>V\u00ed d\u1ee5 code b\u1eb1ng nhi\u1ec1u ng\u00f4n ng\u1eef (JavaScript, Python, curl)</li> <li>TypeScript types cho an to\u00e0n ki\u1ec3u d\u1eef li\u1ec7u</li> </ul>"},{"location":"vi/about-sematx/#tam-nhin","title":"T\u1ea7m nh\u00ecn","text":"<p>Nhi\u1ec7m v\u1ee5 c\u1ee7a ch\u00fang t\u00f4i: D\u00e2n ch\u1ee7 h\u00f3a c\u00e1c c\u00f4ng ngh\u1ec7 th\u00e0nh ph\u1ed1 th\u00f4ng minh b\u1eb1ng c\u00e1ch cung c\u1ea5p c\u00e1c c\u00f4ng c\u1ee5 m\u00e3 ngu\u1ed3n m\u1edf, d\u1ef1a tr\u00ean ti\u00eau chu\u1ea9n m\u00e0 b\u1ea5t k\u1ef3 ai c\u0169ng c\u00f3 th\u1ec3 tri\u1ec3n khai v\u00e0 t\u00f9y ch\u1ec9nh.</p> <p>T\u1ea7m nh\u00ecn c\u1ee7a ch\u00fang t\u00f4i: M\u1ed9t th\u1ebf gi\u1edbi n\u01a1i m\u1ecdi th\u00e0nh ph\u1ed1, d\u00f9 l\u1edbn hay nh\u1ecf, \u0111\u1ec1u c\u00f3 th\u1ec3 t\u1eadn d\u1ee5ng s\u1ee9c m\u1ea1nh c\u1ee7a d\u1eef li\u1ec7u IoT \u0111\u1ec3 c\u1ea3i thi\u1ec7n cu\u1ed9c s\u1ed1ng c\u1ee7a c\u01b0 d\u00e2n m\u00e0 kh\u00f4ng b\u1ecb kh\u00f3a b\u1edfi c\u00e1c nh\u00e0 cung c\u1ea5p \u0111\u1ed9c quy\u1ec1n.</p>"},{"location":"vi/about-sematx/#cac-truong-hop-su-dung","title":"C\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng","text":"<p>SematX c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho nhi\u1ec1u k\u1ecbch b\u1ea3n th\u00e0nh ph\u1ed1 th\u00f4ng minh:</p>"},{"location":"vi/about-sematx/#1-giam-sat-moi-truong","title":"1. Gi\u00e1m s\u00e1t m\u00f4i tr\u01b0\u1eddng","text":"<ul> <li>Theo d\u00f5i ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed (PM2.5, PM10, CO\u2082, NO\u2082)</li> <li>Gi\u00e1m s\u00e1t m\u1ee9c \u0111\u1ed9 ti\u1ebfng \u1ed3n</li> <li>C\u1ea3m bi\u1ebfn th\u1eddi ti\u1ebft (nhi\u1ec7t \u0111\u1ed9, \u0111\u1ed9 \u1ea9m, \u00e1p su\u1ea5t)</li> <li>Ph\u00e1t hi\u1ec7n ch\u1ea5t l\u01b0\u1ee3ng n\u01b0\u1edbc</li> </ul> <p>V\u00ed d\u1ee5: M\u1ed9t th\u00e0nh ph\u1ed1 tri\u1ec3n khai 50 tr\u1ea1m gi\u00e1m s\u00e1t ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed tr\u00ean c\u00e1c khu v\u1ef1c kh\u00e1c nhau, hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c tr\u00ean dashboard c\u00f4ng khai v\u00e0 k\u00edch ho\u1ea1t c\u1ea3nh b\u00e1o khi v\u01b0\u1ee3t ng\u01b0\u1ee1ng.</p>"},{"location":"vi/about-sematx/#2-quan-ly-giao-thong","title":"2. Qu\u1ea3n l\u00fd giao th\u00f4ng","text":"<ul> <li>\u0110\u1ebfm v\u00e0 ph\u00e1t hi\u1ec7n xe</li> <li>Gi\u00e1m s\u00e1t t\u00ecnh tr\u1ea1ng \u0111\u1ed7 xe</li> <li>Qu\u1ea3n l\u00fd t\u00edn hi\u1ec7u giao th\u00f4ng</li> <li>Theo d\u00f5i ph\u01b0\u01a1ng ti\u1ec7n giao th\u00f4ng c\u00f4ng c\u1ed9ng</li> </ul> <p>V\u00ed d\u1ee5: Gi\u00e1m s\u00e1t ph\u1ea1m vi giao th\u00f4ng th\u00f4ng qua c\u00e1c c\u1ea3m bi\u1ebfn th\u00f4ng minh \u0111\u1ec3 t\u1ed1i \u01b0u h\u00f3a th\u1eddi gian t\u00edn hi\u1ec7u \u0111\u00e8n v\u00e0 gi\u1ea3m t\u1eafc ngh\u1ebdn trong gi\u1edd cao \u0111i\u1ec3m.</p>"},{"location":"vi/about-sematx/#3-quan-ly-nang-luong","title":"3. Qu\u1ea3n l\u00fd n\u0103ng l\u01b0\u1ee3ng","text":"<ul> <li>Gi\u00e1m s\u00e1t ti\u00eau th\u1ee5 \u0111i\u1ec7n n\u0103ng</li> <li>Qu\u1ea3n l\u00fd \u0111\u00e8n \u0111\u01b0\u1eddng th\u00f4ng minh</li> <li>Theo d\u00f5i s\u1ea3n xu\u1ea5t n\u0103ng l\u01b0\u1ee3ng t\u00e1i t\u1ea1o</li> <li>T\u1ed1i \u01b0u h\u00f3a l\u01b0\u1edbi \u0111i\u1ec7n</li> </ul> <p>V\u00ed d\u1ee5: H\u1ec7 th\u1ed1ng \u0111\u00e8n \u0111\u01b0\u1eddng th\u00f4ng minh \u0111i\u1ec1u ch\u1ec9nh \u0111\u1ed9 s\u00e1ng d\u1ef1a tr\u00ean \u0111i\u1ec1u ki\u1ec7n \u00e1nh s\u00e1ng m\u00f4i tr\u01b0\u1eddng v\u00e0 l\u01b0u l\u01b0\u1ee3ng ng\u01b0\u1eddi \u0111i b\u1ed9, ti\u1ebft ki\u1ec7m \u0111\u1ebfn 60% chi ph\u00ed n\u0103ng l\u01b0\u1ee3ng.</p>"},{"location":"vi/about-sematx/#4-quan-ly-chat-thai","title":"4. Qu\u1ea3n l\u00fd ch\u1ea5t th\u1ea3i","text":"<ul> <li>C\u1ea3m bi\u1ebfn m\u1ee9c \u0111\u1ed9 \u0111\u1ea7y th\u00f9ng r\u00e1c</li> <li>T\u1ed1i \u01b0u h\u00f3a tuy\u1ebfn \u0111\u01b0\u1eddng thu gom</li> <li>Theo d\u00f5i xe thu gom r\u00e1c</li> <li>D\u1ef1 \u0111o\u00e1n t\u1ea7n su\u1ea5t thu gom</li> </ul> <p>V\u00ed d\u1ee5: C\u00e1c th\u00f9ng r\u00e1c th\u00f4ng minh b\u00e1o c\u00e1o m\u1ee9c \u0111\u1ed9 \u0111\u1ea7y, cho ph\u00e9p tuy\u1ebfn \u0111\u01b0\u1eddng thu gom \u0111\u1ed9ng ch\u1ec9 gh\u00e9 th\u0103m c\u00e1c th\u00f9ng c\u1ea7n \u0111\u01b0\u1ee3c l\u00e0m tr\u1ed1ng, gi\u1ea3m chi ph\u00ed nhi\u00ean li\u1ec7u 30%.</p>"},{"location":"vi/about-sematx/#5-quan-ly-toa-nha-thong-minh","title":"5. Qu\u1ea3n l\u00fd t\u00f2a nh\u00e0 th\u00f4ng minh","text":"<ul> <li>HVAC v\u00e0 \u0111i\u1ec1u khi\u1ec3n nhi\u1ec7t \u0111\u1ed9</li> <li>H\u1ec7 th\u1ed1ng an ninh v\u00e0 ki\u1ec3m so\u00e1t ra v\u00e0o</li> <li>Ph\u00e1t hi\u1ec7n \u0111i\u1ec3m c\u00f3 ng\u01b0\u1eddi hi\u1ec7n di\u1ec7n v\u00e0 t\u1ed1i \u01b0u h\u00f3a</li> <li>C\u1ea3nh b\u00e1o b\u1ea3o tr\u00ec</li> </ul> <p>V\u00ed d\u1ee5: H\u1ec7 th\u1ed1ng qu\u1ea3n l\u00fd t\u00f2a nh\u00e0 t\u1ef1 \u0111\u1ed9ng \u0111i\u1ec1u ch\u1ec9nh h\u1ec7 th\u1ed1ng s\u01b0\u1edfi, th\u00f4ng gi\u00f3 v\u00e0 \u0111i\u1ec1u h\u00f2a kh\u00f4ng kh\u00ed d\u1ef1a tr\u00ean \u0111i\u1ec3m c\u00f3 ng\u01b0\u1eddi hi\u1ec7n di\u1ec7n v\u00e0 \u0111i\u1ec1u ki\u1ec7n th\u1eddi ti\u1ebft, c\u1ea3i thi\u1ec7n s\u1ef1 tho\u1ea3i m\u00e1i trong khi gi\u1ea3m chi ph\u00ed n\u0103ng l\u01b0\u1ee3ng.</p>"},{"location":"vi/about-sematx/#q1-2025-nen-tang-cot-loi","title":"Q1 2025 - N\u1ec1n t\u1ea3ng c\u1ed1t l\u00f5i","text":"<ul> <li>\u2705 T\u00edch h\u1ee3p NGSI-LD v\u1edbi Orion-LD</li> <li>\u2705 Dashboard PayloadCMS v\u1edbi t\u1ea1o card</li> <li>\u2705 H\u1ed7 tr\u1ee3 x\u00e1c th\u1ef1c v\u00e0 \u0111a tenant JWT</li> <li>\u2705 Gi\u00e1m s\u00e1t th\u1eddi gian th\u1ef1c v\u1edbi WebSockets</li> <li>\ud83d\udd04 T\u00e0i li\u1ec7u v\u00e0 v\u00ed d\u1ee5 to\u00e0n di\u1ec7n</li> </ul>"},{"location":"vi/about-sematx/#q2-2025-trai-nghiem-nha-phat-trien","title":"Q2 2025 - Tr\u1ea3i nghi\u1ec7m nh\u00e0 ph\u00e1t tri\u1ec3n","text":"<ul> <li>\ud83d\udccb H\u01b0\u1edbng d\u1eabn t\u00edch h\u1ee3p cho c\u00e1c ng\u00f4n ng\u1eef ph\u1ed5 bi\u1ebfn</li> <li>\ud83d\udccb M\u1eabu plugin cho c\u00e1c lo\u1ea1i c\u1ea3m bi\u1ebfn ph\u1ed5 bi\u1ebfn</li> <li>\ud83d\udccb T\u00edch h\u1ee3p CI/CD v\u1edbi GitHub Actions</li> <li>\ud83d\udccb N\u1ec1n t\u1ea3ng th\u1eed nghi\u1ec7m online (SematX Cloud)</li> <li>\ud83d\udccb Xu\u1ea5t d\u1eef li\u1ec7u v\u00e0 c\u00f4ng c\u1ee5 di chuy\u1ec3n</li> </ul>"},{"location":"vi/about-sematx/#q3-2025-kha-nang-nang-cao","title":"Q3 2025 - Kh\u1ea3 n\u0103ng n\u00e2ng cao","text":"<ul> <li>\ud83d\udccb Machine Learning cho d\u1ef1 \u0111o\u00e1n v\u00e0 ph\u00e1t hi\u1ec7n b\u1ea5t th\u01b0\u1eddng</li> <li>\ud83d\udccb C\u00f4ng c\u1ee5 tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u n\u00e2ng cao</li> <li>\ud83d\udccb Qu\u1ea3n l\u00fd t\u00edch h\u1ee3p thi\u1ebft b\u1ecb IoT</li> <li>\ud83d\udccb T\u00edch h\u1ee3p b\u1ea3n \u0111\u1ed3 \u0111\u1ecba l\u00fd v\u1edbi Mapbox/Leaflet</li> <li>\ud83d\udccb Kh\u1ea3 n\u0103ng truy v\u1ea5n d\u1eef li\u1ec7u l\u1ecbch s\u1eed</li> </ul>"},{"location":"vi/about-sematx/#q4-2025-quy-mo-doanh-nghiep","title":"Q4 2025 - Quy m\u00f4 doanh nghi\u1ec7p","text":"<ul> <li>\ud83d\udccb Clustering v\u00e0 c\u00e2n b\u1eb1ng t\u1ea3i cho \u0111\u1ed9 kh\u1ea3 d\u1ee5ng cao</li> <li>\ud83d\udccb Sharding c\u01a1 s\u1edf d\u1eef li\u1ec7u cho b\u1ed9 d\u1eef li\u1ec7u l\u1edbn</li> <li>\ud83d\udccb Nh\u1eadt k\u00fd ki\u1ec3m to\u00e1n v\u00e0 b\u00e1o c\u00e1o tu\u00e2n th\u1ee7</li> <li>\ud83d\udccb C\u1ed5ng qu\u1ea3n tr\u1ecb doanh nghi\u1ec7p</li> <li>\ud83d\udccb H\u1ed7 tr\u1ee3 doanh nghi\u1ec7p v\u00e0 c\u00e1c g\u00f3i SLA</li> </ul>"},{"location":"vi/about-sematx/#bat-au","title":"B\u1eaft \u0111\u1ea7u","text":"<p>S\u1eb5n s\u00e0ng kh\u00e1m ph\u00e1 SematX? Ch\u1ecdn \u0111\u01b0\u1eddng d\u1eabn c\u1ee7a b\u1ea1n:</p> <ul> <li>Kh\u00e1m ph\u00e1 h\u1ec7 sinh th\u00e1i \u2192 - Hi\u1ec3u v\u1ec1 ki\u1ebfn tr\u00fac</li> <li>Xem x\u00e9t c\u00f4ng c\u1ee5 \u2192 - T\u00ecm hi\u1ec3u v\u1ec1 ng\u0103n x\u1ebfp c\u00f4ng ngh\u1ec7</li> <li>B\u1eaft \u0111\u1ea7u \u2192 - Tri\u1ec3n khai m\u00f4i tr\u01b0\u1eddng \u0111\u1ea7u ti\u00ean c\u1ee7a b\u1ea1n</li> </ul>"},{"location":"vi/about-sematx/#cong-ong-va-ho-tro","title":"C\u1ed9ng \u0111\u1ed3ng v\u00e0 h\u1ed7 tr\u1ee3","text":"<ul> <li>GitHub: CTU-SematX/LegoCity</li> <li>T\u00e0i li\u1ec7u: https://ctu-sematx.github.io/LegoCity</li> <li>Issues: B\u00e1o c\u00e1o l\u1ed7i ho\u1eb7c \u0111\u1ec1 xu\u1ea5t t\u00ednh n\u0103ng</li> <li>Discussions: Tham gia th\u1ea3o lu\u1eadn c\u1ed9ng \u0111\u1ed3ng</li> </ul>"},{"location":"vi/about-sematx/#giay-phep","title":"Gi\u1ea5y ph\u00e9p","text":"<p>SematX \u0111\u01b0\u1ee3c ph\u00e1t h\u00e0nh theo gi\u1ea5y ph\u00e9p MIT License, cho ph\u00e9p b\u1ea1n t\u1ef1 do:</p> <ul> <li>\u2705 S\u1eed d\u1ee5ng th\u01b0\u01a1ng m\u1ea1i</li> <li>\u2705 Ch\u1ec9nh s\u1eeda v\u00e0 ph\u00e2n ph\u1ed1i l\u1ea1i</li> <li>\u2705 S\u1eed d\u1ee5ng c\u00e1 nh\u00e2n v\u00e0 ri\u00eang t\u01b0</li> <li>\u2705 C\u1ea5p ph\u00e9p l\u1ea1i</li> </ul>"},{"location":"vi/about-sematx/ecosystem/","title":"Hi\u1ec3u v\u1ec1 H\u1ec7 sinh th\u00e1i SematX","text":"<p>Trang n\u00e0y cung c\u1ea5p gi\u1ea3i th\u00edch chi ti\u1ebft v\u1ec1 c\u00e1ch c\u00e1c th\u00e0nh ph\u1ea7n kh\u00e1c nhau c\u1ee7a SematX ho\u1ea1t \u0111\u1ed9ng c\u00f9ng nhau \u0111\u1ec3 t\u1ea1o ra m\u1ed9t n\u1ec1n t\u1ea3ng th\u00e0nh ph\u1ed1 th\u00f4ng minh ho\u00e0n ch\u1ec9nh.</p>"},{"location":"vi/about-sematx/ecosystem/#tong-quan-kien-truc","title":"T\u1ed5ng quan Ki\u1ebfn tr\u00fac","text":"<p>N\u1ec1n t\u1ea3ng SematX tu\u00e2n theo ki\u1ebfn tr\u00fac ph\u00e2n l\u1edbp gi\u00fap t\u00e1ch bi\u1ec7t c\u00e1c m\u1ed1i quan t\u00e2m v\u00e0 cung c\u1ea5p t\u00ednh linh ho\u1ea1t:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            Ng\u01b0\u1eddi d\u00f9ng &amp; Thi\u1ebft b\u1ecb                     \u2502\n\u2502          (Web, Mobile, Thi\u1ebft b\u1ecb IoT)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n                      \u2502 HTTPS/JWT\n                      \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Orion Nginx Gateway                     \u2502\n\u2502         (X\u00e1c th\u1ef1c &amp; API Gateway)                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502                       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Lego Dashboard    \u2502  \u2502   Orion-LD       \u2502\n\u2502  (PayloadCMS)      \u2502  \u2502 Context Broker   \u2502\n\u2502  - UI/Dashboard    \u2502  \u2502  - L\u01b0u tr\u1eef Entity\u2502\n\u2502  - Qu\u1ea3n l\u00fd User    \u2502  \u2502  - NGSI-LD API   \u2502\n\u2502  - API Keys        \u2502  \u2502  - Subscriptions \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502                      \u2502\n          \u2502        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502        \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    C\u01a1 s\u1edf d\u1eef li\u1ec7u MongoDB    \u2502\n\u2502  - D\u1eef li\u1ec7u Dashboard        \u2502\n\u2502  - D\u1eef li\u1ec7u Entity (Orion)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"vi/about-sematx/ecosystem/#phan-tich-chi-tiet-thanh-phan","title":"Ph\u00e2n t\u00edch Chi ti\u1ebft Th\u00e0nh ph\u1ea7n","text":""},{"location":"vi/about-sematx/ecosystem/#orion-ld-context-broker","title":"Orion-LD Context Broker","text":"<p>M\u1ee5c \u0111\u00edch: Kho d\u1eef li\u1ec7u trung t\u00e2m v\u00e0 m\u00e1y ch\u1ee7 NGSI-LD API.</p> <p>Tr\u00e1ch nhi\u1ec7m ch\u00ednh: - L\u01b0u tr\u1eef v\u00e0 qu\u1ea3n l\u00fd d\u1eef li\u1ec7u entity theo ti\u00eau chu\u1ea9n NGSI-LD - Cung c\u1ea5p query API \u0111\u1ec3 truy xu\u1ea5t th\u00f4ng tin entity - X\u1eed l\u00fd subscriptions entity cho th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c - Duy tr\u00ec m\u1ed1i quan h\u1ec7 v\u00e0 thu\u1ed9c t\u00ednh c\u1ee7a entity - H\u1ed7 tr\u1ee3 truy v\u1ea5n temporal cho d\u1eef li\u1ec7u l\u1ecbch s\u1eed</p> <p>Ng\u0103n x\u1ebfp C\u00f4ng ngh\u1ec7: - \u0110\u01b0\u1ee3c vi\u1ebft b\u1eb1ng C++ \u0111\u1ec3 c\u00f3 hi\u1ec7u su\u1ea5t cao - S\u1eed d\u1ee5ng MongoDB \u0111\u1ec3 l\u01b0u tr\u1eef d\u1eef li\u1ec7u - Tri\u1ec3n khai \u0111\u1eb7c t\u1ea3 NGSI-LD v1.6.1 - H\u1ed7 tr\u1ee3 GeoJSON cho truy v\u1ea5n kh\u00f4ng gian \u0111\u1ecba l\u00fd</p> <p>API Endpoints: - <code>POST /ngsi-ld/v1/entities</code> - T\u1ea1o entities - <code>GET /ngsi-ld/v1/entities</code> - Truy v\u1ea5n entities - <code>PATCH /ngsi-ld/v1/entities/{entityId}/attrs</code> - C\u1eadp nh\u1eadt thu\u1ed9c t\u00ednh entity - <code>DELETE /ngsi-ld/v1/entities/{entityId}</code> - X\u00f3a entities - <code>POST /ngsi-ld/v1/subscriptions</code> - T\u1ea1o subscriptions</p> <p>V\u00ed d\u1ee5 Entity: <pre><code>{\n  \"id\": \"urn:ngsi-ld:AirQualityObserved:001\",\n  \"type\": \"AirQualityObserved\",\n  \"dateObserved\": {\n    \"type\": \"Property\",\n    \"value\": {\n      \"@type\": \"DateTime\",\n      \"@value\": \"2025-12-02T10:30:00Z\"\n    }\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"PM25\": {\n    \"type\": \"Property\",\n    \"value\": 35,\n    \"unitCode\": \"GQ\"\n  },\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 28.5,\n    \"unitCode\": \"CEL\"\n  }\n}\n</code></pre></p>"},{"location":"vi/about-sematx/ecosystem/#orion-nginx-gateway","title":"Orion Nginx Gateway","text":"<p>M\u1ee5c \u0111\u00edch: L\u1edbp API gateway v\u00e0 x\u00e1c th\u1ef1c an to\u00e0n, hi\u1ec7u su\u1ea5t cao.</p> <p>Tr\u00e1ch nhi\u1ec7m ch\u00ednh: - X\u00e1c th\u1ef1c c\u00e1c y\u00eau c\u1ea7u s\u1eed d\u1ee5ng JWT tokens - \u0110\u1ecbnh tuy\u1ebfn API calls \u0111\u1ebfn c\u00e1c d\u1ecbch v\u1ee5 backend ph\u00f9 h\u1ee3p - Th\u1ef1c thi gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 \u0111\u1ec3 ng\u0103n ch\u1eb7n l\u1ea1m d\u1ee5ng - X\u1eed l\u00fd CORS cho \u1ee9ng d\u1ee5ng web - Cung c\u1ea5p SSL/TLS termination - Ghi log v\u00e0 gi\u00e1m s\u00e1t vi\u1ec7c s\u1eed d\u1ee5ng API</p> <p>Ng\u0103n x\u1ebfp C\u00f4ng ngh\u1ec7: - Nginx \u0111\u1ec3 x\u1eed l\u00fd y\u00eau c\u1ea7u hi\u1ec7u su\u1ea5t cao - Lua scripts cho logic x\u00e1c th\u1ef1c t\u00f9y ch\u1ec9nh - X\u00e1c th\u1ef1c JWT s\u1eed d\u1ee5ng public keys - Redis cho rate limiting v\u00e0 caching</p> <p>T\u00ednh n\u0103ng B\u1ea3o m\u1eadt:</p> <ol> <li> <p>X\u00e1c th\u1ef1c JWT: M\u1ecdi y\u00eau c\u1ea7u API ph\u1ea3i bao g\u1ed3m JWT token h\u1ee3p l\u1ec7 trong header <code>Authorization</code>:    <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n</code></pre></p> </li> <li> <p>X\u00e1c th\u1ef1c API Key: Tokens \u0111\u01b0\u1ee3c ph\u00e1t h\u00e0nh b\u1edfi Lego Dashboard v\u00e0 ch\u1ee9a:</p> </li> <li>User ID</li> <li>Permissions/scopes</li> <li>Th\u1eddi gian h\u1ebft h\u1ea1n</li> <li> <p>M\u1ee9c gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9</p> </li> <li> <p>Gi\u1edbi h\u1ea1n T\u1ed1c \u0111\u1ed9: Ng\u0103n ch\u1eb7n l\u1ea1m d\u1ee5ng API v\u1edbi c\u00e1c gi\u1edbi h\u1ea1n c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh:</p> </li> <li>M\u1eb7c \u0111\u1ecbnh: 100 requests m\u1ed7i ph\u00fat cho m\u1ed7i API key</li> <li> <p>C\u00e1c tiers t\u00f9y ch\u1ec9nh c\u00f3 s\u1eb5n cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng kh\u00e1c nhau</p> </li> <li> <p>C\u1ea5u h\u00ecnh CORS: Cho ph\u00e9p c\u00e1c \u1ee9ng d\u1ee5ng web truy c\u1eadp API:    <pre><code>add_header 'Access-Control-Allow-Origin' '*';\nadd_header 'Access-Control-Allow-Methods' 'GET, POST, PATCH, DELETE, OPTIONS';\nadd_header 'Access-Control-Allow-Headers' 'Authorization, Content-Type, NGSILD-Tenant';\n</code></pre></p> </li> </ol> <p>Logic \u0110\u1ecbnh tuy\u1ebfn:</p> <pre><code># Dashboard API routes\nlocation /api/ {\n    proxy_pass http://dashboard:3000;\n}\n\n# NGSI-LD API routes (y\u00eau c\u1ea7u JWT)\nlocation /ngsi-ld/ {\n    access_by_lua_file /etc/nginx/lua/jwt_verify.lua;\n    proxy_pass http://orion:1026;\n}\n\n# Health check endpoint (kh\u00f4ng c\u1ea7n auth)\nlocation /health {\n    return 200 \"OK\";\n}\n</code></pre>"},{"location":"vi/about-sematx/ecosystem/#lego-dashboard","title":"Lego Dashboard","text":"<p>M\u1ee5c \u0111\u00edch: Giao di\u1ec7n web th\u00e2n thi\u1ec7n v\u1edbi ng\u01b0\u1eddi d\u00f9ng \u0111\u1ec3 qu\u1ea3n l\u00fd v\u00e0 tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u IoT.</p> <p>Tr\u00e1ch nhi\u1ec7m ch\u00ednh: - Cung c\u1ea5p tr\u00ecnh t\u1ea1o dashboard tr\u1ef1c quan v\u1edbi widgets k\u00e9o-th\u1ea3 - Qu\u1ea3n l\u00fd ng\u01b0\u1eddi d\u00f9ng, teams v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp - T\u1ea1o v\u00e0 qu\u1ea3n l\u00fd API keys - T\u1ea1o v\u00e0 qu\u1ea3n l\u00fd m\u1eabu entity - C\u1ea5u h\u00ecnh subscriptions d\u1eef li\u1ec7u v\u00e0 webhooks - Hi\u1ec3n th\u1ecb tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c</p> <p>Ng\u0103n x\u1ebfp C\u00f4ng ngh\u1ec7: - \u0110\u01b0\u1ee3c x\u00e2y d\u1ef1ng tr\u00ean PayloadCMS (Node.js/React) - MongoDB \u0111\u1ec3 l\u01b0u tr\u1eef c\u1ea5u h\u00ecnh dashboard - Next.js cho server-side rendering - React cho c\u00e1c th\u00e0nh ph\u1ea7n UI t\u01b0\u01a1ng t\u00e1c - TypeScript cho type safety</p> <p>T\u00ednh n\u0103ng C\u1ed1t l\u00f5i:</p> <ol> <li>Tr\u00ecnh t\u1ea1o Dashboard:</li> <li>T\u1ea1o card k\u00e9o-th\u1ea3</li> <li>Nhi\u1ec1u lo\u1ea1i card: b\u1ea3n \u0111\u1ed3, bi\u1ec3u \u0111\u1ed3, b\u1ea3ng, metrics</li> <li>C\u1eadp nh\u1eadt d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c qua subscriptions</li> <li> <p>Layouts responsive cho mobile v\u00e0 desktop</p> </li> <li> <p>Qu\u1ea3n l\u00fd Entity:</p> </li> <li>Duy\u1ec7t v\u00e0 t\u00ecm ki\u1ebfm entities</li> <li>T\u1ea1o entities v\u1edbi form builder</li> <li>C\u1eadp nh\u1eadt thu\u1ed9c t\u00ednh entity theo th\u1eddi gian th\u1ef1c</li> <li>X\u00f3a v\u00e0 c\u00e1c thao t\u00e1c h\u00e0ng lo\u1ea1t</li> <li> <p>Import/export entities d\u01b0\u1edbi d\u1ea1ng JSON</p> </li> <li> <p>Qu\u1ea3n l\u00fd API Key:</p> </li> <li>T\u1ea1o JWT tokens cho truy c\u1eadp API</li> <li>\u0110\u1eb7t permissions v\u00e0 rate limits cho m\u1ed7i key</li> <li>Thu h\u1ed3i keys ngay l\u1eadp t\u1ee9c</li> <li> <p>Gi\u00e1m s\u00e1t vi\u1ec7c s\u1eed d\u1ee5ng API cho m\u1ed7i key</p> </li> <li> <p>Ki\u1ec3m so\u00e1t Truy c\u1eadp:</p> </li> <li>Role-based access control (RBAC)</li> <li>Qu\u1ea3n l\u00fd organization v\u00e0 team</li> <li>Permissions chi ti\u1ebft cho m\u1ed7i lo\u1ea1i entity</li> <li> <p>Audit logs cho tu\u00e2n th\u1ee7 b\u1ea3o m\u1eadt</p> </li> <li> <p>Subscriptions:</p> </li> <li>T\u1ea1o NGSI-LD subscriptions</li> <li>C\u1ea5u h\u00ecnh webhook endpoints</li> <li>L\u1ecdc entities theo type v\u00e0 properties</li> <li>Gi\u00e1m s\u00e1t tr\u1ea1ng th\u00e1i subscription</li> </ol>"},{"location":"vi/about-sematx/ecosystem/#vi-du-data-flow","title":"V\u00ed d\u1ee5 Data Flow","text":""},{"location":"vi/about-sematx/ecosystem/#vi-du-1-thiet-bi-iot-gui-du-lieu","title":"V\u00ed d\u1ee5 1: Thi\u1ebft b\u1ecb IoT G\u1eedi D\u1eef li\u1ec7u","text":"<ol> <li>Thi\u1ebft b\u1ecb t\u1ea1o sensor reading (nhi\u1ec7t \u0111\u1ed9: 28.5\u00b0C)</li> <li>Thi\u1ebft b\u1ecb g\u1eedi HTTP POST \u0111\u1ebfn <code>/ngsi-ld/v1/entities/{id}/attrs</code> v\u1edbi JWT token</li> <li>Nginx Gateway x\u00e1c th\u1ef1c JWT v\u00e0 ki\u1ec3m tra rate limits</li> <li>Nginx Gateway chuy\u1ec3n ti\u1ebfp request \u0111\u1ebfn Orion-LD</li> <li>Orion-LD c\u1eadp nh\u1eadt entity trong MongoDB</li> <li>Orion-LD k\u00edch ho\u1ea1t active subscriptions</li> <li>Orion-LD g\u1eedi notifications \u0111\u1ebfn Lego Dashboard webhooks</li> <li>Lego Dashboard c\u1eadp nh\u1eadt bi\u1ec3u \u0111\u1ed3 th\u1eddi gian th\u1ef1c tr\u00ean dashboards ng\u01b0\u1eddi d\u00f9ng</li> </ol>"},{"location":"vi/about-sematx/ecosystem/#vi-du-2-nguoi-dung-tao-dashboard-card","title":"V\u00ed d\u1ee5 2: Ng\u01b0\u1eddi d\u00f9ng T\u1ea1o Dashboard Card","text":"<ol> <li>Ng\u01b0\u1eddi d\u00f9ng \u0111\u0103ng nh\u1eadp v\u00e0o Lego Dashboard web UI</li> <li>Ng\u01b0\u1eddi d\u00f9ng \u0111i\u1ec1u h\u01b0\u1edbng \u0111\u1ebfn dashboard builder</li> <li>Ng\u01b0\u1eddi d\u00f9ng k\u00e9o card \"Temperature Chart\" v\u00e0o canvas</li> <li>Ng\u01b0\u1eddi d\u00f9ng c\u1ea5u h\u00ecnh card \u0111\u1ec3 hi\u1ec3n th\u1ecb entity <code>urn:ngsi-ld:Sensor:001</code></li> <li>Dashboard l\u01b0u c\u1ea5u h\u00ecnh card v\u00e0o MongoDB</li> <li>Dashboard t\u1ea1o NGSI-LD subscription trong Orion-LD</li> <li>Orion-LD th\u00f4ng b\u00e1o cho Dashboard khi entity c\u1eadp nh\u1eadt</li> <li>Dashboard \u0111\u1ea9y c\u1eadp nh\u1eadt \u0111\u1ebfn tr\u00ecnh duy\u1ec7t ng\u01b0\u1eddi d\u00f9ng qua WebSocket</li> </ol>"},{"location":"vi/about-sematx/ecosystem/#vi-du-3-ung-dung-ben-thu-ba-truy-van-du-lieu","title":"V\u00ed d\u1ee5 3: \u1ee8ng d\u1ee5ng B\u00ean th\u1ee9 ba Truy v\u1ea5n D\u1eef li\u1ec7u","text":"<ol> <li>Developer l\u1ea5y API key t\u1eeb Lego Dashboard</li> <li>App th\u1ef1c hi\u1ec7n GET request \u0111\u1ebfn <code>/ngsi-ld/v1/entities?type=Sensor</code></li> <li>Nginx Gateway x\u00e1c th\u1ef1c JWT token</li> <li>Nginx Gateway ki\u1ec3m tra rate limits (99/100 \u0111\u00e3 s\u1eed d\u1ee5ng)</li> <li>Nginx Gateway chuy\u1ec3n ti\u1ebfp truy v\u1ea5n \u0111\u1ebfn Orion-LD</li> <li>Orion-LD truy v\u1ea5n MongoDB cho c\u00e1c entities kh\u1edbp</li> <li>Orion-LD tr\u1ea3 v\u1ec1 JSON response</li> <li>Nginx Gateway chuy\u1ec3n ti\u1ebfp response \u0111\u1ebfn App</li> <li>App hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u sensor cho ng\u01b0\u1eddi d\u00f9ng cu\u1ed1i</li> </ol>"},{"location":"vi/about-sematx/ecosystem/#cac-buoc-tiep-theo","title":"C\u00e1c B\u01b0\u1edbc Ti\u1ebfp theo","text":"<ul> <li>Kh\u1edfi \u0111\u1ed9ng Local Server</li> <li>Tri\u1ec3n khai Production</li> <li>H\u1ecdc Core Concepts</li> </ul>"},{"location":"vi/about-sematx/tools/","title":"C\u00f4ng c\u1ee5 v\u00e0 C\u00f4ng ngh\u1ec7 SematX","text":"<p>Trang n\u00e0y cung c\u1ea5p t\u1ed5ng quan v\u1ec1 c\u00e1c c\u00f4ng ngh\u1ec7 v\u00e0 c\u00f4ng c\u1ee5 ch\u00ednh h\u1ed7 tr\u1ee3 n\u1ec1n t\u1ea3ng SematX.</p>"},{"location":"vi/about-sematx/tools/#cong-nghe-cot-loi","title":"C\u00f4ng ngh\u1ec7 C\u1ed1t l\u00f5i","text":""},{"location":"vi/about-sematx/tools/#tieu-chuan-ngsi-ld","title":"Ti\u00eau chu\u1ea9n NGSI-LD","text":"<p>NGSI-LD l\u00e0 g\u00ec?</p> <p>NGSI-LD (Next Generation Service Interface - Linked Data) l\u00e0 m\u1ed9t m\u00f4 h\u00ecnh th\u00f4ng tin v\u00e0 \u0111\u1eb7c t\u1ea3 API \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi ETSI (European Telecommunications Standards Institute) \u0111\u1ec3 qu\u1ea3n l\u00fd th\u00f4ng tin ng\u1eef c\u1ea3nh trong c\u00e1c \u1ee9ng d\u1ee5ng IoT v\u00e0 th\u00e0nh ph\u1ed1 th\u00f4ng minh.</p> <p>T\u00ednh n\u0103ng Ch\u00ednh: - Bi\u1ec3u di\u1ec5n entity \u0111\u01b0\u1ee3c chu\u1ea9n h\u00f3a - M\u00f4 h\u00ecnh d\u1eef li\u1ec7u d\u1ef1a tr\u00ean Property - Qu\u1ea3n l\u00fd Relationship gi\u1eefa c\u00e1c entities - H\u1ed7 tr\u1ee3 truy v\u1ea5n kh\u00f4ng gian \u0111\u1ecba l\u00fd - X\u1eed l\u00fd d\u1eef li\u1ec7u temporal - C\u01a1 ch\u1ebf subscription cho th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c</p> <p>T\u1ea1i sao NGSI-LD? - Kh\u1ea3 n\u0103ng t\u01b0\u01a1ng t\u00e1c: \u0110\u1ecbnh d\u1ea1ng d\u1eef li\u1ec7u chu\u1ea9n tr\u00ean c\u00e1c h\u1ec7 th\u1ed1ng - Semantic Web: \u0110\u01b0\u1ee3c x\u00e2y d\u1ef1ng tr\u00ean JSON-LD cho linked data - B\u1ec1n v\u1eefng trong t\u01b0\u01a1ng lai: \u0110\u01b0\u1ee3c h\u1ed7 tr\u1ee3 b\u1edfi FIWARE v\u00e0 c\u00e1c n\u1ec1n t\u1ea3ng IoT ch\u00ednh - Linh ho\u1ea1t: H\u1ed7 tr\u1ee3 b\u1ea5t k\u1ef3 lo\u1ea1i entity v\u00e0 property n\u00e0o</p> <p>V\u00ed d\u1ee5 Entity trong NGSI-LD: <pre><code>{\n  \"@context\": [\n    \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n  ],\n  \"id\": \"urn:ngsi-ld:Building:001\",\n  \"type\": \"Building\",\n  \"address\": {\n    \"type\": \"Property\",\n    \"value\": {\n      \"streetAddress\": \"123 \u0110\u01b0\u1eddng Ch\u00ednh\",\n      \"addressLocality\": \"C\u1ea7n Th\u01a1\",\n      \"addressCountry\": \"Vi\u1ec7t Nam\"\n    }\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"hasFloor\": {\n    \"type\": \"Relationship\",\n    \"object\": \"urn:ngsi-ld:Floor:001\"\n  }\n}\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#fiware-orion-ld","title":"FIWARE Orion-LD","text":"<p>FIWARE l\u00e0 g\u00ec?</p> <p>FIWARE l\u00e0 m\u1ed9t n\u1ec1n t\u1ea3ng m\u00e3 ngu\u1ed3n m\u1edf cung c\u1ea5p m\u1ed9t framework \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n v\u00e0 ti\u00eau chu\u1ea9n \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c gi\u1ea3i ph\u00e1p th\u00f4ng minh. Orion-LD l\u00e0 th\u00e0nh ph\u1ea7n context broker th\u1ebf h\u1ec7 ti\u1ebfp theo c\u1ee7a FIWARE.</p> <p>T\u00ednh n\u0103ng Orion-LD: - Tu\u00e2n th\u1ee7 \u0111\u1ea7y \u0111\u1ee7 NGSI-LD v1.6.1 - Tri\u1ec3n khai C++ hi\u1ec7u su\u1ea5t cao - Backend MongoDB \u0111\u1ec3 l\u01b0u tr\u1eef - Temporal API cho truy v\u1ea5n l\u1ecbch s\u1eed - H\u1ed7 tr\u1ee3 distributed tracing - Kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng theo chi\u1ec1u ngang</p> <p>\u0110\u1eb7c \u0111i\u1ec3m Hi\u1ec7u su\u1ea5t: - X\u1eed l\u00fd 1000+ requests/gi\u00e2y tr\u00ean m\u1ed7i instance - \u0110\u1ed9 tr\u1ec5 d\u01b0\u1edbi 10ms cho truy v\u1ea5n \u0111\u01a1n gi\u1ea3n - H\u1ed7 tr\u1ee3 h\u00e0ng tri\u1ec7u entities - Subscriptions th\u1eddi gian th\u1ef1c v\u1edbi \u0111\u1ed9 tr\u1ec5 th\u00f4ng b\u00e1o &lt;100ms</p> <p>T\u00f9y ch\u1ecdn C\u1ea5u h\u00ecnh: <pre><code># C\u00e1c tham s\u1ed1 kh\u1edfi \u0111\u1ed9ng Orion-LD ch\u00ednh\n-dbhost mongodb:27017          # K\u1ebft n\u1ed1i MongoDB\n-logLevel DEBUG                # M\u1ee9c \u0111\u1ed9 chi ti\u1ebft logging\n-forwarding                    # B\u1eadt federation\n-experimental                  # B\u1eadt t\u00ednh n\u0103ng th\u1eed nghi\u1ec7m\n-corsOrigin __ALL              # C\u1ea5u h\u00ecnh CORS\n</code></pre></p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng Orion-LD: - C\u1ea7n context broker tu\u00e2n th\u1ee7 ti\u00eau chu\u1ea9n - X\u00e2y d\u1ef1ng h\u1ec7 th\u1ed1ng IoT \u0111a nh\u00e0 cung c\u1ea5p - Y\u00eau c\u1ea7u truy v\u1ea5n kh\u00f4ng gian \u0111\u1ecba l\u00fd - C\u1ea7n subscriptions d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c - Mu\u1ed1n gi\u1ea3i ph\u00e1p m\u00e3 ngu\u1ed3n m\u1edf</p>"},{"location":"vi/about-sematx/tools/#payloadcms","title":"PayloadCMS","text":"<p>PayloadCMS l\u00e0 g\u00ec?</p> <p>Payload l\u00e0 m\u1ed9t headless CMS v\u00e0 application framework \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng v\u1edbi Node.js, React v\u00e0 TypeScript. Trong SematX, ch\u00fang t\u00f4i s\u1eed d\u1ee5ng Payload l\u00e0m n\u1ec1n t\u1ea3ng cho Lego Dashboard.</p> <p>T\u1ea1i sao PayloadCMS? - Type-safe: H\u1ed7 tr\u1ee3 TypeScript \u0111\u1ea7y \u0111\u1ee7 - Linh ho\u1ea1t: Collections v\u00e0 fields c\u00f3 th\u1ec3 t\u00f9y ch\u1ec9nh - Hi\u1ec7n \u0111\u1ea1i: Admin UI d\u1ef1a tr\u00ean React - API-first: REST v\u00e0 GraphQL APIs \u0111\u01b0\u1ee3c t\u1ef1 \u0111\u1ed9ng t\u1ea1o - C\u00f3 th\u1ec3 m\u1edf r\u1ed9ng: Ki\u1ebfn tr\u00fac plugin cho ch\u1ee9c n\u0103ng t\u00f9y ch\u1ec9nh - M\u00e3 ngu\u1ed3n m\u1edf: C\u1ed9ng \u0111\u1ed3ng v\u00e0 ph\u00e1t tri\u1ec3n t\u00edch c\u1ef1c</p> <p>T\u00ednh n\u0103ng Ch\u00ednh \u0110\u01b0\u1ee3c S\u1eed d\u1ee5ng trong SematX: - M\u00f4 h\u00ecnh h\u00f3a d\u1eef li\u1ec7u d\u1ef1a tr\u00ean Collection - Role-based access control (RBAC) - C\u00e1c th\u00e0nh ph\u1ea7n React t\u00f9y ch\u1ec9nh cho dashboard cards - Hooks cho business logic - Upload files cho assets - X\u00e1c th\u1ef1c v\u00e0 qu\u1ea3n l\u00fd ng\u01b0\u1eddi d\u00f9ng</p> <p>V\u00ed d\u1ee5 Collection Definition: <pre><code>export const Cards: CollectionConfig = {\n  slug: 'cards',\n  admin: {\n    useAsTitle: 'name',\n  },\n  access: {\n    read: authenticated,\n    create: authenticated,\n    update: authenticated,\n    delete: authenticated,\n  },\n  fields: [\n    {\n      name: 'name',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'type',\n      type: 'select',\n      options: ['map', 'chart', 'table', 'metric'],\n      required: true,\n    },\n    {\n      name: 'entityType',\n      type: 'text',\n      required: true,\n    },\n    {\n      name: 'configuration',\n      type: 'json',\n    },\n  ],\n}\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#mongodb","title":"MongoDB","text":"<p>Vai tr\u00f2 trong SematX:</p> <p>MongoDB \u0111\u00f3ng vai tr\u00f2 l\u00e0 l\u1edbp l\u01b0u tr\u1eef cho c\u1ea3 Orion-LD v\u00e0 Lego Dashboard, l\u01b0u tr\u1eef: - D\u1eef li\u1ec7u entity (Orion-LD) - C\u1ea5u h\u00ecnh dashboard - T\u00e0i kho\u1ea3n ng\u01b0\u1eddi d\u00f9ng v\u00e0 permissions - API keys v\u00e0 access tokens - \u0110\u1ecbnh ngh\u0129a subscription</p> <p>T\u1ea1i sao MongoDB? - Schema-less: C\u1ea5u tr\u00fac document linh ho\u1ea1t cho NGSI-LD entities - Hi\u1ec7u su\u1ea5t: Thao t\u00e1c \u0111\u1ecdc/ghi nhanh - Kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng: Replica sets v\u00e0 sharding - Kh\u00f4ng gian \u0111\u1ecba l\u00fd: H\u1ed7 tr\u1ee3 native cho truy v\u1ea5n GeoJSON - Aggregation: Pipeline ph\u00e2n t\u00edch d\u1eef li\u1ec7u m\u1ea1nh m\u1ebd</p> <p>M\u1eabu Tri\u1ec3n khai:</p> <ol> <li>Development: Single MongoDB instance</li> <li>Production: Replica set (3+ nodes) cho high availability</li> <li>Large Scale: Sharded cluster cho horizontal scaling</li> </ol> <p>Chi\u1ebfn l\u01b0\u1ee3c Backup: <pre><code># Backup th\u01b0\u1eddng xuy\u00ean s\u1eed d\u1ee5ng mongodump\nmongodump --uri=\"mongodb://localhost:27017/orion\" --out=/backup/\n\n# Point-in-time recovery v\u1edbi replica sets\n# S\u1eed d\u1ee5ng oplog cho continuous backup\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#nginx","title":"Nginx","text":"<p>Vai tr\u00f2 trong SematX:</p> <p>Nginx \u0111\u00f3ng vai tr\u00f2 l\u00e0 API gateway v\u00e0 reverse proxy, x\u1eed l\u00fd: - SSL/TLS termination - Request routing - X\u00e1c th\u1ef1c JWT - Rate limiting - Load balancing - Ph\u1ee5c v\u1ee5 static files</p> <p>Modules Ch\u00ednh \u0110\u01b0\u1ee3c S\u1eed d\u1ee5ng: - <code>ngx_http_auth_jwt_module</code> - X\u00e1c th\u1ef1c JWT - <code>ngx_http_limit_req_module</code> - Rate limiting - <code>ngx_http_headers_module</code> - CORS headers - <code>ngx_http_upstream_module</code> - Load balancing</p> <p>V\u00ed d\u1ee5 C\u1ea5u h\u00ecnh: <pre><code>http {\n  # Rate limiting zone\n  limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;\n\n  upstream dashboard {\n    server dashboard:3000;\n  }\n\n  upstream orion {\n    server orion:1026;\n  }\n\n  server {\n    listen 443 ssl;\n    server_name api.sematx.io;\n\n    ssl_certificate /etc/nginx/ssl/cert.pem;\n    ssl_certificate_key /etc/nginx/ssl/key.pem;\n\n    # Dashboard routes\n    location /api/ {\n      proxy_pass http://dashboard;\n    }\n\n    # Orion-LD routes (v\u1edbi JWT)\n    location /ngsi-ld/ {\n      limit_req zone=api_limit burst=20 nodelay;\n      auth_jwt \"SematX API\";\n      auth_jwt_key_file /etc/nginx/jwt_key.json;\n      proxy_pass http://orion;\n    }\n  }\n}\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#cong-cu-phat-trien","title":"C\u00f4ng c\u1ee5 Ph\u00e1t tri\u1ec3n","text":""},{"location":"vi/about-sematx/tools/#docker-va-docker-compose","title":"Docker v\u00e0 Docker Compose","text":"<p>T\u1ea1i sao Docker? - M\u00f4i tr\u01b0\u1eddng nh\u1ea5t qu\u00e1n tr\u00ean dev/staging/prod - Qu\u1ea3n l\u00fd dependencies d\u1ec5 d\u00e0ng - Tri\u1ec3n khai \u0111\u01a1n gi\u1ea3n h\u00f3a - C\u00f4 l\u1eadp v\u00e0 b\u1ea3o m\u1eadt</p> <p>SematX Docker Setup: <pre><code>version: '3.8'\nservices:\n  mongodb:\n    image: mongo:6.0\n    volumes:\n      - mongo-data:/data/db\n\n  orion:\n    image: fiware/orion-ld:1.5.1\n    depends_on:\n      - mongodb\n    command: -dbhost mongodb\n\n  dashboard:\n    build: ./dashboard\n    depends_on:\n      - mongodb\n    environment:\n      - DATABASE_URI=mongodb://mongodb:27017/payload\n      - PAYLOAD_SECRET=${PAYLOAD_SECRET}\n\n  nginx:\n    image: nginx:alpine\n    ports:\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n    depends_on:\n      - orion\n      - dashboard\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#typescript","title":"TypeScript","text":"<p>L\u1ee3i \u00edch: - Type safety ng\u0103n ch\u1eb7n l\u1ed7i runtime - H\u1ed7 tr\u1ee3 IDE v\u00e0 autocomplete t\u1ed1t h\u01a1n - Code t\u1ef1 t\u00e0i li\u1ec7u h\u00f3a - Refactoring d\u1ec5 d\u00e0ng h\u01a1n - C\u00e1c t\u00ednh n\u0103ng JavaScript hi\u1ec7n \u0111\u1ea1i</p> <p>\u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng trong SematX cho: - Dashboard frontend (React components) - Dashboard backend (PayloadCMS configuration) - \u0110\u1ecbnh ngh\u0129a API types - Utility functions</p>"},{"location":"vi/about-sematx/tools/#react-va-nextjs","title":"React v\u00e0 Next.js","text":"<p>React: Th\u01b0 vi\u1ec7n UI d\u1ef1a tr\u00ean component - Dashboard widgets c\u00f3 th\u1ec3 t\u00e1i s\u1eed d\u1ee5ng - C\u1eadp nh\u1eadt d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c - Forms t\u01b0\u01a1ng t\u00e1c</p> <p>Next.js: React framework v\u1edbi server-side rendering - Page loads nhanh - T\u1ed1i \u01b0u h\u00f3a SEO - API routes cho backend logic - Static site generation</p>"},{"location":"vi/about-sematx/tools/#git-va-github","title":"Git v\u00e0 GitHub","text":"<p>Version Control: - T\u1ea5t c\u1ea3 code SematX \u0111\u01b0\u1ee3c version-controlled v\u1edbi Git - GitHub cho collaboration v\u00e0 CI/CD - Chi\u1ebfn l\u01b0\u1ee3c branching cho features v\u00e0 releases</p> <p>C\u1ea5u tr\u00fac Repository: <pre><code>LegoCity/\n\u251c\u2500\u2500 dashboard/              # Lego Dashboard (PayloadCMS)\n\u251c\u2500\u2500 orion-ld/              # C\u1ea5u h\u00ecnh Orion-LD\n\u251c\u2500\u2500 nginx/                 # C\u1ea5u h\u00ecnh Nginx gateway\n\u251c\u2500\u2500 docs/                  # Documentation (MkDocs)\n\u2514\u2500\u2500 docker-compose.yml     # Full stack orchestration\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#cong-cu-testing","title":"C\u00f4ng c\u1ee5 Testing","text":""},{"location":"vi/about-sematx/tools/#postmaninsomnia","title":"Postman/Insomnia","text":"<p>API Testing: - Test NGSI-LD endpoints - X\u00e1c th\u1ef1c JWT authentication - Ki\u1ec3m tra subscription notifications - Debug c\u00e1c v\u1ea5n \u0111\u1ec1 API</p> <p>Sample NGSI-LD Request: <pre><code># Create Entity\nPOST /ngsi-ld/v1/entities\nAuthorization: Bearer &lt;jwt_token&gt;\nContent-Type: application/ld+json\n\n{\n  \"id\": \"urn:ngsi-ld:Sensor:001\",\n  \"type\": \"Sensor\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 25.5\n  }\n}\n</code></pre></p>"},{"location":"vi/about-sematx/tools/#playwright","title":"Playwright","text":"<p>End-to-End Testing: - Automated UI testing cho dashboard - X\u00e1c th\u1ef1c user flow - Cross-browser testing - Visual regression testing</p>"},{"location":"vi/about-sematx/tools/#vitest","title":"Vitest","text":"<p>Unit Testing: - Test React components - X\u00e1c th\u1ef1c business logic - Mock API responses - Th\u1ef1c thi test nhanh</p>"},{"location":"vi/about-sematx/tools/#cong-cu-monitoring","title":"C\u00f4ng c\u1ee5 Monitoring","text":""},{"location":"vi/about-sematx/tools/#prometheus","title":"Prometheus","text":"<p>Thu th\u1eadp Metrics: - T\u1ef7 l\u1ec7 API request - Th\u1eddi gian response - T\u1ef7 l\u1ec7 l\u1ed7i - S\u1eed d\u1ee5ng t\u00e0i nguy\u00ean</p>"},{"location":"vi/about-sematx/tools/#grafana","title":"Grafana","text":"<p>Visualization: - Dashboards th\u1eddi gian th\u1ef1c - Bi\u1ec3u \u0111\u1ed3 metrics t\u00f9y ch\u1ec9nh - Alerting rules - Log aggregation</p>"},{"location":"vi/about-sematx/tools/#mongodb-compass","title":"MongoDB Compass","text":"<p>Qu\u1ea3n l\u00fd Database: - Visual query builder - Ph\u00e2n t\u00edch index - Th\u00f4ng tin chi ti\u1ebft v\u1ec1 hi\u1ec7u su\u1ea5t - Import/export d\u1eef li\u1ec7u</p>"},{"location":"vi/about-sematx/tools/#ide-uoc-khuyen-nghi","title":"IDE \u0110\u01b0\u1ee3c Khuy\u1ebfn ngh\u1ecb","text":""},{"location":"vi/about-sematx/tools/#tai-nguyen-hoc-tap","title":"T\u00e0i nguy\u00ean H\u1ecdc t\u1eadp","text":""},{"location":"vi/about-sematx/tools/#tai-lieu-chinh-thuc","title":"T\u00e0i li\u1ec7u Ch\u00ednh th\u1ee9c","text":"<ul> <li>\u0110\u1eb7c t\u1ea3 NGSI-LD</li> <li>T\u00e0i li\u1ec7u FIWARE</li> <li>PayloadCMS Docs</li> <li>MongoDB Manual</li> <li>Nginx Documentation</li> </ul>"},{"location":"vi/about-sematx/tools/#cong-ong","title":"C\u1ed9ng \u0111\u1ed3ng","text":"<ul> <li>FIWARE Community</li> <li>PayloadCMS Discord</li> <li>SematX GitHub Discussions</li> </ul>"},{"location":"vi/about-sematx/tools/#cac-buoc-tiep-theo","title":"C\u00e1c B\u01b0\u1edbc Ti\u1ebfp theo","text":"<ul> <li>Hi\u1ec3u v\u1ec1 H\u1ec7 sinh th\u00e1i</li> <li>B\u1eaft \u0111\u1ea7u X\u00e2y d\u1ef1ng</li> <li>Kh\u00e1m ph\u00e1 Core Concepts</li> </ul>"},{"location":"vi/ai/openrouter/","title":"Nh\u00e0 cung c\u1ea5p t\u00f9y ch\u1ec9nh OpenRouter","text":"<p>OpenRouter cung c\u1ea5p truy c\u1eadp 100+ m\u00f4 h\u00ecnh AI th\u00f4ng qua m\u1ed9t API duy nh\u1ea5t, gi\u00fap d\u1ec5 d\u00e0ng s\u1eed d\u1ee5ng c\u00e1c m\u00f4 h\u00ecnh t\u00f9y ch\u1ec9nh nh\u01b0 Gemini 2.0 Flash, Claude, GPT-4o v\u00e0 nhi\u1ec1u h\u01a1n n\u1eefa m\u00e0 kh\u00f4ng c\u1ea7n qu\u1ea3n l\u00fd nhi\u1ec1u t\u00edch h\u1ee3p nh\u00e0 cung c\u1ea5p.</p> <p>!!! success \"T\u1ea1i sao ch\u1ecdn OpenRouter?\" - \ud83c\udd93 C\u00e1c m\u00f4 h\u00ecnh mi\u1ec5n ph\u00ed kh\u1ea3 d\u1ee5ng (Gemini 2.0 Flash, v.v.) - \ud83d\udd0c H\u01a1n 100 m\u00f4 h\u00ecnh - Truy c\u1eadp c\u00e1c m\u00f4 h\u00ecnh m\u1edbi nh\u1ea5t t\u1eeb t\u1ea5t c\u1ea3 nh\u00e0 cung c\u1ea5p - \ud83d\udcb0 Hi\u1ec7u qu\u1ea3 v\u1ec1 chi ph\u00ed - Gi\u00e1 c\u1ea1nh tranh, tr\u1ea3 theo m\u1ee9c s\u1eed d\u1ee5ng - \ud83d\ude80 Kh\u00f4ng gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 t\u1eeb c\u00e1c nh\u00e0 cung c\u1ea5p ri\u00eang l\u1ebb - \ud83d\udd04 T\u1ef1 \u0111\u1ed9ng d\u1ef1 ph\u00f2ng - Logic th\u1eed l\u1ea1i t\u00edch h\u1ee3p s\u1eb5n - \ud83c\udfaf API duy nh\u1ea5t - M\u1ed9t t\u00edch h\u1ee3p cho t\u1ea5t c\u1ea3 m\u00f4 h\u00ecnh</p>"},{"location":"vi/ai/openrouter/#bat-au-nhanh","title":"B\u1eaft \u0111\u1ea7u nhanh","text":""},{"location":"vi/ai/openrouter/#1-lay-khoa-api-openrouter","title":"1. L\u1ea5y kh\u00f3a API OpenRouter","text":"<ol> <li>Truy c\u1eadp openrouter.ai</li> <li>\u0110\u0103ng k\u00fd ho\u1eb7c \u0111\u0103ng nh\u1eadp</li> <li>\u0110i t\u1edbi API Keys</li> <li>T\u1ea1o kh\u00f3a API m\u1edbi</li> </ol>"},{"location":"vi/ai/openrouter/#2-cau-hinh-moi-truong","title":"2. C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng","text":".env<pre><code># B\u1eadt t\u00ednh n\u0103ng AI\nENABLE_AI=true\nAI_PROVIDER=openrouter\n\n# C\u1ea5u h\u00ecnh OpenRouter\nOPENROUTER_API_KEY=sk-or-v1-...\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\nOPENROUTER_SITE_URL=https://legocity.example.com  # T\u00f9y ch\u1ecdn\nOPENROUTER_APP_NAME=LegoCity                      # T\u00f9y ch\u1ecdn\n</code></pre>"},{"location":"vi/ai/openrouter/#3-cau-hinh-nha-cung-cap-tuy-chinh","title":"3. C\u1ea5u h\u00ecnh nh\u00e0 cung c\u1ea5p t\u00f9y ch\u1ec9nh","text":"src/payload.config.ts<pre><code>import { buildConfig } from \"payload/config\";\n\nexport default buildConfig({\n  plugins: [\n    // Custom OpenRouter provider\n    {\n      name: \"ai-openrouter\",\n      provider: async ({ apiKey, model }) =&gt; {\n        return {\n          generateText: async ({ prompt, max_tokens = 500 }) =&gt; {\n            const response = await fetch(\n              \"https://openrouter.ai/api/v1/chat/completions\",\n              {\n                method: \"POST\",\n                headers: {\n                  Authorization: `Bearer ${apiKey}`,\n                  \"Content-Type\": \"application/json\",\n                  \"HTTP-Referer\": process.env.OPENROUTER_SITE_URL,\n                  \"X-Title\": process.env.OPENROUTER_APP_NAME,\n                },\n                body: JSON.stringify({\n                  model: model,\n                  messages: [{ role: \"user\", content: prompt }],\n                  max_tokens,\n                }),\n              }\n            );\n\n            const data = await response.json();\n            return data.choices[0].message.content;\n          },\n        };\n      },\n      apiKey: process.env.OPENROUTER_API_KEY,\n      model: process.env.OPENROUTER_MODEL,\n      enabled: process.env.ENABLE_AI === \"true\",\n    },\n  ],\n});\n</code></pre>"},{"location":"vi/ai/openrouter/#cac-mo-hinh-uoc-khuyen-nghi","title":"C\u00e1c m\u00f4 h\u00ecnh \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb","text":""},{"location":"vi/ai/openrouter/#cac-mo-hinh-mien-phi-hoan-hao-cho-phat-trien","title":"C\u00e1c m\u00f4 h\u00ecnh mi\u1ec5n ph\u00ed (Ho\u00e0n h\u1ea3o cho ph\u00e1t tri\u1ec3n)","text":"M\u00f4 h\u00ecnh Nh\u00e0 cung c\u1ea5p T\u1ed1c \u0111\u1ed9 Ch\u1ea5t l\u01b0\u1ee3ng Ng\u1eef c\u1ea3nh google/gemini-2.0-flash-exp:free Google \u26a1\u26a1\u26a1 \u2b50\u2b50\u2b50\u2b50 1M tokens google/gemini-flash-1.5:free Google \u26a1\u26a1\u26a1 \u2b50\u2b50\u2b50\u2b50 1M tokens meta-llama/llama-3.2-3b-instruct:free Meta \u26a1\u26a1 \u2b50\u2b50\u2b50 128K qwen/qwen-2-7b-instruct:free Alibaba \u26a1\u26a1 \u2b50\u2b50\u2b50 32K <p>M\u00f4 h\u00ecnh mi\u1ec5n ph\u00ed t\u1ed1t nh\u1ea5t</p> <p>google/gemini-2.0-flash-exp:free - Ch\u1ea5t l\u01b0\u1ee3ng tuy\u1ec7t v\u1eddi, r\u1ea5t nhanh, c\u1eeda s\u1ed5 ng\u1eef c\u1ea3nh 1M token</p>"},{"location":"vi/ai/openrouter/#cac-mo-hinh-cao-cap-su-dung-cho-san-xuat","title":"C\u00e1c m\u00f4 h\u00ecnh cao c\u1ea5p (S\u1eed d\u1ee5ng cho s\u1ea3n xu\u1ea5t)","text":"M\u00f4 h\u00ecnh Chi ph\u00ed (m\u1ed7i 1M tokens) T\u1ed1t nh\u1ea5t cho google/gemini-2.0-flash-thinking-exp $0.10 / $0.40 L\u00fd lu\u1eadn n\u00e2ng cao anthropic/claude-3.5-sonnet $3.00 / $15.00 N\u1ed9i dung ch\u1ea5t l\u01b0\u1ee3ng cao openai/gpt-4o-mini $0.15 / $0.60 S\u1eed d\u1ee5ng chung openai/gpt-4o $2.50 / $10.00 Nhi\u1ec7m v\u1ee5 ph\u1ee9c t\u1ea1p meta-llama/llama-3.3-70b-instruct $0.59 / $0.79 Hi\u1ec7u qu\u1ea3 chi ph\u00ed"},{"location":"vi/ai/openrouter/#cac-mo-hinh-chuyen-biet","title":"C\u00e1c m\u00f4 h\u00ecnh chuy\u00ean bi\u1ec7t","text":"M\u00f4 h\u00ecnh M\u1ee5c \u0111\u00edch Ng\u1eef c\u1ea3nh google/gemini-flash-1.5-8b Ph\u1ea3n h\u1ed3i c\u1ef1c nhanh 1M tokens anthropic/claude-3-haiku B\u1ea3n th\u1ea3o nhanh 200K perplexity/llama-3.1-sonar-huge-128k-online T\u00ecm ki\u1ebfm web + AI 128K"},{"location":"vi/ai/openrouter/#huong-dan-lua-chon-mo-hinh","title":"H\u01b0\u1edbng d\u1eabn l\u1ef1a ch\u1ecdn m\u00f4 h\u00ecnh","text":""},{"location":"vi/ai/openrouter/#theo-truong-hop-su-dung","title":"Theo tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng","text":"<p>T\u1ea1o n\u1ed9i dung Khuy\u1ebfn ngh\u1ecb: <code>google/gemini-2.0-flash-exp:free</code></p> <ul> <li>B\u00e0i vi\u1ebft blog, m\u00f4 t\u1ea3</li> <li>N\u1ed9i dung h\u01b0\u1edbng \u0111\u1ebfn ng\u01b0\u1eddi d\u00f9ng</li> <li>T\u00e0i li\u1ec7u</li> </ul> <p>T\u1ea1o m\u00e3 ngu\u1ed3n Khuy\u1ebfn ngh\u1ecb: <code>anthropic/claude-3.5-sonnet</code></p> <ul> <li>T\u1ec7p c\u1ea5u h\u00ecnh</li> <li>V\u00ed d\u1ee5 API</li> <li>T\u00e0i li\u1ec7u k\u1ef9 thu\u1eadt</li> </ul> <p>B\u1ea3n th\u1ea3o nhanh Khuy\u1ebfn ngh\u1ecb: <code>google/gemini-flash-1.5-8b</code></p> <ul> <li>M\u00f4 t\u1ea3 ng\u1eafn</li> <li>Nh\u00e3n, ti\u00eau \u0111\u1ec1</li> <li>T\u00f3m t\u1eaft nhanh</li> </ul> <p>L\u00fd lu\u1eadn ph\u1ee9c t\u1ea1p Khuy\u1ebfn ngh\u1ecb: <code>google/gemini-2.0-flash-thinking-exp</code></p> <ul> <li>Ph\u00e2n t\u00edch d\u1eef li\u1ec7u</li> <li>H\u1ed7 tr\u1ee3 quy\u1ebft \u0111\u1ecbnh</li> <li>Nhi\u1ec7m v\u1ee5 nhi\u1ec1u b\u01b0\u1edbc</li> </ul>"},{"location":"vi/ai/openrouter/#theo-ngan-sach","title":"Theo ng\u00e2n s\u00e1ch","text":"<p>Mi\u1ec5n ph\u00ed</p> <pre><code>// L\u1ef1a ch\u1ecdn mi\u1ec5n ph\u00ed t\u1ed1t nh\u1ea5t\nmodel: \"google/gemini-2.0-flash-exp:free\";\n\n// C\u00e1c l\u1ef1a ch\u1ecdn kh\u00e1c\n// model: 'google/gemini-flash-1.5:free'\n// model: 'meta-llama/llama-3.2-3b-instruct:free'\n</code></pre> <p>Chi ph\u00ed th\u1ea5p ($)</p> <pre><code>// Gi\u00e1 tr\u1ecb t\u1ed1t nh\u1ea5t\nmodel: \"openai/gpt-4o-mini\"; // $0.15/$0.60 m\u1ed7i 1M\n\n// L\u1ef1a ch\u1ecdn kh\u00e1c\n// model: 'google/gemini-flash-1.5'  // $0.075/$0.30 m\u1ed7i 1M\n</code></pre> <p>Ch\u1ea5t l\u01b0\u1ee3ng cao ($$)</p> <pre><code>// Ch\u1ea5t l\u01b0\u1ee3ng t\u1ed1t nh\u1ea5t\nmodel: \"anthropic/claude-3.5-sonnet\"; // $3/$15 m\u1ed7i 1M\n\n// L\u1ef1a ch\u1ecdn kh\u00e1c\n// model: 'openai/gpt-4o'  // $2.50/$10 m\u1ed7i 1M\n</code></pre>"},{"location":"vi/ai/openrouter/#cau-hinh-nang-cao","title":"C\u1ea5u h\u00ecnh n\u00e2ng cao","text":""},{"location":"vi/ai/openrouter/#chuyen-oi-mo-hinh","title":"Chuy\u1ec3n \u0111\u1ed5i m\u00f4 h\u00ecnh","text":"<p>\u0110\u1ed5i models d\u1ef1a tr\u00ean task:</p> src/lib/ai-helper.ts<pre><code>const AI_MODELS = {\n  content: \"google/gemini-2.0-flash-exp:free\",\n  code: \"anthropic/claude-3.5-sonnet\",\n  quick: \"google/gemini-flash-1.5-8b\",\n  reasoning: \"google/gemini-2.0-flash-thinking-exp\",\n};\n\nexport async function generateWithAI(\n  prompt: string,\n  task: keyof typeof AI_MODELS\n) {\n  const model = AI_MODELS[task];\n\n  const response = await fetch(\n    \"https://openrouter.ai/api/v1/chat/completions\",\n    {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${process.env.OPENROUTER_API_KEY}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        model,\n        messages: [{ role: \"user\", content: prompt }],\n      }),\n    }\n  );\n\n  return response.json();\n}\n</code></pre>"},{"location":"vi/ai/openrouter/#chuoi-du-phong","title":"Chu\u1ed7i d\u1ef1 ph\u00f2ng","text":"<pre><code>const FALLBACK_MODELS = [\n  \"google/gemini-2.0-flash-exp:free\", // Th\u1eed mi\u1ec5n ph\u00ed tr\u01b0\u1edbc\n  \"openai/gpt-4o-mini\", // D\u1ef1 ph\u00f2ng sang tr\u1ea3 ph\u00ed\n  \"anthropic/claude-3.5-haiku\", // Ph\u01b0\u01a1ng \u00e1n cu\u1ed1i c\u00f9ng\n];\n\nasync function generateWithFallback(prompt: string) {\n  for (const model of FALLBACK_MODELS) {\n    try {\n      return await generateWithAI(prompt, model);\n    } catch (error) {\n      console.warn(`M\u00f4 h\u00ecnh ${model} th\u1ea5t b\u1ea1i, \u0111ang th\u1eed m\u00f4 h\u00ecnh ti\u1ebfp theo...`);\n    }\n  }\n  throw new Error(\"T\u1ea5t c\u1ea3 c\u00e1c m\u00f4 h\u00ecnh AI \u0111\u1ec1u th\u1ea5t b\u1ea1i\");\n}\n</code></pre>"},{"location":"vi/ai/openrouter/#tham-so-tuy-chinh","title":"Tham s\u1ed1 t\u00f9y ch\u1ec9nh","text":"<pre><code>await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\n  method: \"POST\",\n  headers: {\n    Authorization: `Bearer ${process.env.OPENROUTER_API_KEY}`,\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify({\n    model: \"google/gemini-2.0-flash-exp:free\",\n    messages: [{ role: \"user\", content: prompt }],\n\n    // Tham s\u1ed1 t\u00f9y ch\u1ec9nh\n    temperature: 0.7, // \u0110\u1ed9 s\u00e1ng t\u1ea1o (0-2)\n    max_tokens: 1000, // \u0110\u1ed9 d\u00e0i ph\u1ea3n h\u1ed3i\n    top_p: 0.9, // L\u1ea5y m\u1eabu h\u1ea1t nh\u00e2n\n    frequency_penalty: 0.5, // Gi\u1ea3m l\u1eb7p l\u1ea1i\n    presence_penalty: 0.5, // Khuy\u1ebfn kh\u00edch \u0111a d\u1ea1ng\n\n    // D\u00e0nh ri\u00eang cho OpenRouter\n    transforms: [\"middle-out\"], // Gi\u1ea3m \u0111\u1ed9 tr\u1ec5\n    route: \"fallback\", // T\u1ef1 \u0111\u1ed9ng d\u1ef1 ph\u00f2ng khi l\u1ed7i\n  }),\n});\n</code></pre>"},{"location":"vi/ai/openrouter/#quan-ly-chi-phi","title":"Qu\u1ea3n l\u00fd chi ph\u00ed","text":""},{"location":"vi/ai/openrouter/#giam-sat-muc-su-dung","title":"Gi\u00e1m s\u00e1t m\u1ee9c s\u1eed d\u1ee5ng","text":"<p>OpenRouter cung c\u1ea5p theo d\u00f5i m\u1ee9c s\u1eed d\u1ee5ng:</p> <ol> <li>Truy c\u1eadp openrouter.ai/activity</li> <li>Xem chi ph\u00ed theo t\u1eebng m\u00f4 h\u00ecnh</li> <li>\u0110\u1eb7t c\u1ea3nh b\u00e1o ng\u00e2n s\u00e1ch</li> </ol>"},{"location":"vi/ai/openrouter/#chien-luoc-tiet-kiem-chi-phi","title":"Chi\u1ebfn l\u01b0\u1ee3c ti\u1ebft ki\u1ec7m chi ph\u00ed","text":"<p>S\u1eed d\u1ee5ng m\u00f4 h\u00ecnh mi\u1ec5n ph\u00ed cho ph\u00e1t tri\u1ec3n</p> .env.development<pre><code>OPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\n</code></pre> <p>Gi\u1edbi h\u1ea1n s\u1ed1 l\u01b0\u1ee3ng token</p> <pre><code>max_tokens: 300; // Gi\u1eef ph\u1ea3n h\u1ed3i ng\u1eafn g\u1ecdn\n</code></pre> <p>L\u01b0u tr\u1eef ph\u1ea3n h\u1ed3i v\u00e0o b\u1ed9 nh\u1edb \u0111\u1ec7m</p> <pre><code>// L\u01b0u tr\u1eef ph\u1ea3n h\u1ed3i AI cho c\u00e1c l\u1eddi nh\u1eafc gi\u1ed1ng h\u1ec7t nhau\nconst cache = new Map();\n\nasync function cachedGenerate(prompt: string) {\n  if (cache.has(prompt)) return cache.get(prompt);\n\n  const result = await generateWithAI(prompt);\n  cache.set(prompt, result);\n  return result;\n}\n</code></pre> <p>X\u1eed l\u00fd theo l\u00f4</p> <pre><code>// T\u1ea1o nhi\u1ec1u m\u1ee5c trong m\u1ed9t y\u00eau c\u1ea7u\nconst prompt = `T\u1ea1o m\u00f4 t\u1ea3 cho c\u00e1c l\u1edbp n\u00e0y:\n1. Quan s\u00e1t th\u1eddi ti\u1ebft\n2. V\u00f9ng l\u0169 l\u1ee5t\n3. C\u01a1 s\u1edf \u0111\u1eadu xe`;\n</code></pre>"},{"location":"vi/ai/openrouter/#khac-phuc-su-co","title":"Kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1","text":""},{"location":"vi/ai/openrouter/#cac-van-e-thuong-gap","title":"C\u00e1c v\u1ea5n \u0111\u1ec1 th\u01b0\u1eddng g\u1eb7p","text":"<p>401 Kh\u00f4ng \u0111\u01b0\u1ee3c \u1ee7y quy\u1ec1n V\u1ea5n \u0111\u1ec1: Kh\u00f3a API kh\u00f4ng h\u1ee3p l\u1ec7</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># X\u00e1c minh \u0111\u1ecbnh d\u1ea1ng kh\u00f3a\necho $OPENROUTER_API_KEY  # Ph\u1ea3i b\u1eaft \u0111\u1ea7u b\u1eb1ng sk-or-v1-\n\n# Ki\u1ec3m tra kh\u00f3a\ncurl https://openrouter.ai/api/v1/models \\\n  -H \"Authorization: Bearer $OPENROUTER_API_KEY\"\n</code></pre> <p>402 Y\u00eau c\u1ea7u thanh to\u00e1n V\u1ea5n \u0111\u1ec1: Kh\u00f4ng \u0111\u1ee7 t\u00edn d\u1ee5ng</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ul> <li>S\u1eed d\u1ee5ng c\u00e1c m\u00f4 h\u00ecnh mi\u1ec5n ph\u00ed: <code>google/gemini-2.0-flash-exp:free</code></li> <li>Th\u00eam t\u00edn d\u1ee5ng: openrouter.ai/credits</li> </ul> <p>429 Gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 V\u1ea5n \u0111\u1ec1: Qu\u00e1 nhi\u1ec1u y\u00eau c\u1ea7u</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code>// Th\u00eam \u0111\u1ed9 tr\u1ec5 gi\u1eefa c\u00e1c y\u00eau c\u1ea7u\nawait new Promise((resolve) =&gt; setTimeout(resolve, 1000));\n</code></pre> <p>Kh\u00f4ng t\u00ecm th\u1ea5y m\u00f4 h\u00ecnh V\u1ea5n \u0111\u1ec1: T\u00ean m\u00f4 h\u00ecnh kh\u00f4ng h\u1ee3p l\u1ec7</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># Li\u1ec7t k\u00ea c\u00e1c m\u00f4 h\u00ecnh kh\u1ea3 d\u1ee5ng\ncurl https://openrouter.ai/api/v1/models \\\n  -H \"Authorization: Bearer $OPENROUTER_API_KEY\"\n</code></pre>"},{"location":"vi/ai/openrouter/#thuc-hanh-tot-nhat","title":"Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t","text":""},{"location":"vi/ai/openrouter/#1-thiet-lap-phat-trien","title":"1. Thi\u1ebft l\u1eadp ph\u00e1t tri\u1ec3n","text":".env.development<pre><code># S\u1eed d\u1ee5ng c\u00e1c m\u00f4 h\u00ecnh mi\u1ec5n ph\u00ed cho ph\u00e1t tri\u1ec3n\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\nOPENROUTER_SITE_URL=http://localhost:3000\n</code></pre>"},{"location":"vi/ai/openrouter/#2-thiet-lap-san-xuat","title":"2. Thi\u1ebft l\u1eadp s\u1ea3n xu\u1ea5t","text":".env.production<pre><code># S\u1eed d\u1ee5ng c\u00e1c m\u00f4 h\u00ecnh tr\u1ea3 ph\u00ed \u0111\u00e1ng tin c\u1eady cho s\u1ea3n xu\u1ea5t\nOPENROUTER_MODEL=anthropic/claude-3.5-sonnet\nOPENROUTER_SITE_URL=https://legocity.example.com\n</code></pre>"},{"location":"vi/ai/openrouter/#3-xu-ly-loi","title":"3. X\u1eed l\u00fd l\u1ed7i","text":"<pre><code>async function safeGenerate(prompt: string) {\n  try {\n    return await generateWithAI(prompt);\n  } catch (error) {\n    console.error(\"AI generation failed:\", error);\n    // Fallback sang manual content\n    return null;\n  }\n}\n</code></pre>"},{"location":"vi/ai/openrouter/#4-gioi-han-toc-o","title":"4. Gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9","text":"<pre><code>import pLimit from \"p-limit\";\n\n// Gi\u1edbi h\u1ea1n c\u00e1c y\u00eau c\u1ea7u AI \u0111\u1ed3ng th\u1eddi\nconst limit = pLimit(3);\n\nconst promises = prompts.map((prompt) =&gt; limit(() =&gt; generateWithAI(prompt)));\n\nawait Promise.all(promises);\n</code></pre>"},{"location":"vi/ai/openrouter/#tai-nguyen","title":"T\u00e0i nguy\u00ean","text":"<ul> <li>T\u00e0i li\u1ec7u OpenRouter: openrouter.ai/docs</li> <li>Danh s\u00e1ch m\u00f4 h\u00ecnh: openrouter.ai/models</li> <li>Gi\u00e1 c\u1ea3: openrouter.ai/docs#pricing</li> <li>Tham chi\u1ebfu API: openrouter.ai/docs/api-reference</li> </ul>"},{"location":"vi/ai/openrouter/#cac-buoc-tiep-theo","title":"C\u00e1c b\u01b0\u1edbc ti\u1ebfp theo","text":"<ul> <li>C\u1ea5u h\u00ecnh nh\u00e0 cung c\u1ea5p AI - So s\u00e1nh t\u1ea5t c\u1ea3 nh\u00e0 cung c\u1ea5p</li> <li>C\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng AI - C\u00e1c v\u00ed d\u1ee5 th\u1ef1c t\u1ebf</li> <li>T\u1ed5ng quan v\u1ec1 AI - Hi\u1ec3u v\u1ec1 AI trong LegoCity</li> </ul>"},{"location":"vi/ai/overview/","title":"T\u1ed5ng quan Tr\u1ee3 gi\u00fap AI","text":"<p>LegoCity t\u00edch h\u1ee3p tr\u1ee3 gi\u00fap AI t\u00f9y ch\u1ecdn \u0111\u1ec3 h\u1ed7 tr\u1ee3 bi\u00ean t\u1eadp vi\u00ean v\u00e0 qu\u1ea3n tr\u1ecb vi\u00ean trong vi\u1ec7c t\u1ea1o descriptions, labels v\u00e0 c\u00e1c t\u00e1c v\u1ee5 n\u1ed9i dung kh\u00e1c. C\u00e1c t\u00ednh n\u0103ng AI n\u00e0y l\u00e0 ho\u00e0n to\u00e0n t\u00f9y ch\u1ecdn v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh theo m\u00f4i tr\u01b0\u1eddng.</p>"},{"location":"vi/ai/overview/#muc-ich","title":"M\u1ee5c \u0111\u00edch","text":"<p>Tr\u1ee3 gi\u00fap AI trong LegoCity \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3:</p> <ul> <li> <p>H\u1ed7 tr\u1ee3 bi\u00ean t\u1eadp vi\u00ean n\u1ed9i dung v\u1edbi c\u00e1c m\u00f4 t\u1ea3 \u0111\u01b0\u1ee3c t\u1ea1o cho:</p> </li> <li> <p>Map layers,</p> </li> <li>data views,</li> <li>entity types,</li> <li> <p>form fields.</p> </li> <li> <p>Gi\u1ea3m c\u00f4ng vi\u1ec7c l\u1eb7p l\u1ea1i trong vi\u1ec7c vi\u1ebft v\u0103n b\u1ea3n t\u01b0\u01a1ng t\u1ef1 cho nhi\u1ec1u layers, views ho\u1eb7c entity types.</p> </li> <li> <p>\u0110\u1ec1 xu\u1ea5t c\u1ea3i ti\u1ebfn cho:</p> </li> <li>labels,</li> <li>tooltips,</li> <li>summaries,</li> <li>schema descriptions.</li> </ul>"},{"location":"vi/ai/overview/#pham-vi","title":"Ph\u1ea1m vi","text":"<p>Tr\u1ee3 gi\u00fap AI l\u00e0 b\u1ed5 sung v\u00e0 kh\u00f4ng quy\u1ebft \u0111\u1ecbnh.</p> <p>Logic n\u1ec1n t\u1ea3ng kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o t\u00ednh n\u0103ng AI:</p> <ul> <li>Ch\u1ee9c n\u0103ng c\u1ed1t l\u00f5i ho\u1ea1t \u0111\u1ed9ng m\u00e0 kh\u00f4ng c\u00f3 AI</li> <li>Seeds, migrations v\u00e0 workflows \u0111\u1ed9c l\u1eadp v\u1edbi AI</li> <li>T\u00ednh n\u0103ng AI l\u00e0 c\u00e1c c\u1ea3i ti\u1ebfn thu\u1ea7n t\u00fay b\u1ed5 sung</li> </ul>"},{"location":"vi/ai/overview/#vi-du-truong-hop-su-dung","title":"V\u00ed d\u1ee5 tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng","text":""},{"location":"vi/ai/overview/#use-case-1-mo-ta-lop","title":"Use Case 1: M\u00f4 t\u1ea3 l\u1edbp","text":"<p>=== \"Quy tr\u00ecnh l\u00e0m vi\u1ec7c\" 1. Bi\u00ean t\u1eadp vi\u00ean t\u1ea1o l\u1edbp b\u1ea3n \u0111\u1ed3 m\u1edbi cho entity type \"WeatherObserved\" 2. Nh\u1ea5p \"Generate Description with AI\" 3. AI \u0111\u1ec1 xu\u1ea5t: &gt; \"L\u1edbp n\u00e0y hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u quan s\u00e1t th\u1eddi ti\u1ebft theo th\u1eddi gian th\u1ef1c, &gt; bao g\u1ed3m nhi\u1ec7t \u0111\u1ed9, \u0111\u1ed9 \u1ea9m v\u00e0 \u00e1p su\u1ea5t kh\u00ed quy\u1ec3n.\" 4. Bi\u00ean t\u1eadp vi\u00ean xem x\u00e9t, ch\u1ec9nh s\u1eeda n\u1ebfu c\u1ea7n v\u00e0 ch\u1ea5p nh\u1eadn</p> <p>=== \"L\u1ee3i \u00edch\" - Ti\u1ebft ki\u1ec7m th\u1eddi gian vi\u1ebft m\u00f4 t\u1ea3 cho c\u00e1c entity types ph\u1ed5 bi\u1ebfn - \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n gi\u1eefa c\u00e1c l\u1edbp - \u0110\u1ec1 xu\u1ea5t thu\u1eadt ng\u1eef ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 d\u1ec5 ti\u1ebfp c\u1eadn</p>"},{"location":"vi/ai/overview/#use-case-2-tom-tat-view","title":"Use Case 2: T\u00f3m t\u1eaft View","text":"<p>=== \"Quy tr\u00ecnh l\u00e0m vi\u1ec7c\" 1. Bi\u00ean t\u1eadp vi\u00ean t\u1ea1o view \"Flood Monitoring\" v\u1edbi: - L\u1edbp th\u1eddi ti\u1ebft (l\u01b0\u1ee3ng m\u01b0a) - V\u00f9ng nguy c\u01a1 l\u0169 l\u1ee5t - C\u1ea3m bi\u1ebfn m\u1ee9c n\u01b0\u1edbc</p> <pre><code>2. AI \u0111\u1ec1 xu\u1ea5t v\u0103n b\u1ea3n gi\u1edbi thi\u1ec7u:\n   &gt; **B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n gi\u00e1m s\u00e1t l\u0169 l\u1ee5t**\n   &gt;\n   &gt; Gi\u00e1m s\u00e1t nguy c\u01a1 l\u0169 l\u1ee5t theo th\u1eddi gian th\u1ef1c tr\u00ean to\u00e0n th\u00e0nh ph\u1ed1:\n   &gt; - Theo d\u00f5i c\u01b0\u1eddng \u0111\u1ed9 m\u01b0a v\u00e0 l\u01b0\u1ee3ng m\u01b0a t\u00edch l\u0169y\n   &gt; - Xem c\u00e1c v\u00f9ng nguy c\u01a1 l\u0169 l\u1ee5t cao\n   &gt; - Gi\u00e1m s\u00e1t m\u1ee9c n\u01b0\u1edbc s\u00f4ng t\u1ea1i c\u00e1c \u0111i\u1ec3m ch\u00ednh\n</code></pre> <p>=== \"L\u1ee3i \u00edch\" - C\u00e1c b\u1ea3n nh\u00e1p nhanh cho views m\u1edbi - \u0110\u1ecbnh d\u1ea1ng n\u1ed9i dung c\u00f3 c\u1ea5u tr\u00fac - C\u00e1c c\u00e2u h\u1ecfi v\u00ed d\u1ee5 cho tooltips tr\u1ee3 gi\u00fap</p>"},{"location":"vi/ai/overview/#use-case-3-nhan-khoi","title":"Use Case 3: Nh\u00e3n kh\u1ed1i","text":"<p>=== \"Quy tr\u00ecnh l\u00e0m vi\u1ec7c\" 1. Kh\u1ed1i <code>LayerToggle</code> \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh v\u1edbi c\u00e1c l\u1edbp: - <code>flood-risk-high</code> - <code>flood-risk-medium</code> - <code>flood-risk-low</code></p> <pre><code>2. AI \u0111\u1ec1 xu\u1ea5t nh\u00e3n ng\u1eafn g\u1ecdn:\n   &gt; \"V\u00f9ng nguy c\u01a1 l\u0169 l\u1ee5t\"\n</code></pre> <p>=== \"L\u1ee3i \u00edch\" - Quy \u01b0\u1edbc \u0111\u1eb7t t\u00ean nh\u1ea5t qu\u00e1n - Thu\u1eadt ng\u1eef th\u00e2n thi\u1ec7n v\u1edbi ng\u01b0\u1eddi d\u00f9ng - Ti\u1ebft ki\u1ec7m c\u00e1c t\u00e1c v\u1ee5 \u0111\u1eb7t t\u00ean l\u1eb7p \u0111i l\u1eb7p l\u1ea1i</p>"},{"location":"vi/ai/overview/#use-case-4-cau-hoi-vi-du","title":"Use Case 4: C\u00e2u h\u1ecfi v\u00ed d\u1ee5","text":"Quy tr\u00ecnh l\u00e0m vi\u1ec7c\" 1. AI ph\u00e2n t\u00edch c\u1ea5u h\u00ecnh view 2. \u0110\u1ec1 xu\u1ea5t c\u00e1c c\u00e2u h\u1ecfi m\u1eabu ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 h\u1ecfi: - \"Khu v\u1ef1c n\u00e0o c\u00f3 nguy c\u01a1 l\u0169 l\u1ee5t cao nh\u1ea5t?\" - \"C\u01b0\u1eddng \u0111\u1ed9 m\u01b0a hi\u1ec7n t\u1ea1i l\u00e0 bao nhi\u00eau?\" - \"Khu v\u1ef1c n\u00e0o n\u00ean \u0111\u01b0\u1ee3c s\u01a1 t\u00e1n? <p>=== \"L\u1ee3i \u00edch\" - Gi\u00fap v\u1edbi t\u00e0i li\u1ec7u tr\u1ee3 gi\u00fap - C\u1ea3i thi\u1ec7n h\u01b0\u1edbng d\u1eabn ng\u01b0\u1eddi d\u00f9ng - X\u00e1c \u0111\u1ecbnh c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng ph\u1ed5 bi\u1ebfn</p>"},{"location":"vi/ai/overview/#nguyen-tac-kiem-soat-bien-tap-vien","title":"Nguy\u00ean t\u1eafc ki\u1ec3m so\u00e1t bi\u00ean t\u1eadp vi\u00ean","text":"<p>Con ng\u01b0\u1eddi trong v\u00f2ng l\u1eb7p</p> <p>Trong m\u1ecdi tr\u01b0\u1eddng h\u1ee3p:</p> <pre><code>- \u2705 \u0110\u1ea7u ra AI **c\u00f3 th\u1ec3 ch\u1ec9nh s\u1eeda** v\u00e0 **c\u00f3 th\u1ec3 \u0111\u1ea3o ng\u01b0\u1ee3c**\n- \u2705 Bi\u00ean t\u1eadp vi\u00ean gi\u1eef **to\u00e0n quy\u1ec1n ki\u1ec3m so\u00e1t**\n- \u2705 AI cung c\u1ea5p **\u0111\u1ec1 xu\u1ea5t**, kh\u00f4ng ph\u1ea3i quy\u1ebft \u0111\u1ecbnh cu\u1ed1i c\u00f9ng\n- \u2705 N\u1ed9i dung tr\u01b0\u1edbc \u0111\u00f3 \u0111\u01b0\u1ee3c b\u1ea3o t\u1ed3n\n</code></pre>"},{"location":"vi/ai/overview/#cau-hinh-va-moi-truong","title":"C\u1ea5u h\u00ecnh v\u00e0 m\u00f4i tr\u01b0\u1eddng","text":""},{"location":"vi/ai/overview/#thiet-lap-moi-truong","title":"Thi\u1ebft l\u1eadp m\u00f4i tr\u01b0\u1eddng","text":"<p>\u0110\u1ec3 s\u1eed d\u1ee5ng plugin AI, m\u1ed7i m\u00f4i tr\u01b0\u1eddng ph\u1ea3i c\u00f3:</p> <p>=== \"C\u1ea5u h\u00ecnh b\u1eaft bu\u1ed9c\" - Kh\u00f3a API ho\u1eb7c th\u00f4ng tin x\u00e1c th\u1ef1c cho nh\u00e0 cung c\u1ea5p \u0111\u00e3 ch\u1ecdn - C\u1ea5u h\u00ecnh plugin trong c\u1ea5u h\u00ecnh Payload - Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng cho secrets - T\u00f9y ch\u1ecdn: C\u00e0i \u0111\u1eb7t c\u1ee5 th\u1ec3 cho nh\u00e0 cung c\u1ea5p</p> C\u1ea5u h\u00ecnh v\u00ed d\u1ee5Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng payload.config.ts<pre><code>import { payloadAI } from '@payloadcms/plugin-ai'\n\nexport default buildConfig({\n  plugins: [\n    payloadAI({\n      provider: 'openai',\n      apiKey: process.env.OPENAI_API_KEY,\n      enabled: process.env.ENABLE_AI === 'true',\n      collections: {\n        layers: {\n          fields: ['description', 'tooltip']\n        },\n        views: {\n          fields: ['summary', 'introduction']\n        }\n      }\n    })\n  ]\n})\n</code></pre> <p>```env title=\".env\" # C\u1ea5u h\u00ecnh nh\u00e0 cung c\u1ea5p AI ENABLE_AI=true AI_PROVIDER=openai OPENAI_API_KEY=sk-...</p> <pre><code># T\u00f9y ch\u1ecdn: C\u00e0i \u0111\u1eb7t c\u1ee5 th\u1ec3 cho nh\u00e0 cung c\u1ea5p\nAI_MODEL=gpt-4\nAI_TEMPERATURE=0.7\nAI_MAX_TOKENS=500\n```\n</code></pre>"},{"location":"vi/ai/overview/#nguyen-tac-cau-hinh","title":"Nguy\u00ean t\u1eafc c\u1ea5u h\u00ecnh","text":"<p>!!! warning \"Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t v\u1ec1 b\u1ea3o m\u1eadt\" - \ud83d\udd10 L\u01b0u tr\u1eef kh\u00f3a nh\u00e0 cung c\u1ea5p AI nh\u01b0 secrets (env vars ho\u1eb7c secret manager) - \ud83c\udf0d Cho ph\u00e9p nh\u00e0 cung c\u1ea5p ho\u1eb7c kh\u00f3a kh\u00e1c nhau cho m\u1ed7i m\u00f4i tr\u01b0\u1eddng - \ud83d\udd0c Cho ph\u00e9p AI \u0111\u01b0\u1ee3c t\u1eaft ho\u00e0n to\u00e0n - \ud83d\udeab Kh\u00f4ng bao gi\u1edd commit kh\u00f3a API v\u00e0o version control</p>"},{"location":"vi/ai/overview/#ma-tran-moi-truong","title":"Ma tr\u1eadn m\u00f4i tr\u01b0\u1eddng","text":"M\u00f4i tr\u01b0\u1eddng AI \u0111\u01b0\u1ee3c b\u1eadt Nh\u00e0 cung c\u1ea5p Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng Development \u2705 C\u00f3 OpenAI (test key) Ki\u1ec3m tra t\u00ednh n\u0103ng AI Staging \u2705 C\u00f3 OpenAI (prod key) X\u00e1c th\u1ef1c pre-prod Production \u26a0\ufe0f T\u00f9y ch\u1ecdn OpenAI (prod key) H\u1ed7 tr\u1ee3 ch\u1ec9nh s\u1eeda n\u1ed9i dung CI/CD \u274c Kh\u00f4ng None Ki\u1ec3m th\u1eed t\u1ef1 \u0111\u1ed9ng"},{"location":"vi/ai/overview/#oc-lap-nen-tang","title":"\u0110\u1ed9c l\u1eadp n\u1ec1n t\u1ea3ng","text":"<p>Kh\u00f4ng ph\u1ee5 thu\u1ed9c</p> <p>Logic n\u1ec1n t\u1ea3ng kh\u00f4ng \u0111\u01b0\u1ee3c ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1c t\u00ednh n\u0103ng AI:</p> <pre><code>- Ch\u1ee9c n\u0103ng c\u1ed1t l\u00f5i ho\u1ea1t \u0111\u1ed9ng m\u00e0 kh\u00f4ng c\u1ea7n AI\n- Seeds, migrations v\u00e0 workflows \u0111\u1ed9c l\u1eadp v\u1edbi AI\n- C\u00e1c t\u00ednh n\u0103ng AI l\u00e0 c\u00e1c c\u1ea3i ti\u1ebfn b\u1ed5 sung thu\u1ea7n t\u00fay\n</code></pre>"},{"location":"vi/ai/overview/#huong-dan-trai-nghiem-nguoi-dung","title":"H\u01b0\u1edbng d\u1eabn tr\u1ea3i nghi\u1ec7m ng\u01b0\u1eddi d\u00f9ng","text":"<p>Khi th\u00eam AI helpers v\u00e0o admin UI:</p>"},{"location":"vi/ai/overview/#1-hanh-ong-ai-ro-rang","title":"1. H\u00e0nh \u0111\u1ed9ng AI r\u00f5 r\u00e0ng","text":"<p>!!! tip \"Y\u00eau c\u1ea7u \u00dd \u0111\u1ecbnh c\u1ee7a ng\u01b0\u1eddi d\u00f9ng\" - Th\u00eam c\u00e1c button r\u00f5 r\u00e0ng: \"T\u1ea1o m\u00f4 t\u1ea3\", \"\u0110\u1ec1 xu\u1ea5t nh\u00e3n\" - Kh\u00f4ng bao gi\u1edd t\u1ef1 \u0111\u1ed9ng ch\u1ea1y AI m\u00e0 kh\u00f4ng c\u00f3 h\u00e0nh \u0111\u1ed9ng c\u1ee7a ng\u01b0\u1eddi d\u00f9ng - Cung c\u1ea5p keyboard shortcuts cho ng\u01b0\u1eddi d\u00f9ng chuy\u00ean nghi\u1ec7p - Hi\u1ec3n th\u1ecb tr\u1ea1ng th\u00e1i \u0111ang t\u1ea3i trong c\u00e1c thao t\u00e1c AI</p> <p>V\u00ed d\u1ee5:</p> <pre><code>&lt;Button\n  onClick={handleGenerateDescription}\n  icon={&lt;SparklesIcon /&gt;}\n  loading={isGenerating}\n&gt;\n  \u2728 T\u1ea1o m\u00f4 t\u1ea3 b\u1eb1ng AI\n&lt;/Button&gt;\n</code></pre>"},{"location":"vi/ai/overview/#2-hien-thi-e-xuat-ro-rang","title":"2. Hi\u1ec3n th\u1ecb \u0111\u1ec1 xu\u1ea5t r\u00f5 r\u00e0ng","text":"<p>!!! tip \"\u0110\u1ea7u ra AI minh b\u1ea1ch\" - Hi\u1ec3n th\u1ecb AI output d\u01b0\u1edbi d\u1ea1ng n\u1ed9i dung g\u1ee3i \u00fd, kh\u00f4ng ph\u1ea3i s\u1ef1 th\u1eadt cu\u1ed1i c\u00f9ng - Cho ph\u00e9p bi\u00ean t\u1eadp vi\u00ean accept, edit ho\u1eb7c discard - B\u1ea3o to\u00e0n original content n\u1ebfu \u0111\u01b0\u1ee3c thay th\u1ebf - Hi\u1ec3n th\u1ecb comparison view khi h\u1eefu \u00edch</p> <p>Giao di\u1ec7n v\u00ed d\u1ee5:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u0110\u1ec1 xu\u1ea5t t\u1eeb AI:                      \u2502\n\u2502                                     \u2502\n\u2502 \"L\u1edbp n\u00e0y hi\u1ec3n th\u1ecb th\u1eddi gian th\u1ef1c...\" \u2502\n\u2502                                     \u2502\n\u2502 [\u2713 Ch\u1ea5p nh\u1eadn] [\u270e Ch\u1ec9nh s\u1eeda] [\u2717 T\u1eeb ch\u1ed1i]   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nN\u1ed9i dung g\u1ed1c: \"L\u1edbp th\u1eddi ti\u1ebft\"\n</code></pre>"},{"location":"vi/ai/overview/#3-cac-hanh-ong-tap-trung","title":"3. C\u00e1c h\u00e0nh \u0111\u1ed9ng t\u1eadp trung","text":"<p>!!! tip \"Nhi\u1ec7m v\u1ee5 nh\u1ecf, m\u1ee5c \u0111\u00edch \u0111\u01a1n\" - Gi\u1eef c\u00e1c actions nh\u1ecf v\u00e0 t\u1eadp trung (m\u1ed9t field ho\u1eb7c section) - Tr\u00e1nh c\u00e1c chu\u1ed7i AI ph\u1ee9c t\u1ea1p, nhi\u1ec1u b\u01b0\u1edbc - Cho ph\u00e9p ch\u1ea5p nh\u1eadn t\u1eebng ph\u1ea7n c\u00e1c \u0111\u1ec1 xu\u1ea5t - Cho ph\u00e9p ho\u00e0n t\u00e1c/l\u00e0m l\u1ea1i</p>"},{"location":"vi/ai/overview/#4-xu-ly-loi-kheo-leo","title":"4. X\u1eed l\u00fd l\u1ed7i kh\u00e9o l\u00e9o","text":"<p>X\u1eed l\u00fd l\u1ed7i t\u1ed1t</p> <p>Timeouts, v\u1ea5n \u0111\u1ec1 nh\u00e0 cung c\u1ea5p ho\u1eb7c c\u1ea5u h\u00ecnh kh\u00f4ng h\u1ee3p l\u1ec7 n\u00ean:</p> <pre><code>- Hi\u1ec3n th\u1ecb **th\u00f4ng b\u00e1o l\u1ed7i r\u00f5 r\u00e0ng**\n- \u0110\u1ec1 xu\u1ea5t **c\u00e1ch kh\u1eafc ph\u1ee5c th\u1ef1c t\u1ebf**\n- **Kh\u00f4ng bao gi\u1edd ph\u00e1 v\u1ee1** to\u00e0n b\u1ed9 admin UI\n- Quay l\u1ea1i ch\u1ec9nh s\u1eeda th\u1ee7 c\u00f4ng\n</code></pre> <p>V\u00ed d\u1ee5 th\u00f4ng b\u00e1o l\u1ed7i:</p> <pre><code>\u274c T\u1ea1o n\u1ed9i dung AI th\u1ea5t b\u1ea1i\n\nNh\u00e0 cung c\u1ea5p AI hi\u1ec7n kh\u00f4ng kh\u1ea3 d\u1ee5ng. B\u1ea1n c\u00f3 th\u1ec3:\n\u2022 Th\u1eed l\u1ea1i sau v\u00e0i ph\u00fat\n\u2022 Ch\u1ec9nh s\u1eeda tr\u01b0\u1eddng th\u1ee7 c\u00f4ng\n\u2022 Li\u00ean h\u1ec7 h\u1ed7 tr\u1ee3 n\u1ebfu v\u1ea5n \u0111\u1ec1 v\u1eabn ti\u1ebfp di\u1ec5n\n\n[Th\u1eed l\u1ea1i] [Ch\u1ec9nh s\u1eeda th\u1ee7 c\u00f4ng]\n</code></pre>"},{"location":"vi/ai/overview/#an-toan-va-gioi-han","title":"An to\u00e0n v\u00e0 gi\u1edbi h\u1ea1n","text":""},{"location":"vi/ai/overview/#quyen-rieng-tu-du-lieu","title":"Quy\u1ec1n ri\u00eang t\u01b0 d\u1eef li\u1ec7u","text":"<p>B\u1ea3o v\u1ec7 d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m</p> <p>Tr\u00e1nh g\u1eedi t\u1edbi c\u00e1c nh\u00e0 cung c\u1ea5p AI b\u00ean ngo\u00e0i:</p> <pre><code>- Th\u00f4ng tin nh\u1eadn d\u1ea1ng c\u00e1 nh\u00e2n (PII)\n- Th\u00f4ng tin x\u00e1c th\u1ef1c\n- Chi ti\u1ebft h\u1ec7 th\u1ed1ng n\u1ed9i b\u1ed9\n- To\u00e0n b\u1ed9 c\u1ea5u h\u00ecnh\n- Nh\u1eadt k\u00fd \u1ee9ng d\u1ee5ng\n</code></pre> <p>Nh\u1eefng g\u00ec n\u00ean g\u1eedi:</p> <ul> <li>\u2705 Nh\u00e3n v\u00e0 m\u00f4 t\u1ea3 tr\u01b0\u1eddng</li> <li>\u2705 N\u1ed9i dung c\u00f4ng khai</li> <li>\u2705 T\u00ean lo\u1ea1i th\u1ef1c th\u1ec3 chung</li> <li>\u2705 Si\u00eau d\u1eef li\u1ec7u kh\u00f4ng nh\u1ea1y c\u1ea3m### X\u00e1c th\u1ef1c n\u1ed9i dung</li> </ul> <p>Xem x\u00e9t \u0111\u1ea7u ra AI</p> <p>X\u1eed l\u00fd \u0111\u1ea7u ra AI nh\u01b0 kh\u00f4ng \u0111\u00e1ng tin c\u1eady cho \u0111\u1ebfn khi c\u00f3 s\u1ef1 ch\u1ea5p thu\u1eadn c\u1ee7a con ng\u01b0\u1eddi:</p> <pre><code>- Xem x\u00e9t \u0111\u1ec3 ki\u1ec3m tra \u0111\u1ed9 ch\u00ednh x\u00e1c k\u1ef9 thu\u1eadt\n- Ki\u1ec3m tra c\u00e1c s\u1ef1 th\u1eadt b\u1ecba \u0111\u1eb7t\n- X\u00e1c minh \u00e1nh x\u1ea1 th\u1ef1c th\u1ec3\n- X\u00e1c th\u1ef1c v\u1edbi ki\u1ebfn th\u1ee9c chuy\u00ean m\u00f4n\n- \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n v\u1ec1 th\u01b0\u01a1ng hi\u1ec7u/gi\u1ecdng \u0111i\u1ec7u### Gi\u1edbi h\u1ea1n ng\u1eef c\u1ea3nh\n</code></pre> <p>Ch\u1ec9 g\u1eedi ng\u1eef c\u1ea3nh c\u1ea7n thi\u1ebft:</p> <pre><code>// \u2705 T\u1ed1t: Ng\u1eef c\u1ea3nh t\u1ed1i thi\u1ec3u\n{\n  field: \"description\",\n  entityType: \"WeatherObserved\",\n  Thu\u1ed9c t\u00ednh: [\"temperature\", \"humidity\"]\n}\n\n// \u274c X\u1ea5u: Ng\u1eef c\u1ea3nh qu\u00e1 m\u1ee9c\n{\n  field: \"description\",\n  fullConfig: {...}, // To\u00e0n b\u1ed9 c\u1ea5u h\u00ecnh payload\n  logs: [...],       // Nh\u1eadt k\u00fd h\u1ec7 th\u1ed1ng\n  secrets: {...}     // Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng\n}\n</code></pre>"},{"location":"vi/ai/overview/#yeu-cau-minh-bach","title":"Y\u00eau c\u1ea7u minh b\u1ea1ch","text":"<p>Giao ti\u1ebfp r\u00f5 r\u00e0ng</p> <p>T\u00e0i li\u1ec7u v\u00e0 giao di\u1ec7n n\u00ean l\u00e0m r\u00f5:</p> <pre><code>- \u0110\u1ea7u ra AI c\u00f3 th\u1ec3 **kh\u00f4ng ch\u00ednh x\u00e1c ho\u1eb7c kh\u00f4ng \u0111\u1ea7y \u0111\u1ee7**\n- Bi\u00ean t\u1eadp vi\u00ean **ch\u1ecbu tr\u00e1ch nhi\u1ec7m** cho n\u1ed9i dung cu\u1ed1i c\u00f9ng\n- AI l\u00e0 m\u1ed9t **c\u00f4ng c\u1ee5**, kh\u00f4ng ph\u1ea3i thay th\u1ebf cho chuy\u00ean m\u00f4n\n- Xem x\u00e9t c\u1ee7a con ng\u01b0\u1eddi **lu\u00f4n \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u**---\n</code></pre>"},{"location":"vi/ai/overview/#huong-dan-phat-trien-va-ong-gop","title":"H\u01b0\u1edbng d\u1eabn ph\u00e1t tri\u1ec3n v\u00e0 \u0111\u00f3ng g\u00f3p","text":""},{"location":"vi/ai/overview/#1-kien-truc-tach-biet","title":"1. Ki\u1ebfn tr\u00fac t\u00e1ch bi\u1ec7t","text":"<p>!!! success \"T\u00e1ch bi\u1ec7t m\u1ed1i quan t\u00e2m\" - Gi\u1eef c\u00e1c t\u00ednh n\u0103ng AI \u0111\u1ed9c l\u1eadp kh\u1ecfi ch\u1ee9c n\u0103ng c\u1ed1t l\u00f5i - Plugin AI n\u00ean c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111\u1ed9c l\u1eadp - Kh\u00f4ng r\u00e0ng bu\u1ed9c c\u00e1c lu\u1ed3ng c\u1ed1t l\u00f5i v\u1edbi ho\u00e0n thi\u1ec7n AI: - Seed data generation - Database migrations - Authentication/authorization - API responses</p>"},{"location":"vi/ai/overview/#2-loi-nhac-minh-bach","title":"2. L\u1eddi nh\u1eafc minh b\u1ea1ch","text":"<p>!!! success \"T\u00e0i li\u1ec7u h\u00f3a h\u00e0nh vi AI\" - L\u01b0u prompts \u1edf n\u01a1i \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u r\u00f5 r\u00e0ng - L\u00e0m ch\u00fang ng\u1eafn g\u1ecdn v\u00e0 c\u1ee5 th\u1ec3 theo l\u0129nh v\u1ef1c: - Smart city concepts - NGSI-LD terminology - LegoCity architecture - Ki\u1ec3m so\u00e1t phi\u00ean b\u1ea3n c\u00e1c thay \u0111\u1ed5i l\u1eddi nh\u1eafc - Xem x\u00e9t c\u1eadp nh\u1eadt l\u1eddi nh\u1eafc trong PR</p> <p>L\u01b0u tr\u1eef l\u1eddi nh\u1eafc v\u00ed d\u1ee5:</p> src/ai/prompts/layer-description.ts<pre><code>export const LAYER_DESCRIPTION_PROMPT = `\nT\u1ea1o m\u00f4 t\u1ea3 th\u00e2n thi\u1ec7n v\u1edbi ng\u01b0\u1eddi d\u00f9ng cho l\u1edbp b\u1ea3n \u0111\u1ed3 th\u00e0nh ph\u1ed1 th\u00f4ng minh.\n\nNg\u1eef c\u1ea3nh:\n- Lo\u1ea1i th\u1ef1c th\u1ec3: {entityType}\n- L\u0129nh v\u1ef1c: {domain}\n- Thu\u1ed9c t\u00ednh: {attributes}\n\nY\u00eau c\u1ea7u:\n- T\u1ed1i \u0111a 2-3 c\u00e2u\n- Ng\u00f4n ng\u1eef kh\u00f4ng chuy\u00ean m\u00f4n\n- Gi\u1ea3i th\u00edch ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 h\u1ecdc \u0111\u01b0\u1ee3c g\u00ec t\u1eeb l\u1edbp n\u00e0y\n- \u0110\u1ec1 c\u1eadp t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt n\u1ebfu c\u00f3 li\u00ean quan\n\n\u0110\u1ea7u ra: M\u00f4 t\u1ea3 r\u00f5 r\u00e0ng, ng\u1eafn g\u1ecdn.\n`;\n</code></pre>"},{"location":"vi/ai/overview/#3-su-dung-co-the-cau-hinh","title":"3. S\u1eed d\u1ee5ng c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh","text":"<p>!!! success \"Ki\u1ec3m so\u00e1t linh ho\u1ea1t\" - Cho ph\u00e9p admins b\u1eadt/t\u1eaft AI theo t\u1eebng b\u1ed9 s\u01b0u t\u1eadp - Cho ph\u00e9p admins b\u1eadt/t\u1eaft AI theo t\u1eebng tr\u01b0\u1eddng - H\u1ed7 tr\u1ee3 h\u1ea1n ch\u1ebf d\u1ef1a tr\u00ean vai tr\u00f2: - Ch\u1ec9 bi\u00ean t\u1eadp vi\u00ean c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng AI features - Ng\u01b0\u1eddi xem kh\u00f4ng th\u1ec3 k\u00edch ho\u1ea1t h\u00e0nh \u0111\u1ed9ng AI - Cung c\u1ea5p c\u00f4ng t\u1eafc AI to\u00e0n c\u1ee5c</p> <p>Example C\u1ea5u h\u00ecnh:</p> <pre><code>payloadAI({\n  collections: {\n    layers: {\n      enabled: true,\n      fields: [\"description\", \"tooltip\"],\n      roles: [\"editor\", \"admin\"],\n    },\n    views: {\n      enabled: true,\n      fields: [\"summary\"],\n      roles: [\"admin\"],\n    },\n  },\n});\n</code></pre>"},{"location":"vi/ai/overview/#4-ghi-nhat-ky-co-y-thuc-ve-quyen-rieng-tu","title":"4. Ghi nh\u1eadt k\u00fd c\u00f3 \u00fd th\u1ee9c v\u1ec1 quy\u1ec1n ri\u00eang t\u01b0","text":"<p>!!! success \"Ghi nh\u1eadt k\u00fd t\u1ed1i thi\u1ec3u\" - Log AI interactions ch\u1ec9 cho debugging - Tr\u00e1nh l\u01b0u full prompts v\u00e0 responses - Kh\u00f4ng bao gi\u1edd log n\u1ed9i dung nh\u1ea1y c\u1ea3m - S\u1eed d\u1ee5ng m\u1ee9c nh\u1eadt k\u00fd ph\u00f9 h\u1ee3p: - INFO: H\u00e0nh \u0111\u1ed9ng AI \u0111\u01b0\u1ee3c k\u00edch ho\u1ea1t - DEBUG: Si\u00eau d\u1eef li\u1ec7u y\u00eau c\u1ea7u/ph\u1ea3n h\u1ed3i - ERROR: Failures v\u00e0 timeouts</p> <p>Example Log Structure:</p> <pre><code>logger.info(\"AI action\", {\n  action: \"generate_description\",\n  collection: \"layers\",\n  field: \"description\",\n  provider: \"openai\",\n  model: \"gpt-4\",\n  duration_ms: 1250,\n  success: true,\n  // \u274c Kh\u00f4ng ghi: l\u1eddi nh\u1eafc, ph\u1ea3n h\u1ed3i, n\u1ed9i dung ng\u01b0\u1eddi d\u00f9ng\n});\n</code></pre>"},{"location":"vi/ai/overview/#kiem-thu-cac-tinh-nang-ai","title":"Ki\u1ec3m th\u1eed c\u00e1c t\u00ednh n\u0103ng AI","text":""},{"location":"vi/ai/overview/#kiem-thu-on-vi","title":"Ki\u1ec3m th\u1eed \u0111\u01a1n v\u1ecb","text":"<p>Ki\u1ec3m th\u1eed t\u00edch h\u1ee3p AI m\u00e0 kh\u00f4ng g\u1ecdi nh\u00e0 cung c\u1ea5p th\u1ef1c:</p> ai-helpers.test.ts<pre><code>import { generateLayerDescription } from \"./ai-helpers\";\n\njest.mock(\"@payloadcms/plugin-ai\");\n\ndescribe(\"Tr\u00ecnh t\u1ea1o m\u00f4 t\u1ea3 l\u1edbp AI\", () =&gt; {\n  it(\"t\u1ea1o m\u00f4 t\u1ea3 v\u1edbi \u0111\u1ea7u v\u00e0o h\u1ee3p l\u1ec7\", async () =&gt; {\n    const result = await generateLayerDescription({\n      entityType: \"WeatherObserved\",\n      L\u0129nh v\u1ef1c: \"environment\",\n    });\n\n    expect(result).toContain(\"weather\");\n    expect(result.length).toBeLessThan(500);\n  });\n\n  it(\"x\u1eed l\u00fd l\u1ed7i nh\u00e0 cung c\u1ea5p m\u1ed9t c\u00e1ch kh\u00e9o l\u00e9o\", async () =&gt; {\n    mockAIProvider.mockRejectedValue(new Error(\"H\u1ebft th\u1eddi gian ch\u1edd API\"));\n\n    await expect(generateLayerDescription({ ... })).rejects.toThrow(\n      \"T\u1ea1o n\u1ed9i dung AI th\u1ea5t b\u1ea1i\"\n    );\n  });\n});\n</code></pre>"},{"location":"vi/ai/overview/#kiem-thu-tich-hop","title":"Ki\u1ec3m th\u1eed t\u00edch h\u1ee3p","text":"<p>Ki\u1ec3m th\u1eed c\u00e1c t\u00ednh n\u0103ng AI v\u1edbi nh\u00e0 cung c\u1ea5p gi\u1ea3 l\u1eadp:</p> <pre><code>describe(\"T\u00edch h\u1ee3p AI\", () =&gt; {\n  it(\"t\u1eaft giao di\u1ec7n AI khi kh\u00f4ng c\u1ea5u h\u00ecnh nh\u00e0 cung c\u1ea5p\", () =&gt; {\n    process.env.ENABLE_AI = \"false\";\n\n    const { queryByText } = render(&lt;LayerEditor /&gt;);\n\n    expect(queryByText(\"Generate with AI\")).toBeNull();\n  });\n});\n</code></pre>"},{"location":"vi/ai/overview/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<p>\u0110i\u1ec3m ch\u00ednh</p> <p>Tr\u1ee3 gi\u00fap AI trong LegoCity l\u00e0 t\u00f9y ch\u1ecdn v\u00e0 h\u1ed7 tr\u1ee3</p> <pre><code>**M\u1ee5c \u0111\u00edch:**\n\n- H\u1ed7 tr\u1ee3 v\u1edbi m\u00f4 t\u1ea3, nh\u00e3n v\u00e0 c\u00e1c t\u00e1c v\u1ee5 n\u1ed9i dung\n- Kh\u00f4ng ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho h\u00e0nh vi c\u1ed1t l\u00f5i ho\u1eb7c ki\u1ebfn tr\u00fac\n- C\u1ea3i thi\u1ec7n b\u1ed5 sung thu\u1ea7n t\u00fay cho tr\u1ea3i nghi\u1ec7m ch\u1ec9nh s\u1eeda    **C\u1ea5u h\u00ecnh:**\n\n- S\u1eed d\u1ee5ng bi\u1ebfn m\u00f4i tr\u01b0\u1eddng v\u00e0 l\u01b0u tr\u1eef b\u00ed m\u1eadt\n- C\u00f3 th\u1ec3 kh\u00e1c nhau theo m\u00f4i tr\u01b0\u1eddng (dev, staging, prod)\n- Ph\u1ea3i cho ph\u00e9p c\u00e1c t\u00ednh n\u0103ng AI \u0111\u01b0\u1ee3c t\u1eaft ho\u00e0n to\u00e0n\n- Kh\u00f4ng c\u00f3 ch\u1ee9c n\u0103ng c\u1ed1t l\u00f5i ph\u1ee5 thu\u1ed9c v\u00e0o AI\n\n**Nguy\u00ean t\u1eafc tr\u1ea3i nghi\u1ec7m ng\u01b0\u1eddi d\u00f9ng:**\n\n- H\u00e0nh \u0111\u1ed9ng AI r\u00f5 r\u00e0ng v\u00e0 do ng\u01b0\u1eddi d\u00f9ng k\u00edch ho\u1ea1t\n- \u0110\u1ea7u ra c\u00f3 th\u1ec3 \u0111\u1ea3o ng\u01b0\u1ee3c v\u00e0 ch\u1ec9nh s\u1eeda \u0111\u01b0\u1ee3c\n- \u0110\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u r\u00f5 r\u00e0ng l\u00e0 \u0111\u1ec1 xu\u1ea5t, kh\u00f4ng ph\u1ea3i s\u1ef1 th\u1eadt\n- X\u1eed l\u00fd l\u1ed7i kh\u00e9o l\u00e9o\n\n**Ph\u00e1t tri\u1ec3n:**\n\n- Gi\u1eef t\u00edch h\u1ee3p AI t\u00e1ch bi\u1ec7t kh\u1ecfi n\u1ec1n t\u1ea3ng c\u1ed1t l\u00f5i\n- T\u00e0i li\u1ec7u h\u00f3a l\u1eddi nh\u1eafc v\u00e0 h\u00e0nh vi m\u1ed9t c\u00e1ch minh b\u1ea1ch\n- \u00c1p d\u1ee5ng nguy\u00ean t\u1eafc an to\u00e0n v\u00e0 quy\u1ec1n ri\u00eang t\u01b0\n- Ghi nh\u1eadt k\u00fd t\u1ed1i thi\u1ec3u v\u00e0 c\u00f3 tr\u00e1ch nhi\u1ec7m\n</code></pre> <p>C\u00e1c trang li\u00ean quan:</p> <ul> <li>AI Providers</li> <li>OpenRouter Integration</li> <li>AI Use Cases</li> <li>Creating New Blocks</li> </ul>"},{"location":"vi/ai/providers/","title":"C\u1ea5u h\u00ecnh AI Provider","text":"<p>LegoCity h\u1ed7 tr\u1ee3 nhi\u1ec1u AI providers th\u00f4ng qua Payload AI plugin. H\u01b0\u1edbng d\u1eabn n\u00e0y bao g\u1ed3m c\u00e1c nh\u00e0 cung c\u1ea5p \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 ch\u00ednh th\u1ee9c v\u00e0 thi\u1ebft l\u1eadp nh\u00e0 cung c\u1ea5p t\u00f9y ch\u1ec9nh.</p> <p>H\u1ed7 tr\u1ee3 ch\u00ednh th\u1ee9c</p> <p>Nh\u00e0 cung c\u1ea5p \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 ch\u00ednh th\u1ee9c:</p> <pre><code>- \u2705 **OpenAI** (GPT-4, GPT-3.5-turbo)\n- \u2705 **Anthropic** (Claude 3.5, Claude 3)\n- \u2705 **ElevenLabs** (T\u1ed5ng h\u1ee3p gi\u1ecdng n\u00f3i)\n\n**Nh\u00e0 cung c\u1ea5p t\u00f9y ch\u1ec9nh:**\n\n- \ud83d\udd0c **OpenRouter** - Truy c\u1eadp 100+ models (Gemini, Claude, GPT-4o, etc.)\n- \ud83d\udd27 **Custom Providers** - T\u1ef1 x\u00e2y d\u1ef1ng integration\n</code></pre>"},{"location":"vi/ai/providers/#cau-hinh-openai","title":"C\u1ea5u h\u00ecnh OpenAI","text":""},{"location":"vi/ai/providers/#thiet-lap","title":"Thi\u1ebft l\u1eadp","text":"<ol> <li> <p>L\u1ea5y kh\u00f3a API t\u1eeb platform.openai.com</p> </li> <li> <p>C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng:</p> </li> </ol> .env<pre><code># B\u1eadt t\u00ednh n\u0103ng AI\nENABLE_AI=true\nAI_PROVIDER=openai\n\n# Th\u00f4ng tin x\u00e1c th\u1ef1c OpenAI\nOPENAI_API_KEY=sk-proj-...\nOPENAI_MODEL=gpt-4o-mini\nOPENAI_ORGANIZATION=org-...  # Optional\n</code></pre> <ol> <li>C\u1ea5u h\u00ecnh Plugin Payload:</li> </ol> src/payload.config.ts<pre><code>import { payloadAI } from \"@payloadcms/plugin-ai\";\n\nexport default buildConfig({\n  plugins: [\n    payloadAI({\n      provider: \"openai\",\n      apiKey: process.env.OPENAI_API_KEY,\n      model: process.env.OPENAI_MODEL || \"gpt-4o-mini\",\n      enabled: process.env.ENABLE_AI === \"true\",\n      collections: {\n        pages: {\n          fields: [\"content\", \"description\"],\n        },\n        posts: {\n          fields: [\"content\", \"excerpt\"],\n        },\n      },\n    }),\n  ],\n});\n</code></pre>"},{"location":"vi/ai/providers/#mo-hinh-uoc-khuyen-nghi","title":"M\u00f4 h\u00ecnh \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb","text":"Model T\u1ed1t nh\u1ea5t cho Cost Speed gpt-4o N\u1ed9i dung ch\u1ea5t l\u01b0\u1ee3ng cao, t\u00e1c v\u1ee5 ph\u1ee9c t\u1ea1p $$$ Fast gpt-4o-mini S\u1eed d\u1ee5ng chung, hi\u1ec7u qu\u1ea3 chi ph\u00ed $ Very Fast gpt-4-turbo Suy lu\u1eadn n\u00e2ng cao $$$ Medium gpt-3.5-turbo T\u00e1c v\u1ee5 \u0111\u01a1n gi\u1ea3n, b\u1ea3n nh\u00e1p $ Very Fast <p>Recommendation</p> <p>B\u1eaft \u0111\u1ea7u v\u1edbi gpt-4o-mini cho h\u1ea7u h\u1ebft use cases - ch\u1ea5t l\u01b0\u1ee3ng tuy\u1ec7t v\u1eddi v\u1edbi chi ph\u00ed th\u1ea5p.</p>"},{"location":"vi/ai/providers/#cau-hinh-anthropic-claude","title":"C\u1ea5u h\u00ecnh Anthropic (Claude)","text":""},{"location":"vi/ai/providers/#thiet-lap_1","title":"Thi\u1ebft l\u1eadp","text":"<ol> <li> <p>L\u1ea5y kh\u00f3a API t\u1eeb console.anthropic.com</p> </li> <li> <p>C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng:</p> </li> </ol> .env<pre><code># B\u1eadt t\u00ednh n\u0103ng AI\nENABLE_AI=true\nAI_PROVIDER=anthropic\n\n# Anthropic Credentials\nANTHROPIC_API_KEY=sk-ant-...\nANTHROPIC_MODEL=claude-3-5-sonnet-20241022\n</code></pre> <ol> <li>C\u1ea5u h\u00ecnh Plugin Payload:</li> </ol> src/payload.config.ts<pre><code>import { payloadAI } from \"@payloadcms/plugin-ai\";\n\nexport default buildConfig({\n  plugins: [\n    payloadAI({\n      provider: \"anthropic\",\n      apiKey: process.env.ANTHROPIC_API_KEY,\n      model: process.env.ANTHROPIC_MODEL,\n      enabled: process.env.ENABLE_AI === \"true\",\n      collections: {\n        pages: {\n          fields: [\"content\", \"description\"],\n        },\n      },\n    }),\n  ],\n});\n</code></pre>"},{"location":"vi/ai/providers/#mo-hinh-uoc-khuyen-nghi_1","title":"M\u00f4 h\u00ecnh \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb","text":"Model T\u1ed1t nh\u1ea5t cho Context Window Cost claude-3-5-sonnet-20241022 Ch\u1ea5t l\u01b0\u1ee3ng t\u1ed1t nh\u1ea5t, l\u1eadp tr\u00ecnh 200K $$ claude-3-5-haiku-20241022 Nhanh, hi\u1ec7u qu\u1ea3 chi ph\u00ed 200K $ claude-3-opus Kh\u1ea3 n\u0103ng cao nh\u1ea5t 200K $$$ <p>Recommendation</p> <p>Claude 3.5 Sonnet cung c\u1ea5p ch\u1ea5t l\u01b0\u1ee3ng tuy\u1ec7t v\u1eddi v\u1edbi context windows l\u1edbn - tuy\u1ec7t v\u1eddi cho long-form content.</p>"},{"location":"vi/ai/providers/#elevenlabs-tong-hop-giong-noi","title":"ElevenLabs (T\u1ed5ng h\u1ee3p gi\u1ecdng n\u00f3i)","text":""},{"location":"vi/ai/providers/#thiet-lap_2","title":"Thi\u1ebft l\u1eadp","text":"<ol> <li> <p>L\u1ea5y kh\u00f3a API t\u1eeb elevenlabs.io</p> </li> <li> <p>C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng:</p> </li> </ol> .env<pre><code>ELEVENLABS_API_KEY=...\nELEVENLABS_VOICE_ID=21m00Tcm4TlvDq8ikWAM  # Gi\u1ecdng n\u00f3i m\u1eb7c \u0111\u1ecbnh\n</code></pre> <ol> <li>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: T\u1ea1o audio descriptions cho accessibility</li> </ol> <pre><code>// V\u00ed d\u1ee5: T\u1ea1o audio cho page descriptions\nconst audioUrl = await generateAudio({\n  text: page.description,\n  voiceId: process.env.ELEVENLABS_VOICE_ID,\n});\n</code></pre>"},{"location":"vi/ai/providers/#openrouter-custom-models","title":"OpenRouter (Custom Models)","text":"<p>OpenRouter cung c\u1ea5p truy c\u1eadp 100+ AI models th\u00f4ng qua unified API.</p> <p>!!! success \"Why OpenRouter?\" - \u2705 Truy c\u1eadp Gemini 2.0 Flash, Claude, GPT-4o v\u00e0 nhi\u1ec1u h\u01a1n - \u2705 No rate limits t\u1eeb individual providers - \u2705 Cost-effective - gi\u00e1 c\u1ea1nh tranh - \u2705 Automatic fallbacks - n\u1ebfu m\u1ed9t model fails, th\u1eed model kh\u00e1c - \u2705 Easy switching - \u0111\u1ed5i models m\u00e0 kh\u00f4ng c\u1ea7n \u0111\u1ed5i code</p>"},{"location":"vi/ai/providers/#thiet-lap_3","title":"Thi\u1ebft l\u1eadp","text":"<p>Xem h\u01b0\u1edbng d\u1eabn chi ti\u1ebft: OpenRouter Custom Provider</p> <p>Thi\u1ebft l\u1eadp nhanh:</p> .env<pre><code>AI_PROVIDER=openrouter\nOPENROUTER_API_KEY=sk-or-v1-...\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\n</code></pre>"},{"location":"vi/ai/providers/#so-sanh-provider","title":"So s\u00e1nh Provider","text":""},{"location":"vi/ai/providers/#ma-tran-tinh-nang","title":"Ma tr\u1eadn t\u00ednh n\u0103ng","text":"Feature OpenAI Anthropic OpenRouter Quality \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 (t\u00f9y thu\u1ed9c v\u00e0o m\u00f4 h\u00ecnh) Speed Fast Fast Fast Cost $$ $$ $ (varies by model) Context Window 128K 200K Varies (l\u00ean \u0111\u1ebfn 2M) D\u1ec5 d\u00e0ng thi\u1ebft l\u1eadp \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u0110a d\u1ea1ng m\u00f4 h\u00ecnh Limited Limited 100+ models Rate Limits Yes Yes Ph\u1ee5 thu\u1ed9c nh\u00e0 cung c\u1ea5p"},{"location":"vi/ai/providers/#so-sanh-chi-phi-moi-1m-token","title":"So s\u00e1nh chi ph\u00ed (m\u1ed7i 1M token)","text":"Provider Input Output T\u1ed1t nh\u1ea5t cho OpenAI gpt-4o-mini $0.15 $0.60 General use Anthropic Claude 3.5 Haiku $0.80 $4.00 Fast tasks OpenRouter Gemini 2.0 Flash Free Free Ph\u00e1t tri\u1ec3n, ki\u1ec3m th\u1eed"},{"location":"vi/ai/providers/#cau-hinh-theo-moi-truong","title":"C\u1ea5u h\u00ecnh theo m\u00f4i tr\u01b0\u1eddng","text":""},{"location":"vi/ai/providers/#development","title":"Development","text":".env.development<pre><code>ENABLE_AI=true\nAI_PROVIDER=openrouter\nOPENROUTER_API_KEY=...\nOPENROUTER_MODEL=google/gemini-2.0-flash-exp:free\n</code></pre> <p>Why: B\u1eadc mi\u1ec5n ph\u00ed, l\u1eb7p nhanh</p>"},{"location":"vi/ai/providers/#staging","title":"Staging","text":".env.staging<pre><code>ENABLE_AI=true\nAI_PROVIDER=openai\nOPENAI_API_KEY=...\nOPENAI_MODEL=gpt-4o-mini\n</code></pre> <p>Why: Test production setup v\u1edbi cost-effective model</p>"},{"location":"vi/ai/providers/#production","title":"Production","text":".env.production<pre><code>ENABLE_AI=true\nAI_PROVIDER=anthropic\nANTHROPIC_API_KEY=...\nANTHROPIC_MODEL=claude-3-5-sonnet-20241022\n</code></pre> <p>Why: Ch\u1ea5t l\u01b0\u1ee3ng t\u1ed1t nh\u1ea5t cho end users</p>"},{"location":"vi/ai/providers/#cau-hinh-nang-cao","title":"C\u1ea5u h\u00ecnh n\u00e2ng cao","text":""},{"location":"vi/ai/providers/#multiple-providers-fallback","title":"Multiple Providers (Fallback)","text":"src/payload.config.ts<pre><code>export default buildConfig({\n  plugins: [\n    payloadAI({\n      providers: [\n        {\n          name: \"primary\",\n          provider: \"openai\",\n          apiKey: process.env.OPENAI_API_KEY,\n          model: \"gpt-4o-mini\",\n        },\n        {\n          name: \"fallback\",\n          provider: \"openrouter\",\n          apiKey: process.env.OPENROUTER_API_KEY,\n          model: \"google/gemini-2.0-flash-exp:free\",\n        },\n      ],\n      fallbackStrategy: \"sequential\", // Th\u1eed primary tr\u01b0\u1edbc, fallback n\u1ebfu fails\n    }),\n  ],\n});\n</code></pre>"},{"location":"vi/ai/providers/#gioi-han-toc-o","title":"Gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9","text":"<pre><code>payloadAI({\n  provider: \"openai\",\n  rateLimit: {\n    requests: 100,\n    period: \"1h\",\n  },\n});\n</code></pre>"},{"location":"vi/ai/providers/#loi-nhac-tuy-chinh","title":"L\u1eddi nh\u1eafc t\u00f9y ch\u1ec9nh","text":"<pre><code>payloadAI({\n  prompts: {\n    generateDescription: `T\u1ea1o m\u00f4 t\u1ea3 ng\u1eafn g\u1ecdn, th\u00e2n thi\u1ec7n v\u1edbi ng\u01b0\u1eddi d\u00f9ng for this smart city data layer. \nT\u1eadp trung v\u00e0o nh\u1eefng g\u00ec ng\u01b0\u1eddi d\u00e2n c\u00f3 th\u1ec3 h\u1ecdc \u0111\u01b0\u1ee3c t\u1eeb d\u1eef li\u1ec7u n\u00e0y.\nGi\u1eef d\u01b0\u1edbi 100 t\u1eeb.`,\n  },\n});\n</code></pre>"},{"location":"vi/ai/providers/#khac-phuc-su-co","title":"Kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1","text":""},{"location":"vi/ai/providers/#van-e-khoa-api","title":"V\u1ea5n \u0111\u1ec1 kh\u00f3a API","text":"<pre><code># Ki\u1ec3m tra k\u1ebft n\u1ed1i OpenAI\ncurl https://api.openai.com/v1/models \\\n  -H \"Authorization: Bearer $OPENAI_API_KEY\"\n\n# Ki\u1ec3m tra k\u1ebft n\u1ed1i Anthropic\ncurl https://api.anthropic.com/v1/messages \\\n  -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n  -H \"anthropic-version: 2023-06-01\"\n</code></pre>"},{"location":"vi/ai/providers/#loi-thuong-gap","title":"L\u1ed7i th\u01b0\u1eddng g\u1eb7p","text":"Error Cause Solution <code>401 Unauthorized</code> Kh\u00f3a API kh\u00f4ng h\u1ee3p l\u1ec7 Ki\u1ec3m tra kh\u00f3a, t\u1ea1o l\u1ea1i n\u1ebfu c\u1ea7n <code>429 Too Many Requests</code> V\u01b0\u1ee3t qu\u00e1 gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 Th\u00eam \u0111\u1ed9 tr\u1ec5, n\u00e2ng c\u1ea5p b\u1eadc <code>500 Server Error</code> S\u1ef1 c\u1ed1 nh\u00e0 cung c\u1ea5p S\u1eed d\u1ee5ng nh\u00e0 cung c\u1ea5p d\u1ef1 ph\u00f2ng <code>T\u00ednh n\u0103ng AI b\u1ecb t\u1eaft</code> <code>ENABLE_AI=false</code> Set to <code>true</code> in .env"},{"location":"vi/ai/providers/#thuc-hanh-tot-nhat","title":"Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t","text":""},{"location":"vi/ai/providers/#1-security","title":"1. Security","text":"<ul> <li>\ud83d\udd10 L\u01b0u API keys trong environment variables, kh\u00f4ng bao gi\u1edd trong code</li> <li>\ud83d\udd12 S\u1eed d\u1ee5ng keys kh\u00e1c nhau cho dev/staging/prod</li> <li>\ud83d\udd04 Rotate keys th\u01b0\u1eddng xuy\u00ean</li> <li>\ud83d\udeab Kh\u00f4ng bao gi\u1edd commit <code>.env</code> files</li> </ul>"},{"location":"vi/ai/providers/#2-cost-management","title":"2. Cost Management","text":"<ul> <li>\ud83d\udcb0 B\u1eaft \u0111\u1ea7u v\u1edbi free/cheap models (Gemini 2.0 Flash, gpt-4o-mini)</li> <li>\ud83d\udcca Monitor usage qua provider dashboards</li> <li>\ud83c\udfaf Gi\u1edbi h\u1ea1n AI features cho specific collections/fields</li> <li>\u26a0\ufe0f Set rate limits v\u00e0 budgets</li> </ul>"},{"location":"vi/ai/providers/#3-performance","title":"3. Performance","text":"<ul> <li>\u26a1 S\u1eed d\u1ee5ng faster models cho real-time features</li> <li>\ud83d\udd04 Cache AI responses khi c\u00f3 th\u1ec3</li> <li>\ud83d\udce6 Batch requests khi th\u00edch h\u1ee3p</li> <li>\u23f1\ufe0f \u0110\u1eb7t th\u1eddi gian ch\u1edd h\u1ee3p l\u00fd</li> </ul>"},{"location":"vi/ai/providers/#cac-buoc-tiep-theo","title":"C\u00e1c b\u01b0\u1edbc ti\u1ebfp theo","text":"<ul> <li>H\u01b0\u1edbng d\u1eabn thi\u1ebft l\u1eadp OpenRouter - S\u1eed d\u1ee5ng custom models</li> <li>AI Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng - C\u00e1c v\u00ed d\u1ee5 th\u1ef1c t\u1ebf</li> <li>T\u1ed5ng quan AI - Hi\u1ec3u v\u1ec1 AI trong LegoCity</li> </ul>"},{"location":"vi/ai/use-cases/","title":"AI Use Cases cho LegoCity","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y bao g\u1ed3m c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf n\u01a1i AI c\u00f3 th\u1ec3 h\u1ed7 tr\u1ee3 trong vi\u1ec7c x\u00e2y d\u1ef1ng v\u00e0 qu\u1ea3n l\u00fd b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n th\u00e0nh ph\u1ed1 th\u00f4ng minh, v\u1edbi c\u00e1c gi\u1edbi h\u1ea1n v\u00e0 th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t ph\u00f9 h\u1ee3p.</p> <p>AI l\u00e0 t\u00f9y ch\u1ecdn v\u00e0 h\u1ed7 tr\u1ee3</p> <p>T\u00ednh n\u0103ng AI l\u00e0 tr\u1ee3 gi\u00fap, kh\u00f4ng ph\u1ea3i ch\u1ee9c n\u0103ng c\u1ed1t l\u00f5i:</p> <pre><code>- \u2705 T\u00ecm c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng n\u01a1i AI **ti\u1ebft ki\u1ec7m th\u1eddi gian** m\u00e0 kh\u00f4ng l\u00e0m gi\u1ea3m ch\u1ea5t l\u01b0\u1ee3ng\n- \u2705 Gi\u1eef con ng\u01b0\u1eddi **ki\u1ec3m so\u00e1t** c\u00e1c quy\u1ebft \u0111\u1ecbnh quan tr\u1ecdng\n- \u274c Kh\u00f4ng d\u1ef1a v\u00e0o AI cho **b\u1ea3o m\u1eadt**, **t\u00ednh to\u00e0n v\u1eb9n d\u1eef li\u1ec7u** ho\u1eb7c **logic h\u1ec7 th\u1ed1ng**---\n</code></pre>"},{"location":"vi/ai/use-cases/#cac-truong-hop-su-dung-uoc-khuyen-nghi","title":"C\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb","text":""},{"location":"vi/ai/use-cases/#1-tao-noi-dung-cho-trang-bai-viet","title":"1. T\u1ea1o n\u1ed9i dung cho Trang &amp; B\u00e0i vi\u1ebft","text":"<p>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: T\u1ea1o b\u00e0i vi\u1ebft blog, th\u00f4ng b\u00e1o ho\u1eb7c t\u00e0i li\u1ec7u v\u1ec1 d\u1ecbch v\u1ee5 v\u00e0 d\u1eef li\u1ec7u th\u00e0nh ph\u1ed1.</p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng</p> <ul> <li>\u2705 So\u1ea1n th\u1ea3o th\u00f4ng b\u00e1o c\u00f4ng khai</li> <li>\u2705 T\u1ea1o n\u1ed9i dung h\u01b0\u1edbng d\u1eabn</li> <li>\u2705 Vi\u1ebft c\u00e2u tr\u1ea3 l\u1eddi FAQ</li> <li>\u2705 T\u1ea1o c\u00e1c k\u1ecbch b\u1ea3n v\u00ed d\u1ee5</li> </ul> <p>Tri\u1ec3n khai</p> <pre><code>// Trong qu\u1ea3n tr\u1ecb PayloadCMS\n// B\u1eadt AI tr\u00ean b\u1ed9 s\u01b0u t\u1eadp Posts\n\nexport const Posts: CollectionConfig = {\n  slug: \"posts\",\n  fields: [\n    {\n      name: \"title\",\n      type: \"text\",\n      required: true,\n    },\n    {\n      name: \"content\",\n      type: \"richText\",\n      admin: {\n        ai: {\n          enabled: true,\n          prompts: {\n            generate:\n              \"Write an engaging blog post about smart city initiatives\",\n          },\n        },\n      },\n    },\n  ],\n};\n</code></pre> <p>Quy tr\u00ecnh v\u00ed d\u1ee5</p> <ol> <li>Bi\u00ean t\u1eadp vi\u00ean t\u1ea1o b\u00e0i vi\u1ebft m\u1edbi: \"Ch\u01b0\u01a1ng tr\u00ecnh chia s\u1ebb xe \u0111\u1ea1p m\u1edbi\"</li> <li>Nh\u1ea5p \"T\u1ea1o b\u1eb1ng AI\"</li> <li>AI t\u1ea1o b\u1ea3n nh\u00e1p d\u1ef1a tr\u00ean ti\u00eau \u0111\u1ec1</li> <li>Bi\u00ean t\u1eadp vi\u00ean xem x\u00e9t, ch\u1ec9nh s\u1eeda v\u00e0 xu\u1ea5t b\u1ea3n</li> </ol> <p>\u0110\u1ea7u ra AI:</p> <p>\"Ch\u00fang t\u00f4i vui m\u1eebng th\u00f4ng b\u00e1o ra m\u1eaft ch\u01b0\u01a1ng tr\u00ecnh chia s\u1ebb xe \u0111\u1ea1p m\u1edbi! B\u1eaft \u0111\u1ea7u t\u1eeb th\u00e1ng sau, c\u01b0 d\u00e2n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng 500 xe \u0111\u1ea1p t\u1ea1i 50 tr\u1ea1m tr\u00ean kh\u1eafp th\u00e0nh ph\u1ed1...\"</p> <p>Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t</p> <ul> <li>\u2705 Xem x\u00e9t n\u1ed9i dung AI \u0111\u1ec3 ki\u1ec3m tra \u0111\u1ed9 ch\u00ednh x\u00e1c</li> <li>\u2705 Th\u00eam chi ti\u1ebft c\u1ee5 th\u1ec3 v\u1ec1 th\u00e0nh ph\u1ed1 th\u1ee7 c\u00f4ng</li> <li>\u2705 X\u00e1c minh ng\u00e0y th\u00e1ng, s\u1ed1 li\u1ec7u v\u00e0 s\u1ef1 th\u1eadt</li> <li>\u2705 Duy tr\u00ec gi\u1ecdng \u0111i\u1ec7u v\u00e0 phong c\u00e1ch nh\u1ea5t qu\u00e1n</li> </ul>"},{"location":"vi/ai/use-cases/#2-tu-ong-hoa-mo-ta-lop","title":"2. T\u1ef1 \u0111\u1ed9ng h\u00f3a m\u00f4 t\u1ea3 l\u1edbp","text":"<p>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: T\u1ea1o m\u00f4 t\u1ea3 th\u00e2n thi\u1ec7n v\u1edbi ng\u01b0\u1eddi d\u00f9ng cho c\u00e1c l\u1edbp b\u1ea3n \u0111\u1ed3 d\u1ef1a tr\u00ean si\u00eau d\u1eef li\u1ec7u k\u1ef9 thu\u1eadt.</p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng</p> <ul> <li>\u2705 T\u1ea1o m\u00f4 t\u1ea3 l\u1edbp nhanh ch\u00f3ng</li> <li>\u2705 Duy tr\u00ec t\u00e0i li\u1ec7u nh\u1ea5t qu\u00e1n</li> <li>\u2705 Gi\u1ea3i th\u00edch d\u1eef li\u1ec7u k\u1ef9 thu\u1eadt cho ng\u01b0\u1eddi d\u00e2n</li> <li>\u2705 M\u00f4 t\u1ea3 \u0111a ng\u00f4n ng\u1eef</li> </ul> <p>Tri\u1ec3n khai</p> <pre><code>// Tr\u1ee3 gi\u00fap AI t\u00f9y ch\u1ec9nh cho c\u00e1c l\u1edbp\nasync function generateLayerDescription(layer: Layer) {\n  const prompt = `T\u1ea1o m\u00f4 t\u1ea3 th\u00e2n thi\u1ec7n v\u1edbi ng\u01b0\u1eddi d\u00f9ng cho l\u1edbp b\u1ea3n \u0111\u1ed3 th\u00e0nh ph\u1ed1 th\u00f4ng minh n\u00e0y:\n\n  T\u00ean l\u1edbp: ${layer.name}\n  Lo\u1ea1i th\u1ef1c th\u1ec3: ${layer.entityType}\n  Thu\u1ed9c t\u00ednh: ${layer.attributes.join(\", \")}\n  Ngu\u1ed3n d\u1eef li\u1ec7u: ${layer.source}\n\n  Vi\u1ebft m\u00f4 t\u1ea3 2-3 c\u00e2u:\n  - Gi\u1ea3i th\u00edch ng\u01b0\u1eddi d\u00e2n c\u00f3 th\u1ec3 h\u1ecdc \u0111\u01b0\u1ee3c g\u00ec t\u1eeb d\u1eef li\u1ec7u n\u00e0y\n  - S\u1eed d\u1ee5ng ng\u00f4n ng\u1eef \u0111\u01a1n gi\u1ea3n, kh\u00f4ng k\u1ef9 thu\u1eadt\n  - \u0110\u1ec1 c\u1eadp t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt n\u1ebfu c\u00f3 li\u00ean quan\n\n  Gi\u1eef d\u01b0\u1edbi 100 t\u1eeb.`;\n\n  return await ai.generateText(prompt);\n}\n</code></pre> <p>\u0110\u1ea7u ra v\u00ed d\u1ee5</p> <p>\u0110\u1ea7u v\u00e0o:</p> <ul> <li>L\u1edbp: \"Gi\u00e1m s\u00e1t ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed\"</li> <li>Lo\u1ea1i th\u1ef1c th\u1ec3: <code>AirQualityObserved</code></li> <li>Thu\u1ed9c t\u00ednh: <code>pm25</code>, <code>pm10</code>, <code>no2</code>, <code>co</code></li> </ul> <p>AI t\u1ea1o ra:</p> <p>\"Xem c\u00e1c ph\u00e9p \u0111o ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed th\u1eddi gian th\u1ef1c t\u1eeb c\u00e1c c\u1ea3m bi\u1ebfn tr\u00ean kh\u1eafp th\u00e0nh ph\u1ed1. L\u1edbp n\u00e0y hi\u1ec3n th\u1ecb m\u1ee9c PM2.5, PM10, nit\u01a1 dioxit v\u00e0 carbon monoxide, \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt m\u1ed7i gi\u1edd. S\u1eed d\u1ee5ng d\u1eef li\u1ec7u n\u00e0y \u0111\u1ec3 ki\u1ec3m tra ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed trong khu v\u1ef1c c\u1ee7a b\u1ea1n v\u00e0 l\u00ean k\u1ebf ho\u1ea1ch cho c\u00e1c ho\u1ea1t \u0111\u1ed9ng ngo\u00e0i tr\u1eddi ph\u00f9 h\u1ee3p.\"</p> <p>Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t</p> <ul> <li>\u2705 Cung c\u1ea5p l\u1eddi nh\u1eafc r\u00f5 r\u00e0ng, c\u00f3 c\u1ea5u tr\u00fac</li> <li>\u2705 Bao g\u1ed3m ng\u1eef c\u1ea3nh k\u1ef9 thu\u1eadt (lo\u1ea1i th\u1ef1c th\u1ec3, thu\u1ed9c t\u00ednh)</li> <li>\u2705 Xem x\u00e9t \u0111\u1ed9 ch\u00ednh x\u00e1c k\u1ef9 thu\u1eadt</li> <li>\u2705 \u0110\u1ea3m b\u1ea3o t\u00ednh nh\u1ea5t qu\u00e1n gi\u1eefa c\u00e1c l\u1edbp</li> </ul>"},{"location":"vi/ai/use-cases/#3-e-xuat-cau-hinh","title":"3. \u0110\u1ec1 xu\u1ea5t c\u1ea5u h\u00ecnh","text":"<p>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: \u0110\u1ec1 xu\u1ea5t c\u1ea5u h\u00ecnh t\u1ed1i \u01b0u d\u1ef1a tr\u00ean m\u1eabu d\u1eef li\u1ec7u v\u00e0 c\u00e1c th\u1ef1c h\u00e0nh ph\u1ed5 bi\u1ebfn.</p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng</p> <ul> <li>\u2705 Khuy\u1ebfn ngh\u1ecb b\u1ea3ng m\u00e0u cho c\u00e1c l\u1edbp</li> <li>\u2705 \u0110\u1ec1 xu\u1ea5t m\u1ee9c \u0111\u1ed9 ph\u00f3ng to cho ch\u1ebf \u0111\u1ed9 xem b\u1ea3n \u0111\u1ed3</li> <li>\u2705 \u0110\u1ec1 xu\u1ea5t c\u1ea5u h\u00ecnh b\u1ed9 l\u1ecdc</li> <li>\u2705 T\u1ef1 \u0111\u1ed9ng t\u1ea1o nh\u00e3n ch\u00fa gi\u1ea3i</li> </ul> <p>Implementation</p> <pre><code>// Suggest color scheme cho pollution data\nasync function suggestColorScheme(layerConfig: LayerConfig) {\n  const prompt = `Suggest an appropriate color scheme for this map layer:\n\n  Data Type: ${layerConfig.dataType}\n  Value Range: ${layerConfig.min} to ${layerConfig.max}\n  Purpose: ${layerConfig.purpose}\n\n  Cung c\u1ea5p 5 m\u00e0u \u1edf \u0111\u1ecbnh d\u1ea1ng hex t\u1eeb gi\u00e1 tr\u1ecb th\u1ea5p nh\u1ea5t \u0111\u1ebfn cao nh\u1ea5t.\n  Consider accessibility and common conventions (e.g., green=good, red=bad).`;\n\n  const colors = await ai.generateText(prompt);\n  return parseColors(colors);\n}\n</code></pre> <p>C\u00e1c k\u1ecbch b\u1ea3n v\u00ed d\u1ee5</p> <p>Ch\u1ec9 s\u1ed1 ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed:</p> <ul> <li>AI \u0111\u1ec1 xu\u1ea5t: <code>['#00E400', '#FFFF00', '#FF7E00', '#FF0000', '#8F3F97']</code></li> <li>L\u00fd do: B\u1ea3ng m\u00e0u AQI ti\u00eau chu\u1ea9n</li> </ul> <p>Nhi\u1ec7t \u0111\u1ed9:</p> <ul> <li>AI \u0111\u1ec1 xu\u1ea5t: <code>['#0000FF', '#00FFFF', '#00FF00', '#FFFF00', '#FF0000']</code></li> <li>L\u00fd do: D\u1ea3i m\u00e0u t\u1eeb l\u1ea1nh (xanh) \u0111\u1ebfn n\u00f3ng (\u0111\u1ecf)</li> </ul> <p>Gi\u1edbi h\u1ea1n</p> <ul> <li>\u26a0\ufe0f X\u00e1c minh kh\u1ea3 n\u0103ng ti\u1ebfp c\u1eadn m\u00e0u s\u1eafc (tu\u00e2n th\u1ee7 WCAG)</li> <li>\u26a0\ufe0f Ki\u1ec3m tra kh\u1ea3 n\u0103ng t\u01b0\u01a1ng th\u00edch v\u1edbi m\u00f9 m\u00e0u</li> <li>\u26a0\ufe0f \u0110\u1ea3m b\u1ea3o ph\u00f9 h\u1ee3p v\u1ec1 v\u0103n h\u00f3a</li> <li>\u26a0\ufe0f Ki\u1ec3m tra v\u1edbi d\u1eef li\u1ec7u th\u1ef1c t\u1ebf</li> </ul>"},{"location":"vi/ai/use-cases/#4-tro-ly-tai-lieu","title":"4. Tr\u1ee3 l\u00fd t\u00e0i li\u1ec7u","text":"<p>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: T\u1ea1o t\u00e0i li\u1ec7u k\u1ef9 thu\u1eadt, v\u00ed d\u1ee5 API v\u00e0 h\u01b0\u1edbng d\u1eabn c\u1ea5u h\u00ecnh.</p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng</p> <ul> <li>\u2705 T\u00e0i li\u1ec7u h\u00f3a c\u00e1c \u0111i\u1ec3m cu\u1ed1i API</li> <li>\u2705 T\u1ea1o v\u00ed d\u1ee5 c\u1ea5u h\u00ecnh</li> <li>\u2705 Vi\u1ebft h\u01b0\u1edbng d\u1eabn t\u00edch h\u1ee3p</li> <li>\u2705 T\u1ea1o \u0111o\u1ea1n m\u00e3</li> </ul> <p>Implementation</p> <pre><code>// Generate API documentation\nasync function generateAPIDoc(endpoint: APIEndpoint) {\n  const prompt = `Generate API documentation for this endpoint:\n\n  Method: ${endpoint.method}\n  Path: ${endpoint.path}\n  Parameters: ${JSON.stringify(endpoint.params)}\n  Response: ${JSON.stringify(endpoint.response)}\n\n  Include:\n  - Description\n  - Request example (curl)\n  - Response example\n  - Common use cases`;\n\n  return await ai.generateText(prompt);\n}\n</code></pre> <p>Example Output</p> <p>Endpoint: <code>GET /api/entities/weather</code></p> <p>AI Generated:</p> <pre><code>## Get Weather Entities\n\nL\u1ea5y c\u00e1c entities quan s\u00e1t th\u1eddi ti\u1ebft t\u1eeb context broker.\n\n### Request\n\n```bash\ncurl https://api.city.example/api/entities/weather?limit=10\n```\n</code></pre>"},{"location":"vi/ai/use-cases/#response","title":"Response","text":"<pre><code>{\n  \"entities\": [\n    {\n      \"id\": \"WeatherObserved:Station1\",\n      \"temperature\": 22.5,\n      \"humidity\": 65\n    }\n  ]\n}\n</code></pre>"},{"location":"vi/ai/use-cases/#use-cases","title":"Use Cases","text":"<ul> <li>Display current weather on dashboard</li> <li>Analyze temperature trends</li> <li>Monitor humidity levels</li> </ul> <pre><code>**Best Practices**\n- \u2705 Cung c\u1ea5p \u0111\u1ea7y \u0111\u1ee7 c\u00e1c specification c\u1ee7a endpoint\n- \u2705 X\u00e1c minh c\u00e1c v\u00ed d\u1ee5 code ho\u1ea1t \u0111\u1ed9ng\n- \u2705 C\u1eadp nh\u1eadt t\u00e0i li\u1ec7u khi APIs thay \u0111\u1ed5i\n- \u2705 Bao g\u1ed3m c\u00e1c tr\u01b0\u1eddng h\u1ee3p l\u1ed7i\n\n---\n\n### 5. T\u1ea1o d\u1eef li\u1ec7u kh\u1edfi t\u1ea1o\n\n**Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng**: T\u1ea1o d\u1eef li\u1ec7u ki\u1ec3m th\u1eed th\u1ef1c t\u1ebf cho ph\u00e1t tri\u1ec3n v\u00e0 demo.\n\n**Khi n\u00e0o s\u1eed d\u1ee5ng**\n- \u2705 T\u1ea1o n\u1ed9i dung demo\n- \u2705 \u0110i\u1ec1n v\u00e0o c\u01a1 s\u1edf d\u1eef li\u1ec7u ph\u00e1t tri\u1ec3n\n- \u2705 Ki\u1ec3m th\u1eed giao di\u1ec7n v\u1edbi d\u1eef li\u1ec7u \u0111a d\u1ea1ng\n- \u2705 T\u1ea1o n\u1ed9i dung gi\u1eef ch\u1ed7\n\n**Implementation**\n\n```typescript\n// Generate sample weather data\nasync function generateSeedData(entityType: string, count: number) {\n  const prompt = `Generate ${count} realistic sample records for this entity type:\n\n  Entity Type: ${entityType}\n  Schema: ${getEntitySchema(entityType)}\n\n  Return as JSON array with realistic values for a smart city context.\n  Bao g\u1ed3m d\u1eef li\u1ec7u \u0111a d\u1ea1ng (c\u00e1c th\u1eddi \u0111i\u1ec3m, \u0111\u1ecba \u0111i\u1ec3m, gi\u00e1 tr\u1ecb kh\u00e1c nhau).`\n\n  const data = await ai.generateText(prompt)\n  return JSON.parse(data)\n}\n</code></pre> <p>Example Output</p> <p>Request: 3 weather observations</p> <p>AI Generated:</p> <pre><code>[\n  {\n    \"id\": \"WeatherObserved:Station1\",\n    \"location\": { \"coordinates\": [10.762622, 106.660172] },\n    \"temperature\": 32.5,\n    \"humidity\": 75,\n    \"observedAt\": \"2025-12-01T14:00:00Z\"\n  },\n  {\n    \"id\": \"WeatherObserved:Station2\",\n    \"location\": { \"coordinates\": [10.762733, 106.660283] },\n    \"temperature\": 31.8,\n    \"humidity\": 72,\n    \"observedAt\": \"2025-12-01T14:00:00Z\"\n  },\n  {\n    \"id\": \"WeatherObserved:Station3\",\n    \"location\": { \"coordinates\": [10.762844, 106.660394] },\n    \"temperature\": 33.2,\n    \"humidity\": 78,\n    \"observedAt\": \"2025-12-01T14:00:00Z\"\n  }\n]\n</code></pre> <p>Gi\u1edbi h\u1ea1n</p> <ul> <li>\u26a0\ufe0f X\u00e1c th\u1ef1c tu\u00e2n th\u1ee7 l\u01b0\u1ee3c \u0111\u1ed3 d\u1eef li\u1ec7u</li> <li>\u26a0\ufe0f Ki\u1ec3m tra ph\u1ea1m vi gi\u00e1 tr\u1ecb th\u1ef1c t\u1ebf</li> <li>\u26a0\ufe0f X\u00e1c minh t\u1ecda \u0111\u1ed9 \u0111\u1ecba l\u00fd</li> <li>\u26a0\ufe0f Kh\u00f4ng ph\u00f9 h\u1ee3p cho d\u1eef li\u1ec7u s\u1ea3n xu\u1ea5t</li> </ul>"},{"location":"vi/ai/use-cases/#6-cai-thien-tim-kiem-thong-minh","title":"6. C\u1ea3i thi\u1ec7n t\u00ecm ki\u1ebfm th\u00f4ng minh","text":"<p>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: C\u1ea3i thi\u1ec7n t\u00ecm ki\u1ebfm v\u1edbi hi\u1ec3u ng\u00f4n ng\u1eef t\u1ef1 nhi\u00ean v\u00e0 kh\u1edbp ng\u1eef ngh\u0129a.</p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng</p> <ul> <li>\u2705 Truy v\u1ea5n ng\u00f4n ng\u1eef t\u1ef1 nhi\u00ean</li> <li>\u2705 T\u00ecm ki\u1ebfm ng\u1eef ngh\u0129a cho n\u1ed9i dung</li> <li>\u2705 M\u1edf r\u1ed9ng truy v\u1ea5n v\u00e0 \u0111\u1ec1 xu\u1ea5t</li> <li>\u2705 Kh\u1edbp m\u1edd cho l\u1ed7i \u0111\u00e1nh m\u00e1y</li> </ul> <p>Implementation</p> <pre><code>// Enhance search with AI\nasync function enhanceSearch(query: string) {\n  // Generate search keywords\n  const prompt = `Given this search query: \"${query}\"\n\n  Generate:\n  1. Normalized keywords\n  2. Related terms\n  3. Entity types that might match\n\n  Return as JSON.`;\n\n  const enhanced = await ai.generateText(prompt);\n  const { keywords, related, entityTypes } = JSON.parse(enhanced);\n\n  // Search with enhanced terms\n  return searchEntities({ keywords, related, entityTypes });\n}\n</code></pre> <p>V\u00ed d\u1ee5</p> <p>Truy v\u1ea5n ng\u01b0\u1eddi d\u00f9ng: \"C\u1ea3m bi\u1ebfn \u00f4 nhi\u1ec5m kh\u00f4ng kh\u00ed \u1edf \u0111\u00e2u?\"</p> <p>C\u1ea3i thi\u1ec7n AI:</p> <pre><code>{\n  \"keywords\": [\"air\", \"pollution\", \"sensors\"],\n  \"related\": [\"air quality\", \"PM2.5\", \"PM10\", \"AQI\", \"monitoring stations\"],\n  \"entityTypes\": [\"AirQualityObserved\", \"Device\"]\n}\n</code></pre> <p>K\u1ebft qu\u1ea3: K\u1ebft qu\u1ea3 t\u00ecm ki\u1ebfm t\u1ed1t h\u01a1n bao g\u1ed3m c\u00e1c thu\u1eadt ng\u1eef li\u00ean quan</p> <p>Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t</p> <ul> <li>\u2705 L\u01b0u cache c\u00e1c truy v\u1ea5n ph\u1ed5 bi\u1ebfn</li> <li>\u2705 Quay l\u1ea1i t\u00ecm ki\u1ebfm th\u00f4ng th\u01b0\u1eddng n\u1ebfu AI th\u1ea5t b\u1ea1i</li> <li>\u2705 Theo d\u00f5i c\u00e1c ch\u1ec9 s\u1ed1 ch\u1ea5t l\u01b0\u1ee3ng t\u00ecm ki\u1ebfm</li> <li>\u2705 T\u00f4n tr\u1ecdng quy\u1ec1n ri\u00eang t\u01b0 ng\u01b0\u1eddi d\u00f9ng</li> </ul>"},{"location":"vi/ai/use-cases/#7-chatbot-cho-nguoi-dan","title":"7. Chatbot cho ng\u01b0\u1eddi d\u00e2n","text":"<p>Tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng: Tr\u1ea3 l\u1eddi c\u00e2u h\u1ecfi c\u1ee7a ng\u01b0\u1eddi d\u00e2n v\u1ec1 d\u1ecbch v\u1ee5 v\u00e0 d\u1eef li\u1ec7u th\u00e0nh ph\u1ed1.</p> <p>Khi n\u00e0o s\u1eed d\u1ee5ng</p> <ul> <li>\u2705 C\u00e1c c\u00e2u h\u1ecfi th\u01b0\u1eddng g\u1eb7p (FAQ)</li> <li>\u2705 Tr\u1ee3 gi\u00fap di\u1ec5n gi\u1ea3i d\u1eef li\u1ec7u</li> <li>\u2705 Th\u00f4ng tin d\u1ecbch v\u1ee5</li> <li>\u2705 H\u1ed7 tr\u1ee3 \u0111i\u1ec1u h\u01b0\u1edbng</li> </ul> <p>Implementation</p> <pre><code>// Simple chatbot implementation\nasync function answerQuestion(question: string, context: CityContext) {\n  const prompt = `You are a helpful assistant for a smart city dashboard.\n\n  City Context:\n  - Available data: ${context.availableData.join(\", \")}\n  - Services: ${context.services.join(\", \")}\n\n  Citizen Question: ${question}\n\n  Cung c\u1ea5p c\u00e2u tr\u1ea3 l\u1eddi h\u1eefu \u00edch, ng\u1eafn g\u1ecdn (t\u1ed1i \u0111a 150 t\u1eeb).\n  If you don't know, direct them to contact support.`;\n\n  return await ai.generateText(prompt);\n}\n</code></pre> <p>V\u00ed d\u1ee5 cu\u1ed9c tr\u00f2 chuy\u1ec7n</p> <p>H\u1ecfi: \"L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 t\u00ecm ch\u1ed7 \u0111\u1ed7 xe g\u1ea7n T\u00f2a th\u1ecb ch\u00ednh?\"</p> <p>AI: \"B\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng l\u1edbp c\u01a1 s\u1edf \u0111\u1ed7 xe tr\u00ean b\u1ea3n \u0111\u1ed3 \u0111\u1ec3 t\u00ecm ch\u1ed7 \u0111\u1ed7 xe c\u00f3 s\u1eb5n g\u1ea7n T\u00f2a th\u1ecb ch\u00ednh. Nh\u1ea5p v\u00e0o bi\u1ec3u t\u01b0\u1ee3ng \u0111\u1ed7 xe \u0111\u1ec3 xem t\u00ecnh tr\u1ea1ng c\u00f3 s\u1eb5n v\u00e0 gi\u00e1 c\u1ea3 theo th\u1eddi gian th\u1ef1c. C\u00f3 3 b\u00e3i \u0111\u1ed7 xe c\u00f4ng c\u1ed9ng trong v\u00f2ng 500m t\u1eeb T\u00f2a th\u1ecb ch\u00ednh v\u1edbi t\u1ed5ng c\u1ed9ng 250 ch\u1ed7.\"</p> <p>H\u1ecfi: \"Ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed h\u00f4m nay th\u1ebf n\u00e0o?\"</p> <p>AI: \"D\u1ef1a tr\u00ean c\u00e1c s\u1ed1 \u0111o m\u1edbi nh\u1ea5t t\u1eeb c\u1ea3m bi\u1ebfn ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed, Ch\u1ec9 s\u1ed1 Ch\u1ea5t l\u01b0\u1ee3ng Kh\u00f4ng kh\u00ed (AQI) l\u00e0 65, thu\u1ed9c ph\u1ea1m vi 'Trung b\u00ecnh'. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c \u0111\u1ed1i v\u1edbi h\u1ea7u h\u1ebft m\u1ecdi ng\u01b0\u1eddi, m\u1eb7c d\u00f9 nh\u1eefng c\u00e1 nh\u00e2n nh\u1ea1y c\u1ea3m b\u1ea5t th\u01b0\u1eddng n\u00ean c\u00e2n nh\u1eafc h\u1ea1n ch\u1ebf v\u1eadn \u0111\u1ed9ng ngo\u00e0i tr\u1eddi k\u00e9o d\u00e0i.\"</p> <p>Xem x\u00e9t v\u1ec1 an to\u00e0n</p> <ul> <li>\u26a0\ufe0f Kh\u00f4ng cung c\u1ea5p th\u00f4ng tin ph\u1ea3n \u1ee9ng kh\u1ea9n c\u1ea5p</li> <li>\u26a0\ufe0f Kh\u00f4ng \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh ch\u00ednh s\u00e1ch</li> <li>\u26a0\ufe0f Lu\u00f4n tr\u00edch d\u1eabn ngu\u1ed3n d\u1eef li\u1ec7u</li> <li>\u26a0\ufe0f Bao g\u1ed3m tuy\u00ean b\u1ed1 mi\u1ec5n tr\u1eeb tr\u00e1ch nhi\u1ec7m cho d\u1ef1 \u0111o\u00e1n</li> <li>\u26a0\ufe0f Cung c\u1ea5p t\u00f9y ch\u1ecdn li\u00ean h\u1ec7 con ng\u01b0\u1eddi</li> </ul>"},{"location":"vi/ai/use-cases/#cac-truong-hop-su-dung-can-tranh","title":"C\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng C\u1ea6N TR\u00c1NH","text":""},{"location":"vi/ai/use-cases/#bao-mat-va-kiem-soat-truy-cap","title":"\u274c B\u1ea3o m\u1eadt v\u00e0 Ki\u1ec3m so\u00e1t truy c\u1eadp","text":"<p>Kh\u00f4ng s\u1eed d\u1ee5ng AI cho:</p> <ul> <li>Quy\u1ebft \u0111\u1ecbnh quy\u1ec1n ng\u01b0\u1eddi d\u00f9ng</li> <li>T\u1ea1o ch\u00ednh s\u00e1ch b\u1ea3o m\u1eadt</li> <li>X\u00e1c th\u1ef1c th\u00f4ng tin \u0111\u0103ng nh\u1eadp</li> <li>\u0110\u01b0a ra quy\u1ebft \u0111\u1ecbnh x\u00e1c th\u1ef1c</li> </ul> <p>T\u1ea1i sao: B\u1ea3o m\u1eadt y\u00eau c\u1ea7u logic x\u00e1c \u0111\u1ecbnh, c\u00f3 th\u1ec3 ki\u1ec3m to\u00e1n, kh\u00f4ng ph\u1ea3i AI x\u00e1c su\u1ea5t.</p>"},{"location":"vi/ai/use-cases/#xac-thuc-du-lieu-va-tinh-toan-ven","title":"\u274c X\u00e1c th\u1ef1c d\u1eef li\u1ec7u v\u00e0 T\u00ednh to\u00e0n v\u1eb9n","text":"<p>Kh\u00f4ng s\u1eed d\u1ee5ng AI cho:</p> <ul> <li>X\u00e1c th\u1ef1c l\u01b0\u1ee3c \u0111\u1ed3 th\u1ef1c th\u1ec3</li> <li>Ki\u1ec3m tra t\u00ednh nh\u1ea5t qu\u00e1n d\u1eef li\u1ec7u</li> <li>Th\u1ef1c thi quy t\u1eafc kinh doanh</li> <li>Logic chuy\u1ec3n \u0111\u1ed5i d\u1eef li\u1ec7u</li> </ul> <p>T\u1ea1i sao: T\u00ednh to\u00e0n v\u1eb9n d\u1eef li\u1ec7u y\u00eau c\u1ea7u quy t\u1eafc x\u00e1c th\u1ef1c ch\u00ednh x\u00e1c, c\u00f3 th\u1ec3 ki\u1ec3m th\u1eed.</p>"},{"location":"vi/ai/use-cases/#hoat-ong-quan-trong","title":"\u274c Ho\u1ea1t \u0111\u1ed9ng quan tr\u1ecdng","text":"<p>Kh\u00f4ng s\u1eed d\u1ee5ng AI cho:</p> <ul> <li>Quy\u1ebft \u0111\u1ecbnh tri\u1ec3n khai</li> <li>C\u1ea5u h\u00ecnh h\u1ec7 th\u1ed1ng</li> <li>Di chuy\u1ec3n c\u01a1 s\u1edf d\u1eef li\u1ec7u</li> <li>C\u00e1c ho\u1ea1t \u0111\u1ed9ng sao l\u01b0u/kh\u00f4i ph\u1ee5c</li> </ul> <p>T\u1ea1i sao: C\u00e1c nhi\u1ec7m v\u1ee5 v\u1eadn h\u00e0nh y\u00eau c\u1ea7u th\u1ee7 t\u1ee5c x\u00e1c \u0111\u1ecbnh, \u0111\u00e3 ki\u1ec3m th\u1eed.</p>"},{"location":"vi/ai/use-cases/#canh-bao-thoi-gian-thuc","title":"\u274c C\u1ea3nh b\u00e1o th\u1eddi gian th\u1ef1c","text":"<p>Kh\u00f4ng s\u1eed d\u1ee5ng AI cho:</p> <ul> <li>Th\u00f4ng b\u00e1o kh\u1ea9n c\u1ea5p</li> <li>C\u1ea3nh b\u00e1o d\u1ef1a tr\u00ean ng\u01b0\u1ee1ng</li> <li>C\u1ea3nh b\u00e1o h\u1ec7 th\u1ed1ng quan tr\u1ecdng</li> <li>Th\u00f4ng b\u00e1o an to\u00e0n</li> </ul> <p>T\u1ea1i sao: C\u1ea3nh b\u00e1o y\u00eau c\u1ea7u k\u00edch ho\u1ea1t \u0111\u00e1ng tin c\u1eady, t\u1ee9c th\u00ec, d\u1ef1a tr\u00ean quy t\u1eafc.</p>"},{"location":"vi/ai/use-cases/#huong-dan-trien-khai","title":"H\u01b0\u1edbng d\u1eabn tri\u1ec3n khai","text":""},{"location":"vi/ai/use-cases/#1-yeu-cau-xem-xet-cua-con-nguoi","title":"1. Y\u00eau c\u1ea7u xem x\u00e9t c\u1ee7a con ng\u01b0\u1eddi","text":"<pre><code>// Always require human approval for AI-generated content\nasync function generateWithApproval(prompt: string) {\n  const draft = await ai.generateText(prompt);\n\n  return {\n    draft,\n    status: \"pending_review\",\n    requiresApproval: true,\n    reviewer: null,\n    approvedAt: null,\n  };\n}\n</code></pre>"},{"location":"vi/ai/use-cases/#2-quay-lai-thu-cong","title":"2. Quay l\u1ea1i th\u1ee7 c\u00f4ng","text":"<pre><code>// Graceful fallback if AI unavailable\nasync function generateContent(prompt: string) {\n  if (!process.env.ENABLE_AI) {\n    return {\n      content: \"\",\n      mode: \"manual\",\n      message: \"AI features disabled. Please enter content manually.\",\n    };\n  }\n\n  try {\n    const content = await ai.generateText(prompt);\n    return { content, mode: \"ai\" };\n  } catch (error) {\n    return {\n      content: \"\",\n      mode: \"manual\",\n      message: \"AI generation failed. Please enter content manually.\",\n    };\n  }\n}\n</code></pre>"},{"location":"vi/ai/use-cases/#3-dau-vet-kiem-toan","title":"3. D\u1ea5u v\u1ebft ki\u1ec3m to\u00e1n","text":"<pre><code>// Log all AI operations\nasync function generateWithAudit(prompt: string, userId: string) {\n  const result = await ai.generateText(prompt);\n\n  await logAIOperation({\n    userId,\n    prompt: prompt.substring(0, 100), // Truncate for privacy\n    model: process.env.OPENROUTER_MODEL,\n    timestamp: new Date(),\n    approved: false,\n  });\n\n  return result;\n}\n</code></pre>"},{"location":"vi/ai/use-cases/#4-giam-sat-chi-phi","title":"4. Gi\u00e1m s\u00e1t chi ph\u00ed","text":"<pre><code>// Track AI usage and costs\nasync function generateWithCostTracking(prompt: string) {\n  const startTime = Date.now();\n  const result = await ai.generateText(prompt);\n  const duration = Date.now() - startTime;\n\n  await trackAICost({\n    model: process.env.OPENROUTER_MODEL,\n    promptTokens: estimateTokens(prompt),\n    completionTokens: estimateTokens(result),\n    duration,\n    cost: calculateCost(prompt, result),\n  });\n\n  return result;\n}\n</code></pre>"},{"location":"vi/ai/use-cases/#tom-tat-thuc-hanh-tot-nhat","title":"T\u00f3m t\u1eaft th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t","text":""},{"location":"vi/ai/use-cases/#nen","title":"\u2705 N\u00ean","text":"<ul> <li>S\u1eed d\u1ee5ng AI cho b\u1ea3n nh\u00e1p v\u00e0 \u0111\u1ec1 xu\u1ea5t</li> <li>Gi\u1eef con ng\u01b0\u1eddi ki\u1ec3m so\u00e1t</li> <li>Xem x\u00e9t t\u1ea5t c\u1ea3 \u0111\u1ea7u ra AI</li> <li>Cung c\u1ea5p c\u00e1c l\u1ef1a ch\u1ecdn th\u1ee7 c\u00f4ng</li> <li>Gi\u00e1m s\u00e1t chi ph\u00ed v\u00e0 vi\u1ec7c s\u1eed d\u1ee5ng</li> <li>Ghi nh\u1eadt k\u00fd c\u00e1c ho\u1ea1t \u0111\u1ed9ng AI</li> <li>Ki\u1ec3m th\u1eed v\u1edbi c\u00e1c t\u00ecnh hu\u1ed1ng th\u1ef1c t\u1ebf</li> </ul>"},{"location":"vi/ai/use-cases/#khong-nen","title":"\u274c Kh\u00f4ng n\u00ean","text":"<ul> <li>D\u1ef1a v\u00e0o AI cho logic quan tr\u1ecdng</li> <li>T\u1ef1 \u0111\u1ed9ng xu\u1ea5t b\u1ea3n n\u1ed9i dung AI</li> <li>S\u1eed d\u1ee5ng AI cho quy\u1ebft \u0111\u1ecbnh b\u1ea3o m\u1eadt</li> <li>T\u1ea1o d\u1eef li\u1ec7u s\u1ea3n xu\u1ea5t</li> <li>B\u1ecf qua xem x\u00e9t c\u1ee7a con ng\u01b0\u1eddi</li> <li>B\u1ecf qua gi\u1edbi h\u1ea1n c\u1ee7a AI</li> <li>Ph\u1ee5 thu\u1ed9c qu\u00e1 m\u1ee9c v\u00e0o AI</li> </ul>"},{"location":"vi/ai/use-cases/#cac-buoc-tiep-theo","title":"C\u00e1c b\u01b0\u1edbc ti\u1ebfp theo","text":"<ul> <li>C\u1ea5u h\u00ecnh nh\u00e0 cung c\u1ea5p AI - Thi\u1ebft l\u1eadp nh\u00e0 cung c\u1ea5p AI</li> <li>H\u01b0\u1edbng d\u1eabn OpenRouter - S\u1eed d\u1ee5ng m\u00f4 h\u00ecnh t\u00f9y ch\u1ec9nh</li> <li>T\u1ed5ng quan AI - Hi\u1ec3u v\u1ec1 AI trong LegoCity</li> </ul>"},{"location":"vi/configuration/","title":"H\u01b0\u1edbng d\u1eabn C\u1ea5u h\u00ecnh","text":"<p>C\u1ea5u h\u00ecnh LegoCity \u0111\u1ec3 l\u00e0m vi\u1ec7c v\u1edbi data sources, maps v\u00e0 services c\u1ee7a th\u00e0nh ph\u1ed1 b\u1ea1n.</p>"},{"location":"vi/configuration/#tong-quan-cau-hinh","title":"T\u1ed5ng quan C\u1ea5u h\u00ecnh","text":"<p>C\u1ea5u h\u00ecnh trong LegoCity x\u1ea3y ra \u1edf ba n\u01a1i:</p> <ol> <li>Environment Variables (<code>.env</code>) - Th\u00f4ng tin b\u00ed m\u1eadt, URLs, kh\u00f3a API</li> <li>PayloadCMS Admin - Content, pages, blocks, collections</li> <li>Code Configuration - T\u00f9y ch\u1ec9nh n\u00e2ng cao, plugins</li> </ol>"},{"location":"vi/configuration/#danh-sach-kiem-tra-cau-hinh-nhanh","title":"Danh s\u00e1ch Ki\u1ec3m tra C\u1ea5u h\u00ecnh Nhanh","text":"<p>Sau khi c\u00e0i \u0111\u1eb7t, c\u1ea5u h\u00ecnh nh\u1eefng \u0111i\u1ec1u c\u1ea7n thi\u1ebft n\u00e0y:</p> <ul> <li>[ ] Data Sources - K\u1ebft n\u1ed1i NGSI-LD brokers</li> <li>[ ] C\u00e0i \u0111\u1eb7t B\u1ea3n \u0111\u1ed3 - C\u1ea5u h\u00ecnh Mapbox v\u00e0 map views (xem b\u00ean d\u01b0\u1edbi)</li> <li>[ ] Kh\u00f3a API - Thi\u1ebft l\u1eadp kh\u00f3a d\u1ecbch v\u1ee5 b\u00ean ngo\u00e0i</li> <li>[ ] Ng\u01b0\u1eddi d\u00f9ng Qu\u1ea3n tr\u1ecb - T\u1ea1o admin accounts v\u00e0 roles trong PayloadCMS</li> <li>[ ] T\u00edch h\u1ee3p AI (T\u00f9y ch\u1ecdn) - C\u1ea5u h\u00ecnh AI helpers (xem ph\u1ea7n T\u00edch h\u1ee3p AI)</li> </ul>"},{"location":"vi/configuration/#cau-hinh-moi-truong","title":"C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng","text":""},{"location":"vi/configuration/#core-settings-env","title":"Core Settings (<code>.env</code>)","text":"<pre><code># ================================\n# Database\n# ================================\nDATABASE_URI=mongodb://127.0.0.1/legocity\n\n# ================================\n# Security\n# ================================\nPAYLOAD_SECRET=your-secret-key-minimum-32-characters-long\n\n# ================================\n# Server\n# ================================\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\nPORT=3000\n\n# ================================\n# NGSI-LD Context Broker\n# ================================\nNGSI_LD_BROKER_URL=http://localhost:1026\nNGSI_LD_TENANT=your-tenant-name\n\n# ================================\n# Mapbox\n# ================================\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_access_token\n\n# ================================\n# D\u1ecbch v\u1ee5 t\u00f9y ch\u1ecdn\n# ================================\n# L\u01b0u \u0111\u1ec7m Redis\nREDIS_URL=redis://localhost:6379\n\n# C\u00e1c API b\u00ean ngo\u00e0i (l\u01b0u tr\u1eef ph\u00eda server)\nWEATHER_API_KEY=your-weather-api-key\nGEOCODING_API_KEY=your-geocoding-api-key\n</code></pre>"},{"location":"vi/configuration/#thuc-hanh-bao-mat-tot-nhat","title":"Th\u1ef1c h\u00e0nh b\u1ea3o m\u1eadt t\u1ed1t nh\u1ea5t","text":"<p>!!! warning \"Never Commit Secrets\" - Add <code>.env</code> to <code>.gitignore</code> - Use different secrets per environment - Rotate keys regularly</p> <p>Generate secure secrets:</p> <pre><code># Generate PAYLOAD_SECRET\nnode -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"\n\n# Or use OpenSSL\nopenssl rand -hex 32\n</code></pre> <p>Environment-specific files:</p> <pre><code>.env                    # Local development (gitignored)\n.env.example            # Template (committed)\n.env.production         # Production (secure storage)\n.env.test               # Testing\n</code></pre>"},{"location":"vi/configuration/#cau-hinh-payloadcms","title":"C\u1ea5u h\u00ecnh PayloadCMS","text":""},{"location":"vi/configuration/#tong-quan-ve-collections","title":"T\u1ed5ng quan v\u1ec1 Collections","text":"B\u1ed9 s\u01b0u t\u1eadp M\u1ee5c \u0111\u00edch V\u00ed d\u1ee5 Pages B\u1ed1 c\u1ee5c b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n Home, Map View, Analytics Posts B\u00e0i vi\u1ebft, tin t\u1ee9c Announcements, guides Media Images, files Icons, photos, documents Categories Content organization News, Events, Reports Users Admin accounts Admins, Editors, Viewers"},{"location":"vi/configuration/#global-settings","title":"Global Settings","text":"<p>Navigation \u2192 Globals \u2192 C\u1ea5u h\u00ecnh:</p> <ul> <li>Header - Logo, navigation menu, theme</li> <li>Footer - Links, contact info, social media</li> <li>Site Settings - Title, description, metadata</li> </ul>"},{"location":"vi/configuration/#quy-trinh-cau-hinh","title":"Quy tr\u00ecnh c\u1ea5u h\u00ecnh","text":""},{"location":"vi/configuration/#thiet-lap-ban-au","title":"Thi\u1ebft l\u1eadp Ban \u0111\u1ea7u","text":"<ol> <li> <p>T\u1ea1o T\u00e0i kho\u1ea3n Qu\u1ea3n tr\u1ecb</p> </li> <li> <p>User \u0111\u1ea7u ti\u00ean t\u1ef1 \u0111\u1ed9ng tr\u1edf th\u00e0nh admin</p> </li> <li> <p>Th\u00eam ng\u01b0\u1eddi d\u00f9ng b\u1ed5 sung trong Users collection</p> </li> <li> <p>C\u1ea5u h\u00ecnh C\u01a1 b\u1ea3n Trang web</p> </li> <li> <p>\u0110\u1eb7t t\u00ean trang web v\u00e0 m\u00f4 t\u1ea3</p> </li> <li>T\u1ea3i l\u00ean logo v\u00e0 favicon</li> <li> <p>C\u1ea5u h\u00ecnh header v\u00e0 footer</p> </li> <li> <p>K\u1ebft n\u1ed1i Ngu\u1ed3n D\u1eef li\u1ec7u</p> </li> <li> <p>Th\u00eam NGSI-LD broker URL</p> </li> <li>Ki\u1ec3m tra k\u1ebft n\u1ed1i</li> <li> <p>C\u1ea5u h\u00ecnh c\u00e1c lo\u1ea1i entity</p> </li> <li> <p>Thi\u1ebft l\u1eadp B\u1ea3n \u0111\u1ed3</p> </li> <li> <p>Th\u00eam Mapbox token</p> </li> <li>T\u1ea1o c\u00e1c map views</li> <li> <p>C\u1ea5u h\u00ecnh c\u00e1c l\u1edbp</p> </li> <li> <p>T\u1ea1o Trang \u0110\u1ea7u ti\u00ean</p> </li> <li>S\u1eed d\u1ee5ng blocks \u0111\u1ec3 x\u00e2y d\u1ef1ng b\u1ed1 c\u1ee5c</li> <li>Th\u00eam map views v\u00e0 content</li> <li>Xu\u1ea5t b\u1ea3n trang</li> </ol>"},{"location":"vi/configuration/#them-mot-thanh-pho","title":"Th\u00eam m\u1ed9t Th\u00e0nh ph\u1ed1","text":"<p>Cho c\u00e1c tri\u1ec3n khai \u0111a thu\u00ea bao:</p> <ol> <li>T\u1ea1o Thu\u00ea bao</li> </ol> <pre><code>NGSI_LD_TENANT=city-name\n</code></pre> <ol> <li> <p>C\u1ea5u h\u00ecnh Ngu\u1ed3n D\u1eef li\u1ec7u</p> </li> <li> <p>Tr\u1ecf \u0111\u1ebfn NGSI-LD broker c\u1ee7a th\u00e0nh ph\u1ed1</p> </li> <li> <p>\u00c1nh x\u1ea1 c\u00e1c lo\u1ea1i entity \u0111\u1ebfn views</p> </li> <li> <p>T\u00f9y ch\u1ec9nh Th\u01b0\u01a1ng hi\u1ec7u</p> </li> <li> <p>T\u1ea3i l\u00ean logo th\u00e0nh ph\u1ed1</p> </li> <li>\u0110\u1eb7t m\u00e0u s\u1eafc th\u00e0nh ph\u1ed1 (Tailwind config)</li> <li> <p>T\u1ea1o c\u00e1c trang t\u00f9y ch\u1ec9nh</p> </li> <li> <p>T\u1ea3i D\u1eef li\u1ec7u Th\u00e0nh ph\u1ed1</p> </li> <li>N\u1ea1p d\u1eef li\u1ec7u kh\u1edfi t\u1ea1o v\u1edbi c\u00e1c entity th\u00e0nh ph\u1ed1</li> <li>T\u1ea1o map views cho c\u00e1c khu v\u1ef1c th\u00e0nh ph\u1ed1</li> <li>Th\u00eam n\u1ed9i dung m\u1eabu</li> </ol>"},{"location":"vi/configuration/#cau-hinh-nang-cao","title":"C\u1ea5u h\u00ecnh n\u00e2ng cao","text":""},{"location":"vi/configuration/#cau-hinh-theo-tinh-nang","title":"C\u1ea5u h\u00ecnh theo t\u00ednh n\u0103ng","text":""},{"location":"vi/configuration/#data-integration","title":"Data Integration","text":"<p>K\u1ebft n\u1ed1i Context Broker:</p> <ul> <li>Data Sources Configuration</li> </ul>"},{"location":"vi/configuration/#maps-visualization","title":"Maps &amp; Visualization","text":"<p>C\u1ea5u h\u00ecnh Maps - Xem PayloadCMS admin cho map configuration</p>"},{"location":"vi/configuration/#security-access","title":"Security &amp; Access","text":"<p>Thi\u1ebft l\u1eadp Security:</p> <ul> <li>API Keys Management</li> </ul>"},{"location":"vi/configuration/#ai-features","title":"AI Features","text":"<p>Enable AI Helpers (T\u00f9y ch\u1ecdn):</p> <ul> <li>Xem AI Integration section cho AI provider configuration</li> </ul>"},{"location":"vi/configuration/#xac-thuc-cau-hinh","title":"X\u00e1c th\u1ef1c c\u1ea5u h\u00ecnh","text":""},{"location":"vi/configuration/#health-check","title":"Health Check","text":"<p>T\u1ea1o health check endpoint:</p> <pre><code>// app/api/health/route.ts\nexport async function GET() {\n  const checks = {\n    database: await checkDatabase(),\n    broker: await checkBroker(),\n    mapbox: !!process.env.NEXT_PUBLIC_MAPBOX_TOKEN,\n  };\n\n  return Response.json(checks);\n}\n</code></pre> <p>Truy c\u1eadp t\u1ea1i: <code>http://localhost:3000/api/health</code></p>"},{"location":"vi/configuration/#xac-minh-cau-hinh","title":"X\u00e1c minh c\u1ea5u h\u00ecnh","text":"<pre><code># Ki\u1ec3m tra environment variables\npnpm run check:env\n\n# Test database connection\npnpm run check:db\n\n# Test NGSI-LD broker\ncurl http://localhost:1026/version\n\n# Test Mapbox token\ncurl \"https://api.mapbox.com/v4/mapbox.mapbox-streets-v8.json?access_token=$NEXT_PUBLIC_MAPBOX_TOKEN\"\n</code></pre>"},{"location":"vi/configuration/#sao-luu-cau-hinh","title":"Sao l\u01b0u c\u1ea5u h\u00ecnh","text":"<pre><code># Export PayloadCMS data\nmongodump --db legocity --out ./backup\n\n# Backup environment\ncp .env .env.backup\n\n# Backup media files\ncp -r public/media ./backup/media\n</code></pre>"},{"location":"vi/configuration/#khoi-phuc-cau-hinh","title":"Kh\u00f4i ph\u1ee5c c\u1ea5u h\u00ecnh","text":"<pre><code># Restore database\nmongorestore --db legocity ./backup/legocity\n\n# Restore environment\ncp .env.backup .env\n\n# Restore media\ncp -r ./backup/media public/media\n</code></pre>"},{"location":"vi/configuration/#xu-ly-su-co","title":"X\u1eed l\u00fd s\u1ef1 c\u1ed1","text":""},{"location":"vi/configuration/#cau-hinh-khong-uoc-ap-dung","title":"C\u1ea5u h\u00ecnh kh\u00f4ng \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng","text":"<p>Clear cache:</p> <pre><code>rm -rf .next\npnpm dev\n</code></pre> <p>Ki\u1ec3m tra environment:</p> <pre><code># Print config (safe variables only)\npnpm run config:show\n</code></pre>"},{"location":"vi/configuration/#cau-hinh-khong-hop-le","title":"C\u1ea5u h\u00ecnh kh\u00f4ng h\u1ee3p l\u1ec7","text":"<p>Validate schema:</p> <pre><code>pnpm run validate:config\n</code></pre> <p>Ki\u1ec3m tra logs:</p> <pre><code># Development mode shows detailed errors\npnpm dev\n</code></pre>"},{"location":"vi/configuration/#tham-khao-cau-hinh","title":"Tham kh\u1ea3o c\u1ea5u h\u00ecnh","text":"<ul> <li>PayloadCMS Config API</li> <li>Next.js Configuration</li> </ul>"},{"location":"vi/configuration/#cac-buoc-tiep-theo","title":"C\u00e1c b\u01b0\u1edbc ti\u1ebfp theo","text":"<p>Sau configuration:</p> <ol> <li>H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng - H\u1ecdc c\u00e1ch s\u1eed d\u1ee5ng LegoCity</li> <li>H\u01b0\u1edbng d\u1eabn ph\u00e1t tri\u1ec3n - T\u00f9y ch\u1ec9nh v\u00e0 m\u1edf r\u1ed9ng</li> <li>H\u01b0\u1edbng d\u1eabn tri\u1ec3n khai - Tri\u1ec3n khai l\u00ean m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t</li> </ol> <p>C\u1ea7n specific configuration? Ch\u1ecdn topic c\u1ee7a b\u1ea1n:</p> <ul> <li>Data Sources - K\u1ebft n\u1ed1i brokers</li> <li>API Keys - External services</li> </ul>"},{"location":"vi/configuration/api-keys/","title":"Kh\u00f3a API v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch ki\u1ec3m so\u00e1t quy\u1ec1n ghi v\u00e0o context broker trong tri\u1ec3n khai LegoCity v\u00e0 c\u00e1ch chia s\u1ebb kh\u00f3a API ho\u1eb7c token v\u1edbi c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt (update servers) v\u00e0 client \u0111\u1ecdc (read clients).</p> <p>N\u00f3 d\u00e0nh cho nh\u1eefng ng\u01b0\u1eddi:</p> <ul> <li>c\u1ea5u h\u00ecnh b\u1ea3o m\u1eadt tr\u00ean broker v\u00e0 proxy,</li> <li>v\u1eadn h\u00e0nh c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</li> <li>c\u1ea7n hi\u1ec3u c\u00e1ch qu\u1ea3n l\u00fd th\u00f4ng tin x\u00e1c th\u1ef1c (credentials) gi\u1eefa c\u00e1c m\u00f4i tr\u01b0\u1eddng.</li> </ul>"},{"location":"vi/configuration/api-keys/#cac-mo-hinh-truy-cap","title":"C\u00e1c m\u00f4 h\u00ecnh truy c\u1eadp","text":"<p>Trong LegoCity, c\u00f3 ba l\u1edbp truy c\u1eadp ch\u00ednh v\u00e0o broker v\u00e0 c\u00e1c API li\u00ean quan:</p> <ul> <li> <p>Quy\u1ec1n ghi v\u00e0o broker (Write access to the broker) \u00a0 \u0110\u01b0\u1ee3c c\u1ea5p ch\u1ec9 cho c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u00e0 c\u00f4ng c\u1ee5 qu\u1ea3n tr\u1ecb. \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt c\u00e1c th\u1ef1c th\u1ec3 NGSI-LD.</p> </li> <li> <p>Quy\u1ec1n \u0111\u1ecdc n\u1ed9i b\u1ed9 v\u00e0o broker (Internal read access to the broker) \u00a0 \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi proxy v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 n\u1ed9i b\u1ed9 \u0111\u1ec3 truy v\u1ea5n th\u1ef1c th\u1ec3. C\u00f3 th\u1ec3 c\u00f3 quy\u1ec1n r\u1ed9ng h\u01a1n nh\u01b0ng kh\u00f4ng \u0111\u01b0\u1ee3c l\u1ed9 ra tr\u00ecnh duy\u1ec7t.</p> </li> <li> <p>Quy\u1ec1n \u0111\u1ecdc c\u00f4ng khai qua proxy (Public read access via the proxy) \u00a0 \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi dashboard v\u00e0 b\u1ea5t k\u1ef3 client b\u00ean ngo\u00e0i n\u00e0o. B\u1ecb gi\u1edbi h\u1ea1n \u1edf c\u00e1c endpoint c\u1ee5 th\u1ec3, th\u01b0\u1eddng \u0111i k\u00e8m v\u1edbi gi\u1edbi h\u1ea1n t\u1ea7n su\u1ea5t (rate limits).</p> </li> </ul> <p>LegoCity khuy\u1ebfn ngh\u1ecb:</p> <ul> <li>gi\u1edbi h\u1ea1n quy\u1ec1n ghi cho m\u1ed9t nh\u00f3m nh\u1ecf c\u00e1c d\u1ecbch v\u1ee5 \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t,</li> <li>cung c\u1ea5p quy\u1ec1n \u0111\u1ecdc cho UI th\u00f4ng qua m\u1ed9t l\u1edbp proxy, kh\u00f4ng tr\u1ef1c ti\u1ebfp v\u00e0o broker.</li> </ul>"},{"location":"vi/configuration/api-keys/#cac-bien-cau-hinh","title":"C\u00e1c bi\u1ebfn c\u1ea5u h\u00ecnh","text":"<p>M\u1ed9t tri\u1ec3n khai n\u00ean chu\u1ea9n h\u00f3a c\u00e1ch truy\u1ec1n c\u00e1c endpoint broker v\u00e0 th\u00f4ng tin x\u00e1c th\u1ef1c v\u00e0o d\u1ecbch v\u1ee5.</p> <p>C\u00e1c bi\u1ebfn \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li> <p><code>BROKER_URL</code> \u00a0 URL c\u01a1 s\u1edf c\u1ee7a context broker NGSI-LD, v\u00ed d\u1ee5: \u00a0 <code>https://broker.example.com/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_KEY</code> ho\u1eb7c <code>BROKER_WRITE_TOKEN</code> \u00a0 Th\u00f4ng tin x\u00e1c th\u1ef1c (token, kh\u00f3a API, v.v.) cho quy\u1ec1n ghi.</p> </li> <li> <p><code>BROKER_READ_KEY</code> (t\u00f9y ch\u1ecdn) \u00a0 Th\u00f4ng tin x\u00e1c th\u1ef1c cho quy\u1ec1n \u0111\u1ecdc, n\u1ebfu broker b\u1eaft bu\u1ed9c x\u00e1c th\u1ef1c \u0111\u1ecdc.</p> </li> </ul> <p>C\u00e1c bi\u1ebfn n\u00e0y \u0111\u01b0\u1ee3c:</p> <ul> <li>\u0111\u1ecbnh ngh\u0129a theo m\u00f4i tr\u01b0\u1eddng (ph\u00e1t tri\u1ec3n, staging, s\u1ea3n xu\u1ea5t),</li> <li>thi\u1ebft l\u1eadp nh\u01b0 bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c l\u01b0u trong tr\u00ecnh qu\u1ea3n l\u00fd b\u00ed m\u1eadt (secret manager),</li> <li>kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c commit v\u00e0o kho m\u00e3 ngu\u1ed3n (source repository).</li> </ul> <p>V\u00ed d\u1ee5 <code>.env</code> cho ph\u00e1t tri\u1ec3n c\u1ee5c b\u1ed9:</p> <p>BROKER_URL=https://dev-broker.example.com/ngsi-ld/v1 \u00a0 \u00a0 BROKER_WRITE_KEY=dev-broker-write-key \u00a0 \u00a0 BROKER_READ_KEY=dev-broker-read-key</p> <p>C\u00e1c file <code>.env</code> n\u00ean b\u1ecb b\u1ecf qua b\u1edfi version control.</p>"},{"location":"vi/configuration/api-keys/#co-che-xac-thuc","title":"C\u01a1 ch\u1ebf x\u00e1c th\u1ef1c","text":"<p>C\u01a1 ch\u1ebf x\u00e1c th\u1ef1c th\u1ef1c t\u1ebf ph\u1ee5 thu\u1ed9c v\u00e0o broker v\u00e0 h\u1ea1 t\u1ea7ng \u0111\u01b0\u1ee3c ch\u1ecdn. C\u00e1c t\u00f9y ch\u1ecdn ph\u1ed5 bi\u1ebfn:</p> <ul> <li> <p>Kh\u00f3a API t\u0129nh ho\u1eb7c token (Static API keys or tokens) \u00a0 Kh\u00f3a \u0111\u01b0\u1ee3c g\u1eedi trong header nh\u01b0 <code>Authorization</code> ho\u1eb7c <code>X-API-Key</code>. \u0110\u01a1n gi\u1ea3n \u0111\u1ec3 c\u1ea5u h\u00ecnh.</p> </li> <li> <p>Mutual TLS (mTLS) \u00a0 Ch\u1ee9ng ch\u1ec9 client \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 x\u00e1c th\u1ef1c d\u1ecbch v\u1ee5. B\u1ea3o m\u1eadt m\u1ea1nh h\u01a1n, qu\u1ea3n l\u00fd ph\u1ee9c t\u1ea1p h\u01a1n.</p> </li> <li> <p>OAuth2 / OpenID Connect \u00a0 Token \u0111\u01b0\u1ee3c c\u1ea5p b\u1edfi nh\u00e0 cung c\u1ea5p \u0111\u1ecbnh danh (identity provider). H\u1eefu \u00edch khi broker l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a n\u1ec1n t\u1ea3ng l\u1edbn h\u01a1n c\u00f3 nh\u1eadn di\u1ec7n danh t\u00ednh.</p> </li> </ul> <p>LegoCity mong \u0111\u1ee3i r\u1eb1ng:</p> <ul> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt s\u1eed d\u1ee5ng c\u00e1c ph\u01b0\u01a1ng th\u1ee9c kh\u00f4ng t\u01b0\u01a1ng t\u00e1c (kh\u00f4ng \u0111\u0103ng nh\u1eadp th\u1ee7 c\u00f4ng),</li> <li>th\u00f4ng tin x\u00e1c th\u1ef1c c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh \u0111\u01b0\u1ee3c, kh\u00f4ng b\u1ecb hard-coded,</li> <li>c\u01a1 ch\u1ebf \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0 c\u00e1c header b\u1eaft bu\u1ed9c ph\u1ea3i \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u h\u00f3a cho vi\u1ec7c tri\u1ec3n khai.</li> </ul>"},{"location":"vi/configuration/api-keys/#cac-mau-khoa-ghi-write-keys-patterns","title":"C\u00e1c m\u1eabu kh\u00f3a ghi (Write keys patterns)","text":"<p>C\u00f3 nhi\u1ec1u c\u00e1ch \u0111\u1ec3 g\u00e1n kh\u00f3a ghi cho c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt. Tri\u1ec3n khai ph\u1ea3i ch\u1ecdn m\u1ed9t c\u00e1ch v\u00e0 t\u00e0i li\u1ec7u h\u00f3a n\u00f3.</p>"},{"location":"vi/configuration/api-keys/#mot-khoa-ghi-dung-chung-single-shared-write-key","title":"M\u1ed9t kh\u00f3a ghi d\u00f9ng chung (Single shared write key)","text":"<p>T\u1ea5t c\u1ea3 c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t kh\u00f3a ho\u1eb7c token \u0111\u1ec3 ghi v\u00e0o broker.</p> <p>\u0110\u1eb7c \u0111i\u1ec3m</p> <ul> <li>m\u1ed9t kh\u00f3a ghi cho m\u1ed7i broker ho\u1eb7c m\u1ed7i m\u00f4i tr\u01b0\u1eddng.</li> </ul> <p>\u01afu \u0111i\u1ec3m</p> <ul> <li>\u0111\u01a1n gi\u1ea3n \u0111\u1ec3 hi\u1ec3u,</li> <li>chi ph\u00ed qu\u1ea3n tr\u1ecb th\u1ea5p.</li> </ul> <p>Nh\u01b0\u1ee3c \u0111i\u1ec3m</p> <ul> <li>n\u1ebfu m\u1ed9t m\u00e1y ch\u1ee7 b\u1ecb x\u00e2m nh\u1eadp, c\u00f9ng m\u1ed9t kh\u00f3a c\u00f3 th\u1ec3 b\u1ecb l\u1ea1m d\u1ee5ng t\u1eeb b\u1ea5t c\u1ee9 \u0111\u00e2u,</li> <li>thu h\u1ed3i kh\u00f3a y\u00eau c\u1ea7u c\u1eadp nh\u1eadt t\u1ea5t c\u1ea3 m\u00e1y ch\u1ee7 c\u00f9ng l\u00fac.</li> </ul> <p>Ph\u00f9 h\u1ee3p cho c\u00e1c tri\u1ec3n khai nh\u1ecf ho\u1eb7c nguy\u00ean m\u1eabu (prototypes).</p>"},{"location":"vi/configuration/api-keys/#khoa-rieng-cho-tung-may-chu-cap-nhat-separate-keys-per-update-server","title":"Kh\u00f3a ri\u00eang cho t\u1eebng m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt (Separate keys per update server)","text":"<p>M\u1ed7i m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt c\u00f3 kh\u00f3a ghi ho\u1eb7c token ri\u00eang.</p> <p>\u0110\u1eb7c \u0111i\u1ec3m</p> <ul> <li>th\u00f4ng tin x\u00e1c th\u1ef1c kh\u00e1c nhau cho m\u1ed7i m\u00e1y ch\u1ee7 domain (<code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>, v.v.).</li> </ul> <p>\u01afu \u0111i\u1ec3m</p> <ul> <li>vi\u1ec7c x\u00e2m nh\u1eadp m\u1ed9t m\u00e1y ch\u1ee7 kh\u00f4ng l\u00e0m l\u1ed9 quy\u1ec1n ghi c\u1ee7a c\u00e1c m\u00e1y ch\u1ee7 kh\u00e1c,</li> <li>quy\u1ec1n truy c\u1eadp c\u00f3 th\u1ec3 b\u1ecb thu h\u1ed3i cho m\u1ed9t m\u00e1y ch\u1ee7 duy nh\u1ea5t m\u00e0 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn ph\u1ea7n c\u00f2n l\u1ea1i,</li> <li>c\u00f3 th\u1ec3 g\u00e1n c\u00e1c ph\u1ea1m vi (scopes) kh\u00e1c nhau cho m\u1ed7i kh\u00f3a.</li> </ul> <p>Nh\u01b0\u1ee3c \u0111i\u1ec3m</p> <ul> <li>nhi\u1ec1u th\u00f4ng tin x\u00e1c th\u1ef1c h\u01a1n \u0111\u1ec3 qu\u1ea3n l\u00fd,</li> <li>c\u1ea7n nhi\u1ec1u t\u00e0i li\u1ec7u h\u01a1n \u0111\u1ec3 theo d\u00f5i quy\u1ec1n s\u1edf h\u1eefu.</li> </ul> <p>\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho c\u00e1c tri\u1ec3n khai nghi\u00eam t\u00fac.</p>"},{"location":"vi/configuration/api-keys/#cac-mau-lai-hybrid-patterns","title":"C\u00e1c m\u1eabu lai (Hybrid patterns)","text":"<p>M\u1ed9t s\u1ed1 tri\u1ec3n khai c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t kh\u00f3a cho m\u1ed7i domain:</p> <ul> <li>m\u1ed9t kh\u00f3a cho c\u00e1c m\u00e1y ch\u1ee7 li\u00ean quan \u0111\u1ebfn m\u00f4i tr\u01b0\u1eddng (environment),</li> <li>m\u1ed9t kh\u00f3a cho n\u01b0\u1edbc v\u00e0 ng\u1eadp l\u1ee5t,</li> <li>m\u1ed9t kh\u00f3a cho di chuy\u1ec3n (mobility).</li> </ul> <p>\u0110i\u1ec3m quan tr\u1ecdng l\u00e0 m\u1eabu ph\u1ea3i \u1ed5n \u0111\u1ecbnh, \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u h\u00f3a v\u00e0 ph\u1ea3n \u00e1nh trong gi\u00e1m s\u00e1t v\u00e0 ph\u1ea3n \u1ee9ng s\u1ef1 c\u1ed1.</p>"},{"location":"vi/configuration/api-keys/#luu-tru-va-phan-phoi","title":"L\u01b0u tr\u1eef v\u00e0 ph\u00e2n ph\u1ed1i","text":"<p>B\u1ea5t k\u1ec3 m\u1eabu n\u00e0o, kh\u00f3a ph\u1ea3i \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef v\u00e0 ph\u00e2n ph\u1ed1i an to\u00e0n.</p>"},{"location":"vi/configuration/api-keys/#luu-tru-chap-nhan-uoc","title":"L\u01b0u tr\u1eef ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c","text":"<ul> <li>bi\u1ebfn m\u00f4i tr\u01b0\u1eddng \u0111\u01b0\u1ee3c ti\u00eam v\u00e0o (injected) t\u1ea1i th\u1eddi \u0111i\u1ec3m tri\u1ec3n khai,</li> <li>tr\u00ecnh qu\u1ea3n l\u00fd b\u00ed m\u1eadt (secret managers) \u0111\u01b0\u1ee3c cung c\u1ea5p b\u1edfi n\u1ec1n t\u1ea3ng \u0111\u00e1m m\u00e2y,</li> <li>kho c\u1ea5u h\u00ecnh an to\u00e0n, t\u00e1ch bi\u1ec7t kh\u1ecfi image \u1ee9ng d\u1ee5ng.</li> </ul>"},{"location":"vi/configuration/api-keys/#luu-tru-khong-chap-nhan-uoc","title":"L\u01b0u tr\u1eef kh\u00f4ng ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c","text":"<ul> <li>kh\u00f3a b\u1ecb hard-coded trong m\u00e3 ngu\u1ed3n,</li> <li>kh\u00f3a \u0111\u01b0\u1ee3c commit v\u00e0o kho git,</li> <li>kh\u00f3a \u0111\u01b0\u1ee3c chia s\u1ebb kh\u00f4ng ch\u00ednh th\u1ee9c qua c\u00e1c k\u00eanh kh\u00f4ng m\u00e3 h\u00f3a.</li> </ul>"},{"location":"vi/configuration/api-keys/#cau-hinh-vi-du","title":"C\u1ea5u h\u00ecnh v\u00ed d\u1ee5","text":"<p>Cho ba m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt:</p> <ul> <li><code>env-weather-server</code></li> </ul> <p>- <code>BROKER_URL</code> \u00a0 - <code>BROKER_WRITE_KEY_ENV</code></p> <ul> <li><code>water-flood-server</code></li> </ul> <p>- <code>BROKER_URL</code> \u00a0 - <code>BROKER_WRITE_KEY_WATER</code></p> <ul> <li><code>mobility-parking-server</code> \u00a0 - <code>BROKER_URL</code> \u00a0 - <code>BROKER_WRITE_KEY_MOBILITY</code></li> </ul> <p>M\u1ed7i d\u1ecbch v\u1ee5 \u0111\u1ecdc c\u1ea5u h\u00ecnh c\u1ee7a n\u00f3 t\u1eeb m\u00f4i tr\u01b0\u1eddng ho\u1eb7c tr\u00ecnh qu\u1ea3n l\u00fd b\u00ed m\u1eadt khi kh\u1edfi \u0111\u1ed9ng.</p>"},{"location":"vi/configuration/api-keys/#xoay-vong-khoa-key-rotation","title":"Xoay v\u00f2ng kh\u00f3a (Key rotation)","text":"<p>Xoay v\u00f2ng kh\u00f3a thay th\u1ebf c\u00e1c kh\u00f3a hi\u1ec7n c\u00f3 b\u1eb1ng kh\u00f3a m\u1edbi m\u00e0 kh\u00f4ng l\u00e0m gi\u00e1n \u0111o\u1ea1n d\u1ecbch v\u1ee5 l\u00e2u d\u00e0i.</p> <p>Quy tr\u00ecnh xoay v\u00f2ng \u0111\u01a1n gi\u1ea3n:</p> <ol> <li> <p>T\u1ea1o kh\u00f3a m\u1edbi (Generate new keys) \u00a0 \u00a0T\u1ea1o kh\u00f3a ho\u1eb7c token m\u1edbi t\u1ea1i broker ho\u1eb7c gateway. L\u01b0u ch\u00fang v\u00e0o tr\u00ecnh qu\u1ea3n l\u00fd b\u00ed m\u1eadt ho\u1eb7c h\u1ec7 th\u1ed1ng c\u1ea5u h\u00ecnh.</p> </li> <li> <p>C\u1eadp nh\u1eadt d\u1ecbch v\u1ee5 (Update services) \u00a0 \u00a0C\u1eadp nh\u1eadt bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c config cho m\u1ed7i m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt \u0111\u1ec3 s\u1eed d\u1ee5ng kh\u00f3a m\u1edbi. Kh\u1edfi \u0111\u1ed9ng l\u1ea1i ho\u1eb7c t\u1ea3i l\u1ea1i c\u00e1c m\u00e1y ch\u1ee7.</p> </li> <li> <p>X\u00e1c minh ho\u1ea1t \u0111\u1ed9ng (Verify operation) \u00a0 \u00a0Ki\u1ec3m tra r\u1eb1ng c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt ti\u1ebfp t\u1ee5c ghi th\u1ef1c th\u1ec3 th\u00e0nh c\u00f4ng. Gi\u00e1m s\u00e1t log v\u00e0 metrics cho l\u1ed7i ghi.</p> </li> <li> <p>Thu h\u1ed3i kh\u00f3a c\u0169 (Revoke old keys) \u00a0 \u00a0Khi t\u1ea5t c\u1ea3 d\u1ecbch v\u1ee5 \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn \u0111ang s\u1eed d\u1ee5ng kh\u00f3a m\u1edbi, x\u00f3a ho\u1eb7c v\u00f4 hi\u1ec7u h\u00f3a c\u00e1c kh\u00f3a c\u0169.</p> </li> </ol> <p>T\u00e0i li\u1ec7u n\u00ean n\u00eau r\u00f5:</p> <ul> <li>n\u01a1i kh\u00f3a \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a,</li> <li>ai \u0111\u01b0\u1ee3c ph\u00e9p xoay v\u00f2ng ch\u00fang,</li> <li>c\u00e1c t\u00edn hi\u1ec7u gi\u00e1m s\u00e1t n\u00e0o ch\u1ec9 ra vi\u1ec7c xoay v\u00f2ng th\u1ea5t b\u1ea1i.</li> </ul>"},{"location":"vi/configuration/api-keys/#quyen-oc-va-proxy","title":"Quy\u1ec1n \u0111\u1ecdc v\u00e0 proxy","text":"<p>Quy\u1ec1n ghi v\u00e0 quy\u1ec1n \u0111\u1ecdc ph\u1ea3i \u0111\u01b0\u1ee3c x\u1eed l\u00fd kh\u00e1c nhau.</p>"},{"location":"vi/configuration/api-keys/#quyen-oc-noi-bo-internal-read-access","title":"Quy\u1ec1n \u0111\u1ecdc n\u1ed9i b\u1ed9 (Internal read access)","text":"<p>C\u00e1c d\u1ecbch v\u1ee5 n\u1ed9i b\u1ed9 (proxy, analytics) c\u00f3 th\u1ec3 \u0111\u1ecdc tr\u1ef1c ti\u1ebfp t\u1eeb broker. T\u00f9y thu\u1ed9c v\u00e0o c\u1ea5u h\u00ecnh, ho\u1ea1t \u0111\u1ed9ng \u0111\u1ecdc c\u00f3 th\u1ec3:</p> <ul> <li>kh\u00f4ng h\u1ea1n ch\u1ebf b\u00ean trong m\u1ea1ng tin c\u1eady, ho\u1eb7c</li> <li>\u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 b\u1edfi kh\u00f3a ho\u1eb7c token ch\u1ec9 \u0111\u1ecdc (read-only key).</li> </ul> <p>Jika m\u1ed9t kh\u00f3a ch\u1ec9 \u0111\u1ecdc \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, n\u00f3 n\u00ean:</p> <ul> <li>kh\u00e1c bi\u1ec7t v\u1edbi kh\u00f3a ghi,</li> <li>kh\u00f4ng b\u1ecb l\u1ed9 ra tr\u00ecnh duy\u1ec7t.</li> </ul>"},{"location":"vi/configuration/api-keys/#quyen-oc-cong-khai-qua-proxy-public-read-access-via-proxy","title":"Quy\u1ec1n \u0111\u1ecdc c\u00f4ng khai qua proxy (Public read access via proxy)","text":"<p>Dashboard v\u00e0 c\u00e1c client c\u00f4ng khai n\u00ean g\u1ecdi proxy, kh\u00f4ng tr\u1ef1c ti\u1ebfp g\u1ecdi broker. Proxy:</p> <ul> <li>th\u1ef1c hi\u1ec7n truy v\u1ea5n \u0111\u1ecdc t\u1edbi broker,</li> <li>chuy\u1ec3n \u0111\u1ed5i ph\u1ea3n h\u1ed3i th\u00e0nh c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n h\u01a1n,</li> <li>th\u1ef1c thi caching, gi\u1edbi h\u1ea1n t\u1ea7n su\u1ea5t (rate limits) v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp.</li> </ul> <p>Th\u00f4ng tin x\u00e1c th\u1ef1c broker (\u0111\u1ecdc ho\u1eb7c ghi) kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c nh\u00fang trong m\u00e3 frontend. Tr\u00ecnh duy\u1ec7t ch\u1ec9 th\u1ea5y URL proxy v\u00e0 b\u1ea5t k\u1ef3 kh\u00f3a c\u1ea5p proxy ho\u1eb7c c\u01a1 ch\u1ebf x\u00e1c th\u1ef1c ng\u01b0\u1eddi d\u00f9ng n\u00e0o.</p>"},{"location":"vi/configuration/api-keys/#kich-ban-vi-du","title":"K\u1ecbch b\u1ea3n v\u00ed d\u1ee5","text":"<p>Xem x\u00e9t m\u1ed9t tri\u1ec3n khai v\u1edbi:</p> <ul> <li>m\u1ed9t broker t\u1ea1i <code>https://broker.city.example/ngsi-ld/v1</code>,</li> <li>ba m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt: <code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>,</li> <li>m\u1ed9t proxy t\u1ea1i <code>https://api.city.example</code>.</li> </ul>"},{"location":"vi/configuration/api-keys/#broker","title":"Broker","text":"<p>Token ghi \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh t\u1ea1i broker ho\u1eb7c gateway:</p> <ul> <li><code>TOKEN_ENV</code> cho c\u00e1c th\u1ef1c th\u1ec3 m\u00f4i tr\u01b0\u1eddng,</li> <li><code>TOKEN_WATER</code> cho c\u00e1c th\u1ef1c th\u1ec3 n\u01b0\u1edbc v\u00e0 ng\u1eadp l\u1ee5t,</li> <li><code>TOKEN_MOBILITY</code> cho c\u00e1c th\u1ef1c th\u1ec3 di chuy\u1ec3n.</li> </ul>"},{"location":"vi/configuration/api-keys/#may-chu-cap-nhat-update-servers","title":"M\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt (Update servers)","text":"<ul> <li><code>env-weather-server</code></li> </ul> <p>- <code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code> \u00a0 - <code>BROKER_WRITE_TOKEN=TOKEN_ENV</code></p> <ul> <li><code>water-flood-server</code></li> </ul> <p>- <code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code> \u00a0 - <code>BROKER_WRITE_TOKEN=TOKEN_WATER</code></p> <ul> <li><code>mobility-parking-server</code> \u00a0 - <code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code> \u00a0 - <code>BROKER_WRITE_TOKEN=TOKEN_MOBILITY</code></li> </ul> <p>M\u1ed7i m\u00e1y ch\u1ee7 g\u1eedi token c\u1ee7a n\u00f3 trong header th\u00edch h\u1ee3p khi ghi th\u1ef1c th\u1ec3.</p>"},{"location":"vi/configuration/api-keys/#proxy","title":"Proxy","text":"<ul> <li>ch\u1ea1y t\u1ea1i <code>https://api.city.example</code>,</li> <li>s\u1eed d\u1ee5ng th\u00f4ng tin x\u00e1c th\u1ef1c n\u1ed9i b\u1ed9 ho\u1eb7c m\u1ea1ng tin c\u1eady \u0111\u1ec3 truy v\u1ea5n broker,</li> <li>ph\u01a1i b\u00e0y c\u00e1c endpoint nh\u01b0: \u00a0 - <code>/map/weather</code> \u00a0 - <code>/map/flood-zones</code> \u00a0 - <code>/map/parking-facilities</code></li> </ul> <p>Dashboard g\u1ecdi c\u00e1c endpoint n\u00e0y v\u00e0 kh\u00f4ng bao gi\u1edd th\u1ea5y token c\u1ea5p broker.</p>"},{"location":"vi/configuration/api-keys/#xu-ly-su-co-incident-handling","title":"X\u1eed l\u00fd s\u1ef1 c\u1ed1 (Incident handling)","text":"<p>N\u1ebfu m\u1ed9t kh\u00f3a b\u1ecb l\u1ed9 ho\u1eb7c nghi ng\u1edd b\u1ecb x\u00e2m nh\u1eadp:</p> <ul> <li>x\u00e1c \u0111\u1ecbnh kh\u00f3a n\u00e0o b\u1ecb l\u1ed9 v\u00e0 d\u1ecbch v\u1ee5 n\u00e0o s\u1eed d\u1ee5ng n\u00f3,</li> <li>thu h\u1ed3i ho\u1eb7c v\u00f4 hi\u1ec7u h\u00f3a kh\u00f3a t\u1ea1i broker ho\u1eb7c gateway,</li> <li>t\u1ea1o v\u00e0 ph\u00e2n ph\u1ed1i kh\u00f3a thay th\u1ebf n\u1ebfu c\u1ea7n thi\u1ebft,</li> <li>c\u1eadp nh\u1eadt c\u1ea5u h\u00ecnh v\u00e0 kh\u1edfi \u0111\u1ed9ng l\u1ea1i c\u00e1c d\u1ecbch v\u1ee5 b\u1ecb \u1ea3nh h\u01b0\u1edfng,</li> <li>xem x\u00e9t log \u0111\u1ec3 t\u00ecm c\u00e1c n\u1ed7 l\u1ef1c ghi tr\u00e1i ph\u00e9p ho\u1eb7c c\u00e1c m\u1eabu kh\u1ea3 nghi.</li> </ul> <p>T\u00e0i li\u1ec7u n\u00ean ch\u1ec9 ra:</p> <ul> <li>n\u01a1i kh\u00f3a c\u00f3 th\u1ec3 b\u1ecb thu h\u1ed3i,</li> <li>log ho\u1eb7c dashboard n\u00e0o hi\u1ec3n th\u1ecb quy\u1ec1n truy c\u1eadp broker,</li> <li>c\u00e1ch x\u00e1c minh r\u1eb1ng c\u00e1c th\u1ef1c th\u1ec3 ch\u01b0a b\u1ecb h\u1ecfng.</li> </ul>"},{"location":"vi/configuration/api-keys/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt l\u00e0 th\u00e0nh ph\u1ea7n duy nh\u1ea5t c\u00f3 quy\u1ec1n ghi v\u00e0o broker v\u00e0 s\u1eed d\u1ee5ng kh\u00f3a ho\u1eb7c token \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a qua c\u1ea5u h\u00ecnh, kh\u00f4ng ph\u1ea3i trong m\u00e3.</li> <li>M\u1ed9t tri\u1ec3n khai ph\u1ea3i ch\u1ecdn v\u00e0 t\u00e0i li\u1ec7u h\u00f3a m\u1ed9t m\u1eabu r\u00f5 r\u00e0ng cho c\u00e1c kh\u00f3a ghi (d\u00f9ng chung, m\u1ed7i m\u00e1y ch\u1ee7, ho\u1eb7c lai).</li> <li>Kh\u00f3a ph\u1ea3i \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef an to\u00e0n, xoay v\u00f2ng th\u01b0\u1eddng xuy\u00ean, v\u00e0 thu h\u1ed3i ngay l\u1eadp t\u1ee9c n\u1ebfu b\u1ecb x\u00e2m nh\u1eadp.</li> <li>Dashboard v\u00e0 client c\u00f4ng khai l\u1ea5y d\u1eef li\u1ec7u th\u00f4ng qua proxy; th\u00f4ng tin x\u00e1c th\u1ef1c broker kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c l\u1ed9 ra tr\u00ecnh duy\u1ec7t.</li> <li>Quy\u1ec1n \u0111\u1ecdc n\u1ed9i b\u1ed9, quy\u1ec1n \u0111\u1ecdc b\u00ean ngo\u00e0i, v\u00e0 quy\u1ec1n ghi n\u00ean \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh v\u00e0 gi\u00e1m s\u00e1t ri\u00eang bi\u1ec7t.</li> </ul>"},{"location":"vi/configuration/data-sources/","title":"Data and brokers","text":"<p>Trang n\u00e0y gi\u1ea3i th\u00edch chi ti\u1ebft c\u00e1ch t\u1ea7ng d\u1eef li\u1ec7u (data layer) c\u1ee7a LegoCity \u0111\u01b0\u1ee3c t\u1ed5 ch\u1ee9c xung quanh NGSI-LD context broker v\u00e0 update server.</p> <p>T\u1eadp trung v\u00e0o:</p> <ul> <li>broker c\u1ea7n l\u01b0u tr\u1eef v\u00e0 cung c\u1ea5p nh\u1eefng g\u00ec,</li> <li>d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c nh\u00f3m th\u00e0nh domain nh\u01b0 th\u1ebf n\u00e0o,</li> <li>c\u00e1ch thi\u1ebft k\u1ebf v\u00e0 v\u1eadn h\u00e0nh update server,</li> <li>c\u00e1ch ra quy\u1ebft \u0111\u1ecbnh v\u1ec1 history, ch\u1ea5t l\u01b0\u1ee3ng d\u1eef li\u1ec7u v\u00e0 source-of-truth.</li> </ul> <p>Trang n\u00e0y kh\u00f4ng \u0111\u1ec1 c\u1eadp l\u1ec7nh tri\u1ec3n khai hay t\u1ef1 \u0111\u1ed9ng h\u00f3a h\u1ea1 t\u1ea7ng; nh\u1eefng ph\u1ea7n \u0111\u00f3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong m\u1ee5c Deployment.</p>"},{"location":"vi/configuration/data-sources/#1-overall-data-flow","title":"1. Overall data flow","text":"<p>Lu\u1ed3ng d\u1eef li\u1ec7u c\u01a1 b\u1ea3n trong m\u1ed9t deployment LegoCity:</p> <ol> <li>M\u1ed9t h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i (v\u00ed d\u1ee5: weather API, sensor gateway, m\u00f4 h\u00ecnh l\u0169, lu\u1ed3ng d\u1eef li\u1ec7u giao th\u00f4ng) cung c\u1ea5p d\u1eef li\u1ec7u th\u00f4 (raw data).</li> <li>M\u1ed9t update server cho domain \u0111\u00f3 \u0111\u1ecdc d\u1eef li\u1ec7u th\u00f4 theo l\u1ecbch (schedule).</li> <li>Update server chuy\u1ec3n d\u1eef li\u1ec7u th\u00f4 th\u00e0nh c\u00e1c NGSI-LD entity tu\u00e2n theo c\u00e1c model v\u00e0 convention \u0111\u00e3 th\u1ed1ng nh\u1ea5t.</li> <li>Update server ghi c\u00e1c entity \u0111\u00f3 v\u00e0o context broker.</li> <li>Dashboard v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 \u1ee9ng d\u1ee5ng kh\u00e1c \u0111\u1ecdc entity t\u1eeb broker (th\u01b0\u1eddng th\u00f4ng qua m\u1ed9t proxy) v\u00e0 chuy\u1ec3n ch\u00fang th\u00e0nh c\u00e1c l\u1edbp b\u1ea3n \u0111\u1ed3 (map layer) v\u00e0 th\u00e0nh ph\u1ea7n UI.</li> </ol> <p>Nh\u1eefng r\u00e0ng bu\u1ed9c quan tr\u1ecdng:</p> <ul> <li>trong v\u1eadn h\u00e0nh b\u00ecnh th\u01b0\u1eddng, ch\u1ec9 update server m\u1edbi ghi (write) v\u00e0o broker,</li> <li>broker l\u00e0 ngu\u1ed3n duy nh\u1ea5t m\u00e0 dashboard d\u00f9ng \u0111\u1ec3 \u0111\u1ecdc city context,</li> <li>n\u1ebfu m\u1ed9t th\u1ee9 kh\u00f4ng n\u1eb1m trong broker th\u00ec n\u00f3 coi nh\u01b0 kh\u00f4ng t\u1ed3n t\u1ea1i t\u1eeb g\u00f3c nh\u00ecn c\u1ee7a LegoCity.</li> </ul>"},{"location":"vi/configuration/data-sources/#2-context-broker-role","title":"2. Context broker role","text":"<p>Context broker ch\u1ecbu tr\u00e1ch nhi\u1ec7m:</p> <ul> <li>l\u01b0u tr\u1eef to\u00e0n b\u1ed9 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i (current state) c\u1ee7a c\u00e1c city entity m\u00e0 LegoCity c\u1ea7n,</li> <li>cung c\u1ea5p m\u1ed9t NGSI-LD API chu\u1ea9n cho create, update, query v\u00e0 subscription,</li> <li>cung c\u1ea5p m\u1ed9t g\u00f3c nh\u00ecn nh\u1ea5t qu\u00e1n, chu\u1ea9n h\u00f3a (canonical) v\u1ec1 \u201cth\u00e0nh ph\u1ed1 tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0o ngay b\u00e2y gi\u1edd\u201d.</li> </ul> <p>T\u1eeb g\u00f3c nh\u00ecn LegoCity, broker ph\u1ea3i:</p> <ul> <li>l\u01b0u tr\u1eef entity cho t\u1ea5t c\u1ea3 c\u00e1c domain n\u1eb1m trong ph\u1ea1m vi (v\u00ed d\u1ee5: environment, flooding, mobility, public services),</li> <li>h\u1ed7 tr\u1ee3 geospatial query v\u00e0 l\u1ecdc theo c\u00e1c thu\u1ed9c t\u00ednh (attribute) m\u00e0 UI s\u1ebd c\u1ea7n,</li> <li>x\u1eed l\u00fd \u0111\u01b0\u1ee3c volume v\u00e0 t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt d\u1ef1 ki\u1ebfn c\u1ee7a c\u00e1c entity.</li> </ul> <p>Broker kh\u00f4ng \u0111\u01b0\u1ee3c k\u1ef3 v\u1ecdng s\u1ebd:</p> <ul> <li>th\u1ef1c hi\u1ec7n c\u00e1c ph\u00e2n t\u00edch n\u1eb7ng (heavy analytics),</li> <li>render b\u1ea3n \u0111\u1ed3,</li> <li>hi\u1ec3u c\u00e1c kh\u00e1i ni\u1ec7m UI nh\u01b0 page, block hay permission b\u00ean trong dashboard.</li> </ul> <p>Nh\u1eefng m\u1ed1i quan t\u00e2m \u0111\u00f3 thu\u1ed9c v\u1ec1 c\u00e1c th\u00e0nh ph\u1ea7n ngo\u00e0i broker.</p>"},{"location":"vi/configuration/data-sources/#21-what-is-stored-in-the-broker","title":"2.1 What is stored in the broker","text":"<p>V\u1edbi m\u1ed7i domain, broker l\u01b0u tr\u1eef:</p> <ul> <li>entity identifier bi\u1ec3u di\u1ec5n c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng ho\u1eb7c quan tr\u1eafc (observation) trong th\u1ebf gi\u1edbi th\u1ef1c,</li> <li>gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a c\u00e1c attribute (status, measurement, capacity, \u2026),</li> <li>c\u00e1c thu\u1ed9c t\u00ednh kh\u00f4ng gian (geospatial attributes: location, geometry, coverage area),</li> <li>timestamp cho bi\u1ebft th\u1eddi \u0111i\u1ec3m th\u00f4ng tin \u0111\u01b0\u1ee3c quan s\u00e1t ho\u1eb7c \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt l\u1ea7n cu\u1ed1i.</li> </ul> <p>V\u00ed d\u1ee5 nh\u1eefng th\u1ee9 thu\u1ed9c ph\u1ea1m vi broker:</p> <ul> <li>\u201cC\u00f3 m\u1ed9t flood zone v\u1edbi polygon n\u00e0y v\u00e0 m\u1ee9c \u0111\u1ed9 r\u1ee7i ro hi\u1ec7n t\u1ea1i n\u00e0y.\u201d</li> <li>\u201cC\u00f3 m\u1ed9t parking facility v\u1edbi s\u1ee9c ch\u1ee9a n\u00e0y v\u00e0 m\u1ee9c \u0111\u1ed9 chi\u1ebfm d\u1ee5ng hi\u1ec7n t\u1ea1i n\u00e0y.\u201d</li> <li>\u201cC\u00f3 m\u1ed9t weather observation t\u1ea1i v\u1ecb tr\u00ed n\u00e0y v\u1edbi nhi\u1ec7t \u0111\u1ed9 v\u00e0 \u0111\u1ed9 \u1ea9m nh\u01b0 sau.\u201d</li> </ul> <p>N\u1ebfu dashboard c\u1ea7n hi\u1ec3n th\u1ecb m\u1ed9t gi\u00e1 tr\u1ecb cho ng\u01b0\u1eddi d\u00f9ng, gi\u00e1 tr\u1ecb \u0111\u00f3 ph\u1ea3i c\u00f3 m\u1eb7t ho\u1eb7c suy ra \u0111\u01b0\u1ee3c t\u1eeb c\u00e1c entity trong broker.</p>"},{"location":"vi/configuration/data-sources/#22-what-is-not-stored-in-the-broker","title":"2.2 What is not stored in the broker","text":"<p>Broker kh\u00f4ng b\u1eaft bu\u1ed9c ph\u1ea3i l\u01b0u:</p> <ul> <li>c\u1ea5u h\u00ecnh UI (map style, default visibility c\u1ee7a layer, b\u1ed1 c\u1ee5c panel),</li> <li>t\u00e0i kho\u1ea3n ng\u01b0\u1eddi d\u00f9ng, role hay permission,</li> <li>t\u00e0i li\u1ec7u ho\u1eb7c n\u1ed9i dung m\u00f4 t\u1ea3 ch\u1ec9 li\u00ean quan t\u1edbi admin UI.</li> </ul> <p>Nh\u1eefng th\u1ee9 n\u00e0y thu\u1ed9c v\u1ec1 PayloadCMS ho\u1eb7c c\u00e1c ph\u1ea7n kh\u00e1c trong LegoCity stack.</p>"},{"location":"vi/configuration/data-sources/#3-broker-topology","title":"3. Broker topology","text":"<p>M\u1ed9t deployment LegoCity ph\u1ea3i quy\u1ebft \u0111\u1ecbnh ch\u1ea1y bao nhi\u00eau broker v\u00e0 m\u1ed7i broker ch\u1ecbu tr\u00e1ch nhi\u1ec7m g\u00ec. \u0110\u00e2y l\u00e0 quy\u1ebft \u0111\u1ecbnh mang t\u00ednh c\u1ea5u tr\u00fac, \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn m\u1ecdi ph\u1ea7n kh\u00e1c c\u1ee7a h\u1ec7 th\u1ed1ng.</p>"},{"location":"vi/configuration/data-sources/#31-single-broker-deployments","title":"3.1 Single-broker deployments","text":"<p>Trong m\u1ed9t deployment single-broker:</p> <ul> <li>m\u1ed9t instance broker l\u01b0u t\u1ea5t c\u1ea3 entity c\u1ee7a deployment (t\u1ea5t c\u1ea3 domain, t\u1ea5t c\u1ea3 khu v\u1ef1c),</li> <li>t\u1ea5t c\u1ea3 update server ghi v\u00e0o broker \u0111\u00f3,</li> <li>t\u1ea5t c\u1ea3 dashboard v\u00e0 application service \u0111\u1ecdc t\u1eeb broker \u0111\u00f3.</li> </ul> <p>C\u00e1ch n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c d\u00f9ng m\u1eb7c \u0111\u1ecbnh cho:</p> <ul> <li>proof of concept,</li> <li>c\u00e1c deployment nh\u1ecf \u0111\u1ebfn v\u1eeba,</li> <li>m\u1ed9t th\u00e0nh ph\u1ed1 ho\u1eb7c m\u1ed9t campus \u0111\u01a1n l\u1ebb.</li> </ul> <p>\u01afu \u0111i\u1ec3m:</p> <ul> <li>\u00edt endpoint c\u1ea7n c\u1ea5u h\u00ecnh h\u01a1n,</li> <li>monitoring v\u00e0 logging \u0111\u01a1n gi\u1ea3n h\u01a1n,</li> <li>d\u1ec5 cho th\u00e0nh vi\u00ean m\u1edbi c\u1ee7a team hi\u1ec3u h\u1ec7 th\u1ed1ng.</li> </ul> <p>R\u1ee7i ro v\u00e0 r\u00e0ng bu\u1ed9c:</p> <ul> <li>n\u1ebfu broker b\u1ecb down, m\u1ecdi domain \u0111\u1ec1u b\u1ecb \u1ea3nh h\u01b0\u1edfng,</li> <li>t\u1ea5t c\u1ea3 domain chia s\u1ebb c\u00f9ng gi\u1edbi h\u1ea1n v\u1ec1 hi\u1ec7u n\u0103ng v\u00e0 kh\u1ea3 n\u0103ng scale,</li> <li>c\u1ea7n \u0111\u1eb7t t\u00ean v\u00e0 ph\u00e2n ph\u1ea1m vi c\u1ea9n th\u1eadn \u0111\u1ec3 tr\u00e1nh xung \u0111\u1ed9t gi\u1eefa c\u00e1c domain.</li> </ul> <p>Trong th\u1ef1c t\u1ebf, m\u1ed9t deployment single-broker v\u1eabn n\u00ean t\u00e1ch m\u00f4i tr\u01b0\u1eddng, v\u00ed d\u1ee5: m\u1ed9t broker cho development v\u00e0 m\u1ed9t broker cho production.</p>"},{"location":"vi/configuration/data-sources/#32-multi-broker-deployments","title":"3.2 Multi-broker deployments","text":"<p>Trong m\u1ed9t deployment multi-broker, c\u00e1c broker kh\u00e1c nhau \u0111\u01b0\u1ee3c d\u00f9ng cho c\u00e1c ph\u1ea1m vi (scope) kh\u00e1c nhau. C\u00e1c pattern th\u01b0\u1eddng g\u1eb7p:</p> <ul> <li>m\u1ed9t broker cho m\u1ed7i environment (development, staging, production),</li> <li>m\u1ed9t broker cho m\u1ed7i th\u00e0nh ph\u1ed1 ho\u1eb7c v\u00f9ng h\u00e0nh ch\u00ednh,</li> <li>m\u1ed9t broker d\u00e0nh cho high-frequency telemetry v\u00e0 m\u1ed9t broker kh\u00e1c cho d\u1eef li\u1ec7u tham chi\u1ebfu t\u0129nh h\u01a1n (reference data).</li> </ul> <p>\u01afu \u0111i\u1ec3m:</p> <ul> <li>t\u00e1ch b\u1ea1ch r\u00f5 r\u00e0ng gi\u1eefa c\u00e1c m\u00f4i tr\u01b0\u1eddng ho\u1eb7c c\u00e1c th\u00e0nh ph\u1ed1,</li> <li>c\u00f3 th\u1ec3 tinh ch\u1ec9nh (tuning) v\u00e0 policy retention kh\u00e1c nhau cho t\u1eebng broker,</li> <li>s\u1ef1 c\u1ed1 \u1edf m\u1ed9t broker kh\u00f4ng l\u1eadp t\u1ee9c \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn t\u1ea5t c\u1ea3 domain.</li> </ul> <p>Chi ph\u00ed v\u00e0 r\u00e0ng bu\u1ed9c:</p> <ul> <li>nhi\u1ec1u endpoint v\u00e0 credential ph\u1ea3i qu\u1ea3n l\u00fd h\u01a1n,</li> <li>update server ph\u1ea3i bi\u1ebft broker n\u00e0o \u0111\u1ec3 ghi v\u00e0o,</li> <li>dashboard v\u00e0 proxy ph\u1ea3i \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh \u0111\u1ec3 query \u0111\u00fang broker cho t\u1eebng context.</li> </ul> <p>T\u00e0i li\u1ec7u c\u1ee7a m\u1ed9t deployment LegoCity n\u00ean li\u1ec7t k\u00ea r\u00f5:</p> <ul> <li>t\u1eebng broker instance (t\u00ean v\u00e0 base URL),</li> <li>m\u1ed7i broker s\u1edf h\u1eefu nh\u1eefng domain v\u00e0 entity type n\u00e0o,</li> <li>nh\u1eefng update server v\u00e0 application n\u00e0o \u0111\u01b0\u1ee3c ph\u00e9p truy c\u1eadp t\u1eebng broker.</li> </ul>"},{"location":"vi/configuration/data-sources/#4-domains-and-ownership","title":"4. Domains and ownership","text":"<p>N\u1ebfu kh\u00f4ng c\u00f3 c\u1ea5u tr\u00fac, m\u1ed9t broker c\u00f3 th\u1ec3 bi\u1ebfn th\u00e0nh m\u1ed9t \u0111\u1ed1ng entity ng\u1eabu nhi\u00ean. LegoCity khuy\u1ebfn kh\u00edch nh\u00f3m entity theo domain v\u00e0 g\u00e1n tr\u00e1ch nhi\u1ec7m r\u00f5 r\u00e0ng.</p> <p>C\u00e1c domain \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>Environment (weather, air quality, noise),</li> <li>Water and flooding,</li> <li>Mobility and transport,</li> <li>Public services (health, education, administration),</li> <li>Infrastructure assets (parking, charging stations, cameras).</li> </ul> <p>V\u1edbi m\u1ed7i domain, t\u00e0i li\u1ec7u n\u00ean ghi r\u00f5:</p> <ul> <li>nh\u1eefng entity type n\u00e0o thu\u1ed9c domain (theo t\u00ean <code>type</code>),</li> <li>update server n\u00e0o ch\u1ecbu tr\u00e1ch nhi\u1ec7m t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt c\u00e1c entity \u0111\u00f3,</li> <li>broker instance n\u00e0o l\u01b0u c\u00e1c entity \u0111\u00f3,</li> <li>dashboard ho\u1eb7c map view n\u00e0o ti\u00eau th\u1ee5 domain n\u00e0y.</li> </ul> <p>Nh\u1edd \u0111\u00f3 ta c\u00f3 c\u00e2u tr\u1ea3 l\u1eddi r\u00f5 r\u00e0ng cho c\u00e1c c\u00e2u h\u1ecfi nh\u01b0:</p> <ul> <li>\u201cN\u1ebfu d\u1eef li\u1ec7u flood sai, ph\u1ea3i ki\u1ec3m tra server n\u00e0o?\u201d</li> <li>\u201cD\u1eef li\u1ec7u air quality l\u1ea5y t\u1eeb \u0111\u00e2u?\u201d</li> <li>\u201cN\u1ebfu th\u00eam m\u1ed9t th\u00e0nh ph\u1ed1 m\u1edbi, domain n\u00e0o c\u1ea7n broker m\u1edbi ho\u1eb7c server m\u1edbi?\u201d</li> </ul> <p>Domain l\u00e0 kh\u00e1i ni\u1ec7m v\u1ec1 t\u00e0i li\u1ec7u v\u00e0 ownership, kh\u00f4ng ph\u1ea3i m\u1ed9t th\u00e0nh ph\u1ea7n k\u1ef9 thu\u1eadt m\u1edbi.</p>"},{"location":"vi/configuration/data-sources/#5-update-servers","title":"5. Update servers","text":"<p>Update server l\u00e0 c\u00e1c integration service. Ch\u00fang k\u1ebft n\u1ed1i h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i v\u1edbi context broker v\u00e0 l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n ghi entity th\u01b0\u1eddng xuy\u00ean duy nh\u1ea5t.</p>"},{"location":"vi/configuration/data-sources/#51-responsibilities","title":"5.1 Responsibilities","text":"<p>M\u1ed9t update server ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho m\u1ed9t v\u00f2ng l\u1eb7p \u0111\u1ea7y \u0111\u1ee7:</p> <ol> <li>Configuration    \u0110\u1ecdc to\u00e0n b\u1ed9 c\u1ea5u h\u00ecnh t\u1eeb environment variable ho\u1eb7c file c\u1ea5u h\u00ecnh, bao g\u1ed3m:</li> <li>broker URL v\u00e0 credential,</li> <li>external API endpoint v\u00e0 key,</li> <li> <p>t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt v\u00e0 c\u00e1c tham s\u1ed1 \u0111\u1eb7c th\u00f9 domain (v\u00ed d\u1ee5: danh s\u00e1ch location c\u1ea7n monitor).</p> </li> <li> <p>Data ingestion    K\u1ebft n\u1ed1i t\u1edbi external data source:</p> </li> <li>l\u1ea5y d\u1eef li\u1ec7u th\u00f4 (fetch raw data),</li> <li>x\u1eed l\u00fd paging, rate limit v\u00e0 l\u1ed7i t\u1ea1m th\u1eddi,</li> <li> <p>ki\u1ec3m tra d\u1eef li\u1ec7u nh\u1eadn \u0111\u01b0\u1ee3c c\u00f3 c\u1ea5u tr\u00fac h\u1ee3p l\u1ec7 hay kh\u00f4ng.</p> </li> <li> <p>Transformation    Chuy\u1ec3n d\u1eef li\u1ec7u th\u00f4 th\u00e0nh entity n\u1ed9i b\u1ed9:</p> </li> <li>ch\u1ecdn entity type,</li> <li>\u0111\u1eb7t identifier theo convention c\u1ee7a project,</li> <li>\u0111i\u1ec1n c\u00e1c attribute kh\u1edbp v\u1edbi Smart Data Model \u0111\u00e3 ch\u1ecdn,</li> <li> <p>g\u00e1n location v\u00e0 timestamp.</p> </li> <li> <p>Publishing    Ghi entity v\u00e0o broker:</p> </li> <li>t\u1ea1o entity n\u1ebfu ch\u01b0a t\u1ed3n t\u1ea1i,</li> <li>c\u1eadp nh\u1eadt attribute cho entity \u0111\u00e3 t\u1ed3n t\u1ea1i,</li> <li> <p>x\u1eed l\u00fd l\u1ed7i m\u1ed9t ph\u1ea7n (partial failure) v\u00e0 retry khi ph\u00f9 h\u1ee3p.</p> </li> <li> <p>Reporting and health    Ghi log c\u00e1c s\u1ef1 ki\u1ec7n ch\u00ednh:</p> </li> <li>c\u00f3 bao nhi\u00eau entity \u0111\u01b0\u1ee3c t\u1ea1o ho\u1eb7c c\u1eadp nh\u1eadt,</li> <li>l\u1ea7n c\u1eadp nh\u1eadt th\u00e0nh c\u00f4ng g\u1ea7n nh\u1ea5t l\u00e0 khi n\u00e0o,</li> <li>c\u00f3 l\u1ed7i hay kh\u00f4ng, v\u00e0 l\u1ed7i lo\u1ea1i g\u00ec.</li> </ol> <p>V\u00f2ng l\u1eb7p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai nh\u01b0 m\u1ed9t service ch\u1ea1y li\u00ean t\u1ee5c v\u1edbi timer ho\u1eb7c d\u01b0\u1edbi d\u1ea1ng scheduled job.</p>"},{"location":"vi/configuration/data-sources/#52-granularity-and-scope","title":"5.2 Granularity and scope","text":"<p>Khuy\u1ebfn ngh\u1ecb l\u00e0 gi\u1eef scope c\u1ee7a update server h\u1eb9p v\u00e0 r\u00f5 r\u00e0ng:</p> <ul> <li>m\u1ed9t server cho m\u1ed7i external data source,</li> <li>ho\u1eb7c m\u1ed9t server cho m\u1ed7i domain khi c\u00e1c ngu\u1ed3n d\u1eef li\u1ec7u li\u00ean quan ch\u1eb7t ch\u1ebd.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y gi\u00fap tr\u00e1nh:</p> <ul> <li>tr\u1ed9n l\u1eabn c\u00e1c m\u1ed1i quan t\u00e2m kh\u00f4ng li\u00ean quan trong c\u00f9ng m\u1ed9t codebase,</li> <li>\u0111\u1ec3 m\u1ed9t l\u1ed7i l\u00e0m \u1ea3nh h\u01b0\u1edfng nhi\u1ec1u domain,</li> <li>t\u1ea1o ra c\u00e1c r\u00e0ng bu\u1ed9c \u1ea9n (hidden coupling) kh\u00f3 debug.</li> </ul> <p>M\u1ed7i server n\u00ean c\u00f3 t\u00ean v\u00e0 scope \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u h\u00f3a r\u00f5, v\u00ed d\u1ee5:</p> <ul> <li><code>env-weather-server</code> \u2013 \u0111\u1ecdc weather API, ghi <code>WeatherObserved</code>,</li> <li><code>water-flood-server</code> \u2013 \u0111\u1ecdc output c\u1ee7a flood model, ghi <code>FloodZone</code>,</li> <li><code>mobility-parking-server</code> \u2013 \u0111\u1ecdc backend parking, ghi <code>ParkingFacility</code> v\u00e0 <code>ParkingSpot</code>.</li> </ul>"},{"location":"vi/configuration/data-sources/#53-idempotency-and-conflict-handling","title":"5.3 Idempotency and conflict handling","text":"<p>Update server n\u00ean \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf idempotent:</p> <ul> <li>ch\u1ea1y c\u00f9ng m\u1ed9t update hai l\u1ea7n li\u00ean ti\u1ebfp kh\u00f4ng \u0111\u01b0\u1ee3c t\u1ea1o ra entity tr\u00f9ng l\u1eb7p,</li> <li>update ph\u1ea3i lu\u00f4n h\u1ed9i t\u1ee5 v\u1ec1 tr\u1ea1ng th\u00e1i \u0111\u00fang.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn:</p> <ul> <li>c\u00e1ch sinh ID (ID \u1ed5n \u0111\u1ecbnh hay ID random m\u1edbi),</li> <li>c\u00e1ch \u00e1p d\u1ee5ng update (replace vs patch),</li> <li>c\u00e1ch x\u1eed l\u00fd entity b\u1ecb x\u00f3a ho\u1eb7c l\u1ed7i th\u1eddi (x\u00f3a explicit, ho\u1eb7c \u0111\u00e1nh d\u1ea5u inactive).</li> </ul> <p>Project n\u00ean \u0111\u1ecbnh ngh\u0129a r\u00f5 c\u00e1ch bi\u1ec3u di\u1ec5n deletion v\u00e0 deactivation \u0111\u1ec3 UI di\u1ec5n gi\u1ea3i \u0111\u00fang (v\u00ed d\u1ee5: entity inactive \u0111\u01b0\u1ee3c \u1ea9n hay hi\u1ec3n th\u1ecb kh\u00e1c m\u00e0u).</p>"},{"location":"vi/configuration/data-sources/#6-current-state-and-history","title":"6. Current state and history","text":"<p>NGSI-LD broker c\u00f3 th\u1ec3 h\u1ed7 tr\u1ee3 c\u1ea3 current context v\u00e0 temporal query, nh\u01b0ng LegoCity ph\u1ea3i quy\u1ebft \u0111\u1ecbnh r\u00f5 s\u1ebd s\u1eed d\u1ee5ng kh\u1ea3 n\u0103ng n\u00e0y nh\u01b0 th\u1ebf n\u00e0o.</p>"},{"location":"vi/configuration/data-sources/#61-current-state","title":"6.1 Current state","text":"<p>V\u1edbi nhi\u1ec1u dashboard, ch\u1ec9 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i l\u00e0 quan tr\u1ecdng. V\u00ed d\u1ee5:</p> <ul> <li>m\u1ef1c n\u01b0\u1edbc hi\u1ec7n t\u1ea1i,</li> <li>m\u1ee9c chi\u1ebfm d\u1ee5ng parking hi\u1ec7n t\u1ea1i,</li> <li>m\u1ee9c \u0111\u1ed9 r\u1ee7i ro l\u0169 hi\u1ec7n t\u1ea1i.</li> </ul> <p>\u1ede mode n\u00e0y:</p> <ul> <li>broker gi\u1eef m\u1ed9t entity cho m\u1ed7i \u0111\u1ed1i t\u01b0\u1ee3ng th\u1ef1c,</li> <li>m\u1ed7i l\u1ea7n update s\u1ebd overwrite c\u00e1c attribute li\u00ean quan,</li> <li>c\u00e1c gi\u00e1 tr\u1ecb c\u0169 kh\u00f4ng \u0111\u01b0\u1ee3c gi\u1eef l\u1ea1i trong broker.</li> </ul> <p>C\u00e1ch n\u00e0y \u0111\u01a1n gi\u1ea3n h\u01a1n \u0111\u1ec3 v\u1eadn h\u00e0nh v\u00e0 th\u01b0\u1eddng \u0111\u1ee7 cho c\u00e1c use case ki\u1ec3u monitoring.</p>"},{"location":"vi/configuration/data-sources/#62-history-and-trends","title":"6.2 History and trends","text":"<p>V\u1edbi m\u1ed9t s\u1ed1 use case, LegoCity c\u00f3 th\u1ec3 c\u1ea7n history ng\u1eafn h\u1ea1n, v\u00ed d\u1ee5:</p> <ul> <li>bi\u1ec3u \u0111\u1ed3 24 gi\u1edd g\u1ea7n nh\u1ea5t c\u1ee7a weather ho\u1eb7c air quality,</li> <li>di\u1ec5n bi\u1ebfn g\u1ea7n \u0111\u00e2y c\u1ee7a m\u1ef1c n\u01b0\u1edbc trong m\u1ed9t \u0111\u1ee3t l\u0169.</li> </ul> <p>C\u00f3 hai c\u00e1ch ti\u1ebfp c\u1eadn:</p> <ul> <li>d\u00f9ng t\u00ednh n\u0103ng temporal c\u1ee7a broker (n\u1ebfu c\u00f3 v\u00e0 \u0111\u01b0\u1ee3c b\u1eadt) \u0111\u1ec3 l\u01b0u history attribute,</li> <li>forward d\u1eef li\u1ec7u sang m\u1ed9t time-series database chuy\u00ean d\u1ee5ng trong khi ch\u1ec9 gi\u1eef gi\u00e1 tr\u1ecb m\u1edbi nh\u1ea5t trong broker.</li> </ul> <p>L\u1ef1a ch\u1ecdn n\u00e0y n\u00ean \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u h\u00f3a cho t\u1eebng domain:</p> <ul> <li>domain n\u00e0o ch\u1ec9 l\u01b0u current state,</li> <li>domain n\u00e0o gi\u1eef history gi\u1edbi h\u1ea1n,</li> <li>d\u1eef li\u1ec7u analytics d\u00e0i h\u1ea1n \u0111\u01b0\u1ee3c l\u01b0u \u1edf \u0111\u00e2u n\u1ebfu kh\u00f4ng n\u1eb1m trong broker.</li> </ul> <p>Dashboard v\u00e0 proxy ph\u1ea3i tu\u00e2n theo quy\u1ebft \u0111\u1ecbnh n\u00e0y \u0111\u1ec3 query v\u1eeba th\u1ef1c t\u1ebf v\u1eeba hi\u1ec7u qu\u1ea3.</p>"},{"location":"vi/configuration/data-sources/#7-data-contracts-and-conventions","title":"7. Data contracts and conventions","text":"<p>\u0110\u1ec3 gi\u1eef data layer nh\u1ea5t qu\u00e1n, LegoCity d\u1ef1a tr\u00ean c\u00e1c data contract explicit gi\u1eefa update server, broker v\u00e0 UI.</p> <p>C\u00e1c contract n\u00e0y bao ph\u1ee7:</p> <ul> <li>d\u00f9ng entity type n\u00e0o,</li> <li>attribute n\u00e0o b\u1eaft bu\u1ed9c ph\u1ea3i c\u00f3,</li> <li>tu\u00e2n theo c\u00e1c quy \u01b0\u1edbc \u0111\u1eb7t t\u00ean (naming convention) n\u00e0o.</li> </ul>"},{"location":"vi/configuration/data-sources/#71-entity-types-and-models","title":"7.1 Entity types and models","text":"<p>V\u1edbi m\u1ed7i entity type \u0111\u01b0\u1ee3c d\u00f9ng trong LegoCity, t\u00e0i li\u1ec7u n\u00ean n\u00eau r\u00f5:</p> <ul> <li>t\u00ean entity type (v\u00ed d\u1ee5: <code>WeatherObserved</code>),</li> <li>n\u00f3 c\u00f3 theo FIWARE Smart Data Model tr\u1ef1c ti\u1ebfp, phi\u00ean b\u1ea3n m\u1edf r\u1ed9ng, hay schema t\u00f9y ch\u1ec9nh,</li> <li>attribute n\u00e0o l\u00e0 mandatory (lu\u00f4n ph\u1ea3i c\u00f3),</li> <li>attribute n\u00e0o l\u00e0 optional v\u00e0 xu\u1ea5t hi\u1ec7n trong \u0111i\u1ec1u ki\u1ec7n n\u00e0o.</li> </ul> <p>Update server ph\u1ea3i tu\u00e2n th\u1ee7 c\u00e1c \u0111\u1ecbnh ngh\u0129a n\u00e0y khi create ho\u1eb7c update entity.</p>"},{"location":"vi/configuration/data-sources/#72-identifiers","title":"7.2 Identifiers","text":"<p>Identifier (<code>id</code>) c\u1ea7n:</p> <ul> <li>\u1ed5n \u0111\u1ecbnh theo th\u1eddi gian cho c\u00f9ng m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng ho\u1eb7c location trong th\u1ebf gi\u1edbi th\u1ef1c,</li> <li>\u0111\u1ee7 d\u1ec5 \u0111o\u00e1n \u0111\u1ec3 h\u1ec7 th\u1ed1ng kh\u00e1c c\u00f3 th\u1ec3 tham chi\u1ebfu entity b\u1eb1ng ID n\u1ebfu c\u1ea7n,</li> <li>l\u00e0 duy nh\u1ea5t trong to\u00e0n broker, ho\u1eb7c \u00edt nh\u1ea5t l\u00e0 duy nh\u1ea5t trong t\u1eebng domain.</li> </ul> <p>T\u00e0i li\u1ec7u n\u00ean ghi r\u00f5:</p> <ul> <li>ID \u0111\u01b0\u1ee3c c\u1ea5u tr\u00fac nh\u01b0 th\u1ebf n\u00e0o (v\u00ed d\u1ee5: pattern URN bao g\u1ed3m domain v\u00e0 location),</li> <li>ID \u0111\u01b0\u1ee3c suy ra t\u1eeb identifier c\u1ee7a h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i hay \u0111\u01b0\u1ee3c sinh n\u1ed9i b\u1ed9,</li> <li>x\u1eed l\u00fd th\u1ebf n\u00e0o n\u1ebfu h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i \u0111\u1ed5i t\u00ean m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng (ID c\u00f3 \u0111\u1ed5i theo kh\u00f4ng, v\u00e0 n\u1ebfu c\u00f3 th\u00ec mapping ra sao).</li> </ul>"},{"location":"vi/configuration/data-sources/#73-geospatial-attributes","title":"7.3 Geospatial attributes","text":"<p>V\u00ec LegoCity l\u00e0 h\u1ec7 th\u1ed1ng t\u1eadp trung v\u00e0o b\u1ea3n \u0111\u1ed3, geospatial attribute ph\u1ea3i nh\u1ea5t qu\u00e1n:</p> <ul> <li>d\u00f9ng t\u00ean attribute n\u00e0o cho v\u1ecb tr\u00ed (v\u00ed d\u1ee5: lu\u00f4n d\u00f9ng <code>location</code>),</li> <li>m\u1ed7i entity type d\u00f9ng lo\u1ea1i geometry n\u00e0o (point, line, polygon),</li> <li>x\u1eed l\u00fd h\u1ec7 t\u1ecda \u0111\u1ed9 (coordinate reference system) ra sao (th\u01b0\u1eddng l\u00e0 WGS84).</li> </ul> <p>S\u1ef1 nh\u1ea5t qu\u00e1n n\u00e0y cho ph\u00e9p:</p> <ul> <li>c\u00e1c map layer generic c\u00f3 th\u1ec3 x\u1eed l\u00fd nhi\u1ec1u entity type,</li> <li>filter \u0111\u01a1n gi\u1ea3n theo bounding box ho\u1eb7c area of interest.</li> </ul>"},{"location":"vi/configuration/data-sources/#74-time-attributes","title":"7.4 Time attributes","text":"<p>Time l\u00e0 y\u1ebfu t\u1ed1 then ch\u1ed1t cho context:</p> <ul> <li>m\u1ed7i entity ki\u1ec3u observation n\u00ean c\u00f3 m\u1ed9t observation timestamp r\u00f5 r\u00e0ng,</li> <li>c\u00e1c entity bi\u1ec3u di\u1ec5n \u0111\u1ed1i t\u01b0\u1ee3ng t\u0129nh (v\u00ed d\u1ee5: public facility) c\u00f3 th\u1ec3 c\u00f3 creation timestamp ho\u1eb7c last-update timestamp.</li> </ul> <p>T\u00e0i li\u1ec7u n\u00ean li\u1ec7t k\u00ea:</p> <ul> <li>attribute n\u00e0o ch\u1ee9a th\u00f4ng tin th\u1eddi gian,</li> <li>ch\u00fang \u0111\u01b0\u1ee3c d\u00f9ng th\u1ebf n\u00e0o trong UI (v\u00ed d\u1ee5: \u0111\u1ec3 \u0111\u00e1nh d\u1ea5u d\u1eef li\u1ec7u stale).</li> </ul>"},{"location":"vi/configuration/data-sources/#8-multiple-sources-for-the-same-entity-type","title":"8. Multiple sources for the same entity type","text":"<p>\u0110\u00f4i khi c\u00f3 nhi\u1ec1u h\u01a1n m\u1ed9t external source cung c\u1ea5p d\u1eef li\u1ec7u cho c\u00f9ng m\u1ed9t entity type kh\u00e1i ni\u1ec7m. V\u00ed d\u1ee5, c\u00e1c c\u01a1 quan kh\u00e1c nhau c\u00f3 th\u1ec3 c\u00f4ng b\u1ed1 c\u00e1c flood map tr\u00f9ng l\u1eb7p m\u1ed9t ph\u1ea7n.</p> <p>Trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, LegoCity c\u1ea7n rule r\u00f5 r\u00e0ng \u0111\u1ec3 tr\u00e1nh nh\u1ea7m l\u1eabn:</p> <ul> <li>c\u00f3 source n\u00e0o \u0111\u01b0\u1ee3c coi l\u00e0 authoritative v\u00e0 c\u00e1c source kh\u00e1c b\u1ecb b\u1ecf qua kh\u00f4ng,</li> <li>entity t\u1eeb c\u00e1c source kh\u00e1c nhau c\u00f3 \u0111\u01b0\u1ee3c gi\u1eef t\u00e1ch bi\u1ec7t b\u1eb1ng ID v\u00e0 metadata kh\u00f4ng,</li> <li>c\u00f3 d\u00f9ng m\u1ed9t aggregation service ri\u00eang \u0111\u1ec3 k\u1ebft h\u1ee3p d\u1eef li\u1ec7u t\u1eeb nhi\u1ec1u source th\u00e0nh m\u1ed9t t\u1eadp entity th\u1ed1ng nh\u1ea5t hay kh\u00f4ng.</li> </ul> <p>N\u1ebfu d\u00f9ng nhi\u1ec1u source, t\u00e0i li\u1ec7u n\u00ean ch\u1ec9 r\u00f5 cho m\u1ed7i entity type:</p> <ul> <li>nh\u1eefng source n\u00e0o feed v\u00e0o lo\u1ea1i n\u00e0y,</li> <li>conflict \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft th\u1ebf n\u00e0o,</li> <li>attribute n\u00e0o cho bi\u1ebft origin ho\u1eb7c quality c\u1ee7a t\u1eebng entity.</li> </ul>"},{"location":"vi/configuration/data-sources/#9-subscriptions-and-reactive-flows","title":"9. Subscriptions and reactive flows","text":"<p>NGSI-LD h\u1ed7 tr\u1ee3 subscription \u0111\u1ec3 service \u0111\u01b0\u1ee3c th\u00f4ng b\u00e1o khi entity thay \u0111\u1ed5i. LegoCity c\u00f3 th\u1ec3 d\u00f9ng subscription \u0111\u1ec3 k\u00edch ho\u1ea1t workflow backend, nh\u01b0ng kh\u00f4ng d\u00f9ng nh\u01b0 c\u01a1 ch\u1ebf ch\u00ednh cho dashboard.</p> <p>C\u00e1c c\u00e1ch d\u00f9ng kh\u1ea3 thi:</p> <ul> <li>m\u1ed9t service c\u1eadp nh\u1eadt c\u00e1c indicator t\u1ed5ng h\u1ee3p khi sensor entity thay \u0111\u1ed5i,</li> <li>m\u1ed9t th\u00e0nh ph\u1ea7n monitoring g\u1eedi c\u1ea3nh b\u00e1o khi v\u01b0\u1ee3t ng\u01b0\u1ee1ng n\u00e0o \u0111\u00f3.</li> </ul> <p>N\u1ebfu d\u00f9ng subscription:</p> <ul> <li>c\u1ea7n x\u00e1c \u0111\u1ecbnh r\u00f5 component n\u00e0o t\u1ea1o v\u00e0 qu\u1ea3n l\u00fd subscription,</li> <li>ph\u1ea1m vi subscription (entity type n\u00e0o, \u0111i\u1ec1u ki\u1ec7n n\u00e0o) ph\u1ea3i \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u h\u00f3a,</li> <li>c\u1ea7n \u0111\u1ecbnh ngh\u0129a chi\u1ebfn l\u01b0\u1ee3c x\u1eed l\u00fd l\u1ed7i v\u00e0 kh\u00f4i ph\u1ee5c (\u0111i\u1ec1u g\u00ec x\u1ea3y ra khi g\u1eedi notification th\u1ea5t b\u1ea1i).</li> </ul> <p>Dashboard v\u1eabn \u0111\u01b0\u1ee3c k\u1ef3 v\u1ecdng d\u00f9ng normal query; m\u1ecdi logic \u201cpush\u201d n\u00ean \u0111\u01b0\u1ee3c trung gian b\u1edfi application service.</p>"},{"location":"vi/configuration/data-sources/#10-relationship-to-the-dashboard-and-proxy","title":"10. Relationship to the dashboard and proxy","text":"<p>Data layer v\u00e0 UI layer giao ti\u1ebfp v\u1edbi nhau qua m\u1ed9t narrow interface.</p> <p>Trong m\u1ed9t setup \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>proxy layer cung c\u1ea5p m\u1ed9t t\u1eadp nh\u1ecf endpoint HTTP \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf ri\u00eang cho UI,</li> <li>c\u00e1c endpoint n\u00e0y n\u1ed9i b\u1ed9 s\u1ebd query broker b\u1eb1ng NGSI-LD v\u00e0 chuy\u1ec3n k\u1ebft qu\u1ea3 sang c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n h\u01a1n,</li> <li>dashboard g\u1ecdi c\u00e1c endpoint \u0111\u00f3 \u0111\u1ec3 l\u1ea5y d\u1eef li\u1ec7u c\u1ea7n cho map view v\u00e0 block.</li> </ul> <p>H\u1ec7 qu\u1ea3:</p> <ul> <li>chi ti\u1ebft n\u1ed9i b\u1ed9 c\u1ee7a broker kh\u00f4ng b\u1ecb l\u1ed9 tr\u1ef1c ti\u1ebfp ra browser ho\u1eb7c client kh\u00f4ng tin c\u1eady,</li> <li>thay \u0111\u1ed5i trong c\u1ea5u tr\u00fac entity c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c h\u1ea5p th\u1ee5 \u1edf layer proxy m\u00e0 kh\u00f4ng l\u00e0m v\u1ee1 UI ngay l\u1eadp t\u1ee9c,</li> <li>policy b\u1ea3o m\u1eadt (ai \u0111\u01b0\u1ee3c \u0111\u1ecdc c\u00e1i g\u00ec) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai t\u1eadp trung t\u1ea1i m\u1ed9t n\u01a1i.</li> </ul> <p>Thi\u1ebft k\u1ebf c\u1ee7a c\u00e1c proxy endpoint \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u trong ph\u1ea7n Development; t\u1eeb g\u00f3c nh\u00ecn data layer, ch\u1ec9 c\u1ea7n hi\u1ec3u r\u1eb1ng:</p> <ul> <li>read access \u0111\u01b0\u1ee3c t\u1eadp trung (centralised),</li> <li>write access v\u1eabn thu\u1ed9c v\u1ec1 update server,</li> <li>broker v\u1eabn l\u00e0 single source of truth.</li> </ul>"},{"location":"vi/configuration/data-sources/#11-summary","title":"11. Summary","text":"<ul> <li>Context broker l\u01b0u tr\u1eef bi\u1ec3u di\u1ec5n hi\u1ec7n t\u1ea1i c\u1ee7a th\u00e0nh ph\u1ed1 d\u01b0\u1edbi d\u1ea1ng NGSI-LD entity v\u00e0 \u0111\u01b0\u1ee3c coi l\u00e0 source of truth.</li> <li>M\u1ed7i deployment ph\u1ea3i l\u1ef1a ch\u1ecdn v\u00e0 t\u00e0i li\u1ec7u h\u00f3a broker topology (single broker hay multi-broker) v\u00e0 c\u1ea5u tr\u00fac domain.</li> <li>Domain nh\u00f3m c\u00e1c entity type v\u00e0 update server li\u00ean quan; m\u1ed7i domain c\u00f3 ownership v\u00e0 tr\u00e1ch nhi\u1ec7m r\u00f5 r\u00e0ng.</li> <li>Update server l\u00e0 c\u00e1c writer th\u01b0\u1eddng xuy\u00ean duy nh\u1ea5t v\u00e0o broker v\u00e0 ph\u1ea3i tu\u00e2n theo data contract chung v\u1ec1 c\u1ea5u tr\u00fac entity, identifier, geospatial attribute v\u00e0 timestamp.</li> <li>C\u00e1c quy\u1ebft \u0111\u1ecbnh v\u1ec1 history, retention v\u00e0 multiple data source ph\u1ea3i r\u00f5 r\u00e0ng \u0111\u1ec3 dashboard v\u00e0 h\u1ec7 th\u1ed1ng analytics ho\u1ea1t \u0111\u1ed9ng d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c.</li> <li>Dashboard \u0111\u1ecdc t\u1eeb broker th\u00f4ng qua proxy, gi\u1eef cho m\u1ed1i quan t\u00e2m UI t\u00e1ch bi\u1ec7t v\u1edbi vi\u1ec7c ingest v\u00e0 l\u01b0u tr\u1eef d\u1eef li\u1ec7u.</li> </ul>"},{"location":"vi/deployment/","title":"T\u1ed5ng quan tri\u1ec3n khai","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch tri\u1ec3n khai v\u00e0 v\u1eadn h\u00e0nh m\u1ed9t c\u00e0i \u0111\u1eb7t LegoCity.</p> <p>N\u00f3 t\u1eadp trung v\u00e0o:</p> <ul> <li>c\u00e1c th\u00e0nh ph\u1ea7n ch\u00ednh c\u1ea7n \u0111\u01b0\u1ee3c tri\u1ec3n khai,</li> <li>c\u00e1c m\u1eabu tri\u1ec3n khai ph\u1ed5 bi\u1ebfn (VM \u0111\u01a1n, n\u1ec1n t\u1ea3ng \u0111\u00e1m m\u00e2y, n\u1ec1n t\u1ea3ng nh\u01b0 d\u1ecbch v\u1ee5),</li> <li>c\u00e1c t\u00e1c v\u1ee5 v\u1eadn h\u00e0nh nh\u01b0 c\u1eadp nh\u1eadt, gi\u00e1m s\u00e1t v\u00e0 sao l\u01b0u.</li> </ul> <p>C\u00e1c trang ri\u00eang bi\u1ec7t cung c\u1ea5p h\u01b0\u1edbng d\u1eabn c\u1ee5 th\u1ec3 cho c\u00e1c n\u1ec1n t\u1ea3ng c\u1ee5 th\u1ec3:</p> <ul> <li>AWS</li> <li>Thi\u1ebft l\u1eadp d\u1ef1a tr\u00ean Cloudflare</li> <li>M\u00e1y \u1ea3o v\u00e0 Docker</li> <li>Coolify</li> </ul>"},{"location":"vi/deployment/#cac-thanh-phan-can-trien-khai","title":"C\u00e1c th\u00e0nh ph\u1ea7n c\u1ea7n tri\u1ec3n khai","text":"<p>M\u1ed9t tri\u1ec3n khai LegoCity th\u01b0\u1eddng bao g\u1ed3m c\u00e1c th\u00e0nh ph\u1ea7n sau:</p> <ul> <li> <p>Context broker   Broker NGSI-LD l\u01b0u tr\u1eef c\u00e1c th\u1ef1c th\u1ec3 (FIWARE Orion-LD ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng).</p> </li> <li> <p>C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt   M\u1ed9t ho\u1eb7c nhi\u1ec1u d\u1ecbch v\u1ee5 l\u1ea5y d\u1eef li\u1ec7u b\u00ean ngo\u00e0i, chuy\u1ec3n \u0111\u1ed5i n\u00f3 v\u00e0 ghi c\u00e1c th\u1ef1c th\u1ec3 v\u00e0o broker.</p> </li> <li> <p>L\u1edbp Proxy / API   M\u1ed9t d\u1ecbch v\u1ee5 backend nh\u1ecf:</p> </li> <li> <p>\u0111\u1ecdc t\u1eeb broker,</p> </li> <li>cung c\u1ea5p c\u00e1c \u0111i\u1ec3m cu\u1ed1i \u0111\u01a1n gi\u1ea3n, th\u00e2n thi\u1ec7n v\u1edbi giao di\u1ec7n ng\u01b0\u1eddi d\u00f9ng,</li> <li> <p>\u00e1p d\u1ee5ng ki\u1ec3m so\u00e1t truy c\u1eadp, b\u1ed9 nh\u1edb \u0111\u1ec7m v\u00e0 gi\u1edbi h\u1ea1n t\u1ef7 l\u1ec7.</p> </li> <li> <p>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n (frontend)   Giao di\u1ec7n Next.js + Mapbox \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng t\u1eeb m\u00e3 ngu\u1ed3n LegoCity.</p> </li> <li> <p>PayloadCMS   Giao di\u1ec7n qu\u1ea3n tr\u1ecb \u0111\u1ec3 c\u1ea5u h\u00ecnh c\u00e1c ch\u1ebf \u0111\u1ed9 xem b\u1ea3n \u0111\u1ed3, l\u1edbp, kh\u1ed1i v\u00e0 n\u1ed9i dung.</p> </li> <li> <p>C\u00e1c d\u1ecbch v\u1ee5 h\u1ed7 tr\u1ee3 (t\u00f9y ch\u1ecdn, t\u00f9y thu\u1ed9c v\u00e0o tri\u1ec3n khai):</p> </li> <li>c\u01a1 s\u1edf d\u1eef li\u1ec7u cho PayloadCMS,</li> <li>ng\u0103n x\u1ebfp ghi nh\u1eadt k\u00fd / gi\u00e1m s\u00e1t,</li> <li>c\u00e1c reverse proxy ho\u1eb7c b\u1ed9 c\u00e2n b\u1eb1ng t\u1ea3i.</li> </ul> <p>Ki\u1ebfn tr\u00fac tri\u1ec3n khai quy\u1ebft \u0111\u1ecbnh:</p> <ul> <li>m\u1ed7i th\u00e0nh ph\u1ea7n ch\u1ea1y \u1edf \u0111\u00e2u,</li> <li>c\u00e1c th\u00e0nh ph\u1ea7n giao ti\u1ebfp nh\u01b0 th\u1ebf n\u00e0o,</li> <li>c\u1ea5u h\u00ecnh v\u00e0 b\u00ed m\u1eadt \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd nh\u01b0 th\u1ebf n\u00e0o.</li> </ul>"},{"location":"vi/deployment/#cac-che-o-trien-khai","title":"C\u00e1c ch\u1ebf \u0111\u1ed9 tri\u1ec3n khai","text":"<p>C\u00f3 nhi\u1ec1u c\u00e1ch \u0111\u1ec3 tri\u1ec3n khai LegoCity. C\u00e1c ch\u1ebf \u0111\u1ed9 ph\u1ed5 bi\u1ebfn nh\u1ea5t l\u00e0:</p> <ul> <li> <p>M\u00e1y \u1ea3o \u0111\u01a1n s\u1eed d\u1ee5ng Docker ho\u1eb7c tr\u00ecnh qu\u1ea3n l\u00fd ti\u1ebfn tr\u00ecnh   \u0110\u01a1n gi\u1ea3n \u0111\u1ec3 thi\u1ebft l\u1eadp, ph\u00f9 h\u1ee3p cho ph\u00e1t tri\u1ec3n v\u00e0 c\u00e1c d\u1ef1 \u00e1n th\u00ed \u0111i\u1ec3m nh\u1ecf.</p> </li> <li> <p>Nh\u00e0 cung c\u1ea5p \u0111\u00e1m m\u00e2y (v\u00ed d\u1ee5 AWS)   C\u00e1c th\u00e0nh ph\u1ea7n \u0111\u01b0\u1ee3c chia th\u00e0nh c\u00e1c d\u1ecbch v\u1ee5 \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd (container, c\u01a1 s\u1edf d\u1eef li\u1ec7u, l\u01b0u tr\u1eef).</p> </li> <li> <p>L\u01b0u tr\u1eef t\u0129nh + API kh\u00f4ng c\u1ea7n m\u00e1y ch\u1ee7 (Cloudflare, v.v.)   Frontend \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef tr\u00ean n\u1ec1n t\u1ea3ng bi\u00ean, API v\u00e0 proxy d\u01b0\u1edbi d\u1ea1ng c\u00e1c h\u00e0m kh\u00f4ng c\u1ea7n m\u00e1y ch\u1ee7.</p> </li> <li> <p>C\u00e1c n\u1ec1n t\u1ea3ng \u1ee9ng d\u1ee5ng (Coolify, v.v.)   M\u1ed9t n\u1ec1n t\u1ea3ng qu\u1ea3n l\u00fd container, \u0111\u1ecbnh tuy\u1ebfn v\u00e0 TLS cho b\u1ea1n.</p> </li> </ul> <p>M\u1ed7i ch\u1ebf \u0111\u1ed9 c\u00f3 nh\u1eefng \u0111\u00e1nh \u0111\u1ed5i kh\u00e1c nhau v\u1ec1:</p> <ul> <li>d\u1ec5 d\u00e0ng thi\u1ebft l\u1eadp,</li> <li>chi ph\u00ed,</li> <li>kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng,</li> <li>\u0111\u1ed9 ph\u1ee9c t\u1ea1p v\u1eadn h\u00e0nh.</li> </ul> <p>C\u00e1c ph\u1ea7n sau m\u00f4 t\u1ea3 m\u1ed9t c\u00e1ch ti\u1ebfp c\u1eadn chung c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh cho m\u1ed7i n\u1ec1n t\u1ea3ng.</p>"},{"location":"vi/deployment/#cac-moi-truong","title":"C\u00e1c m\u00f4i tr\u01b0\u1eddng","text":"<p>C\u00e1c tri\u1ec3n khai LegoCity n\u00ean s\u1eed d\u1ee5ng \u00edt nh\u1ea5t hai m\u00f4i tr\u01b0\u1eddng:</p> <ul> <li> <p>Ph\u00e1t tri\u1ec3n / Staging   \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng cho:</p> </li> <li> <p>ki\u1ec3m tra c\u00e1c ch\u1ebf \u0111\u1ed9 xem, l\u1edbp v\u00e0 kh\u1ed1i m\u1edbi,</p> </li> <li>th\u1eed nghi\u1ec7m v\u1edbi c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</li> <li> <p>x\u00e1c th\u1ef1c c\u00e1c m\u00f4 h\u00ecnh th\u1ef1c th\u1ec3.</p> </li> <li> <p>S\u1ea3n xu\u1ea5t   \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng cho:</p> </li> <li>c\u00e1c b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n tr\u1ef1c ti\u1ebfp,</li> <li>ng\u01b0\u1eddi d\u00f9ng c\u00f4ng khai ho\u1eb7c n\u1ed9i b\u1ed9,</li> <li>c\u00e1c ngu\u1ed3n c\u1ea5p d\u1eef li\u1ec7u \u1ed5n \u0111\u1ecbnh.</li> </ul> <p>M\u1ed7i m\u00f4i tr\u01b0\u1eddng n\u00ean c\u00f3:</p> <ul> <li>broker context ri\u00eang (ho\u1eb7c c\u00e1c kh\u00f4ng gian t\u00ean broker \u0111\u01b0\u1ee3c ph\u00e2n t\u00e1ch r\u00f5 r\u00e0ng),</li> <li>phi\u00ean b\u1ea3n PayloadCMS ri\u00eang,</li> <li>c\u1ea5u h\u00ecnh ri\u00eang (kh\u00f3a API, URL c\u01a1 s\u1edf d\u1eef li\u1ec7u, v.v.),</li> <li>m\u1ed9t quy tr\u00ecnh r\u00f5 r\u00e0ng \u0111\u1ec3 th\u0103ng c\u1ea5p c\u00e1c thay \u0111\u1ed5i t\u1eeb ph\u00e1t tri\u1ec3n sang s\u1ea3n xu\u1ea5t.</li> </ul>"},{"location":"vi/deployment/#cau-hinh-va-bi-mat","title":"C\u1ea5u h\u00ecnh v\u00e0 b\u00ed m\u1eadt","text":"<p>B\u1ea5t k\u1ec3 n\u1ec1n t\u1ea3ng tri\u1ec3n khai n\u00e0o, c\u1ea5u h\u00ecnh n\u00ean \u0111\u01b0\u1ee3c \u0111\u1eb7t b\u00ean ngo\u00e0i.</p> <p>C\u00e1c m\u1ee5c c\u1ea5u h\u00ecnh \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>URL v\u00e0 th\u00f4ng tin \u0111\u0103ng nh\u1eadp c\u1ee7a broker,</li> <li>URL v\u00e0 th\u00f4ng tin \u0111\u0103ng nh\u1eadp c\u01a1 s\u1edf d\u1eef li\u1ec7u PayloadCMS,</li> <li>c\u1ea5u h\u00ecnh proxy (ngu\u1ed3n g\u1ed1c \u0111\u01b0\u1ee3c ph\u00e9p, gi\u1edbi h\u1ea1n t\u1ef7 l\u1ec7),</li> <li>c\u00e1c \u0111i\u1ec3m cu\u1ed1i v\u00e0 kh\u00f3a API b\u00ean ngo\u00e0i (cho c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt),</li> <li>\u0111\u1ecbnh danh m\u00f4i tr\u01b0\u1eddng (v\u00ed d\u1ee5 <code>NODE_ENV</code>, <code>APP_ENV</code>).</li> </ul> <p>Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t:</p> <ul> <li>l\u01b0u tr\u1eef c\u1ea5u h\u00ecnh trong c\u00e1c bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c t\u1ec7p c\u1ea5u h\u00ecnh kh\u00f4ng \u0111\u01b0\u1ee3c cam k\u1ebft v\u00e0o ki\u1ec3m so\u00e1t phi\u00ean b\u1ea3n,</li> <li>l\u01b0u tr\u1eef b\u00ed m\u1eadt (token, m\u1eadt kh\u1ea9u) trong tr\u00ecnh qu\u1ea3n l\u00fd b\u00ed m\u1eadt ho\u1eb7c kho l\u01b0u tr\u1eef \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a,</li> <li>tr\u00e1nh m\u00e3 h\u00f3a c\u1ee9ng b\u1ea5t k\u1ef3 th\u00f4ng tin \u0111\u0103ng nh\u1eadp n\u00e0o trong m\u00e3 ngu\u1ed3n.</li> </ul> <p>Trong s\u1ea3n xu\u1ea5t:</p> <ul> <li>c\u00e1c thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi c\u1ea5u h\u00ecnh n\u00ean \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng th\u00f4ng qua m\u1ed9t quy tr\u00ecnh \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t,</li> <li>t\u1ea5t c\u1ea3 c\u00e1c thay \u0111\u1ed5i c\u1ea5u h\u00ecnh n\u00ean c\u00f3 th\u1ec3 truy v\u1ebft (ai \u0111\u00e3 thay \u0111\u1ed5i c\u00e1i g\u00ec v\u00e0 khi n\u00e0o).</li> </ul>"},{"location":"vi/deployment/#co-ban-ve-mang-va-bao-mat","title":"C\u01a1 b\u1ea3n v\u1ec1 m\u1ea1ng v\u00e0 b\u1ea3o m\u1eadt","text":"<p>\u1ede c\u1ea5p \u0111\u1ed9 cao, c\u1ea5u tr\u00fac m\u1ea1ng n\u00ean \u0111\u1ea3m b\u1ea3o r\u1eb1ng:</p> <ul> <li>context broker kh\u00f4ng \u0111\u01b0\u1ee3c ti\u1ebfp x\u00fac tr\u1ef1c ti\u1ebfp v\u1edbi internet c\u00f4ng c\u1ed9ng,</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u00e0 proxy c\u00f3 quy\u1ec1n truy c\u1eadp v\u00e0o broker,</li> <li>b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn \u0111\u01b0\u1ee3c b\u1edfi ng\u01b0\u1eddi d\u00f9ng d\u1ef1 \u0111\u1ecbnh,</li> <li>qu\u1ea3n tr\u1ecb PayloadCMS b\u1ecb h\u1ea1n ch\u1ebf \u0111\u1ed1i v\u1edbi ng\u01b0\u1eddi d\u00f9ng v\u00e0 m\u1ea1ng \u0111\u01b0\u1ee3c \u1ee7y quy\u1ec1n.</li> </ul> <p>C\u00e1c m\u1eabu \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>\u0111\u1eb7t broker, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt, PayloadCMS v\u00e0 proxy trong m\u1ea1ng ri\u00eang ho\u1eb7c VPC,</li> <li>ch\u1ec9 ti\u1ebfp x\u00fac:</li> <li>URL b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li>URL API proxy,</li> <li>URL qu\u1ea3n tr\u1ecb PayloadCMS (t\u00f9y ch\u1ecdn b\u1ecb h\u1ea1n ch\u1ebf b\u1edfi IP ho\u1eb7c VPN),</li> <li>k\u1ebft th\u00fac TLS t\u1ea1i reverse proxy, b\u1ed9 c\u00e2n b\u1eb1ng t\u1ea3i ho\u1eb7c c\u1ed5ng n\u1ec1n t\u1ea3ng.</li> </ul> <p>M\u1ed7i trang c\u1ee5 th\u1ec3 theo n\u1ec1n t\u1ea3ng s\u1ebd m\u00f4 t\u1ea3 c\u00e1ch \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1c c\u00f4ng c\u1ee5 c\u1ee7a n\u00f3 (v\u00ed d\u1ee5: nh\u00f3m b\u1ea3o m\u1eadt AWS v\u00e0 b\u1ed9 c\u00e2n b\u1eb1ng t\u1ea3i, quy t\u1eafc \u0111\u1ecbnh tuy\u1ebfn Cloudflare, t\u00ean mi\u1ec1n v\u00e0 TLS c\u1ee7a Coolify).</p>"},{"location":"vi/deployment/#trien-khai-dua-tren-vm-on-docker-khai-niem","title":"Tri\u1ec3n khai d\u1ef1a tr\u00ean VM \u0111\u01a1n / Docker (kh\u00e1i ni\u1ec7m)","text":"<p>M\u1eabu tri\u1ec3n khai \u0111\u01a1n gi\u1ea3n nh\u1ea5t l\u00e0:</p> <ul> <li>m\u1ed9t m\u00e1y \u1ea3o,</li> <li>t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch v\u1ee5 ch\u1ea1y d\u01b0\u1edbi d\u1ea1ng container Docker,</li> <li>m\u1ed9t reverse proxy nh\u01b0 Nginx ho\u1eb7c Traefik \u0111\u1ecbnh tuy\u1ebfn c\u00e1c y\u00eau c\u1ea7u.</li> </ul> <p>C\u00e1c container \u0111i\u1ec3n h\u00ecnh l\u00e0:</p> <ul> <li><code>broker</code> \u2013 context broker,</li> <li><code>payload</code> \u2013 PayloadCMS v\u00e0 c\u01a1 s\u1edf d\u1eef li\u1ec7u c\u1ee7a n\u00f3,</li> <li><code>proxy</code> \u2013 l\u1edbp API gi\u1eefa giao di\u1ec7n ng\u01b0\u1eddi d\u00f9ng v\u00e0 broker,</li> <li><code>dashboard</code> \u2013 frontend Next.js (\u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb tr\u00ean m\u00e1y ch\u1ee7 ho\u1eb7c b\u1ea3n d\u1ef1ng t\u0129nh \u0111\u01b0\u1ee3c ph\u1ee5c v\u1ee5 b\u1edfi m\u00e1y ch\u1ee7 web),</li> <li><code>update-*</code> \u2013 m\u1ed9t ho\u1eb7c nhi\u1ec1u m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt.</li> </ul> <p>\u01afu \u0111i\u1ec3m:</p> <ul> <li>h\u1ea1 t\u1ea7ng t\u1ed1i thi\u1ec3u,</li> <li>d\u1ec5 hi\u1ec3u v\u00e0 g\u1ee1 l\u1ed7i,</li> <li>ph\u00f9 h\u1ee3p cho demo, h\u1ed9i th\u1ea3o v\u00e0 th\u00ed \u0111i\u1ec3m.</li> </ul> <p>H\u1ea1n ch\u1ebf:</p> <ul> <li>kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng b\u1ecb gi\u1edbi h\u1ea1n b\u1edfi dung l\u01b0\u1ee3ng c\u1ee7a m\u00e1y \u0111\u01a1n,</li> <li>kh\u00f4ng c\u00f3 kh\u1ea3 d\u1ee5ng cao t\u1ef1 \u0111\u1ed9ng,</li> <li>c\u1eeda s\u1ed5 b\u1ea3o tr\u00ec c\u00f3 th\u1ec3 \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n.</li> </ul> <p>Chi ti\u1ebft \u0111\u1ec3 thi\u1ebft l\u1eadp m\u1eabu n\u00e0y \u0111\u01b0\u1ee3c cung c\u1ea5p trong t\u00e0i li\u1ec7u \"M\u00e1y \u1ea3o &amp; Docker\".</p>"},{"location":"vi/deployment/#trien-khai-am-may-aws-vv","title":"Tri\u1ec3n khai \u0111\u00e1m m\u00e2y (AWS, v.v.)","text":"<p>Khi tri\u1ec3n khai cho nh\u00e0 cung c\u1ea5p \u0111\u00e1m m\u00e2y nh\u01b0 AWS, c\u00e1ch ti\u1ebfp c\u1eadn ph\u1ed5 bi\u1ebfn l\u00e0:</p> <ul> <li>ch\u1ea1y c\u00e1c d\u1ecbch v\u1ee5 trong container (v\u00ed d\u1ee5: ECS ho\u1eb7c Kubernetes),</li> <li>s\u1eed d\u1ee5ng c\u01a1 s\u1edf d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd cho PayloadCMS v\u00e0 l\u01b0u tr\u1eef kh\u00e1c,</li> <li>s\u1eed d\u1ee5ng b\u1ed9 c\u00e2n b\u1eb1ng t\u1ea3i v\u00e0 DNS \u0111\u1ec3 \u0111\u1ecbnh tuy\u1ebfn l\u01b0u l\u01b0\u1ee3ng.</li> </ul> <p>Ki\u1ebfn tr\u00fac AWS \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>C\u00e1c d\u1ecbch v\u1ee5 ECS ho\u1eb7c EKS cho:</li> <li>broker,</li> <li>proxy,</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</li> <li>PayloadCMS v\u00e0 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n (n\u1ebfu kh\u00f4ng ho\u00e0n to\u00e0n t\u0129nh),</li> <li>RDS ho\u1eb7c d\u1ecbch v\u1ee5 c\u01a1 s\u1edf d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd cho d\u1eef li\u1ec7u PayloadCMS,</li> <li>Application Load Balancer \u0111\u1ec3 \u0111\u1ecbnh tuy\u1ebfn HTTP,</li> <li>Route 53 cho DNS,</li> <li>CloudWatch cho nh\u1eadt k\u00fd v\u00e0 ch\u1ec9 s\u1ed1.</li> </ul> <p>L\u1ee3i \u00edch:</p> <ul> <li>d\u1ec5 d\u00e0ng m\u1edf r\u1ed9ng ngang h\u01a1n,</li> <li>c\u01a1 s\u1edf d\u1eef li\u1ec7u v\u00e0 l\u01b0u tr\u1eef \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd,</li> <li>t\u00edch h\u1ee3p v\u1edbi c\u00e1c t\u00ednh n\u0103ng nh\u1eadn d\u1ea1ng v\u00e0 b\u1ea3o m\u1eadt c\u1ee7a AWS.</li> </ul> <p>Chi ph\u00ed:</p> <ul> <li>\u0111\u1ed9 ph\u1ee9c t\u1ea1p v\u1eadn h\u00e0nh cao h\u01a1n,</li> <li>nhi\u1ec1u ph\u1ea7n di chuy\u1ec3n h\u01a1n \u0111\u1ec3 gi\u00e1m s\u00e1t v\u00e0 c\u1ea5u h\u00ecnh.</li> </ul> <p>Trang c\u1ee5 th\u1ec3 v\u1ec1 AWS s\u1ebd ph\u00e1c th\u1ea3o c\u00e1c \u00e1nh x\u1ea1 \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t t\u1eeb c\u00e1c th\u00e0nh ph\u1ea7n LegoCity sang c\u00e1c d\u1ecbch v\u1ee5 AWS v\u00e0 cung c\u1ea5p h\u01b0\u1edbng d\u1eabn t\u1eebng b\u01b0\u1edbc cho tri\u1ec3n khai t\u1ed1i thi\u1ec3u.</p>"},{"location":"vi/deployment/#trien-khai-bien-va-khong-can-may-chu-cloudflare-vv","title":"Tri\u1ec3n khai bi\u00ean v\u00e0 kh\u00f4ng c\u1ea7n m\u00e1y ch\u1ee7 (Cloudflare, v.v.)","text":"<p>Trong m\u1ed9t s\u1ed1 k\u1ecbch b\u1ea3n, h\u1eefu \u00edch khi:</p> <ul> <li>l\u01b0u tr\u1eef b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n d\u01b0\u1edbi d\u1ea1ng t\u00e0i nguy\u00ean t\u0129nh tr\u00ean n\u1ec1n t\u1ea3ng bi\u00ean,</li> <li>ch\u1ea1y proxy v\u00e0 m\u1ed9t s\u1ed1 API d\u01b0\u1edbi d\u1ea1ng c\u00e1c h\u00e0m kh\u00f4ng c\u1ea7n m\u00e1y ch\u1ee7,</li> <li>gi\u1eef broker v\u00e0 PayloadCMS trong m\u00f4i tr\u01b0\u1eddng truy\u1ec1n th\u1ed1ng h\u01a1n.</li> </ul> <p>V\u00ed d\u1ee5, s\u1eed d\u1ee5ng Cloudflare:</p> <ul> <li>b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n t\u0129nh \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng v\u00e0 tri\u1ec3n khai l\u00ean Cloudflare Pages,</li> <li>proxy \u0111\u01b0\u1ee3c tri\u1ec3n khai d\u01b0\u1edbi d\u1ea1ng Cloudflare Workers g\u1ecdi broker,</li> <li>PayloadCMS v\u00e0 broker ch\u1ea1y \u1edf n\u01a1i kh\u00e1c (v\u00ed d\u1ee5: VM ho\u1eb7c nh\u00e0 cung c\u1ea5p \u0111\u00e1m m\u00e2y kh\u00e1c),</li> <li>DNS v\u00e0 TLS \u0111\u01b0\u1ee3c x\u1eed l\u00fd b\u1edfi Cloudflare.</li> </ul> <p>L\u1ee3i \u00edch:</p> <ul> <li>ph\u00e2n ph\u1ed1i to\u00e0n c\u1ea7u nhanh c\u1ee7a b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li>m\u1edf r\u1ed9ng v\u00e0 qu\u1ea3n l\u00fd \u0111\u01a1n gi\u1ea3n h\u00f3a cho frontend v\u00e0 proxy,</li> <li>ph\u00f9 h\u1ee3p t\u1ed1t cho c\u00e1c c\u1ed5ng th\u00f4ng tin c\u00f4ng khai.</li> </ul> <p>C\u00e2n nh\u1eafc:</p> <ul> <li>broker v\u00e0 PayloadCMS v\u1eabn c\u1ea7n l\u01b0u tr\u1eef \u0111\u00e1ng tin c\u1eady \u1edf n\u01a1i kh\u00e1c,</li> <li>k\u1ebft n\u1ed1i gi\u1eefa Cloudflare Workers v\u00e0 broker ph\u1ea3i \u0111\u01b0\u1ee3c b\u1ea3o m\u1eadt v\u00e0 gi\u00e1m s\u00e1t.</li> </ul> <p>Trang c\u1ee5 th\u1ec3 v\u1ec1 Cloudflare s\u1ebd m\u00f4 t\u1ea3 s\u1ef1 ph\u00e2n chia tr\u00e1ch nhi\u1ec7m v\u00e0 lu\u1ed3ng tri\u1ec3n khai c\u01a1 b\u1ea3n.</p>"},{"location":"vi/deployment/#cac-nen-tang-ung-dung-coolify-va-tuong-tu","title":"C\u00e1c n\u1ec1n t\u1ea3ng \u1ee9ng d\u1ee5ng (Coolify v\u00e0 t\u01b0\u01a1ng t\u1ef1)","text":"<p>C\u00e1c n\u1ec1n t\u1ea3ng nh\u01b0 Coolify nh\u1eb1m m\u1ee5c \u0111\u00edch:</p> <ul> <li>ch\u1ea1y c\u00e1c \u1ee9ng d\u1ee5ng \u0111\u01b0\u1ee3c container h\u00f3a tr\u00ean m\u00e1y ch\u1ee7 ho\u1eb7c c\u1ee5m,</li> <li>qu\u1ea3n l\u00fd tri\u1ec3n khai, t\u00ean mi\u1ec1n v\u00e0 ch\u1ee9ng ch\u1ec9 TLS,</li> <li>cung c\u1ea5p giao di\u1ec7n ng\u01b0\u1eddi d\u00f9ng \u0111\u1ec3 c\u1ea5u h\u00ecnh v\u00e0 duy tr\u00ec c\u00e1c d\u1ecbch v\u1ee5.</li> </ul> <p>Trong m\u00f4 h\u00ecnh n\u00e0y:</p> <ul> <li>m\u1ed7i th\u00e0nh ph\u1ea7n LegoCity l\u00e0 m\u1ed9t d\u1ecbch v\u1ee5 trong n\u1ec1n t\u1ea3ng,</li> <li>c\u1ea5u h\u00ecnh n\u1ec1n t\u1ea3ng \u0111\u1ecbnh ngh\u0129a:</li> <li>h\u00ecnh \u1ea3nh container ho\u1eb7c ph\u01b0\u01a1ng th\u1ee9c x\u00e2y d\u1ef1ng,</li> <li>bi\u1ebfn m\u00f4i tr\u01b0\u1eddng,</li> <li>c\u00e1c c\u1ed5ng v\u00e0 t\u00ean mi\u1ec1n \u0111\u01b0\u1ee3c ti\u1ebfp x\u00fac.</li> </ul> <p>Thi\u1ebft l\u1eadp \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>m\u1ed9t phi\u00ean b\u1ea3n Coolify ch\u1ea1y tr\u00ean VM ho\u1eb7c m\u00e1y ch\u1ee7,</li> <li>c\u00e1c d\u1ecbch v\u1ee5 cho:</li> <li>broker,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt.</li> </ul> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y:</p> <ul> <li>gi\u1ea3m l\u01b0\u1ee3ng c\u00f4ng vi\u1ec7c h\u1ea1 t\u1ea7ng c\u1ea5p th\u1ea5p,</li> <li>v\u1eabn cho ph\u00e9p ki\u1ec3m so\u00e1t v\u00e0 nh\u1eadt k\u00fd cho t\u1eebng d\u1ecbch v\u1ee5,</li> <li>ph\u00f9 h\u1ee3p cho c\u00e1c nh\u00f3m kh\u00f4ng c\u00f3 ch\u1ee9c n\u0103ng DevOps chuy\u00ean d\u1ee5ng.</li> </ul> <p>Trang c\u1ee5 th\u1ec3 v\u1ec1 Coolify s\u1ebd m\u00f4 t\u1ea3 c\u00e1c \u0111\u1ecbnh ngh\u0129a d\u1ecbch v\u1ee5 c\u1ee5 th\u1ec3 v\u00e0 c\u00e1c b\u01b0\u1edbc tri\u1ec3n khai.</p>"},{"location":"vi/deployment/#bao-tri-va-van-hanh","title":"B\u1ea3o tr\u00ec v\u00e0 v\u1eadn h\u00e0nh","text":"<p>Tri\u1ec3n khai ch\u1ec9 l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a v\u00f2ng \u0111\u1eddi. M\u1ed9t c\u00e0i \u0111\u1eb7t LegoCity c\u0169ng ph\u1ea3i \u0111\u01b0\u1ee3c b\u1ea3o tr\u00ec.</p> <p>C\u00e1c ho\u1ea1t \u0111\u1ed9ng v\u1eadn h\u00e0nh ch\u00ednh:</p> <ul> <li> <p>Gi\u00e1m s\u00e1t v\u00e0 c\u1ea3nh b\u00e1o</p> </li> <li> <p>gi\u00e1m s\u00e1t:</p> <ul> <li>kh\u1ea3 d\u1ee5ng c\u1ee7a broker,</li> <li>t\u1ef7 l\u1ec7 th\u00e0nh c\u00f4ng/th\u1ea5t b\u1ea1i c\u1ee7a m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</li> <li>s\u1ee9c kh\u1ecfe c\u1ee7a PayloadCMS v\u00e0 proxy,</li> <li>s\u1eed d\u1ee5ng t\u00e0i nguy\u00ean (CPU, b\u1ed9 nh\u1edb, \u0111\u0129a).</li> </ul> </li> <li> <p>\u0111\u1ecbnh ngh\u0129a c\u1ea3nh b\u00e1o cho:</p> <ul> <li>broker ng\u1eebng ho\u1ea1t \u0111\u1ed9ng,</li> <li>th\u1ea5t b\u1ea1i c\u1eadp nh\u1eadt l\u1eb7p l\u1ea1i,</li> <li>t\u0103ng ho\u1eb7c gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng th\u1ef1c th\u1ec3 b\u1ea5t ng\u1edd.</li> </ul> </li> <li> <p>Sao l\u01b0u</p> </li> <li> <p>c\u00e1c c\u01a1 s\u1edf d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi PayloadCMS ph\u1ea3i \u0111\u01b0\u1ee3c sao l\u01b0u th\u01b0\u1eddng xuy\u00ean,</p> </li> <li>n\u1ebfu broker l\u01b0u gi\u1eef c\u00e1c th\u1ef1c th\u1ec3, l\u01b0u tr\u1eef c\u1ee7a n\u00f3 n\u00ean \u0111\u01b0\u1ee3c sao l\u01b0u ho\u1eb7c nh\u00e2n b\u1ea3n,</li> <li> <p>c\u1ea5u h\u00ecnh v\u00e0 t\u00e0i li\u1ec7u n\u00ean \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t phi\u00ean b\u1ea3n.</p> </li> <li> <p>C\u1eadp nh\u1eadt</p> </li> <li> <p>thi\u1ebft l\u1eadp quy tr\u00ecnh cho:</p> <ul> <li>x\u00e2y d\u1ef1ng v\u00e0 ki\u1ec3m tra c\u00e1c phi\u00ean b\u1ea3n m\u1edbi c\u1ee7a b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n, proxy, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u00e0 PayloadCMS,</li> <li>tri\u1ec3n khai c\u00e1c c\u1eadp nh\u1eadt l\u00ean m\u00f4i tr\u01b0\u1eddng ph\u00e1t tri\u1ec3n tr\u01b0\u1edbc,</li> <li>tri\u1ec3n khai l\u00ean s\u1ea3n xu\u1ea5t v\u1edbi gi\u00e1n \u0111o\u1ea1n t\u1ed1i thi\u1ec3u.</li> </ul> </li> <li> <p>duy tr\u00ec nh\u1eadt k\u00fd thay \u0111\u1ed5i cho c\u00e1c thay \u0111\u1ed5i l\u1edbn trong:</p> <ul> <li>c\u00e1c m\u00f4 h\u00ecnh th\u1ef1c th\u1ec3,</li> <li>API,</li> <li>c\u1ea5u tr\u00fac c\u1ea5u h\u00ecnh.</li> </ul> </li> <li> <p>B\u1ea3o m\u1eadt</p> </li> <li>xoay v\u00f2ng c\u00e1c kh\u00f3a API v\u00e0 token \u0111\u1ecbnh k\u1ef3,</li> <li>\u00e1p d\u1ee5ng c\u00e1c c\u1eadp nh\u1eadt b\u1ea3o m\u1eadt cho c\u00e1c n\u1ec1n t\u1ea3ng b\u00ean d\u01b0\u1edbi (VM, th\u1eddi gian ch\u1ea1y container, h\u00ecnh \u1ea3nh h\u1ec7 \u0111i\u1ec1u h\u00e0nh),</li> <li>xem x\u00e9t quy\u1ec1n truy c\u1eadp v\u00e0o PayloadCMS v\u00e0 c\u00e1c \u0111i\u1ec3m cu\u1ed1i qu\u1ea3n tr\u1ecb.</li> </ul> <p>M\u1ed7i trang c\u1ee5 th\u1ec3 theo n\u1ec1n t\u1ea3ng n\u00ean li\u00ean k\u1ebft c\u00e1c nhi\u1ec7m v\u1ee5 n\u00e0y v\u1edbi c\u00e1c c\u00f4ng c\u1ee5 c\u1ee7a n\u1ec1n t\u1ea3ng (v\u00ed d\u1ee5: c\u1ea3nh b\u00e1o CloudWatch tr\u00ean AWS, ki\u1ec3m tra s\u1ee9c kh\u1ecfe Coolify, ph\u00e2n t\u00edch Cloudflare).</p>"},{"location":"vi/deployment/#lua-chon-chien-luoc-trien-khai","title":"L\u1ef1a ch\u1ecdn chi\u1ebfn l\u01b0\u1ee3c tri\u1ec3n khai","text":"<p>Khi ch\u1ecdn chi\u1ebfn l\u01b0\u1ee3c tri\u1ec3n khai, c\u00e1c nh\u00f3m n\u00ean xem x\u00e9t:</p> <ul> <li>t\u1ea3i d\u1ef1 ki\u1ebfn v\u00e0 s\u1ed1 l\u01b0\u1ee3ng ng\u01b0\u1eddi d\u00f9ng,</li> <li>s\u1ed1 t\u00ean mi\u1ec1n v\u00e0 m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt trong ph\u1ea1m vi,</li> <li>chuy\u00ean m\u00f4n v\u1eadn h\u00e0nh c\u00f3 s\u1eb5n,</li> <li>r\u1eb1ng bu\u1ed9c t\u1eeb t\u1ed5 ch\u1ee9c l\u01b0u tr\u1eef (\u0111\u00e1m m\u00e2y \u01b0u ti\u00ean, c\u00f4ng c\u1ee5 hi\u1ec7n c\u00f3).</li> </ul> <p>H\u01b0\u1edbng d\u1eabn s\u01a1 b\u1ed9:</p> <ul> <li> <p>VM \u0111\u01a1n + Docker   T\u1ed1t cho:</p> </li> <li> <p>nguy\u00ean m\u1eabu ban \u0111\u1ea7u,</p> </li> <li>b\u1ea3n demo n\u1ed9i b\u1ed9,</li> <li> <p>c\u00e1c tri\u1ec3n khai nh\u1ecf \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd b\u1edfi m\u1ed9t nh\u00f3m duy nh\u1ea5t.</p> </li> <li> <p>Nh\u00e0 cung c\u1ea5p \u0111\u00e1m m\u00e2y (AWS)   Ph\u00f9 h\u1ee3p khi:</p> </li> <li> <p>c\u1ea7n kh\u1ea3 d\u1ee5ng cao ho\u1eb7c kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng,</p> </li> <li>c\u00f3 h\u1ea1 t\u1ea7ng \u0111\u00e1m m\u00e2y hi\u1ec7n c\u00f3,</li> <li> <p>c\u1ea7n t\u00edch h\u1ee3p v\u1edbi c\u00e1c d\u1ecbch v\u1ee5 \u0111\u00e1m m\u00e2y kh\u00e1c.</p> </li> <li> <p>Thi\u1ebft l\u1eadp d\u1ef1a tr\u00ean Cloudflare   H\u1eefu \u00edch khi:</p> </li> <li> <p>b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n l\u00e0 c\u00f4ng khai v\u00e0 \u0111\u01b0\u1ee3c h\u01b0\u1edfng l\u1ee3i t\u1eeb vi\u1ec7c ph\u00e2n ph\u1ed1i bi\u00ean,</p> </li> <li>proxy c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai d\u01b0\u1edbi d\u1ea1ng c\u00e1c h\u00e0m nh\u1eb9,</li> <li> <p>c\u00e1c backend hi\u1ec7n c\u00f3 (broker, PayloadCMS) \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef \u1edf n\u01a1i kh\u00e1c.</p> </li> <li> <p>Coolify ho\u1eb7c n\u1ec1n t\u1ea3ng t\u01b0\u01a1ng t\u1ef1   Th\u00edch h\u1ee3p khi:</p> </li> <li>nh\u00f3m \u01b0a th\u00edch tri\u1ec3n khai v\u00e0 qu\u1ea3n l\u00fd d\u1ef1a tr\u00ean giao di\u1ec7n,</li> <li>tri\u1ec3n khai nh\u1ecf \u0111\u1ebfn trung b\u00ecnh,</li> <li>t\u1eadp trung v\u00e0o vi\u1ec7c nhanh ch\u00f3ng c\u00f3 \u0111\u01b0\u1ee3c n\u1ec1n t\u1ea3ng ho\u1ea1t \u0111\u1ed9ng thay v\u00ec qu\u1ea3n l\u00fd h\u1ea1 t\u1ea7ng th\u00f4.</li> </ul>"},{"location":"vi/deployment/#moi-quan-he-voi-tai-lieu-khac","title":"M\u1ed1i quan h\u1ec7 v\u1edbi t\u00e0i li\u1ec7u kh\u00e1c","text":"<p>T\u1ed5ng quan tri\u1ec3n khai n\u00e0y c\u1ed1 \u00fd \u1edf c\u1ea5p \u0111\u1ed9 cao. N\u00f3 \u0111\u01b0\u1ee3c b\u1ed5 sung b\u1edfi:</p> <ul> <li>Tri\u1ec3n khai AWS \u2013 \u00e1nh x\u1ea1 c\u00e1c th\u00e0nh ph\u1ea7n LegoCity sang c\u00e1c d\u1ecbch v\u1ee5 AWS v\u00e0 c\u00e1c m\u1eabu s\u1eb5n s\u00e0ng s\u1eed d\u1ee5ng,</li> <li>Tri\u1ec3n khai Cloudflare \u2013 thi\u1ebft k\u1ebf giao di\u1ec7n t\u0129nh + proxy kh\u00f4ng c\u1ea7n m\u00e1y ch\u1ee7,</li> <li>M\u00e1y \u1ea3o v\u00e0 Docker \u2013 tri\u1ec3n khai VM \u0111\u01a1n v\u00e0 nhi\u1ec1u VM s\u1eed d\u1ee5ng container,</li> <li>Tri\u1ec3n khai Coolify \u2013 \u0111\u1ecbnh ngh\u0129a c\u00e1c d\u1ecbch v\u1ee5 LegoCity b\u00ean trong Coolify v\u00e0 qu\u1ea3n l\u00fd ch\u00fang theo th\u1eddi gian.</li> </ul> <p>C\u00e1c trang n\u00e0y cung c\u1ea5p h\u01b0\u1edbng d\u1eabn c\u1ee5 th\u1ec3 v\u1ec1 n\u1ec1n t\u1ea3ng c\u1ee5 th\u1ec3 h\u01a1n v\u00e0 n\u00ean \u0111\u01b0\u1ee3c tham kh\u1ea3o khi tri\u1ec3n khai m\u1ed9t tri\u1ec3n khai c\u1ee5 th\u1ec3.</p>"},{"location":"vi/deployment/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>M\u1ed9t tri\u1ec3n khai LegoCity bao g\u1ed3m context broker, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt, proxy, b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n, PayloadCMS v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 h\u1ed7 tr\u1ee3.</li> <li>C\u00f3 nhi\u1ec1u ch\u1ebf \u0111\u1ed9 tri\u1ec3n khai: VM \u0111\u01a1n, nh\u00e0 cung c\u1ea5p \u0111\u00e1m m\u00e2y, k\u1ebft h\u1ee3p bi\u00ean/kh\u00f4ng c\u1ea7n m\u00e1y ch\u1ee7 v\u00e0 c\u00e1c n\u1ec1n t\u1ea3ng \u1ee9ng d\u1ee5ng.</li> <li>M\u1ed7i m\u00f4i tr\u01b0\u1eddng (ph\u00e1t tri\u1ec3n, s\u1ea3n xu\u1ea5t) c\u1ea7n broker, c\u1ea5u h\u00ecnh v\u00e0 th\u00f4ng tin \u0111\u0103ng nh\u1eadp \u0111\u01b0\u1ee3c t\u00e1ch bi\u1ec7t r\u00f5 r\u00e0ng.</li> <li>B\u1ea3o m\u1eadt, qu\u1ea3n l\u00fd c\u1ea5u h\u00ecnh, gi\u00e1m s\u00e1t, sao l\u01b0u v\u00e0 quy tr\u00ecnh c\u1eadp nh\u1eadt l\u00e0 c\u00e1c ph\u1ea7n c\u1ed1t l\u00f5i c\u1ee7a thi\u1ebft k\u1ebf tri\u1ec3n khai, kh\u00f4ng ph\u1ea3i l\u00e0 suy ngh\u0129 sau.</li> <li>C\u00e1c trang c\u1ee5 th\u1ec3 v\u1ec1 n\u1ec1n t\u1ea3ng tinh ch\u1ec9nh t\u1ed5ng quan n\u00e0y th\u00e0nh c\u00e1c b\u01b0\u1edbc s\u1eb5n s\u00e0ng s\u1eed d\u1ee5ng cho AWS, Cloudflare, m\u00e1y \u1ea3o v\u00e0 Coolify.</li> </ul>"},{"location":"vi/deployment/aws/","title":"Tri\u1ec3n khai AWS","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch th\u1ef1c t\u1ebf \u0111\u1ec3 tri\u1ec3n khai LegoCity tr\u00ean AWS s\u1eed d\u1ee5ng c\u00e1c managed services.</p> <p>N\u00f3 t\u1eadp trung v\u00e0o:</p> <ul> <li>\u00e1nh x\u1ea1 c\u00e1c components c\u1ee7a LegoCity t\u1edbi AWS services,</li> <li>ki\u1ebfn tr\u00fac t\u1ed1i thi\u1ec3u nh\u01b0ng th\u1ef1c t\u1ebf (dev + prod),</li> <li>c\u00e1c b\u01b0\u1edbc c\u1ee5 th\u1ec3 \u0111\u1ec3 c\u00f3 m\u1ed9t deployment ho\u1ea1t \u0111\u1ed9ng,</li> <li>maintenance c\u01a1 b\u1ea3n: updates, monitoring, backups.</li> </ul> <p>\u0110\u00e2y kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t template Terraform/CloudFormation \u0111\u1ea7y \u0111\u1ee7, nh\u01b0ng n\u00f3 n\u00ean \u0111\u1ee7 chi ti\u1ebft \u0111\u1ec3 m\u1ed9t engineer quen thu\u1ed9c v\u1edbi AWS basics c\u00f3 th\u1ec3 implement.</p>"},{"location":"vi/deployment/aws/#khi-nao-su-dung-aws","title":"Khi n\u00e0o s\u1eed d\u1ee5ng AWS","text":"<p>Deployment d\u1ef1a tr\u00ean AWS ph\u00f9 h\u1ee3p khi:</p> <ul> <li>t\u1ed5 ch\u1ee9c \u0111\u00e3 s\u1eed d\u1ee5ng AWS,</li> <li>y\u00eau c\u1ea7u uptime v\u00e0 scalability cao h\u01a1n \"m\u1ed9t VM v\u1edbi Docker\",</li> <li>\u01b0u ti\u00ean managed databases v\u00e0 monitoring h\u01a1n self-hosted.</li> </ul> <p>C\u00f3 th\u1ec3 l\u00e0 overkill khi:</p> <ul> <li>b\u1ea1n ch\u1ec9 c\u1ea7n m\u1ed9t prototype ng\u1eafn h\u1ea1n,</li> <li>b\u1ea1n kh\u00f4ng c\u00f3 quy\u1ec1n truy c\u1eadp AWS account ho\u1eb7c AWS skills c\u01a1 b\u1ea3n.</li> </ul>"},{"location":"vi/deployment/aws/#anh-xa-component-aws-service","title":"\u00c1nh x\u1ea1 Component \u2192 AWS service","text":"<p>\u00c1nh x\u1ea1 \u0111i\u1ec3n h\u00ecnh t\u1eeb c\u00e1c components c\u1ee7a LegoCity t\u1edbi AWS nh\u01b0 sau:</p> <ul> <li> <p>Context broker</p> </li> <li> <p>Ch\u1ea1y nh\u01b0 m\u1ed9t container tr\u00ean:</p> <ul> <li>AWS ECS (Fargate ho\u1eb7c EC2 launch type), ho\u1eb7c</li> <li>EKS (Kubernetes) n\u1ebfu b\u1ea1n \u0111\u00e3 c\u00f3.</li> </ul> </li> <li> <p>Storage tr\u00ean:</p> <ul> <li>EBS volume ho\u1eb7c</li> <li>S3 (n\u1ebfu broker h\u1ed7 tr\u1ee3) ho\u1eb7c</li> <li>internal DB, t\u00f9y thu\u1ed9c v\u00e0o broker implementation.</li> </ul> </li> <li> <p>PayloadCMS</p> </li> <li> <p>Ch\u1ea1y nh\u01b0 m\u1ed9t container tr\u00ean ECS/EKS.</p> </li> <li> <p>Database tr\u00ean:</p> <ul> <li>Amazon RDS (PostgreSQL ho\u1eb7c MySQL) ho\u1eb7c</li> <li>Amazon DocumentDB / Mongo-compatible service.</li> </ul> </li> <li> <p>Proxy / API layer</p> </li> <li> <p>Ch\u1ea1y nh\u01b0 m\u1ed9t container tr\u00ean ECS/EKS.</p> </li> <li> <p>T\u00f9y ch\u1ecdn \u0111\u01b0\u1ee3c fronted b\u1edfi:</p> <ul> <li>Application Load Balancer (ALB) ho\u1eb7c</li> <li>API Gateway + Lambda n\u1ebfu \u0111\u01b0\u1ee3c rewrite.</li> </ul> </li> <li> <p>Dashboard (Next.js + Mapbox)   Options:</p> </li> <li> <p>build nh\u01b0 static assets v\u00e0 host tr\u00ean:</p> <ul> <li>S3 + CloudFront,   HO\u1eb6C</li> </ul> </li> <li> <p>ch\u1ea1y nh\u01b0 m\u1ed9t container tr\u00ean ECS/EKS ph\u00eda sau ALB n\u1ebfu c\u1ea7n server-side rendering.</p> </li> <li> <p>Update servers</p> </li> <li> <p>Ch\u1ea1y nh\u01b0:</p> <ul> <li>ECS services (long-running tasks), ho\u1eb7c</li> <li>ECS scheduled tasks (cron-like), ho\u1eb7c</li> <li>Lambda functions (n\u1ebfu implemented serverless).</li> </ul> </li> <li> <p>Networking &amp; ingress</p> </li> <li> <p>VPC v\u1edbi public v\u00e0 private subnets,</p> </li> <li>ALB trong public subnets routing t\u1edbi ECS services trong private subnets,</li> <li> <p>security groups controlling traffic.</p> </li> <li> <p>Configuration &amp; secrets</p> </li> <li> <p>AWS Systems Manager Parameter Store ho\u1eb7c Secrets Manager cho:</p> <ul> <li>broker write keys,</li> <li>DB credentials,</li> <li>external API keys.</li> </ul> </li> <li> <p>Monitoring &amp; logs</p> </li> <li>CloudWatch Logs cho container logs,</li> <li>CloudWatch metrics v\u00e0 alarms.</li> </ul>"},{"location":"vi/deployment/aws/#environments-dev-va-prod","title":"Environments: dev v\u00e0 prod","text":"<p>\u1ede m\u1ee9c t\u1ed1i thi\u1ec3u, b\u1ea1n n\u00ean \u0111\u1ecbnh ngh\u0129a:</p> <ul> <li> <p>m\u1ed9t development environment:</p> </li> <li> <p>ECS services nh\u1ecf h\u01a1n,</p> </li> <li>RDS instance nh\u1ecf h\u01a1n,</li> <li>restricted access (ch\u1ec9 internal users),</li> <li> <p>\u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 test blocks m\u1edbi, map views v\u00e0 update servers.</p> </li> <li> <p>m\u1ed9t production environment:</p> </li> <li>scaled versions c\u1ee7a c\u00f9ng c\u00e1c components,</li> <li>stricter access controls,</li> <li>visible cho end users.</li> </ul> <p>B\u1ea1n c\u00f3 th\u1ec3 implement \u0111i\u1ec1u n\u00e0y b\u1eb1ng:</p> <ul> <li>c\u00e1c AWS accounts ri\u00eang bi\u1ec7t (preferred trong c\u00e1c orgs l\u1edbn h\u01a1n), ho\u1eb7c</li> <li>c\u00e1c VPCs v\u00e0 ECS clusters ri\u00eang bi\u1ec7t trong c\u00f9ng m\u1ed9t account, ho\u1eb7c</li> <li>\u00edt nh\u1ea5t c\u00e1c ECS services, RDS instances v\u00e0 Parameter Store paths ri\u00eang bi\u1ec7t v\u1edbi prefixes (v\u00ed d\u1ee5 <code>/legocity/dev/...</code> vs <code>/legocity/prod/...</code>).</li> </ul> <p>T\u00e0i li\u1ec7u n\u00e0y gi\u1ea3 \u0111\u1ecbnh c\u00e1c dev v\u00e0 prod ECS services v\u00e0 RDS instances ri\u00eang bi\u1ec7t b\u00ean trong c\u00f9ng m\u1ed9t account, v\u1edbi configuration \u0111\u01b0\u1ee3c ph\u00e2n t\u00e1ch b\u1eb1ng Parameter Store prefixes.</p>"},{"location":"vi/deployment/aws/#container-images-va-registries","title":"Container images v\u00e0 registries","text":"<p>T\u1ea5t c\u1ea3 c\u00e1c components c\u1ee7a LegoCity ch\u1ea1y nh\u01b0 containers c\u1ea7n images:</p> <ul> <li>broker image (official ho\u1eb7c custom),</li> <li>PayloadCMS image,</li> <li>proxy image,</li> <li>dashboard image (n\u1ebfu kh\u00f4ng purely static),</li> <li>update server images.</li> </ul> <p>Workflow:</p> <ol> <li>Build images locally ho\u1eb7c trong CI.</li> <li>Push images t\u1edbi Amazon ECR (Elastic Container Registry).</li> <li>Configure ECS services \u0111\u1ec3 s\u1eed d\u1ee5ng c\u00e1c images n\u00e0y by tag.</li> </ol> <p>Patterns \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb:</p> <ul> <li>s\u1eed d\u1ee5ng ECR repositories ri\u00eang bi\u1ec7t per service:</li> <li><code>legocity-broker</code>,</li> <li><code>legocity-payload</code>,</li> <li><code>legocity-proxy</code>,</li> <li><code>legocity-dashboard</code>,</li> <li><code>legocity-update-env</code>, v.v.</li> <li>s\u1eed d\u1ee5ng semantic tags ho\u1eb7c \u00edt nh\u1ea5t:</li> <li><code>dev-&lt;short-sha&gt;</code> cho dev,</li> <li><code>prod-&lt;short-sha&gt;</code> cho prod.</li> </ul>"},{"location":"vi/deployment/aws/#network-va-vpc-layout","title":"Network v\u00e0 VPC layout","text":"<p>M\u1ed9t minimal network layout ph\u1ed5 bi\u1ebfn:</p> <ul> <li>m\u1ed9t VPC v\u1edbi:</li> <li>public subnets (cho ALB),</li> <li>private subnets (cho ECS tasks v\u00e0 RDS).</li> </ul> <p>Components:</p> <ul> <li> <p>ALB trong public subnets:</p> </li> <li> <p>nh\u1eadn HTTPS traffic t\u1eeb internet,</p> </li> <li>terminates TLS (ACM certificates),</li> <li> <p>forwards t\u1edbi ECS target groups.</p> </li> <li> <p>ECS services trong private subnets:</p> </li> <li> <p>broker (ch\u1ec9 cho internal access),</p> </li> <li>proxy,</li> <li>PayloadCMS,</li> <li>Next.js (n\u1ebfu SSR),</li> <li> <p>update servers.</p> </li> <li> <p>RDS trong private subnets:</p> </li> <li>ch\u1ec9 accessible t\u1eeb ECS tasks qua security groups.</li> </ul> <p>Security groups:</p> <ul> <li>m\u1ed9t SG cho ALB (ingress 80/443 t\u1eeb internet),</li> <li>m\u1ed9t SG cho ECS tasks (ingress t\u1eeb ALB SG v\u00e0 t\u1eeb internal SGs kh\u00e1c),</li> <li>m\u1ed9t SG cho RDS (ingress t\u1eeb ECS SG only),</li> <li>optional SGs cho broker n\u1ebfu mu\u1ed1n restrict ECS services n\u00e0o c\u00f3 th\u1ec3 call n\u00f3.</li> </ul>"},{"location":"vi/deployment/aws/#minimal-architecture-pattern","title":"Minimal architecture pattern","text":"<p>Cho m\u1ed9t minimal nh\u01b0ng structured setup:</p> <ul> <li> <p>ECS Cluster: <code>legocity-cluster</code></p> </li> <li> <p>ch\u1ea1y t\u1ea5t c\u1ea3 services nh\u01b0 ECS services v\u1edbi Fargate.</p> </li> <li> <p>Services:</p> </li> <li> <p><code>legocity-broker-service</code> (Fargate, private subnets, no public IP),</p> </li> <li><code>legocity-payload-service</code> (Fargate, private, behind ALB),</li> <li><code>legocity-proxy-service</code> (Fargate, private, behind ALB),</li> <li><code>legocity-dashboard-service</code> (Fargate, private, behind ALB)     (skip n\u1ebfu host dashboard tr\u00ean S3+CloudFront),</li> <li> <p><code>legocity-update-env-service</code> (Fargate, private, no ALB, long-running / scheduled).</p> </li> <li> <p>RDS:</p> </li> <li> <p><code>legocity-payload-db</code> \u2013 PostgreSQL ho\u1eb7c MySQL,</p> </li> <li> <p>security group ch\u1ec9 allowing connections t\u1eeb ECS tasks.</p> </li> <li> <p>ALB:</p> </li> <li> <p>listeners tr\u00ean 80/443, redirect 80 \u2192 443,</p> </li> <li> <p>target groups:</p> <ul> <li><code>/admin</code> \u2192 PayloadCMS,</li> <li><code>/api</code> \u2192 proxy,</li> <li><code>/</code> \u2192 dashboard.</li> </ul> </li> <li> <p>S3 + CloudFront (optional nh\u01b0ng recommended cho Next.js static build):</p> </li> <li>S3 bucket cho static assets,</li> <li>CloudFront distribution fronting bucket,</li> <li>API requests \u0111\u01b0\u1ee3c routed t\u1edbi ALB.</li> </ul>"},{"location":"vi/deployment/aws/#configuration-va-secrets-tren-aws","title":"Configuration v\u00e0 secrets tr\u00ean AWS","text":"<p>S\u1eed d\u1ee5ng SSM Parameter Store ho\u1eb7c Secrets Manager cho configuration, kh\u00f4ng ph\u1ea3i hard-coded environment variables trong ECS task definitions.</p> <p>V\u00ed d\u1ee5 v\u1ec1 Parameter Store paths:</p> <ul> <li><code>/legocity/dev/broker/url</code></li> <li><code>/legocity/dev/broker/write-key/env</code></li> <li><code>/legocity/dev/payload/db-url</code></li> <li> <p><code>/legocity/dev/external/weather/api-key</code></p> </li> <li> <p><code>/legocity/prod/broker/url</code></p> </li> <li><code>/legocity/prod/broker/write-key/env</code></li> <li><code>/legocity/prod/payload/db-url</code></li> <li><code>/legocity/prod/external/weather/api-key</code></li> </ul> <p>M\u1ed7i ECS task:</p> <ul> <li>obtains config c\u1ee7a n\u00f3 at runtime qua environment variables,</li> <li>environment values c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c pulled t\u1eeb SSM parameters by name.</li> </ul> <p>Basic pattern:</p> <ul> <li>TASK_DEF env:</li> <li><code>BROKER_URL</code> \u2190 SSM <code>/legocity/prod/broker/url</code></li> <li><code>BROKER_WRITE_KEY</code> \u2190 SSM <code>/legocity/prod/broker/write-key/env</code></li> <li><code>PAYLOAD_DB_URL</code> \u2190 SSM <code>/legocity/prod/payload/db-url</code></li> <li><code>WEATHER_API_KEY</code> \u2190 SSM <code>/legocity/prod/external/weather/api-key</code></li> </ul> <p>Grant ECS task role permission \u0111\u1ec3 read c\u00e1c specific parameter paths c\u1ea7n thi\u1ebft.</p>"},{"location":"vi/deployment/aws/#step-by-step-skeleton-first-production-like-deployment","title":"Step-by-step skeleton: first production-like deployment","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t skeleton sequence cho vi\u1ec7c set up m\u1ed9t first production-like environment. Chi ti\u1ebft ph\u1ee5 thu\u1ed9c v\u00e0o chosen tools c\u1ee7a b\u1ea1n (console vs IaC), nh\u01b0ng th\u1ee9 t\u1ef1 c\u1ea7n r\u00f5 r\u00e0ng.</p>"},{"location":"vi/deployment/aws/#1-prepare-vpc-va-networking","title":"1. Prepare VPC v\u00e0 networking","text":"<ul> <li> <p>Create m\u1ed9t VPC (ho\u1eb7c reuse m\u1ed9t VPC hi\u1ec7n c\u00f3) v\u1edbi:</p> </li> <li> <p>\u00edt nh\u1ea5t hai public subnets (trong different AZs),</p> </li> <li>\u00edt nh\u1ea5t hai private subnets (trong different AZs),</li> <li>m\u1ed9t Internet Gateway,</li> <li> <p>NAT Gateway(s) cho private subnets (\u0111\u1ec3 ECS tasks c\u00f3 th\u1ec3 fetch images, call external APIs).</p> </li> <li> <p>Create security groups:</p> </li> <li><code>sg-alb</code>:<ul> <li>ingress: 80/443 t\u1eeb internet,</li> <li>egress: t\u1edbi ECS SG.</li> </ul> </li> <li><code>sg-ecs</code>:<ul> <li>ingress: t\u1eeb <code>sg-alb</code> tr\u00ean app ports,</li> <li>ingress: t\u1eeb ch\u00ednh n\u00f3 n\u1ebfu services call nhau,</li> <li>egress: t\u1edbi <code>sg-rds</code>, internet qua NAT.</li> </ul> </li> <li><code>sg-rds</code>:<ul> <li>ingress: t\u1eeb <code>sg-ecs</code> tr\u00ean DB port (v\u00ed d\u1ee5 5432).</li> </ul> </li> </ul>"},{"location":"vi/deployment/aws/#2-create-rds-cho-payloadcms","title":"2. Create RDS cho PayloadCMS","text":"<ul> <li>Choose engine: PostgreSQL ho\u1eb7c MySQL.</li> <li>Deploy <code>legocity-payload-db</code> v\u00e0o private subnets v\u1edbi <code>sg-rds</code>.</li> <li>Configure:</li> <li>DB name, user, password,</li> <li>backup retention, automated backups.</li> <li>\u0110\u1ea3m b\u1ea3o ECS tasks c\u00f3 th\u1ec3 resolve v\u00e0 connect qua DB endpoint.</li> </ul>"},{"location":"vi/deployment/aws/#3-create-ecr-repositories-va-push-images","title":"3. Create ECR repositories v\u00e0 push images","text":"<p>Cho m\u1ed7i component:</p> <ul> <li>create m\u1ed9t ECR repo (v\u00ed d\u1ee5 <code>legocity-payload</code>),</li> <li>build image v\u00e0 push:</li> <li><code>dev</code> tag cho dev,</li> <li><code>prod</code> tag cho prod.</li> </ul> <p>L\u00e0m \u0111i\u1ec1u n\u00e0y cho:</p> <ul> <li>broker,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>dashboard (n\u1ebfu container-based),</li> <li>\u00edt nh\u1ea5t m\u1ed9t update server.</li> </ul>"},{"location":"vi/deployment/aws/#4-configure-ssm-parameters-cho-configuration","title":"4. Configure SSM parameters cho configuration","text":"<p>Create parameters cho prod environment:</p> <ul> <li><code>/legocity/prod/broker/url</code></li> <li><code>/legocity/prod/broker/write-key/env</code></li> <li><code>/legocity/prod/payload/db-url</code></li> <li><code>/legocity/prod/external/weather/api-key</code></li> <li>b\u1ea5t k\u1ef3 others c\u1ea7n b\u1edfi proxy v\u00e0 update servers.</li> </ul> <p>Store sensitive values nh\u01b0 SecureString.</p>"},{"location":"vi/deployment/aws/#5-create-ecs-cluster-va-task-definitions","title":"5. Create ECS cluster v\u00e0 task definitions","text":"<ul> <li>Create <code>legocity-cluster</code>.</li> <li>Cho m\u1ed7i service, define m\u1ed9t task definition:</li> <li>container image t\u1eeb ECR,</li> <li>CPU/memory limits,</li> <li>environment variables referencing SSM parameters,</li> <li>logging t\u1edbi CloudWatch Logs,</li> <li>port mappings.</li> </ul> <p>Services:</p> <ul> <li> <p><code>broker-task</code> / <code>broker-service</code>:</p> </li> <li> <p>desired count: 1 (\u0111\u1ec3 start),</p> </li> <li>private subnets, <code>sg-ecs</code>,</li> <li>no public IP,</li> <li> <p>no ALB (internal only).</p> </li> <li> <p><code>payload-task</code> / <code>payload-service</code>:</p> </li> <li> <p>desired count: 1,</p> </li> <li>private subnets, <code>sg-ecs</code>,</li> <li> <p>ALB target group (HTTP port, v\u00ed d\u1ee5 3000).</p> </li> <li> <p><code>proxy-task</code> / <code>proxy-service</code>:</p> </li> <li> <p>similar to payload, v\u1edbi ALB target group (HTTP port, v\u00ed d\u1ee5 4000).</p> </li> <li> <p><code>dashboard-task</code> / <code>dashboard-service</code> (n\u1ebfu container-based):</p> </li> <li> <p>ALB target group (HTTP port, v\u00ed d\u1ee5 3001).</p> </li> <li> <p><code>update-env-task</code> / <code>update-env-service</code>:</p> </li> <li>no ALB,</li> <li>private subnets, <code>sg-ecs</code>,</li> <li><code>desiredCount = 1</code> (long-running) ho\u1eb7c scheduled task.</li> </ul>"},{"location":"vi/deployment/aws/#6-create-va-configure-application-load-balancer","title":"6. Create v\u00e0 configure Application Load Balancer","text":"<ul> <li>Create m\u1ed9t ALB trong public subnets v\u1edbi <code>sg-alb</code>.</li> <li> <p>Create target groups:</p> </li> <li> <p><code>tg-payload</code> \u2192 ECS tasks (payload),</p> </li> <li><code>tg-proxy</code> \u2192 ECS tasks (proxy),</li> <li> <p><code>tg-dashboard</code> \u2192 ECS tasks (dashboard) n\u1ebfu applicable.</p> </li> <li> <p>Configure listeners:</p> </li> <li> <p>HTTP (80) \u2192 redirect t\u1edbi HTTPS (443),</p> </li> <li> <p>HTTPS (443):</p> <ul> <li>path <code>/admin*</code> \u2192 <code>tg-payload</code>,</li> <li>path <code>/api*</code> \u2192 <code>tg-proxy</code>,</li> <li>path <code>/</code> \u2192 <code>tg-dashboard</code> (ho\u1eb7c CloudFront n\u1ebfu s\u1eed d\u1ee5ng static hosting).</li> </ul> </li> <li> <p>Attach m\u1ed9t ACM certificate cho domain(s) c\u1ee7a b\u1ea1n.</p> </li> </ul>"},{"location":"vi/deployment/aws/#7-dns-va-domains","title":"7. DNS v\u00e0 domains","text":"<p>S\u1eed d\u1ee5ng Route 53 (ho\u1eb7c DNS provider kh\u00e1c) \u0111\u1ec3:</p> <ul> <li>point <code>city.example</code> ho\u1eb7c <code>dashboard.city.example</code> t\u1edbi ALB,</li> <li>point <code>admin.city.example</code> t\u1edbi c\u00f9ng ALB n\u1ebfu mu\u1ed1n m\u1ed9t host ri\u00eang cho PayloadCMS admin.</li> </ul> <p>Check:</p> <ul> <li>HTTP(S) routing,</li> <li>TLS configuration,</li> <li>r\u1eb1ng PayloadCMS v\u00e0 dashboard load correctly.</li> </ul>"},{"location":"vi/deployment/aws/#8-verify-data-flow","title":"8. Verify data flow","text":"<p>Sau khi services \u0111ang ch\u1ea1y:</p> <ul> <li> <p>confirm broker health:</p> </li> <li> <p>t\u1eeb m\u1ed9t ECS task ho\u1eb7c m\u1ed9t bastion host, call broker's NGSI-LD endpoint.</p> </li> <li> <p>confirm PayloadCMS connects t\u1edbi RDS:</p> </li> <li> <p>complete b\u1ea5t k\u1ef3 initial admin setup,</p> </li> <li> <p>log in t\u1edbi admin UI.</p> </li> <li> <p>confirm update servers write entities:</p> </li> <li> <p>check update server logs trong CloudWatch,</p> </li> <li> <p>query broker cho <code>WeatherObserved</code> ho\u1eb7c c\u00e1c entities kh\u00e1c.</p> </li> <li> <p>confirm proxy returns data:</p> </li> <li> <p>call <code>/api/...</code> endpoints qua ALB,</p> </li> <li> <p>check r\u1eb1ng responses reflect entities trong broker.</p> </li> <li> <p>confirm dashboard shows data:</p> </li> <li>open dashboard URL,</li> <li>check map layers v\u00e0 widgets cho live entities.</li> </ul>"},{"location":"vi/deployment/aws/#monitoring-va-logging","title":"Monitoring v\u00e0 logging","text":"<p>S\u1eed d\u1ee5ng CloudWatch Logs v\u00e0 CloudWatch metrics:</p> <ul> <li> <p>send logs t\u1eeb ECS tasks t\u1edbi CloudWatch Log Groups:</p> </li> <li> <p>m\u1ed9t log group per service th\u01b0\u1eddng \u0111\u1ee7.</p> </li> <li> <p>define CloudWatch alarms cho:</p> </li> <li>ECS service kh\u00f4ng reaching desired count,</li> <li>high CPU/memory usage,</li> <li>RDS storage ho\u1eb7c CPU thresholds,</li> <li>broker ho\u1eb7c proxy health check failures.</li> </ul> <p>Optional:</p> <ul> <li>integrate v\u1edbi email/Slack/other qua SNS cho alerts,</li> <li>s\u1eed d\u1ee5ng AWS X-Ray ho\u1eb7c similar cho deeper request tracing n\u1ebfu c\u1ea7n.</li> </ul>"},{"location":"vi/deployment/aws/#backups-va-restoration","title":"Backups v\u00e0 restoration","text":"<p>Primary stateful components:</p> <ul> <li> <p>RDS (PayloadCMS DB):</p> </li> <li> <p>configure automatic backups,</p> </li> <li>enable point-in-time recovery n\u1ebfu c\u1ea7n,</li> <li> <p>create manual snapshots tr\u01b0\u1edbc major changes.</p> </li> <li> <p>Broker storage:</p> </li> <li> <p>n\u1ebfu broker keeps state tr\u00ean disk:</p> <ul> <li>s\u1eed d\u1ee5ng EBS snapshots,</li> <li>ho\u1eb7c export entities periodically.</li> </ul> </li> <li> <p>Configuration:</p> </li> <li>SSM parameters v\u00e0 service definitions l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a infrastructure-as-code ho\u1eb7c documented procedures.</li> </ul> <p>Restoration drills:</p> <ul> <li>periodically restore RDS t\u1edbi m\u1ed9t test instance,</li> <li>verify PayloadCMS c\u00f3 th\u1ec3 connect v\u00e0 data nh\u1ea5t qu\u00e1n.</li> </ul>"},{"location":"vi/deployment/aws/#updating-services","title":"Updating services","text":"<p>\u0110\u1ec3 deploy versions m\u1edbi c\u1ee7a LegoCity components:</p> <ol> <li>Build v\u00e0 push images m\u1edbi t\u1edbi ECR.</li> <li>Update ECS task definitions \u0111\u1ec3 reference image tags m\u1edbi.</li> <li>Deploy task definitions m\u1edbi t\u1edbi corresponding services:</li> <li>qua ECS rolling update,</li> <li>ho\u1eb7c s\u1eed d\u1ee5ng deployment pipelines.</li> </ol> <p>Th\u1ee9 t\u1ef1 updates:</p> <ul> <li>update non-critical components tr\u01b0\u1edbc (dashboard),</li> <li>sau \u0111\u00f3 proxy v\u00e0 update servers,</li> <li>cu\u1ed1i c\u00f9ng broker v\u00e0 PayloadCMS (trong m\u1ed9t maintenance window n\u1ebfu schema changes).</li> </ul> <p>\u0110\u1ea3m b\u1ea3o:</p> <ul> <li>backward compatibility khi c\u00f3 th\u1ec3,</li> <li>r\u1eb1ng configuration (SSM parameters) matches expected schema c\u1ee7a versions m\u1edbi.</li> </ul>"},{"location":"vi/deployment/aws/#cost-va-resource-considerations","title":"Cost v\u00e0 resource considerations","text":"<p>Rough cost drivers tr\u00ean AWS:</p> <ul> <li>ECS tasks (CPU/memory) cho broker, PayloadCMS, proxy, dashboard v\u00e0 update servers,</li> <li>RDS instance size v\u00e0 storage,</li> <li>ALB v\u00e0 data transfer,</li> <li>S3 v\u00e0 CloudFront (n\u1ebfu s\u1eed d\u1ee5ng),</li> <li>NAT gateway (c\u00f3 th\u1ec3 non-trivial cho low-traffic deployments).</li> </ul> <p>\u0110\u1ec3 control costs:</p> <ul> <li>start v\u1edbi small Fargate task sizes (v\u00ed d\u1ee5 0.25 vCPU / 0.5\u20131 GB RAM),</li> <li>choose m\u1ed9t small RDS instance cho dev v\u00e0 m\u1ed9t moderate one cho prod,</li> <li>scale task counts v\u00e0 sizes khi usage grows,</li> <li>consider turning off non-essential update servers trong dev khi kh\u00f4ng s\u1eed d\u1ee5ng.</li> </ul>"},{"location":"vi/deployment/aws/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>Tr\u00ean AWS, c\u00e1c components c\u1ee7a LegoCity \u00e1nh x\u1ea1 cleanly t\u1edbi ECS/EKS, RDS, ALB, S3/CloudFront v\u00e0 c\u00e1c supporting services nh\u01b0 SSM v\u00e0 CloudWatch.</li> <li>M\u1ed9t minimal architecture s\u1eed d\u1ee5ng m\u1ed9t ECS cluster trong m\u1ed9t VPC, RDS cho PayloadCMS, Fargate services cho broker, PayloadCMS, proxy, dashboard, v\u00e0 update servers, c\u1ed9ng m\u1ed9t ALB cho ingress.</li> <li>Configuration v\u00e0 secrets n\u00ean \u0111\u01b0\u1ee3c stored trong SSM Parameter Store ho\u1eb7c Secrets Manager v\u00e0 injected v\u00e0o ECS tasks at runtime.</li> <li>M\u1ed9t staged deployment (dev + prod) v\u1edbi c\u00e1c SSM prefixes v\u00e0 ECS services ri\u00eang bi\u1ec7t gi\u00fap control changes v\u00e0 risk.</li> <li>Maintenance requires regular monitoring (CloudWatch), backups (RDS snapshots, broker storage), v\u00e0 controlled rolling updates qua ECS.</li> </ul>"},{"location":"vi/deployment/cloudflare/","title":"Tri\u1ec3n khai tr\u00ean Cloudflare","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch tri\u1ec3n khai b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n LegoCity (ho\u1eb7c m\u1ed9t ph\u1ea7n c\u1ee7a n\u00f3) tr\u00ean Cloudflare, s\u1eed d\u1ee5ng:</p> <ul> <li>Cloudflare Pages cho b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n Next.js t\u0129nh,</li> <li>Cloudflare Workers cho l\u1edbp proxy API m\u1ecfng (t\u00f9y ch\u1ecdn).</li> </ul> <p>Trong thi\u1ebft l\u1eadp n\u00e0y:</p> <ul> <li>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n \u0111\u01b0\u1ee3c ph\u1ee5c v\u1ee5 t\u1eeb m\u1ea1ng l\u01b0\u1edbi bi\u00ean c\u1ee7a Cloudflare,</li> <li>Ph\u1ea7n ph\u1ee5 tr\u1ee3 (broker, PayloadCMS, m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt) v\u1eabn \u1edf tr\u00ean h\u1ea1 t\u1ea7ng c\u1ee7a b\u1ea1n (VM / AWS / Coolify / v.v.),</li> <li>M\u1ed9t Worker (t\u00f9y ch\u1ecdn) c\u00f3 th\u1ec3 n\u1eb1m gi\u1eefa dashboard v\u00e0 backend, \u0111\u1ecbnh tuy\u1ebfn c\u00e1c y\u00eau c\u1ea7u API.</li> </ul>"},{"location":"vi/deployment/cloudflare/#khi-nao-su-dung-trien-khai-cloudflare","title":"Khi n\u00e0o s\u1eed d\u1ee5ng tri\u1ec3n khai Cloudflare","text":"<p>S\u1eed d\u1ee5ng Cloudflare khi:</p> <ul> <li>B\u1ea1n mu\u1ed1n ph\u1ee5c v\u1ee5 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n to\u00e0n c\u1ea7u v\u1edbi \u0111\u1ed9 tr\u1ec5 th\u1ea5p,</li> <li>B\u1ea1n mu\u1ed1n t\u1eadn d\u1ee5ng b\u1ed9 nh\u1edb \u0111\u1ec7m bi\u00ean v\u00e0 b\u1ea3o v\u1ec7 DDoS c\u1ee7a Cloudflare,</li> <li>B\u1ea1n \u0111\u00e3 c\u00f3 ph\u1ea7n ph\u1ee5 tr\u1ee3 \u0111\u01b0\u1ee3c tri\u1ec3n khai \u1edf n\u01a1i kh\u00e1c v\u00e0 ch\u1ec9 c\u1ea7n giao di\u1ec7n c\u00f4ng khai cho b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li>B\u1ea1n \u01b0a th\u00edch c\u00e1ch ti\u1ebfp c\u1eadn kh\u00f4ng c\u1ea7n server/bi\u00ean m\u00e0 kh\u00f4ng c\u1ea7n qu\u1ea3n l\u00fd vi\u1ec7c l\u01b0u tr\u1eef container cho b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n.</li> </ul> <p>Gi\u1edbi h\u1ea1n:</p> <ul> <li>Cloudflare kh\u00f4ng l\u01b0u tr\u1eef logic ph\u1ea7n ph\u1ee5 tr\u1ee3 (broker, PayloadCMS),</li> <li>C\u01a1 s\u1edf d\u1eef li\u1ec7u v\u00e0 l\u01b0u tr\u1eef b\u1ec1n v\u1eefng ph\u1ea3i \u0111\u01b0\u1ee3c x\u1eed l\u00fd \u1edf backend c\u1ee7a b\u1ea1n,</li> <li>C\u00e1c route API trong Next.js c\u00f3 th\u1ec3 c\u1ea7n \u0111\u01b0\u1ee3c t\u00e1i c\u1ea5u tr\u00fac th\u00e0nh Workers n\u1ebfu b\u1ea1n tri\u1ec3n khai ho\u00e0n to\u00e0n t\u0129nh.</li> </ul>"},{"location":"vi/deployment/cloudflare/#kien-truc-tong-quan","title":"Ki\u1ebfn tr\u00fac t\u1ed5ng quan","text":"<pre><code>Ng\u01b0\u1eddi d\u00f9ng\n  |\nCloudflare Pages (giao di\u1ec7n dashboard)\n  |\nCloudflare Workers (proxy API t\u00f9y ch\u1ecdn)\n  |\nH\u1ea1 t\u1ea7ng backend c\u1ee7a b\u1ea1n (VM / AWS / v.v.)\n  \u251c\u2500\u2500 Broker (NGSI-LD)\n  \u251c\u2500\u2500 PayloadCMS\n  \u2514\u2500\u2500 M\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt\n</code></pre> <p>Tri\u1ec3n khai Cloudflare t\u00e1ch frontend kh\u1ecfi backend:</p> <ul> <li>Frontend: Dashboard tr\u00ean Cloudflare Pages,</li> <li>Backend: T\u1ea5t c\u1ea3 logic, c\u01a1 s\u1edf d\u1eef li\u1ec7u, brokers, m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt tr\u00ean h\u1ea1 t\u1ea7ng c\u1ee7a b\u1ea1n,</li> <li>Workers: L\u1edbp m\u1ecfng t\u00f9y ch\u1ecdn \u0111\u1ec3 \u1ee7y quy\u1ec1n c\u00e1c y\u00eau c\u1ea7u API ho\u1eb7c th\u00eam logic bi\u00ean (x\u00e1c th\u1ef1c, b\u1ed9 nh\u1edb \u0111\u1ec7m, gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9).</li> </ul>"},{"location":"vi/deployment/cloudflare/#cac-thanh-phan-trong-trien-khai-cloudflare","title":"C\u00e1c th\u00e0nh ph\u1ea7n trong tri\u1ec3n khai Cloudflare","text":"<ol> <li> <p>Cloudflare Pages: L\u01b0u tr\u1eef b\u1ea3n build dashboard t\u0129nh</p> </li> <li> <p>Next.js \u0111\u01b0\u1ee3c xu\u1ea5t d\u01b0\u1edbi d\u1ea1ng HTML/CSS/JS t\u0129nh,</p> </li> <li> <p>Ho\u1eb7c \u0111\u01b0\u1ee3c tri\u1ec3n khai d\u01b0\u1edbi d\u1ea1ng Pages v\u1edbi k\u1ebft xu\u1ea5t ph\u00eda m\u00e1y ch\u1ee7 tr\u00ean Workers (n\u1ebfu s\u1eed d\u1ee5ng Next.js v\u1edbi Pages Functions).</p> </li> <li> <p>Cloudflare Workers (t\u00f9y ch\u1ecdn): Proxy API m\u1ecfng</p> </li> <li> <p>Chuy\u1ec3n ti\u1ebfp c\u00e1c y\u00eau c\u1ea7u t\u1eeb dashboard t\u1edbi API backend (c\u00e1c route <code>/api/*</code>),</p> </li> <li>C\u00f3 th\u1ec3 th\u00eam headers (kh\u00f3a x\u00e1c th\u1ef1c),</li> <li> <p>C\u00f3 th\u1ec3 l\u01b0u \u0111\u1ec7m m\u1ed9t s\u1ed1 ph\u1ea3n h\u1ed3i t\u1ea1i bi\u00ean.</p> </li> <li> <p>H\u1ea1 t\u1ea7ng backend: Kh\u00f4ng thay \u0111\u1ed5i</p> </li> <li>Broker, PayloadCMS, c\u01a1 s\u1edf d\u1eef li\u1ec7u, m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u1eabn \u1edf tr\u00ean VM, AWS, Coolify, v.v.</li> <li>\u0110\u01b0\u1ee3c truy c\u1eadp t\u1eeb Workers ho\u1eb7c tr\u1ef1c ti\u1ebfp t\u1eeb dashboard qua c\u00e1c API c\u00f4ng khai.</li> </ol>"},{"location":"vi/deployment/cloudflare/#cac-buoc-trien-khai","title":"C\u00e1c b\u01b0\u1edbc tri\u1ec3n khai","text":""},{"location":"vi/deployment/cloudflare/#1-trien-khai-backend-broker-payloadcms-may-chu-cap-nhat","title":"1. Tri\u1ec3n khai backend (broker, PayloadCMS, m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt)","text":"<p>Backend ph\u1ea3i \u0111\u00e3 \u0111\u01b0\u1ee3c tri\u1ec3n khai tr\u00ean h\u1ea1 t\u1ea7ng \u1ed5n \u0111\u1ecbnh:</p> <ul> <li>C\u00f3 th\u1ec3 l\u00e0 thi\u1ebft l\u1eadp VM + Docker,</li> <li>C\u00f3 th\u1ec3 l\u00e0 AWS ECS + RDS,</li> <li>C\u00f3 th\u1ec3 l\u00e0 Coolify,</li> <li>Ho\u1eb7c b\u1ea5t k\u1ef3 n\u1ec1n t\u1ea3ng n\u00e0o kh\u00e1c.</li> </ul> <p>\u0110\u1ea3m b\u1ea3o:</p> <ul> <li>Broker c\u00f3 th\u1ec3 truy c\u1eadp qua \u0111i\u1ec3m cu\u1ed1i ri\u00eang t\u01b0 ho\u1eb7c truy c\u1eadp \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t,</li> <li>Qu\u1ea3n tr\u1ecb PayloadCMS \u0111\u01b0\u1ee3c b\u1ea3o m\u1eadt (truy c\u1eadp h\u1ea1n ch\u1ebf),</li> <li>L\u1edbp proxy / API \u0111\u01b0\u1ee3c ph\u01a1i b\u00e0y qua URL c\u00f4ng khai (v\u00ed d\u1ee5: <code>https://api.city.example</code>),</li> <li>M\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt \u0111ang ch\u1ea1y v\u00e0 ghi d\u1eef li\u1ec7u v\u00e0o broker.</li> </ul>"},{"location":"vi/deployment/cloudflare/#2-chuan-bi-dashboard-cho-cloudflare-pages","title":"2. Chu\u1ea9n b\u1ecb dashboard cho Cloudflare Pages","text":"<p>\u0110\u1ed1i v\u1edbi dashboard Next.js, c\u00f3 hai c\u00e1ch ti\u1ebfp c\u1eadn:</p>"},{"location":"vi/deployment/cloudflare/#tuy-chon-a-xuat-tinh-on-gian-nhat","title":"T\u00f9y ch\u1ecdn A: Xu\u1ea5t t\u0129nh (\u0111\u01a1n gi\u1ea3n nh\u1ea5t)","text":"<p>X\u00e2y d\u1ef1ng Next.js nh\u01b0 m\u1ed9t trang web t\u0129nh:</p> <pre><code>// next.config.js\nmodule.exports = {\n  output: 'export',\n  // ... other configuration\n}\n</code></pre> <p>X\u00e2y d\u1ef1ng:</p> <pre><code>npm run build\n</code></pre> <p>L\u1ec7nh n\u00e0y s\u1ebd t\u1ea1o th\u01b0 m\u1ee5c <code>out/</code> v\u1edbi c\u00e1c t\u1ec7p HTML/JS/CSS t\u0129nh.</p> <p>Gi\u1edbi h\u1ea1n:</p> <ul> <li>Kh\u00f4ng c\u00f3 c\u00e1c route API ph\u00eda m\u00e1y ch\u1ee7,</li> <li>T\u1ea5t c\u1ea3 vi\u1ec7c l\u1ea5y d\u1eef li\u1ec7u ph\u1ea3i t\u1eeb ph\u00eda m\u00e1y kh\u00e1ch ho\u1eb7c qua c\u00e1c API b\u00ean ngo\u00e0i.</li> </ul>"},{"location":"vi/deployment/cloudflare/#tuy-chon-b-trien-khai-voi-pages-functions-ssr","title":"T\u00f9y ch\u1ecdn B: Tri\u1ec3n khai v\u1edbi Pages Functions (SSR)","text":"<p>N\u1ebfu dashboard c\u1ea7n k\u1ebft xu\u1ea5t ph\u00eda m\u00e1y ch\u1ee7 ho\u1eb7c c\u00e1c route API, b\u1ea1n c\u00f3 th\u1ec3 tri\u1ec3n khai Next.js d\u01b0\u1edbi d\u1ea1ng Pages v\u1edbi Functions:</p> <ul> <li>Cloudflare Pages h\u1ed7 tr\u1ee3 tri\u1ec3n khai Next.js v\u1edbi adapter cho Pages Functions,</li> <li>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p k\u1ebft xu\u1ea5t ph\u00eda m\u00e1y ch\u1ee7 v\u00e0 c\u00e1c route API \u0111\u01b0\u1ee3c th\u1ef1c thi t\u1ea1i bi\u00ean.</li> </ul> <p>Tham kh\u1ea3o t\u00e0i li\u1ec7u Cloudflare Pages cho tri\u1ec3n khai Next.js v\u1edbi Pages Functions.</p>"},{"location":"vi/deployment/cloudflare/#3-tao-du-an-cloudflare-pages","title":"3. T\u1ea1o d\u1ef1 \u00e1n Cloudflare Pages","text":"<p>Trong b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n Cloudflare:</p> <ul> <li>\u0110i t\u1edbi Pages,</li> <li>T\u1ea1o d\u1ef1 \u00e1n m\u1edbi,</li> <li>K\u1ebft n\u1ed1i v\u1edbi kho l\u01b0u tr\u1eef Git (GitHub, GitLab) ho\u1eb7c t\u1ea3i l\u00ean tr\u1ef1c ti\u1ebfp.</li> </ul> <p>C\u00e0i \u0111\u1eb7t x\u00e2y d\u1ef1ng cho xu\u1ea5t t\u0129nh:</p> <ul> <li>L\u1ec7nh x\u00e2y d\u1ef1ng: <code>npm run build</code> (ho\u1eb7c b\u1ea5t k\u1ef3 script x\u00e2y d\u1ef1ng n\u00e0o c\u1ee7a b\u1ea1n),</li> <li>Th\u01b0 m\u1ee5c \u0111\u1ea7u ra: <code>out</code> (cho xu\u1ea5t t\u0129nh),</li> <li>Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng: \u0110\u1eb7t b\u1ea5t k\u1ef3 bi\u1ebfn <code>NEXT_PUBLIC_*</code> n\u00e0o c\u1ea7n thi\u1ebft (v\u00ed d\u1ee5: URL c\u01a1 s\u1edf API).</li> </ul> <p>Tri\u1ec3n khai:</p> <ul> <li>Cloudflare s\u1ebd x\u00e2y d\u1ef1ng v\u00e0 tri\u1ec3n khai t\u1ef1 \u0111\u1ed9ng,</li> <li>Sau khi \u0111\u01b0\u1ee3c tri\u1ec3n khai, dashboard c\u00f3 s\u1eb5n t\u1ea1i <code>https://&lt;t\u00ean-d\u1ef1-\u00e1n&gt;.pages.dev</code>.</li> </ul> <p>T\u00ean mi\u1ec1n t\u00f9y ch\u1ec9nh:</p> <ul> <li>Th\u00eam t\u00ean mi\u1ec1n t\u00f9y ch\u1ec9nh trong c\u00e0i \u0111\u1eb7t Pages,</li> <li>Tr\u1ecf b\u1ea3n ghi DNS t\u1edbi Cloudflare (th\u01b0\u1eddng l\u00e0 CNAME t\u1edbi <code>&lt;t\u00ean-d\u1ef1-\u00e1n&gt;.pages.dev</code>).</li> </ul>"},{"location":"vi/deployment/cloudflare/#4-cau-hinh-cac-yeu-cau-api-tu-dashboard","title":"4. C\u1ea5u h\u00ecnh c\u00e1c y\u00eau c\u1ea7u API t\u1eeb dashboard","text":"<p>N\u1ebfu dashboard c\u1ea7n g\u1ecdi c\u00e1c API backend:</p> <ul> <li>\u0110\u1eb7t bi\u1ebfn m\u00f4i tr\u01b0\u1eddng <code>NEXT_PUBLIC_API_BASE_URL</code> t\u1edbi URL backend (v\u00ed d\u1ee5: <code>https://api.city.example</code>),</li> <li>Dashboard s\u1ebd th\u1ef1c hi\u1ec7n c\u00e1c y\u00eau c\u1ea7u tr\u1ef1c ti\u1ebfp t\u1edbi URL \u0111\u00f3.</li> </ul> <p>N\u1ebfu backend kh\u00f4ng th\u1ec3 truy c\u1eadp c\u00f4ng khai:</p> <ul> <li>Thi\u1ebft l\u1eadp Worker proxy (xem b\u00ean d\u01b0\u1edbi).</li> </ul>"},{"location":"vi/deployment/cloudflare/#5-trien-khai-cloudflare-worker-proxy-api-tuy-chon","title":"5. Tri\u1ec3n khai Cloudflare Worker (proxy API t\u00f9y ch\u1ecdn)","text":"<p>N\u1ebfu b\u1ea1n mu\u1ed1n Worker n\u1eb1m gi\u1eefa dashboard v\u00e0 backend:</p> <p>M\u1ee5c \u0111\u00edch:</p> <ul> <li>\u1ea8n c\u00e1c URL backend kh\u1ecfi m\u00e1y kh\u00e1ch,</li> <li>Th\u00eam c\u00e1c header x\u00e1c th\u1ef1c,</li> <li>L\u01b0u \u0111\u1ec7m c\u00e1c ph\u1ea3n h\u1ed3i t\u1ea1i bi\u00ean,</li> <li>Gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 ho\u1eb7c logic bi\u00ean kh\u00e1c.</li> </ul> <p>V\u00ed d\u1ee5 Worker:</p> <pre><code>// worker.js\nexport default {\n  async fetch(request, env) {\n    const url = new URL(request.url);\n\n    // \u0110\u1ecbnh tuy\u1ebfn c\u00e1c y\u00eau c\u1ea7u API t\u1edbi backend\n    if (url.pathname.startsWith(\"/api/\")) {\n      const backendUrl = `https://your-backend.example${url.pathname}${url.search}`;\n\n      // Chuy\u1ec3n ti\u1ebfp y\u00eau c\u1ea7u t\u1edbi backend\n      const response = await fetch(backendUrl, {\n        method: request.method,\n        headers: request.headers,\n        body: request.body,\n      });\n\n      return response;\n    }\n\n    // \u0110\u1ed1i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c y\u00eau c\u1ea7u kh\u00e1c, ph\u1ee5c v\u1ee5 t\u1eeb Pages\n    return env.ASSETS.fetch(request);\n  },\n};\n</code></pre> <p>Tri\u1ec3n khai Worker:</p> <pre><code>npm install -g wrangler\nwrangler login\nwrangler publish\n</code></pre> <p>\u0110\u1ecbnh tuy\u1ebfn Worker:</p> <ul> <li>Trong b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n Cloudflare, c\u1ea5u h\u00ecnh route cho t\u00ean mi\u1ec1n c\u1ee7a b\u1ea1n (v\u00ed d\u1ee5: <code>city.example/*</code> \u2192 Worker),</li> <li>\u0110i\u1ec1u n\u00e0y \u0111\u1ea3m b\u1ea3o Worker x\u1eed l\u00fd c\u00e1c y\u00eau c\u1ea7u tr\u01b0\u1edbc khi t\u1edbi Pages.</li> </ul>"},{"location":"vi/deployment/cloudflare/#6-xac-minh-trien-khai","title":"6. X\u00e1c minh tri\u1ec3n khai","text":"<ul> <li>M\u1edf URL dashboard (<code>https://city.example</code> ho\u1eb7c <code>https://&lt;t\u00ean-d\u1ef1-\u00e1n&gt;.pages.dev</code>),</li> <li>Ki\u1ec3m tra b\u1ea3n \u0111\u1ed3 c\u00f3 t\u1ea3i kh\u00f4ng,</li> <li>X\u00e1c minh c\u00e1c l\u1edbp d\u1eef li\u1ec7u l\u1ea5y th\u1ef1c th\u1ec3 t\u1eeb broker (qua API backend ho\u1eb7c Worker),</li> <li>Ki\u1ec3m tra qu\u1ea3n tr\u1ecb PayloadCMS c\u00f3 th\u1ec3 truy c\u1eadp (n\u1ebfu \u0111\u01b0\u1ee3c \u0111\u1ecbnh tuy\u1ebfn qua c\u00f9ng t\u00ean mi\u1ec1n).</li> </ul>"},{"location":"vi/deployment/cloudflare/#can-nhac-bao-mat","title":"C\u00e2n nh\u1eafc b\u1ea3o m\u1eadt","text":"<p>Trong tri\u1ec3n khai Cloudflare:</p> <ul> <li>Dashboard: C\u00f4ng khai, b\u1ea5t k\u1ef3 ai c\u0169ng c\u00f3 th\u1ec3 truy c\u1eadp (tr\u1eeb khi b\u1ea1n th\u00eam l\u1edbp x\u00e1c th\u1ef1c),</li> <li> <p>API Backend: N\u00ean \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7:</p> </li> <li> <p>H\u1ea1n ch\u1ebf truy c\u1eadp t\u1edbi c\u00e1c IP \u0111\u00e3 bi\u1ebft (v\u00ed d\u1ee5: IP c\u1ee7a Cloudflare Workers n\u1ebfu s\u1eed d\u1ee5ng Workers),</p> </li> <li>Y\u00eau c\u1ea7u token x\u00e1c th\u1ef1c trong c\u00e1c y\u00eau c\u1ea7u API,</li> <li> <p>S\u1eed d\u1ee5ng c\u00e1c quy t\u1eafc t\u01b0\u1eddng l\u1eeda tr\u00ean h\u1ea1 t\u1ea7ng backend.</p> </li> <li> <p>Broker: Kh\u00f4ng \u0111\u01b0\u1ee3c ph\u01a1i b\u00e0y tr\u1ef1c ti\u1ebfp; ch\u1ec9 c\u00f3 th\u1ec3 truy c\u1eadp qua proxy backend.</p> </li> <li> <p>Qu\u1ea3n tr\u1ecb PayloadCMS: H\u1ea1n ch\u1ebf truy c\u1eadp:</p> </li> <li>Ch\u1ea1y tr\u00ean subdomain ri\u00eang bi\u1ec7t v\u1edbi truy c\u1eadp h\u1ea1n ch\u1ebf,</li> <li>S\u1eed d\u1ee5ng Cloudflare Access ho\u1eb7c VPN cho giao di\u1ec7n qu\u1ea3n tr\u1ecb.</li> </ul> <p>Thi\u1ebft l\u1eadp \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb:</p> <ul> <li>C\u00e1c route c\u00f4ng khai: <code>/</code>, <code>/map</code>, c\u00e1c trang c\u00f4ng khai,</li> <li>C\u00e1c route \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7: <code>/admin</code>, <code>/api</code> (n\u1ebfu ch\u1ec9 d\u00e0nh cho qu\u1ea3n tr\u1ecb),</li> <li>C\u00e1c route n\u1ed9i b\u1ed9: C\u00e1c \u0111i\u1ec3m cu\u1ed1i broker kh\u00f4ng \u0111\u01b0\u1ee3c ph\u01a1i b\u00e0y c\u00f4ng khai.</li> </ul>"},{"location":"vi/deployment/cloudflare/#giam-sat-va-nhat-ky","title":"Gi\u00e1m s\u00e1t v\u00e0 nh\u1eadt k\u00fd","text":"<p>\u0110\u1ed1i v\u1edbi c\u00e1c th\u00e0nh ph\u1ea7n \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef tr\u00ean Cloudflare:</p> <ul> <li>Pages: Cloudflare cung c\u1ea5p nh\u1eadt k\u00fd tri\u1ec3n khai v\u00e0 ph\u00e2n t\u00edch,</li> <li>Workers: S\u1eed d\u1ee5ng Wrangler \u0111\u1ec3 xem nh\u1eadt k\u00fd:</li> </ul> <pre><code>wrangler tail\n</code></pre> <p>\u0110\u1ed1i v\u1edbi c\u00e1c th\u00e0nh ph\u1ea7n backend:</p> <ul> <li>Ti\u1ebfp t\u1ee5c s\u1eed d\u1ee5ng c\u00e1ch ghi nh\u1eadt k\u00fd hi\u1ec7n c\u00f3 (CloudWatch, nh\u1eadt k\u00fd VM, v.v.).</li> </ul> <p>K\u1ebft h\u1ee3p:</p> <ul> <li>Ph\u00e2n t\u00edch Cloudflare cho l\u01b0u l\u01b0\u1ee3ng frontend,</li> <li>Gi\u00e1m s\u00e1t backend cho t\u00ecnh tr\u1ea1ng API v\u00e0 broker.</li> </ul>"},{"location":"vi/deployment/cloudflare/#cap-nhat-dashboard","title":"C\u1eadp nh\u1eadt dashboard","text":"<p>\u0110\u1ec3 tri\u1ec3n khai phi\u00ean b\u1ea3n m\u1edbi:</p> <ol> <li>\u0110\u1ea9y c\u00e1c thay \u0111\u1ed5i t\u1edbi kho l\u01b0u tr\u1eef Git (n\u1ebfu \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i v\u1edbi Pages),</li> <li>Cloudflare s\u1ebd t\u1ef1 \u0111\u1ed9ng x\u00e2y d\u1ef1ng v\u00e0 tri\u1ec3n khai,</li> <li>Ho\u1eb7c k\u00edch ho\u1ea1t tri\u1ec3n khai th\u1ee7 c\u00f4ng trong b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n Pages.</li> </ol> <p>\u0110\u1ed1i v\u1edbi c\u1eadp nh\u1eadt Worker:</p> <pre><code>wrangler publish\n</code></pre> <p>\u0110\u1ed1i v\u1edbi c\u1eadp nh\u1eadt backend:</p> <ul> <li>L\u00e0m theo quy tr\u00ecnh tri\u1ec3n khai hi\u1ec7n c\u00f3 (VM, AWS, Coolify).</li> </ul>"},{"location":"vi/deployment/cloudflare/#moi-quan-he-voi-cac-mau-trien-khai-khac","title":"M\u1ed1i quan h\u1ec7 v\u1edbi c\u00e1c m\u1eabu tri\u1ec3n khai kh\u00e1c","text":"<p>Tri\u1ec3n khai Cloudflare ho\u1ea1t \u0111\u1ed9ng c\u00f9ng v\u1edbi c\u00e1c m\u1eabu kh\u00e1c:</p> <ul> <li>B\u1ea1n c\u00f3 th\u1ec3 l\u01b0u tr\u1eef backend tr\u00ean:</li> <li>VM + Docker (nh\u01b0 trong t\u00e0i li\u1ec7u VM/Docker),</li> <li>AWS ECS/RDS (nh\u01b0 trong t\u00e0i li\u1ec7u AWS),</li> <li>Coolify, v.v.</li> </ul> <p>Sau \u0111\u00f3 Cloudflare tr\u1edf th\u00e0nh:</p> <ul> <li>Giao di\u1ec7n c\u00f4ng khai cho dashboard,</li> <li>V\u00e0 t\u00f9y ch\u1ecdn l\u00e0 giao di\u1ec7n c\u00f4ng khai cho c\u00e1c y\u00eau c\u1ea7u API (qua Workers).</li> </ul> <p>S\u1ef1 t\u00e1ch bi\u1ec7t n\u00e0y cho ph\u00e9p:</p> <ul> <li>Thay \u0111\u1ed5i n\u1ec1n t\u1ea3ng backend (v\u00ed d\u1ee5: t\u1eeb VM sang AWS) v\u1edbi c\u00e1c thay \u0111\u1ed5i t\u1ed1i thi\u1ec3u trong dashboard,</li> <li>Gi\u1eef brokers v\u00e0 PayloadCMS ph\u00eda sau c\u00e1c \u0111i\u1ec3m cu\u1ed1i \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t.</li> </ul>"},{"location":"vi/deployment/cloudflare/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>Cloudflare \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 l\u01b0u tr\u1eef dashboard LegoCity (qua Pages) v\u00e0 l\u1edbp proxy API m\u1ecfng (qua Workers).</li> <li>Broker, PayloadCMS v\u00e0 m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u1eabn \u1edf trong h\u1ea1 t\u1ea7ng backend c\u1ee7a b\u1ea1n (VM / AWS / kh\u00e1c).</li> <li>Dashboard g\u1ecdi <code>/api/...</code> tr\u00ean t\u00ean mi\u1ec1n c\u1ee7a b\u1ea1n; Workers chuy\u1ec3n ti\u1ebfp nh\u1eefng y\u00eau c\u1ea7u n\u00e0y t\u1edbi API backend c\u1ee7a b\u1ea1n, t\u1eeb \u0111\u00f3 giao ti\u1ebfp v\u1edbi broker.</li> <li>B\u1ea3o m\u1eadt \u0111\u01b0\u1ee3c x\u1eed l\u00fd b\u1edfi:</li> <li>Gi\u1eef broker v\u00e0 DB ngo\u00e0i internet c\u00f4ng khai,</li> <li>H\u1ea1n ch\u1ebf c\u00e1c \u0111i\u1ec3m cu\u1ed1i backend v\u00e0 b\u1ea3o v\u1ec7 ch\u00fang b\u1eb1ng token ho\u1eb7c quy t\u1eafc t\u01b0\u1eddng l\u1eeda,</li> <li>Ch\u1ec9 ph\u01a1i b\u00e0y Workers + Pages ra c\u00f4ng khai.</li> <li>Tri\u1ec3n khai \u0111\u01b0\u1ee3c chia th\u00e0nh ba b\u01b0\u1edbc: tri\u1ec3n khai backend, tri\u1ec3n khai Worker, v\u00e0 tri\u1ec3n khai dashboard.</li> <li>Gi\u00e1m s\u00e1t s\u1eed d\u1ee5ng nh\u1eadt k\u00fd Cloudflare cho c\u00e1c th\u00e0nh ph\u1ea7n bi\u00ean v\u00e0 c\u00f4ng c\u1ee5 th\u00f4ng th\u01b0\u1eddng c\u1ee7a b\u1ea1n cho c\u00e1c th\u00e0nh ph\u1ea7n backend.</li> </ul>"},{"location":"vi/deployment/coolify/","title":"Tri\u1ec3n khai Coolify","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch tri\u1ec3n khai LegoCity s\u1eed d\u1ee5ng Coolify ho\u1eb7c n\u1ec1n t\u1ea3ng \u1ee9ng d\u1ee5ng t\u1ef1 l\u01b0u tr\u1eef t\u01b0\u01a1ng t\u1ef1.</p> <p>N\u00f3 t\u1eadp trung v\u00e0o:</p> <ul> <li>\u00e1nh x\u1ea1 c\u00e1c th\u00e0nh ph\u1ea7n c\u1ee7a LegoCity t\u1edbi \"d\u1ecbch v\u1ee5\" c\u1ee7a Coolify,</li> <li>m\u1eabu s\u1eb5n s\u00e0ng s\u1eed d\u1ee5ng cho m\u00e1y ch\u1ee7 \u0111\u01a1n ho\u1eb7c c\u1ee5m nh\u1ecf,</li> <li>c\u00e1ch c\u1ea5u h\u00ecnh bi\u1ebfn m\u00f4i tr\u01b0\u1eddng, t\u00ean mi\u1ec1n v\u00e0 TLS,</li> <li>b\u1ea3o tr\u00ec c\u01a1 b\u1ea3n (c\u1eadp nh\u1eadt, sao l\u01b0u, gi\u00e1m s\u00e1t) trong thi\u1ebft l\u1eadp n\u00e0y.</li> </ul> <p>Coolify ho\u1ea1t \u0111\u1ed9ng nh\u01b0 m\u1eb7t ph\u1eb3ng ki\u1ec3m so\u00e1t cho c\u00e1c container, gi\u00fap vi\u1ec7c tri\u1ec3n khai d\u1ec5 d\u00e0ng h\u01a1n m\u00e0 kh\u00f4ng c\u1ea7n qu\u1ea3n l\u00fd c\u00e1c l\u1ec7nh Docker th\u00f4 v\u00e0 reverse proxy th\u1ee7 c\u00f4ng.</p>"},{"location":"vi/deployment/coolify/#khi-nao-su-dung-coolify","title":"Khi n\u00e0o s\u1eed d\u1ee5ng Coolify","text":"<p>Tri\u1ec3n khai d\u1ef1a tr\u00ean Coolify l\u00e0 l\u1ef1a ch\u1ecdn t\u1ed1t khi:</p> <ul> <li>b\u1ea1n c\u00f3 m\u1ed9t ho\u1eb7c s\u1ed1 l\u01b0\u1ee3ng nh\u1ecf c\u00e1c m\u00e1y ch\u1ee7,</li> <li>b\u1ea1n mu\u1ed1n c\u00e1ch h\u01b0\u1edbng giao di\u1ec7n \u0111\u1ec3 tri\u1ec3n khai c\u00e1c \u1ee9ng d\u1ee5ng Docker,</li> <li>b\u1ea1n mu\u1ed1n x\u1eed l\u00fd t\u00ean mi\u1ec1n, \u0111\u1ecbnh tuy\u1ebfn v\u00e0 TLS t\u1ef1 \u0111\u1ed9ng,</li> <li>b\u1ea1n kh\u00f4ng mu\u1ed1n qu\u1ea3n l\u00fd Kubernetes ho\u1eb7c c\u00e1c d\u1ecbch v\u1ee5 AWS ph\u1ee9c t\u1ea1p.</li> </ul> <p>N\u00f3 c\u00f3 th\u1ec3 k\u00e9m ph\u00f9 h\u1ee3p h\u01a1n khi:</p> <ul> <li>b\u1ea1n c\u1ea7n \u0111\u1ed9 s\u1eb5n s\u00e0ng cao quy m\u00f4 l\u1edbn, nhi\u1ec1u v\u00f9ng,</li> <li>t\u1ed5 ch\u1ee9c b\u1eaft bu\u1ed9c s\u1eed d\u1ee5ng n\u1ec1n t\u1ea3ng \u0111\u00e1m m\u00e2y v\u00e0 c\u00f4ng c\u1ee5 c\u1ee5 th\u1ec3.</li> </ul>"},{"location":"vi/deployment/coolify/#cac-thanh-phan-nhu-dich-vu-coolify","title":"C\u00e1c th\u00e0nh ph\u1ea7n nh\u01b0 d\u1ecbch v\u1ee5 Coolify","text":"<p>Trong Coolify, m\u1ed7i th\u00e0nh ph\u1ea7n c\u1ee7a LegoCity tr\u1edf th\u00e0nh m\u1ed9t ho\u1eb7c nhi\u1ec1u d\u1ecbch v\u1ee5:</p> <ul> <li> <p>D\u1ecbch v\u1ee5 context broker</p> </li> <li> <p>ch\u1ea1y container NGSI-LD broker.</p> </li> <li> <p>D\u1ecbch v\u1ee5 PayloadCMS</p> </li> <li> <p>ch\u1ea1y container PayloadCMS (Node.js).</p> </li> <li> <p>D\u1ecbch v\u1ee5 c\u01a1 s\u1edf d\u1eef li\u1ec7u cho PayloadCMS</p> </li> <li> <p>container PostgreSQL ho\u1eb7c MongoDB.</p> </li> <li> <p>D\u1ecbch v\u1ee5 Proxy / API</p> </li> <li> <p>backend gi\u1eefa giao di\u1ec7n v\u00e0 broker.</p> </li> <li> <p>D\u1ecbch v\u1ee5 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n</p> </li> <li> <p>giao di\u1ec7n Next.js (c\u00f3 th\u1ec3 l\u00e0 SSR ho\u1eb7c x\u00e2y d\u1ef1ng t\u0129nh).</p> </li> <li> <p>C\u00e1c d\u1ecbch v\u1ee5 m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt</p> </li> <li>m\u1ed9t d\u1ecbch v\u1ee5 cho m\u1ed7i m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt (worker ch\u1ea1y l\u00e2u d\u00e0i).</li> </ul> <p>T\u00f9y ch\u1ecdn, b\u1ea1n c\u00f3 th\u1ec3:</p> <ul> <li>th\u00eam reverse proxy ri\u00eang bi\u1ec7t ho\u1eb7c \u0111\u1ec3 Coolify qu\u1ea3n l\u00fd \u0111\u1ecbnh tuy\u1ebfn tr\u1ef1c ti\u1ebfp,</li> <li>th\u00eam c\u00e1c d\u1ecbch v\u1ee5 h\u1ed7 tr\u1ee3 kh\u00e1c (ch\u1ec9 s\u1ed1, gi\u00e1m s\u00e1t, v.v.) n\u1ebfu c\u1ea7n.</li> </ul>"},{"location":"vi/deployment/coolify/#tien-quyet","title":"Ti\u00ean quy\u1ebft","text":"<p>\u0110\u1ec3 s\u1eed d\u1ee5ng m\u1eabu n\u00e0y, b\u1ea1n c\u1ea7n:</p> <ul> <li>m\u00e1y ch\u1ee7 (ho\u1eb7c VM) \u0111\u00e3 c\u00e0i \u0111\u1eb7t Coolify,</li> <li>t\u00ean mi\u1ec1n v\u1edbi quy\u1ec1n ki\u1ec3m so\u00e1t DNS (v\u00ed d\u1ee5 <code>city.example</code>),</li> <li>kh\u1ea3 n\u0103ng ch\u1ec9 c\u00e1c b\u1ea3n ghi DNS t\u1edbi m\u00e1y ch\u1ee7 Coolify.</li> </ul> <p>V\u1ec1 ph\u00eda LegoCity:</p> <ul> <li>c\u00e1c h\u00ecnh \u1ea3nh container cho broker, PayloadCMS, proxy, b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n v\u00e0 c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</li> <li>c\u00e1c URL kho l\u01b0u tr\u1eef (Git) n\u1ebfu b\u1ea1n \u0111\u1ec3 Coolify x\u00e2y d\u1ef1ng h\u00ecnh \u1ea3nh t\u1eeb ngu\u1ed3n.</li> </ul>"},{"location":"vi/deployment/coolify/#kien-truc-cap-cao-tren-coolify","title":"Ki\u1ebfn tr\u00fac c\u1ea5p cao tr\u00ean Coolify","text":"<p>V\u1ec1 m\u1eb7t logic, tri\u1ec3n khai tr\u00f4ng nh\u01b0:</p> <ul> <li> <p>M\u00e1y ch\u1ee7 Coolify</p> </li> <li> <p>ch\u1ea1y t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch v\u1ee5 LegoCity nh\u01b0 c\u00e1c container,</p> </li> <li> <p>qu\u1ea3n l\u00fd:</p> <ul> <li>chu k\u1ef3 s\u1ed1ng container,</li> <li>\u0111\u1ecbnh tuy\u1ebfn v\u00e0 t\u00ean mi\u1ec1n,</li> <li>ch\u1ee9ng ch\u1ec9 TLS.</li> </ul> </li> <li> <p>C\u00e1c d\u1ecbch v\u1ee5 LegoCity</p> </li> <li>d\u1ecbch v\u1ee5 c\u01a1 s\u1edf d\u1eef li\u1ec7u (PayloadCMS DB),</li> <li>d\u1ecbch v\u1ee5 context broker,</li> <li>d\u1ecbch v\u1ee5 PayloadCMS,</li> <li>d\u1ecbch v\u1ee5 proxy,</li> <li>d\u1ecbch v\u1ee5 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt.</li> </ul> <p>B\u1ed1 c\u1ee5c m\u1ea1ng:</p> <ul> <li>Coolify qu\u1ea3n l\u00fd c\u00e1c m\u1ea1ng n\u1ed9i b\u1ed9 gi\u1eefa c\u00e1c container,</li> <li>l\u01b0u l\u01b0\u1ee3ng b\u00ean ngo\u00e0i \u0111i qua:</li> <li>reverse proxy v\u00e0 c\u1ea5u h\u00ecnh t\u00ean mi\u1ec1n c\u1ee7a Coolify.</li> </ul> <p>Broker v\u00e0 c\u01a1 s\u1edf d\u1eef li\u1ec7u kh\u00f4ng \u0111\u01b0\u1ee3c th\u1edd tr\u1ef1c ti\u1ebfp, tr\u1eeb khi \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh r\u00f5 r\u00e0ng.</p>"},{"location":"vi/deployment/coolify/#lap-ke-hoach-dich-vu-va-ten-mien","title":"L\u1eadp k\u1ebf ho\u1ea1ch d\u1ecbch v\u1ee5 v\u00e0 t\u00ean mi\u1ec1n","text":"<p>Tr\u01b0\u1edbc khi t\u1ea1o d\u1ecbch v\u1ee5, h\u00e3y quy\u1ebft \u0111\u1ecbnh:</p> <ul> <li> <p>b\u1ea1n mu\u1ed1n t\u00ean mi\u1ec1n ho\u1eb7c t\u00ean mi\u1ec1n ph\u1ee5 n\u00e0o:</p> </li> <li> <p>v\u00ed d\u1ee5 <code>city.example</code> \u2192 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</p> </li> <li><code>api.city.example</code> \u2192 proxy,</li> <li> <p><code>admin.city.example</code> \u2192 PayloadCMS.</p> </li> <li> <p>m\u1ed7i d\u1ecbch v\u1ee5 n\u00ean truy c\u1eadp \u0111\u01b0\u1ee3c \u1edf \u0111\u00e2u:</p> </li> <li>m\u1ed9t s\u1ed1 ch\u1ec9 n\u1ed9i b\u1ed9 (broker, DB, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt),</li> <li>m\u1ed9t s\u1ed1 b\u00ean ngo\u00e0i (b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n, proxy, qu\u1ea3n tr\u1ecb PayloadCMS).</li> </ul> <p>\u00c1nh x\u1ea1 \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n \u2192 <code>city.example</code></li> <li>Proxy \u2192 <code>api.city.example</code></li> <li>Qu\u1ea3n tr\u1ecb PayloadCMS \u2192 <code>admin.city.example</code></li> <li>Broker \u2192 kh\u00f4ng c\u00f3 t\u00ean mi\u1ec1n c\u00f4ng khai (ch\u1ec9 n\u1ed9i b\u1ed9)</li> <li>C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt \u2192 kh\u00f4ng c\u00f3 t\u00ean mi\u1ec1n c\u00f4ng khai (ch\u1ec9 n\u1ed9i b\u1ed9)</li> </ul> <p>Coolify cho ph\u00e9p b\u1ea1n g\u00e1n t\u00ean mi\u1ec1n cho m\u1ed7i d\u1ecbch v\u1ee5 v\u00e0 s\u1ebd y\u00eau c\u1ea7u ch\u1ee9ng ch\u1ec9 TLS t\u1ef1 \u0111\u1ed9ng.</p>"},{"location":"vi/deployment/coolify/#inh-nghia-cac-dich-vu-trong-coolify","title":"\u0110\u1ecbnh ngh\u0129a c\u00e1c d\u1ecbch v\u1ee5 trong Coolify","text":""},{"location":"vi/deployment/coolify/#1-dich-vu-co-so-du-lieu-payloadcms-db","title":"1. D\u1ecbch v\u1ee5 c\u01a1 s\u1edf d\u1eef li\u1ec7u (PayloadCMS DB)","text":"<ul> <li> <p>Th\u00eam d\u1ecbch v\u1ee5 C\u01a1 s\u1edf d\u1eef li\u1ec7u m\u1edbi trong Coolify:</p> </li> <li> <p>ch\u1ecdn PostgreSQL ho\u1eb7c MongoDB, theo c\u1ea5u h\u00ecnh PayloadCMS c\u1ee7a b\u1ea1n.</p> </li> <li> <p>C\u1ea5u h\u00ecnh:</p> </li> <li> <p>t\u00ean c\u01a1 s\u1edf d\u1eef li\u1ec7u: <code>payload_db</code> (v\u00ed d\u1ee5),</p> </li> <li>ng\u01b0\u1eddi d\u00f9ng: <code>payload_user</code>,</li> <li> <p>m\u1eadt kh\u1ea9u: m\u1eadt kh\u1ea9u ng\u1eabu nhi\u00ean an to\u00e0n.</p> </li> <li> <p>Ghi ch\u00fa:</p> </li> <li>m\u00e1y ch\u1ee7 n\u1ed9i b\u1ed9,</li> <li>c\u1ed5ng,</li> <li>t\u00ean c\u01a1 s\u1edf d\u1eef li\u1ec7u,</li> <li>ng\u01b0\u1eddi d\u00f9ng v\u00e0 m\u1eadt kh\u1ea9u.</li> </ul> <p>Coolify th\u01b0\u1eddng cung c\u1ea5p chu\u1ed7i k\u1ebft n\u1ed1i b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng tr\u1ef1c ti\u1ebfp trong bi\u1ebfn m\u00f4i tr\u01b0\u1eddng.</p>"},{"location":"vi/deployment/coolify/#2-dich-vu-context-broker","title":"2. D\u1ecbch v\u1ee5 context broker","text":"<ul> <li> <p>Th\u00eam d\u1ecbch v\u1ee5 \u1ee8ng d\u1ee5ng (container) m\u1edbi:</p> </li> <li> <p>ch\u1ecdn \"H\u00ecnh \u1ea3nh Docker\" l\u00e0m ngu\u1ed3n,</p> </li> <li> <p>ch\u1ec9 r\u00f5 h\u00ecnh \u1ea3nh broker (v\u00ed d\u1ee5 <code>orion-ld</code> ho\u1eb7c h\u00ecnh \u1ea3nh t\u00f9y ch\u1ec9nh c\u1ee7a b\u1ea1n).</p> </li> <li> <p>C\u1ea5u h\u00ecnh:</p> </li> <li> <p>c\u1ed5ng n\u1ed9i b\u1ed9: c\u1ed5ng broker s\u1eed d\u1ee5ng (v\u00ed d\u1ee5 <code>1026</code>),</p> </li> <li>kh\u00f4ng c\u00f3 t\u00ean mi\u1ec1n c\u00f4ng khai n\u1ebfu b\u1ea1n mu\u1ed1n n\u00f3 ch\u1ec9 n\u1ed9i b\u1ed9,</li> <li> <p>k\u00edch ho\u1ea1t m\u1ea1ng n\u1ed9i b\u1ed9 \u0111\u1ec3 c\u00e1c d\u1ecbch v\u1ee5 kh\u00e1c c\u00f3 th\u1ec3 truy c\u1eadp n\u00f3.</p> </li> <li> <p>Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng:</p> </li> <li>b\u1ea5t k\u1ef3 c\u1ea5u h\u00ecnh broker n\u00e0o c\u1ea7n thi\u1ebft (t\u00f9y thu\u1ed9c v\u00e0o tri\u1ec3n khai broker).</li> </ul> <p>Coolify s\u1ebd qu\u1ea3n l\u00fd container; c\u00e1c d\u1ecbch v\u1ee5 LegoCity kh\u00e1c s\u1ebd s\u1eed d\u1ee5ng t\u00ean m\u00e1y ch\u1ee7 v\u00e0 c\u1ed5ng n\u1ed9i b\u1ed9 c\u1ee7a broker.</p>"},{"location":"vi/deployment/coolify/#3-dich-vu-payloadcms","title":"3. D\u1ecbch v\u1ee5 PayloadCMS","text":"<ul> <li> <p>Th\u00eam d\u1ecbch v\u1ee5 \u1ee8ng d\u1ee5ng kh\u00e1c:</p> </li> <li> <p>ngu\u1ed3n: kho Git ho\u1eb7c h\u00ecnh \u1ea3nh Docker cho PayloadCMS.</p> </li> <li> <p>N\u1ebfu s\u1eed d\u1ee5ng Git:</p> </li> <li> <p>c\u1ea5u h\u00ecnh x\u00e2y d\u1ef1ng:</p> <ul> <li>phi\u00ean b\u1ea3n Node.js,</li> <li>l\u1ec7nh x\u00e2y d\u1ef1ng (<code>npm run build</code> ho\u1eb7c t\u01b0\u01a1ng t\u1ef1),</li> <li>l\u1ec7nh kh\u1edfi \u0111\u1ed9ng (<code>npm run start</code>),</li> <li>ho\u1eb7c s\u1eed d\u1ee5ng Dockerfile.</li> </ul> </li> <li> <p>\u0110\u00ednh k\u00e8m t\u00ean mi\u1ec1n:</p> </li> <li> <p>v\u00ed d\u1ee5 <code>admin.city.example</code> cho giao di\u1ec7n qu\u1ea3n tr\u1ecb PayloadCMS.</p> </li> <li> <p>Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng:</p> </li> <li><code>PAYLOAD_DB_URL</code> ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng:<ul> <li>s\u1eed d\u1ee5ng chu\u1ed7i k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c cung c\u1ea5p b\u1edfi d\u1ecbch v\u1ee5 c\u01a1 s\u1edf d\u1eef li\u1ec7u,</li> </ul> </li> <li><code>PAYLOAD_SECRET</code>, <code>NODE_ENV</code>, v.v.,</li> <li>b\u1ea5t k\u1ef3 bi\u1ebfn n\u00e0o kh\u00e1c \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u b\u1edfi c\u1ea5u h\u00ecnh PayloadCMS c\u1ee7a b\u1ea1n (v\u00ed d\u1ee5 x\u00e1c th\u1ef1c, l\u01b0u tr\u1eef).</li> </ul> <p>\u0110\u1ea3m b\u1ea3o:</p> <ul> <li>d\u1ecbch v\u1ee5 trong c\u00f9ng m\u1ea1ng n\u1ed9i b\u1ed9 v\u1edbi d\u1ecbch v\u1ee5 DB,</li> <li>d\u1ecbch v\u1ee5 DB kh\u00f4ng \u0111\u01b0\u1ee3c th\u1edd ra b\u00ean ngo\u00e0i.</li> </ul>"},{"location":"vi/deployment/coolify/#4-dich-vu-proxy-api","title":"4. D\u1ecbch v\u1ee5 Proxy / API","text":"<ul> <li> <p>Th\u00eam d\u1ecbch v\u1ee5 \u1ee8ng d\u1ee5ng cho backend proxy:</p> </li> <li> <p>ngu\u1ed3n: kho Git ho\u1eb7c h\u00ecnh \u1ea3nh Docker ch\u1ee9a proxy.</p> </li> <li> <p>\u0110\u00ednh k\u00e8m t\u00ean mi\u1ec1n:</p> </li> <li> <p>v\u00ed d\u1ee5 <code>api.city.example</code>.</p> </li> <li> <p>Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng:</p> </li> <li><code>BROKER_URL</code> \u0111\u1eb7t t\u1edbi URL n\u1ed9i b\u1ed9 c\u1ee7a d\u1ecbch v\u1ee5 broker,</li> <li>c\u1ea5u h\u00ecnh kh\u00e1c (v\u00ed d\u1ee5 ngu\u1ed3n g\u1ed1c \u0111\u01b0\u1ee3c ph\u00e9p, kh\u00f3a API),</li> <li><code>NODE_ENV</code> / <code>APP_ENV</code>.</li> </ul> <p>Proxy l\u00e0 th\u00e0nh ph\u1ea7n duy nh\u1ea5t c\u1ea7n quy\u1ec1n truy c\u1eadp m\u1ea1ng t\u1edbi broker (ngo\u00e0i c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt).</p>"},{"location":"vi/deployment/coolify/#5-dich-vu-bang-ieu-khien","title":"5. D\u1ecbch v\u1ee5 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n","text":"<p>C\u00f3 hai c\u00e1ch ch\u00ednh \u0111\u1ec3 l\u01b0u tr\u1eef b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n:</p>"},{"location":"vi/deployment/coolify/#tuy-chon-a-nextjs-ssr-dich-vu-ung-dung","title":"T\u00f9y ch\u1ecdn A \u2013 Next.js SSR (D\u1ecbch v\u1ee5 \u1ee9ng d\u1ee5ng)","text":"<ul> <li> <p>Th\u00eam d\u1ecbch v\u1ee5 \u1ee8ng d\u1ee5ng:</p> </li> <li> <p>ngu\u1ed3n: kho b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n ho\u1eb7c h\u00ecnh \u1ea3nh,</p> </li> <li> <p>l\u1ec7nh x\u00e2y d\u1ef1ng v\u00e0 kh\u1edfi \u0111\u1ed9ng nh\u01b0 th\u01b0\u1eddng cho Next.js.</p> </li> <li> <p>\u0110\u00ednh k\u00e8m t\u00ean mi\u1ec1n:</p> </li> <li> <p>v\u00ed d\u1ee5 <code>city.example</code>.</p> </li> <li> <p>Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng:</p> </li> <li><code>NEXT_PUBLIC_API_BASE_URL=https://api.city.example</code>,</li> <li><code>NEXT_PUBLIC_MAPBOX_TOKEN</code> v\u00e0 b\u1ea5t k\u1ef3 c\u1ea5u h\u00ecnh c\u00f4ng khai n\u00e0o kh\u00e1c.</li> </ul> <p>T\u00f9y ch\u1ecdn n\u00e0y ch\u1ea1y Next.js nh\u01b0 ti\u1ebfn tr\u00ecnh Node.js \u0111\u1eb1ng sau reverse proxy c\u1ee7a Coolify.</p>"},{"location":"vi/deployment/coolify/#tuy-chon-b-xay-dung-tunh-ung-dung-che-o-tinh","title":"T\u00f9y ch\u1ecdn B \u2013 X\u00e2y d\u1ef1ng t\u0169nh (\u1ee8ng d\u1ee5ng + ch\u1ebf \u0111\u1ed9 t\u0129nh)","text":"<ul> <li>X\u00e2y d\u1ef1ng b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n th\u00e0nh c\u00e1c t\u1ec7p t\u0129nh (v\u00ed d\u1ee5 <code>next export</code>).</li> <li>C\u1ea5u h\u00ecnh d\u1ecbch v\u1ee5 trong Coolify \u0111\u1ec3 ch\u1ec9 ph\u1ee5c v\u1ee5 c\u00e1c t\u1ec7p t\u0129nh.</li> <li>\u0110\u01a1n gi\u1ea3n h\u00f3a th\u1eddi gian ch\u1ea1y nh\u01b0ng h\u1ea1n ch\u1ebf ch\u1ee9c n\u0103ng SSR.</li> </ul> <p>C\u1ea5u h\u00ecnh ch\u00ednh x\u00e1c ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1ch x\u00e2y d\u1ef1ng b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n c\u1ee7a b\u1ea1n; \u0111i\u1ec7u quan tr\u1ecdng l\u00e0:</p> <ul> <li><code>NEXT_PUBLIC_API_BASE_URL</code> ph\u1ea3i ch\u1ec9 t\u1edbi proxy,</li> <li>c\u00e1c t\u00e0i s\u1ea3n t\u0129nh ph\u1ea3i \u0111\u01b0\u1ee3c ph\u1ee5c v\u1ee5 tr\u00ean t\u00ean mi\u1ec1n \u0111\u01b0\u1ee3c ch\u1ecdn c\u1ee7a b\u1ea1n.</li> </ul>"},{"location":"vi/deployment/coolify/#6-cac-dich-vu-may-chu-cap-nhat","title":"6. C\u00e1c d\u1ecbch v\u1ee5 m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt","text":"<ul> <li> <p>Cho m\u1ed7i m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt, th\u00eam d\u1ecbch v\u1ee5 \u1ee8ng d\u1ee5ng:</p> </li> <li> <p>ngu\u1ed3n: kho Git ho\u1eb7c h\u00ecnh \u1ea3nh Docker,</p> </li> <li> <p>lo\u1ea1i: worker n\u1ec1n / ti\u1ebfn tr\u00ecnh ch\u1ea1y l\u00e2u d\u00e0i.</p> </li> <li> <p>Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng:</p> </li> <li> <p><code>BROKER_URL</code> \u2192 URL broker n\u1ed9i b\u1ed9,</p> </li> <li><code>BROKER_WRITE_KEY</code> \u2192 kh\u00f3a ghi cho mi\u1ec1n li\u00ean quan,</li> <li>c\u00e1c kh\u00f3a API b\u00ean ngo\u00e0i (v\u00ed d\u1ee5 <code>WEATHER_API_KEY</code>),</li> <li> <p>b\u1ea5t k\u1ef3 c\u1ea5u h\u00ecnh l\u1ecbch tr\u00ecnh n\u00e0o (n\u1ebfu worker x\u1eed l\u00fd th\u1eddi gian ri\u00eang).</p> </li> <li> <p>M\u1ea1ng:</p> </li> <li>c\u00f9ng m\u1ea1ng n\u1ed9i b\u1ed9 v\u1edbi broker,</li> <li>kh\u00f4ng c\u00f3 t\u00ean mi\u1ec1n c\u00f4ng khai (kh\u00f4ng c\u1ea7n l\u1ed1i v\u00e0o HTTP).</li> </ul> <p>B\u1ea1n c\u00f3 th\u1ec3 ch\u1ea1y c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt kh\u00e1c nhau cho m\u00f4i tr\u01b0\u1eddng, l\u0169 l\u1ee5t, \u0111i l\u1ea1i, v.v.</p>"},{"location":"vi/deployment/coolify/#tach-biet-moi-truong","title":"T\u00e1ch bi\u1ec7t m\u00f4i tr\u01b0\u1eddng","text":"<p>\u0110\u1ec3 gi\u1eef ph\u00e1t tri\u1ec3n v\u00e0 s\u1ea3n xu\u1ea5t ri\u00eang bi\u1ec7t, b\u1ea1n c\u00f3 th\u1ec3:</p> <ul> <li>ch\u1ea1y hai ph\u1ee5c v\u1ee5 Coolify tr\u00ean c\u00e1c m\u00e1y ch\u1ee7 kh\u00e1c nhau, ho\u1eb7c</li> <li>ch\u1ea1y:</li> <li>c\u00e1c d\u1ecbch v\u1ee5 ph\u00e1t tri\u1ec3n v\u00e0 s\u1ea3n xu\u1ea5t tr\u00ean c\u00f9ng Coolify nh\u01b0ng:<ul> <li>v\u1edbi c\u00e1c t\u00ean mi\u1ec1n kh\u00e1c nhau (v\u00ed d\u1ee5 <code>dev.city.example</code> so v\u1edbi <code>city.example</code>),</li> <li>v\u1edbi c\u00e1c ph\u1ee5c v\u1ee5 DB ri\u00eang bi\u1ec7t,</li> <li>v\u1edbi c\u00e1c ph\u1ee5c v\u1ee5 broker kh\u00e1c nhau.</li> </ul> </li> </ul> <p>\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho s\u1ef1 r\u00f5 r\u00e0ng:</p> <ul> <li>m\u1ed9t ph\u1ee5c v\u1ee5 Coolify cho m\u1ed7i m\u00f4i tr\u01b0\u1eddng, ho\u1eb7c</li> <li>\u00edt nh\u1ea5t \u0111\u1eb7t t\u00ean v\u00e0 c\u00f4 l\u1eadp r\u00f5 r\u00e0ng c\u00e1c d\u1ecbch v\u1ee5 v\u00e0 c\u01a1 s\u1edf d\u1eef li\u1ec7u.</li> </ul>"},{"location":"vi/deployment/coolify/#cau-hinh-va-bi-mat-trong-coolify","title":"C\u1ea5u h\u00ecnh v\u00e0 b\u00ed m\u1eadt trong Coolify","text":"<p>Coolify cho ph\u00e9p b\u1ea1n:</p> <ul> <li>\u0111\u1ecbnh ngh\u0129a bi\u1ebfn m\u00f4i tr\u01b0\u1eddng cho m\u1ed7i d\u1ecbch v\u1ee5,</li> <li>\u0111\u00e1nh d\u1ea5u m\u1ed9t s\u1ed1 nh\u01b0 b\u00ed m\u1eadt,</li> <li>ghi \u0111\u00e8 gi\u00e1 tr\u1ecb cho m\u1ed7i l\u1ea7n tri\u1ec3n khai.</li> </ul> <p>Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t:</p> <ul> <li>kh\u00f4ng \u0111\u1eb7t b\u00ed m\u1eadt trong kho l\u01b0u tr\u1eef,</li> <li>\u0111\u1ecbnh ngh\u0129a m\u1eadt kh\u1ea9u DB, kh\u00f3a ghi broker, kh\u00f3a API b\u00ean ngo\u00e0i nh\u01b0 b\u00ed m\u1eadt trong Coolify,</li> <li>gi\u1eef c\u1ea5u h\u00ecnh kh\u00f4ng b\u00ed m\u1eadt (nh\u01b0 t\u00ean ki\u1ec3u b\u1ea3n \u0111\u1ed3) nh\u01b0 bi\u1ebfn th\u00f4ng th\u01b0\u1eddng.</li> </ul> <p>Cho m\u1ed7i d\u1ecbch v\u1ee5, ghi ch\u00e9p:</p> <ul> <li>bi\u1ebfn n\u00e0o ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u1eb7t,</li> <li>gi\u00e1 tr\u1ecb \u0111\u1ebfn t\u1eeb \u0111\u00e2u (d\u1ecbch v\u1ee5 DB, broker, nh\u00e0 cung c\u1ea5p b\u00ean ngo\u00e0i).</li> </ul>"},{"location":"vi/deployment/coolify/#quy-trinh-trien-khai-trong-coolify","title":"Quy tr\u00ecnh tri\u1ec3n khai trong Coolify","text":"<p>Quy tr\u00ecnh \u0111i\u1ec3n h\u00ecnh \u0111\u1ec3 tri\u1ec3n khai thay \u0111\u1ed5i:</p> <ol> <li>\u0110\u1ea9y m\u00e3 m\u1edbi t\u1edbi kho l\u01b0u tr\u1eef Git.</li> <li>Trong Coolify:</li> <li>ho\u1eb7c:<ul> <li>c\u1ea5u h\u00ecnh tri\u1ec3n khai t\u1ef1 \u0111\u1ed9ng khi \u0111\u1ea9y, ho\u1eb7c</li> <li>k\u00edch ho\u1ea1t tri\u1ec3n khai th\u1ee7 c\u00f4ng.</li> </ul> </li> <li>Coolify:</li> <li>k\u00e9o m\u00e3 m\u1edbi nh\u1ea5t,</li> <li>x\u00e2y d\u1ef1ng h\u00ecnh \u1ea3nh \u1ee9ng d\u1ee5ng ho\u1eb7c g\u00f3i,</li> <li>kh\u1edfi \u0111\u1ed9ng l\u1ea1i d\u1ecbch v\u1ee5 v\u1edbi phi\u00ean b\u1ea3n m\u1edbi.</li> </ol> <p>Cho c\u00e1c d\u1ecbch v\u1ee5 d\u1ef1a tr\u00ean h\u00ecnh \u1ea3nh:</p> <ul> <li>c\u1eadp nh\u1eadt th\u1ebb h\u00ecnh \u1ea3nh trong c\u1ea5u h\u00ecnh d\u1ecbch v\u1ee5 Coolify,</li> <li>k\u00edch ho\u1ea1t tri\u1ec3n khai l\u1ea1i.</li> </ul> <p>Th\u1ee9 t\u1ef1 thay \u0111\u1ed5i:</p> <ul> <li>c\u1eadp nh\u1eadt backend/proxy tr\u01b0\u1edbc,</li> <li>sau \u0111\u00f3 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li>th\u1ec9nh tho\u1ea3ng PayloadCMS ho\u1eb7c broker n\u1ebfu h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u thay \u0111\u1ed5i.</li> </ul>"},{"location":"vi/deployment/coolify/#giam-sat-va-nhat-ky","title":"Gi\u00e1m s\u00e1t v\u00e0 nh\u1eadt k\u00fd","text":"<p>Coolify cung c\u1ea5p qu\u1ea3n l\u00fd c\u01a1 b\u1ea3n v\u00e0 truy c\u1eadp v\u00e0o nh\u1eadt k\u00fd:</p> <ul> <li>b\u1ea1n c\u00f3 th\u1ec3 xem nh\u1eadt k\u00fd cho m\u1ed7i d\u1ecbch v\u1ee5 t\u1eeb giao di\u1ec7n,</li> <li>b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y tr\u1ea1ng th\u00e1i container (\u0111ang ch\u1ea1y, th\u1ea5t b\u1ea1i, kh\u1edfi \u0111\u1ed9ng l\u1ea1i).</li> </ul> <p>\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb:</p> <ul> <li>\u0111\u1ecbnh k\u1ef3 ki\u1ec3m tra nh\u1eadt k\u00fd cho:</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt (ti\u1ebfp nh\u1eadn d\u1eef li\u1ec7u),</li> <li>proxy (l\u1ed7i API),</li> <li>PayloadCMS (v\u1ea5n \u0111\u1ec1 DB),</li> <li>broker (t\u00e0i nguy\u00ean ho\u1eb7c l\u1ed7i ng\u1eef c\u1ea3nh).</li> </ul> <p>N\u1ebfu c\u1ea7n, b\u1ea1n c\u00f3 th\u1ec3:</p> <ul> <li>xu\u1ea5t nh\u1eadt k\u00fd sang h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i (ELK, Loki, v.v.),</li> <li>th\u00eam \u0111i\u1ec3m cu\u1ed1i s\u1ee9c kh\u1ecfe v\u00e0o d\u1ecbch v\u1ee5 v\u00e0 s\u1eed d\u1ee5ng ki\u1ec3m tra s\u1ee9c kh\u1ecfe c\u1ee7a Coolify.</li> </ul>"},{"location":"vi/deployment/coolify/#sao-luu-va-bao-tri","title":"Sao l\u01b0u v\u00e0 b\u1ea3o tr\u00ec","text":"<p>C\u00e1c th\u00e0nh ph\u1ea7n c\u00f3 tr\u1ea1ng th\u00e1i tr\u00ean m\u00e1y ch\u1ee7 Coolify:</p> <ul> <li> <p>C\u01a1 s\u1edf d\u1eef li\u1ec7u PayloadCMS:</p> </li> <li> <p>quan tr\u1ecdng \u0111\u1ec3 sao l\u01b0u th\u01b0\u1eddng xuy\u00ean,</p> </li> <li> <p>s\u1eed d\u1ee5ng c\u00f4ng c\u1ee5 g\u1ed1c c\u1ee7a DB ho\u1eb7c add-on sao l\u01b0u n\u1ebfu Coolify h\u1ed7 tr\u1ee3 n\u00f3.</p> </li> <li> <p>L\u01b0u tr\u1eef broker (n\u1ebfu s\u1eed d\u1ee5ng volume b\u1ec1n):</p> </li> <li> <p>nh\u1edb n\u01a1i n\u00f3 \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef tr\u00ean m\u00e1y ch\u1ee7,</p> </li> <li> <p>t\u1ea1o snapshot ho\u1eb7c sao l\u01b0u th\u01b0 m\u1ee5c n\u00e0y.</p> </li> <li> <p>C\u1ea5u h\u00ecnh Coolify:</p> </li> <li>sao l\u01b0u c\u1ea5u h\u00ecnh v\u00e0 metadata c\u1ee7a Coolify,</li> <li>gi\u1eef b\u1ea3n sao c\u00e1c \u0111\u1ecbnh ngh\u0129a tri\u1ec3n khai v\u00e0 bi\u1ebfn m\u00f4i tr\u01b0\u1eddng \u1edf n\u01a1i an to\u00e0n (xu\u1ea5t v\u0103n b\u1ea3n ho\u1eb7c IaC).</li> </ul> <p>Nhi\u1ec7m v\u1ee5 b\u1ea3o tr\u00ec:</p> <ul> <li>\u00e1p d\u1ee5ng c\u1eadp nh\u1eadt h\u1ec7 \u0111i\u1ec1u h\u00e0nh tr\u00ean m\u00e1y ch\u1ee7 (kernel, b\u1ea3o m\u1eadt),</li> <li>c\u1eadp nh\u1eadt \u0111\u1ed9ng c\u01a1 Docker n\u1ebfu li\u00ean quan,</li> <li>c\u1eadp nh\u1eadt b\u1ea3n th\u00e2n Coolify (theo h\u01b0\u1edbng d\u1eabn n\u00e2ng c\u1ea5p c\u1ee7a h\u1ecd),</li> <li>xoay v\u00f2ng th\u00f4ng tin \u0111\u0103ng nh\u1eadp (m\u1eadt kh\u1ea9u DB, kh\u00f3a broker, kh\u00f3a API b\u00ean ngo\u00e0i).</li> </ul> <p>Ki\u1ec3m tra:</p> <ul> <li>kh\u00f4i ph\u1ee5c c\u00e1c b\u1ea3n sao l\u01b0u DB trong m\u00f4i tr\u01b0\u1eddng staging,</li> <li>kh\u1edfi \u0111\u1ed9ng l\u1ea1i d\u1ecbch v\u1ee5 sau khi kh\u1edfi \u0111\u1ed9ng l\u1ea1i m\u00e1y ch\u1ee7.</li> </ul>"},{"location":"vi/deployment/coolify/#mo-rong-va-han-che","title":"M\u1edf r\u1ed9ng v\u00e0 h\u1ea1n ch\u1ebf","text":"<p>Coolify \u0111\u01a1n gi\u1ea3n h\u00f3a tri\u1ec3n khai nh\u01b0ng kh\u00f4ng lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 gi\u1edbi h\u1ea1n h\u1ea1 t\u1ea7ng.</p> <p>Chi\u1ebfn l\u01b0\u1ee3c m\u1edf r\u1ed9ng:</p> <ul> <li>t\u0103ng CPU/b\u1ed9 nh\u1edb \u0111\u01b0\u1ee3c g\u00e1n cho c\u00e1c d\u1ecbch v\u1ee5 c\u1ee5 th\u1ec3,</li> <li>chuy\u1ec3n DB sang m\u00e1y ch\u1ee7 ri\u00eang bi\u1ec7t, m\u1ea1nh h\u01a1n,</li> <li>t\u00e1ch c\u00e1c d\u1ecbch v\u1ee5 n\u1eb7ng (v\u00ed d\u1ee5 broker v\u00e0 PayloadCMS) qua nhi\u1ec1u m\u00e1y ch\u1ee7 \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd b\u1edfi c\u00f9ng ph\u1ee5c v\u1ee5 Coolify (n\u1ebfu \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3).</li> </ul> <p>H\u1ea1n ch\u1ebf:</p> <ul> <li>m\u1edf r\u1ed9ng ngang qua nhi\u1ec1u trung t\u00e2m d\u1eef li\u1ec7u kh\u00f4ng t\u1ef1 \u0111\u1ed9ng,</li> <li>b\u1ea1n v\u1eabn ph\u1ee5 thu\u1ed9c v\u00e0o s\u1ee9c kh\u1ecfe v\u00e0 n\u0103ng l\u1ef1c c\u1ee7a (c\u00e1c) m\u00e1y ch\u1ee7 c\u01a1 b\u1ea3n.</li> </ul> <p>Cho c\u00e1c tri\u1ec3n khai l\u1edbn h\u01a1n, b\u1ea1n c\u00f3 th\u1ec3 sau n\u00e0y chuy\u1ec3n:</p> <ul> <li>broker v\u00e0 DB sang h\u1ea1 t\u1ea7ng chuy\u00ean d\u1ee5ng (AWS/RDS, v.v.),</li> <li>gi\u1eef Coolify ch\u1ee7 y\u1ebfu cho frontend v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 nh\u1ecf h\u01a1n.</li> </ul>"},{"location":"vi/deployment/coolify/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>Coolify cung c\u1ea5p c\u00e1ch h\u01b0\u1edbng giao di\u1ec7n \u0111\u1ec3 tri\u1ec3n khai c\u00e1c th\u00e0nh ph\u1ea7n c\u1ee7a LegoCity nh\u01b0 c\u00e1c container Docker tr\u00ean m\u00e1y ch\u1ee7 \u0111\u01a1n ho\u1eb7c t\u1eadp h\u1ee3p nh\u1ecf c\u00e1c m\u00e1y ch\u1ee7.</li> <li>M\u1ed7i th\u00e0nh ph\u1ea7n ch\u00ednh (broker, PayloadCMS, DB, proxy, b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 d\u1ecbch v\u1ee5 ri\u00eang bi\u1ec7t v\u1edbi bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ri\u00eang v\u00e0, khi c\u1ea7n, t\u00ean mi\u1ec1n.</li> <li>C\u00e1c t\u00ean mi\u1ec1n nh\u01b0 <code>city.example</code>, <code>api.city.example</code> v\u00e0 <code>admin.city.example</code> \u0111\u01b0\u1ee3c \u00e1nh x\u1ea1 qua reverse proxy c\u1ee7a Coolify, c\u0169ng qu\u1ea3n l\u00fd ch\u1ee9ng ch\u1ec9 TLS.</li> <li>C\u1ea5u h\u00ecnh v\u00e0 b\u00ed m\u1eadt \u0111\u01b0\u1ee3c x\u1eed l\u00fd qua bi\u1ebfn m\u00f4i tr\u01b0\u1eddng c\u1ea5p d\u1ecbch v\u1ee5; c\u00e1c d\u1ecbch v\u1ee5 c\u00f3 tr\u1ea1ng th\u00e1i nh\u01b0 DB v\u00e0 broker s\u1eed d\u1ee5ng volume b\u1ec1n v\u00e0 y\u00eau c\u1ea7u sao l\u01b0u \u0111\u1ecbnh k\u1ef3.</li> <li>M\u1eabu n\u00e0y ph\u00f9 h\u1ee3p cho c\u00e1c nh\u00f3m mu\u1ed1n tr\u00e1nh qu\u1ea3n l\u00fd Docker/NGINX c\u1ea5p th\u1ea5p nh\u01b0ng kh\u00f4ng c\u1ea7n s\u1ef1 ph\u1ee9c t\u1ea1p c\u1ee7a n\u1ec1n t\u1ea3ng \u0111\u00e1m m\u00e2y \u0111\u1ea7y \u0111\u1ee7 ho\u1eb7c Kubernetes.</li> </ul>"},{"location":"vi/deployment/operations/","title":"V\u1eadn h\u00e0nh v\u00e0 b\u1ea3o tr\u00ec","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch ch\u1ea1y LegoCity trong d\u00e0i h\u1ea1n:</p> <ul> <li>c\u00e1i g\u00ec c\u1ea7n gi\u00e1m s\u00e1t,</li> <li>c\u00e1i g\u00ec c\u1ea7n sao l\u01b0u,</li> <li>c\u00e1ch c\u1eadp nh\u1eadt c\u00e1c th\u00e0nh ph\u1ea7n an to\u00e0n,</li> <li>c\u00e1ch x\u1eed l\u00fd s\u1ef1 c\u1ed1 v\u00e0 b\u1ea3o m\u1eadt.</li> </ul> <p>N\u00f3 kh\u00f4ng ph\u1ee5 thu\u1ed9c n\u1ec1n t\u1ea3ng: c\u00e1c \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 \u00e1p d\u1ee5ng d\u00f9 b\u1ea1n tri\u1ec3n khai tr\u00ean VM, AWS, Coolify ho\u1eb7c n\u1ec1n t\u1ea3ng kh\u00e1c. C\u00e1c trang c\u1ee5 th\u1ec3 theo n\u1ec1n t\u1ea3ng s\u1ebd ch\u1ec9 c\u00e1ch tri\u1ec3n khai c\u00e1c \u00fd t\u01b0\u1edfng n\u00e0y v\u1edbi c\u00e1c c\u00f4ng c\u1ee5 c\u1ee5 th\u1ec3.</p>"},{"location":"vi/deployment/operations/#trach-nhiem-van-hanh","title":"Tr\u00e1ch nhi\u1ec7m v\u1eadn h\u00e0nh","text":"<p>Tri\u1ec3n khai LegoCity l\u00e0 h\u01a1n c\u1ea3 l\u1ea7n <code>tri\u1ec3n khai</code> \u0111\u1ea7u ti\u00ean:</p> <ul> <li> <p>Kh\u1ea3 d\u1ee5ng   B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n, PayloadCMS v\u00e0 c\u00e1c \u0111i\u1ec3m cu\u1ed1i API n\u00ean c\u00f3 th\u1ec3 truy c\u1eadp v\u00e0 ph\u1ea3n h\u1ed3i.</p> </li> <li> <p>\u0110\u1ed9 m\u1edbi c\u1ee7a d\u1eef li\u1ec7u   C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt ph\u1ea3i ti\u1ebfp t\u1ee5c thu th\u1eadp d\u1eef li\u1ec7u v\u00e0 c\u1eadp nh\u1eadt c\u00e1c th\u1ef1c th\u1ec3.</p> </li> <li> <p>T\u00ednh nh\u1ea5t qu\u00e1n   C\u00e1c m\u00f4 h\u00ecnh th\u1ef1c th\u1ec3 v\u00e0 API ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u1ed3ng b\u1ed9 tr\u00ean c\u00e1c d\u1ecbch v\u1ee5 v\u00e0 t\u00e0i li\u1ec7u.</p> </li> <li> <p>B\u1ea3o m\u1eadt   Quy\u1ec1n truy c\u1eadp ghi v\u00e0o broker, giao di\u1ec7n qu\u1ea3n tr\u1ecb v\u00e0 c\u00e1c b\u00ed m\u1eadt ph\u1ea3i \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 v\u00e0 xoay v\u00f2ng.</p> </li> <li> <p>Kh\u1ea3 n\u0103ng kh\u00f4i ph\u1ee5c   Ph\u1ea3i c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c h\u1ec7 th\u1ed1ng sau khi m\u1ea5t d\u1eef li\u1ec7u ho\u1eb7c c\u1ea5u h\u00ecnh sai.</p> </li> </ul> <p>Trang n\u00e0y gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng:</p> <ul> <li>tri\u1ec3n khai \u0111\u00e3 \u0111ang ch\u1ea1y,</li> <li>b\u1ea1n c\u00f3 \u00edt nh\u1ea5t m\u1ed9t m\u00f4i tr\u01b0\u1eddng (ph\u00e1t tri\u1ec3n) v\u00e0 l\u00fd t\u01b0\u1edfng l\u00e0 m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t ri\u00eang bi\u1ec7t.</li> </ul>"},{"location":"vi/deployment/operations/#cai-gi-can-giam-sat","title":"C\u00e1i g\u00ec c\u1ea7n gi\u00e1m s\u00e1t","text":"<p>Gi\u00e1m s\u00e1t n\u00ean bao ph\u1ee7 c\u1ea3 s\u1ee9c kh\u1ecfe h\u1ea1 t\u1ea7ng v\u00e0 c\u1ea5p \u1ee9ng d\u1ee5ng.</p>"},{"location":"vi/deployment/operations/#cac-thanh-phan-cot-loi","title":"C\u00e1c th\u00e0nh ph\u1ea7n c\u1ed1t l\u00f5i","text":"<p>T\u1ed1i thi\u1ec3u, theo d\u00f5i nh\u1eefng \u0111i\u1ec1u sau:</p> <ul> <li> <p>Context broker</p> </li> <li> <p>s\u1ee9c kh\u1ecfe c\u1ee7a ti\u1ebfn tr\u00ecnh/container,</p> </li> <li>th\u1eddi gian ph\u1ea3n h\u1ed3i v\u00e0 t\u1ef7 l\u1ec7 l\u1ed7i tr\u00ean c\u00e1c \u0111i\u1ec3m cu\u1ed1i ch\u00ednh,</li> <li> <p>s\u1eed d\u1ee5ng l\u01b0u tr\u1eef v\u00e0 b\u1ea5t k\u1ef3 ch\u1ec9 s\u1ed1 n\u1ed9i b\u1ed9 n\u00e0o (n\u1ebfu c\u00f3).</p> </li> <li> <p>C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt</p> </li> <li> <p>th\u1eddi gian ch\u1ea1y th\u00e0nh c\u00f4ng cu\u1ed1i c\u00f9ng,</p> </li> <li>s\u1ed1 l\u01b0\u1ee3ng th\u1ef1c th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o/c\u1eadp nh\u1eadt m\u1ed7i l\u1ea7n ch\u1ea1y,</li> <li> <p>t\u1ef7 l\u1ec7 l\u1ed7i khi g\u1ecdi c\u00e1c API b\u00ean ngo\u00e0i ho\u1eb7c broker.</p> </li> <li> <p>PayloadCMS</p> </li> <li> <p>t\u1ef7 l\u1ec7 l\u1ed7i HTTP (4xx/5xx),</p> </li> <li>th\u1eddi gian ph\u1ea3n h\u1ed3i cho giao di\u1ec7n qu\u1ea3n tr\u1ecb,</li> <li> <p>l\u1ed7i k\u1ebft n\u1ed1i c\u01a1 s\u1edf d\u1eef li\u1ec7u.</p> </li> <li> <p>Proxy / API</p> </li> <li> <p>th\u1eddi gian ph\u1ea3n h\u1ed3i v\u00e0 t\u1ef7 l\u1ec7 l\u1ed7i cho c\u00e1c \u0111i\u1ec3m cu\u1ed1i <code>/api/...</code>,</p> </li> <li>th\u1eddi gian ch\u1edd t\u1edbi broker,</li> <li> <p>kh\u1ed1i l\u01b0\u1ee3ng y\u00eau c\u1ea7u tr\u00ean m\u1ed7i \u0111i\u1ec3m cu\u1ed1i.</p> </li> <li> <p>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n</p> </li> <li>kh\u1ea3 d\u1ee5ng c\u01a1 b\u1ea3n (\u0111\u00e3 c\u00f3 th\u1ec3 t\u1ea3i ch\u01b0a),</li> <li>l\u1ed7i UI nghi\u00eam tr\u1ecdng (n\u1ebfu b\u1ea1n thu th\u1eadp b\u00e1o c\u00e1o l\u1ed7i frontend).</li> </ul>"},{"location":"vi/deployment/operations/#tin-hieu-va-nguong","title":"T\u00edn hi\u1ec7u v\u00e0 ng\u01b0\u1ee1ng","text":"<p>V\u00ed d\u1ee5 v\u1ec1 c\u00e1c c\u1ea3nh b\u00e1o h\u1eefu \u00edch:</p> <ul> <li>broker ng\u1eebng ho\u1ea1t \u0111\u1ed9ng ho\u1eb7c tr\u1ea3 v\u1ec1 5xx tr\u00ean c\u00e1c \u0111i\u1ec3m cu\u1ed1i s\u1ee9c kh\u1ecfe,</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt th\u1ea5t b\u1ea1i li\u00ean ti\u1ebfp trong m\u1ed9t kho\u1ea3ng (v\u00ed d\u1ee5 10\u201315 ph\u00fat),</li> <li>qu\u1ea3n tr\u1ecb payload tr\u1ea3 v\u1ec1 l\u1ed7i 500 th\u01b0\u1eddng xuy\u00ean,</li> <li>s\u1ef1 gi\u1ea3m \u0111\u1ed9t ng\u1ed9t trong s\u1ed1 l\u01b0\u1ee3ng th\u1ef1c th\u1ec3 (c\u00f3 th\u1ec3 ch\u1ec9 ra c\u1eadp nh\u1eadt x\u1ea5u),</li> <li>t\u0103ng tr\u01b0\u1edfng kh\u00f4ng gi\u1edbi h\u1ea1n trong s\u1ed1 l\u01b0\u1ee3ng th\u1ef1c th\u1ec3 (c\u00f3 th\u1ec3 ch\u1ec9 ra tr\u00f9ng l\u1eb7p).</li> </ul> <p>Ng\u01b0\u1ee1ng ch\u00ednh x\u00e1c ph\u1ee5 thu\u1ed9c v\u00e0o:</p> <ul> <li>t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt d\u1eef li\u1ec7u,</li> <li>l\u01b0u l\u01b0\u1ee3ng d\u1ef1 ki\u1ebfn,</li> <li>kh\u1ea3 n\u0103ng ch\u1ecbu \u0111\u1ef1ng cho \u0111\u1ed9 tr\u1ec5 trong b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n.</li> </ul>"},{"location":"vi/deployment/operations/#nhat-ky-va-kha-nang-quan-sat","title":"Nh\u1eadt k\u00fd v\u00e0 kh\u1ea3 n\u0103ng quan s\u00e1t","text":"<p>Nh\u1eadt k\u00fd l\u00e0 ngu\u1ed3n s\u1ef1 th\u1eadt \u0111\u1ea7u ti\u00ean khi c\u00f3 v\u1ea5n \u0111\u1ec1.</p>"},{"location":"vi/deployment/operations/#cai-gi-can-ghi-nhat-ky","title":"C\u00e1i g\u00ec c\u1ea7n ghi nh\u1eadt k\u00fd","text":"<p>M\u1ed7i th\u00e0nh ph\u1ea7n n\u00ean ghi nh\u1eadt k\u00fd \u00edt nh\u1ea5t:</p> <ul> <li> <p>kh\u1edfi \u0111\u1ed9ng:</p> </li> <li> <p>t\u00f3m t\u1eaft c\u1ea5u h\u00ecnh (\u0111\u00e3 l\u00e0m s\u1ea1ch, kh\u00f4ng c\u00f3 b\u00ed m\u1eadt),</p> </li> <li> <p>phi\u00ean b\u1ea3n ho\u1eb7c m\u00e3 b\u0103m commit.</p> </li> <li> <p>ho\u1ea1t \u0111\u1ed9ng b\u00ecnh th\u01b0\u1eddng:</p> </li> <li> <p>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt:</p> <ul> <li>s\u1ed1 l\u01b0\u1ee3ng th\u1ef1c th\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd m\u1ed7i chu k\u1ef3,</li> <li>c\u00e1c cu\u1ed9c g\u1ecdi API b\u00ean ngo\u00e0i ch\u00ednh,</li> <li>th\u1ea5t b\u1ea1i m\u1ed9t ph\u1ea7n (gi\u1edbi h\u1ea1n th\u1eddi gian, nh\u01b0ng c\u00f3 th\u00f4ng tin).</li> </ul> </li> <li> <p>proxy:</p> <ul> <li>l\u1ed7i th\u01b0\u1ee3ng ngu\u1ed3n khi g\u1ecdi broker,</li> <li>l\u1ed7i x\u00e1c th\u1ef1c tr\u00ean c\u00e1c y\u00eau c\u1ea7u \u0111\u1ebfn.</li> </ul> </li> <li> <p>l\u1ed7i:</p> </li> <li>th\u1eddi gian ch\u1edd m\u1ea1ng,</li> <li>th\u1ea5t b\u1ea1i ghi broker,</li> <li>l\u1ed7i c\u01a1 s\u1edf d\u1eef li\u1ec7u (PayloadCMS).</li> </ul> <p>Nh\u1eadt k\u00fd n\u00ean \u0111\u01b0\u1ee3c c\u1ea5u tr\u00fac \u0111\u1ee7 \u0111\u1ec3:</p> <ul> <li>b\u1ea1n c\u00f3 th\u1ec3 l\u1ecdc theo th\u00e0nh ph\u1ea7n, m\u1ee9c \u0111\u1ed9 nghi\u00eam tr\u1ecdng v\u00e0 th\u1eddi gian,</li> <li>b\u1ea1n c\u00f3 th\u1ec3 t\u01b0\u01a1ng quan c\u00e1c s\u1ef1 ki\u1ec7n gi\u1eefa c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u00e0 broker/proxy.</li> </ul>"},{"location":"vi/deployment/operations/#noi-luu-tru-nhat-ky","title":"N\u01a1i l\u01b0u tr\u1eef nh\u1eadt k\u00fd","text":"<p>Ph\u1ee5 thu\u1ed9c v\u00e0o tri\u1ec3n khai:</p> <ul> <li> <p>VM / Docker:</p> </li> <li> <p>nh\u1eadt k\u00fd Docker (qua <code>docker logs</code>),</p> </li> <li>c\u00e1c t\u1ec7p nh\u1eadt k\u00fd tr\u00ean \u0111\u0129a,</li> <li> <p>t\u00f9y ch\u1ecdn chuy\u1ec3n \u0111\u1ebfn h\u1ec7 th\u1ed1ng t\u1eadp trung.</p> </li> <li> <p>AWS:</p> </li> <li> <p>CloudWatch Logs cho m\u1ed7i d\u1ecbch v\u1ee5 ECS,</p> </li> <li> <p>ch\u1ec9 s\u1ed1 v\u00e0 c\u1ea3nh b\u00e1o CloudWatch.</p> </li> <li> <p>Coolify:</p> </li> <li>nh\u1eadt k\u00fd cho m\u1ed7i d\u1ecbch v\u1ee5 qua giao di\u1ec7n Coolify,</li> <li>t\u00edch h\u1ee3p t\u00f9y ch\u1ecdn v\u1edbi c\u00e1c h\u1ec7 th\u1ed1ng nh\u1eadt k\u00fd b\u00ean ngo\u00e0i.</li> </ul> <p>D\u00f9 n\u1ec1n t\u1ea3ng n\u00e0o, ng\u01b0\u1eddi v\u1eadn h\u00e0nh n\u00ean:</p> <ul> <li>bi\u1ebft c\u00e1ch xem nh\u1eadt k\u00fd cho m\u1ed7i th\u00e0nh ph\u1ea7n,</li> <li>c\u00f3 danh s\u00e1ch ng\u1eafn c\u00e1c v\u1ecb tr\u00ed nh\u1eadt k\u00fd v\u00e0 l\u1ec7nh.</li> </ul>"},{"location":"vi/deployment/operations/#sao-luu","title":"Sao l\u01b0u","text":"<p>Sao l\u01b0u l\u00e0 thi\u1ebft y\u1ebfu cho d\u1eef li\u1ec7u PayloadCMS v\u00e0 b\u1ea5t k\u1ef3 l\u01b0u tr\u1eef broker c\u00f3 tr\u1ea1ng th\u00e1i n\u00e0o.</p>"},{"location":"vi/deployment/operations/#cai-gi-can-sao-luu","title":"C\u00e1i g\u00ec c\u1ea7n sao l\u01b0u","text":"<p>T\u1ed1i thi\u1ec3u:</p> <ul> <li> <p>C\u01a1 s\u1edf d\u1eef li\u1ec7u PayloadCMS</p> </li> <li> <p>t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9 s\u01b0u t\u1eadp (l\u1edbp, kh\u1ed1i, c\u1ea5u h\u00ecnh giao di\u1ec7n, n\u1ed9i dung),</p> </li> <li> <p>t\u00e0i kho\u1ea3n ng\u01b0\u1eddi d\u00f9ng v\u00e0 quy\u1ec1n.</p> </li> <li> <p>D\u1eef li\u1ec7u broker (n\u1ebfu b\u1ec1n tr\u00ean \u0111\u0129a v\u00e0 kh\u00f4ng th\u1ec3 t\u00e1i t\u1ea1o ho\u00e0n to\u00e0n):</p> </li> <li>kho l\u01b0u tr\u1eef th\u1ef1c th\u1ec3 ho\u1eb7c c\u01a1 s\u1edf d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c broker s\u1eed d\u1ee5ng,</li> <li>c\u00e1c t\u1ec7p c\u1ea5u h\u00ecnh (n\u1ebfu ch\u01b0a \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t phi\u00ean b\u1ea3n).</li> </ul> <p>Quan tr\u1ecdng nh\u01b0ng th\u01b0\u1eddng b\u1ecb b\u1ecf qua:</p> <ul> <li>C\u1ea5u h\u00ecnh:</li> <li>c\u00e1c t\u1ec7p c\u1ea5u h\u00ecnh gi\u1ed1ng <code>.env</code> (kh\u00f4ng c\u00f3 b\u00ed m\u1eadt) d\u01b0\u1edbi ki\u1ec3m so\u00e1t phi\u00ean b\u1ea3n,</li> <li>h\u1ea1 t\u1ea7ng nh\u01b0 m\u00e3 ho\u1eb7c c\u00e1c \u0111\u1ecbnh ngh\u0129a tri\u1ec3n khai,</li> <li>t\u00ean tham s\u1ed1 v\u00e0 c\u1ea5u tr\u00fac SSM/Secrets Manager (gi\u00e1 tr\u1ecb b\u00ed m\u1eadt, nh\u01b0ng c\u1ea7n kh\u00f3a/\u0111\u01b0\u1eddng d\u1eabn).</li> </ul>"},{"location":"vi/deployment/operations/#bao-lau-sao-luu","title":"Bao l\u00e2u sao l\u01b0u","text":"<p>Khuy\u1ebfn ngh\u1ecb c\u01a1 b\u1ea3n:</p> <ul> <li> <p>c\u01a1 s\u1edf d\u1eef li\u1ec7u s\u1ea3n xu\u1ea5t:</p> </li> <li> <p>sao l\u01b0u t\u1ef1 \u0111\u1ed9ng h\u00e0ng ng\u00e0y,</p> </li> <li> <p>snapshot th\u1ee7 c\u00f4ng tr\u01b0\u1edbc c\u00e1c b\u1ea3n ph\u00e1t h\u00e0nh l\u1edbn ho\u1eb7c thay \u0111\u1ed5i l\u01b0\u1ee3c \u0111\u1ed3.</p> </li> <li> <p>c\u01a1 s\u1edf d\u1eef li\u1ec7u ph\u00e1t tri\u1ec3n:</p> </li> <li> <p>sao l\u01b0u \u0111\u1ecbnh k\u1ef3 n\u1ebfu c\u1ea7n, nh\u01b0ng nghi\u00eam ng\u1eb7t th\u1ea5p h\u01a1n.</p> </li> <li> <p>d\u1eef li\u1ec7u broker:</p> </li> <li>t\u1ea7n su\u1ea5t sao l\u01b0u ph\u1ee5 thu\u1ed9c v\u00e0o li\u1ec7u c\u00e1c th\u1ef1c th\u1ec3 c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng l\u1ea1i t\u1eeb ngu\u1ed3n:<ul> <li>n\u1ebfu c\u00e1c ngu\u1ed3n b\u00ean ngo\u00e0i c\u00f3 th\u1ec3 t\u1ea1o l\u1ea1i tr\u1ea1ng th\u00e1i \u2192 \u00edt th\u01b0\u1eddng xuy\u00ean h\u01a1n ho\u1eb7c t\u00f9y ch\u1ecdn,</li> <li>n\u1ebfu broker gi\u1eef d\u1eef li\u1ec7u duy nh\u1ea5t ho\u1eb7c \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd th\u1ee7 c\u00f4ng \u2192 sao l\u01b0u ph\u00f9 h\u1ee3p v\u1edbi DB.</li> </ul> </li> </ul>"},{"location":"vi/deployment/operations/#kiem-tra-khoi-phuc","title":"Ki\u1ec3m tra kh\u00f4i ph\u1ee5c","text":"<p>B\u1ea3n sao l\u01b0u ch\u1ec9 h\u1eefu \u00edch n\u1ebfu c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c.</p> <ul> <li> <p>\u0111\u1ecbnh k\u1ef3 kh\u00f4i ph\u1ee5c DB PayloadCMS v\u00e0o m\u00f4i tr\u01b0\u1eddng th\u1eed nghi\u1ec7m:</p> </li> <li> <p>x\u00e1c minh r\u1eb1ng:</p> <ul> <li>qu\u1ea3n tr\u1ecb c\u00f3 th\u1ec3 \u0111\u0103ng nh\u1eadp,</li> <li>c\u00e1c trang v\u00e0 c\u1ea5u h\u00ecnh b\u1ea3n \u0111\u1ed3 t\u1ea3i \u0111\u00fang,</li> <li>kh\u00f4ng c\u00f3 h\u1ecfng ho\u1eb7c thi\u1ebfu b\u1ea3ng/b\u1ed9 s\u01b0u t\u1eadp.</li> </ul> </li> <li> <p>n\u1ebfu d\u1eef li\u1ec7u broker \u0111\u01b0\u1ee3c sao l\u01b0u:</p> </li> <li>kh\u00f4i ph\u1ee5c v\u00e0o ph\u1ee5c v\u1ee5 broker th\u1eed nghi\u1ec7m,</li> <li>ch\u1ea1y c\u00e1c truy v\u1ea5n c\u01a1 b\u1ea3n \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o c\u00e1c th\u1ef1c th\u1ec3 xu\u1ea5t hi\u1ec7n nh\u01b0 mong \u0111\u1ee3i.</li> </ul> <p>Ghi ch\u00e9p:</p> <ul> <li>c\u00e1c th\u1ee7 t\u1ee5c ch\u00ednh x\u00e1c \u0111\u1ec3 kh\u00f4i ph\u1ee5c:</li> <li>t\u1eeb ngu\u1ed3n sao l\u01b0u n\u00e0o,</li> <li>v\u00e0o m\u00f4i tr\u01b0\u1eddng n\u00e0o,</li> <li>ai ch\u1ecbu tr\u00e1ch nhi\u1ec7m.</li> </ul>"},{"location":"vi/deployment/operations/#cap-nhat-cac-thanh-phan","title":"C\u1eadp nh\u1eadt c\u00e1c th\u00e0nh ph\u1ea7n","text":"<p>LegoCity bao g\u1ed3m nhi\u1ec1u th\u00e0nh ph\u1ea7n c\u00f3 th\u1ec3 ph\u00e1t tri\u1ec3n \u1edf c\u00e1c t\u1ed1c \u0111\u1ed9 kh\u00e1c nhau.</p>"},{"location":"vi/deployment/operations/#nguyen-tac-chung","title":"Nguy\u00ean t\u1eafc chung","text":"<p>Khi c\u1eadp nh\u1eadt:</p> <ul> <li>thay \u0111\u1ed5i m\u1ed9t l\u1edbp m\u1ed9t l\u00fac khi c\u00f3 th\u1ec3,</li> <li>gi\u1eef m\u00f4i tr\u01b0\u1eddng ph\u00e1t tri\u1ec3n v\u00e0 s\u1ea3n xu\u1ea5t ri\u00eang bi\u1ec7t,</li> <li>\u0111\u1ea3m b\u1ea3o t\u01b0\u01a1ng th\u00edch ng\u01b0\u1ee3c cho c\u00e1c h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u b\u1ea5t c\u1ee9 khi n\u00e0o kh\u1ea3 thi.</li> </ul> <p>Th\u1ee9 t\u1ef1 c\u1eadp nh\u1eadt \u0111i\u1ec3n h\u00ecnh:</p> <ol> <li>C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt v\u00e0 proxy (thay \u0111\u1ed5i t\u01b0\u01a1ng th\u00edch ng\u01b0\u1ee3c).</li> <li>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n (thay \u0111\u1ed5i giao di\u1ec7n s\u1eed d\u1ee5ng API hi\u1ec7n c\u00f3).</li> <li>PayloadCMS (n\u1ebfu c\u1ea7n thay \u0111\u1ed5i l\u01b0\u1ee3c \u0111\u1ed3 ho\u1eb7c giao di\u1ec7n qu\u1ea3n tr\u1ecb).</li> <li>Broker v\u00e0 m\u00f4 h\u00ecnh d\u1eef li\u1ec7u c\u1ed1t l\u00f5i (ch\u1ec9 khi c\u1ea7n thi\u1ebft, v\u1edbi k\u1ebf ho\u1ea1ch).</li> </ol>"},{"location":"vi/deployment/operations/#quy-trinh-cap-nhat","title":"Quy tr\u00ecnh c\u1eadp nh\u1eadt","text":"<p>\u0110\u01b0\u1eddng \u0111i an to\u00e0n cho b\u1ea3n ph\u00e1t h\u00e0nh m\u1edbi:</p> <ol> <li> <p>M\u00f4i tr\u01b0\u1eddng ph\u00e1t tri\u1ec3n</p> </li> <li> <p>tri\u1ec3n khai h\u00ecnh \u1ea3nh m\u1edbi cho ph\u00e1t tri\u1ec3n,</p> </li> <li>\u00e1p d\u1ee5ng di chuy\u1ec3n (n\u1ebfu c\u00f3) cho DB/broker ph\u00e1t tri\u1ec3n,</li> <li> <p>ch\u1ea1y ki\u1ec3m tra kh\u00f3i:</p> <ul> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt c\u00f3 th\u1ec3 kh\u1edfi \u0111\u1ed9ng v\u00e0 c\u1eadp nh\u1eadt th\u1ef1c th\u1ec3,</li> <li>proxy v\u00e0 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n c\u00f3 th\u1ec3 \u0111\u1ecdc th\u1ef1c th\u1ec3 \u0111\u00fang.</li> </ul> </li> <li> <p>Staging (n\u1ebfu c\u00f3)</p> </li> <li> <p>l\u1eb7p l\u1ea1i v\u1edbi d\u1eef li\u1ec7u v\u00e0 ng\u01b0\u1eddi d\u00f9ng th\u1ef1c t\u1ebf h\u01a1n.</p> </li> <li> <p>S\u1ea3n xu\u1ea5t</p> </li> <li> <p>ch\u1ecdn kho\u1ea3ng b\u1ea3o tr\u00ec n\u1ebfu c\u1eadp nh\u1eadt g\u00e2y gi\u00e1n \u0111o\u1ea1n,</p> </li> <li>sao l\u01b0u DB PayloadCMS v\u00e0 tr\u1ea1ng th\u00e1i broker tr\u01b0\u1edbc,</li> <li> <p>tri\u1ec3n khai phi\u00ean b\u1ea3n m\u1edbi:</p> <ul> <li>c\u1eadp nh\u1eadt container (th\u1ebb h\u00ecnh \u1ea3nh),</li> <li>\u00e1p d\u1ee5ng di chuy\u1ec3n,</li> <li>gi\u00e1m s\u00e1t nh\u1eadt k\u00fd v\u00e0 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n ch\u1eb7t ch\u1ebd.</li> </ul> </li> <li> <p>Ki\u1ec3m tra sau tri\u1ec3n khai</p> </li> <li> <p>x\u00e1c th\u1ef1c:</p> <ul> <li>\u0111\u0103ng nh\u1eadp qu\u1ea3n tr\u1ecb,</li> <li>c\u00e1c b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n ch\u00ednh,</li> <li>\u0111\u1ed9 m\u1edbi d\u1eef li\u1ec7u (c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt ch\u1ea1y b\u00ecnh th\u01b0\u1eddng),</li> </ul> </li> <li>x\u00e1c nh\u1eadn ch\u1ec9 s\u1ed1 v\u00e0 t\u1ef7 l\u1ec7 l\u1ed7i v\u1eabn trong ph\u1ea1m vi d\u1ef1 ki\u1ebfn.</li> </ol>"},{"location":"vi/deployment/operations/#thay-oi-luoc-o-va-hop-ong-du-lieu","title":"Thay \u0111\u1ed5i l\u01b0\u1ee3c \u0111\u1ed3 v\u00e0 h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u","text":"<p>C\u00e1c thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi m\u00f4 h\u00ecnh th\u1ef1c th\u1ec3 ho\u1eb7c API l\u00e0 r\u1ee7i ro cao.</p>"},{"location":"vi/deployment/operations/#lap-ke-hoach-thay-oi-luoc-o","title":"L\u1eadp k\u1ebf ho\u1ea1ch thay \u0111\u1ed5i l\u01b0\u1ee3c \u0111\u1ed3","text":"<p>Cho b\u1ea5t k\u1ef3 thay \u0111\u1ed5i n\u00e0o \u0111\u1ed1i v\u1edbi c\u1ea5u tr\u00fac th\u1ef1c th\u1ec3 (thu\u1ed9c t\u00ednh m\u1edbi, tr\u01b0\u1eddng \u0111\u1ed5i t\u00ean, thu\u1ed9c t\u00ednh b\u1ecb x\u00f3a):</p> <ul> <li> <p>c\u1eadp nh\u1eadt t\u00e0i li\u1ec7u th\u1ef1c th\u1ec3 tr\u01b0\u1edbc:</p> </li> <li> <p>t\u00ean lo\u1ea1i,</p> </li> <li>thu\u1ed9c t\u00ednh,</li> <li>m\u1eabu ID,</li> <li> <p>c\u00e1c m\u1ed1i quan h\u1ec7.</p> </li> <li> <p>x\u00e1c \u0111\u1ecbnh t\u1ea5t c\u1ea3 ng\u01b0\u1eddi ti\u00eau d\u00f9ng:</p> </li> <li> <p>c\u00e1c \u0111i\u1ec3m cu\u1ed1i proxy,</p> </li> <li>ch\u1ebf \u0111\u1ed9 xem v\u00e0 kh\u1ed1i c\u1ee7a b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n,</li> <li> <p>b\u1ea5t k\u1ef3 t\u00edch h\u1ee3p b\u00ean ngo\u00e0i n\u00e0o.</p> </li> <li> <p>quy\u1ebft \u0111\u1ecbnh chi\u1ebfn l\u01b0\u1ee3c di chuy\u1ec3n:</p> </li> <li>h\u1ed7 tr\u1ee3 c\u1ea5u tr\u00fac k\u00e9p t\u1ea1m th\u1eddi (thu\u1ed9c t\u00ednh c\u0169 v\u00e0 m\u1edbi),</li> <li>ng\u1eaft m\u1ed9t b\u01b0\u1edbc (ch\u1ec9 trong c\u00e1c k\u1ecbch b\u1ea3n \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t).</li> </ul>"},{"location":"vi/deployment/operations/#ap-dung-thay-oi-luoc-o","title":"\u00c1p d\u1ee5ng thay \u0111\u1ed5i l\u01b0\u1ee3c \u0111\u1ed3","text":"<p>M\u1eabu \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t:</p> <ul> <li> <p>th\u00eam thu\u1ed9c t\u00ednh m\u1edbi tr\u01b0\u1edbc, trong khi gi\u1eef c\u00e1c thu\u1ed9c t\u00ednh c\u0169:</p> </li> <li> <p>c\u1eadp nh\u1eadt c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt \u0111\u1ec3 ghi c\u1ea3 hai,</p> </li> <li>c\u1eadp nh\u1eadt proxy v\u00e0 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n \u0111\u1ec3 s\u1eed d\u1ee5ng thu\u1ed9c t\u00ednh m\u1edbi,</li> <li> <p>gi\u00e1m s\u00e1t cho b\u1ea5t k\u1ef3 tho\u00e1i b\u1ed9 n\u00e0o.</p> </li> <li> <p>x\u00f3a ho\u1eb7c kh\u00f4ng d\u00f9ng thu\u1ed9c t\u00ednh c\u0169 cu\u1ed1i c\u00f9ng:</p> </li> <li>ch\u1ec9 sau khi x\u00e1c nh\u1eadn c\u1ea5u tr\u00fac m\u1edbi \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ea7y \u0111\u1ee7,</li> <li>truy\u1ec1n \u0111\u1ea1t thay \u0111\u1ed5i cho t\u1ea5t c\u1ea3 c\u00e1c nh\u00f3m.</li> </ul> <p>B\u1ea5t k\u1ef3 thay \u0111\u1ed5i ph\u00e1 v\u1ee1 n\u00e0o n\u00ean \u0111\u01b0\u1ee3c ghi ch\u00e9p r\u00f5 r\u00e0ng trong nh\u1eadt k\u00fd thay \u0111\u1ed5i ho\u1eb7c ghi ch\u00fa ph\u00e1t h\u00e0nh.</p>"},{"location":"vi/deployment/operations/#hoat-ong-bao-mat","title":"Ho\u1ea1t \u0111\u1ed9ng b\u1ea3o m\u1eadt","text":"<p>B\u1ea3o m\u1eadt kh\u00f4ng ph\u1ea3i l\u00e0 thi\u1ebft l\u1eadp m\u1ed9t l\u1ea7n; n\u00f3 \u0111\u00f2i h\u1ecfi b\u1ea3o tr\u00ec li\u00ean t\u1ee5c.</p>"},{"location":"vi/deployment/operations/#quan-ly-thong-tin-ang-nhap","title":"Qu\u1ea3n l\u00fd th\u00f4ng tin \u0111\u0103ng nh\u1eadp","text":"<p>C\u00e1c l\u0129nh v\u1ef1c c\u1ea7n t\u1eadp trung:</p> <ul> <li> <p>Kh\u00f3a ghi c\u1ee7a broker:</p> </li> <li> <p>gi\u1edbi h\u1ea1n cho c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</p> </li> <li>xoay v\u00f2ng theo l\u1ecbch tr\u00ecnh \u0111\u1ec1u \u0111\u1eb7n ho\u1eb7c khi th\u00e0nh vi\u00ean nh\u00f3m thay \u0111\u1ed5i,</li> <li> <p>kh\u00f4ng bao gi\u1edd ghi nh\u1eadt k\u00fd ho\u1eb7c hi\u1ec3n th\u1ecb d\u01b0\u1edbi d\u1ea1ng v\u0103n b\u1ea3n thu\u1ea7n.</p> </li> <li> <p>T\u00e0i kho\u1ea3n qu\u1ea3n tr\u1ecb PayloadCMS:</p> </li> <li> <p>m\u1eadt kh\u1ea9u m\u1ea1nh,</p> </li> <li>gi\u1edbi h\u1ea1n cho c\u00e1c qu\u1ea3n tr\u1ecb vi\u00ean c\u1ea7n thi\u1ebft,</li> <li> <p>xem x\u00e9t \u0111\u1ecbnh k\u1ef3 danh s\u00e1ch ng\u01b0\u1eddi d\u00f9ng v\u00e0 vai tr\u00f2.</p> </li> <li> <p>Kh\u00f3a API b\u00ean ngo\u00e0i (th\u1eddi ti\u1ebft, nh\u00e0 cung c\u1ea5p d\u1eef li\u1ec7u di chuy\u1ec3n, v.v.):</p> </li> <li>l\u01b0u tr\u1eef trong tr\u00ecnh qu\u1ea3n l\u00fd b\u00ed m\u1eadt ho\u1eb7c c\u1ea5u h\u00ecnh tri\u1ec3n khai,</li> <li>xoay v\u00f2ng theo khuy\u1ebfn ngh\u1ecb c\u1ee7a nh\u00e0 cung c\u1ea5p.</li> </ul> <p>B\u1ea5t c\u1ee9 khi n\u00e0o kh\u00f3a b\u1ecb nghi ng\u1edd b\u1ecb l\u1ed9:</p> <ul> <li>thu h\u1ed3i v\u00e0 thay th\u1ebf n\u00f3,</li> <li>ki\u1ec3m tra nh\u1eadt k\u00fd cho ho\u1ea1t \u0111\u1ed9ng b\u1ea5t th\u01b0\u1eddng li\u00ean quan \u0111\u1ebfn kh\u00f3a \u0111\u00f3.</li> </ul>"},{"location":"vi/deployment/operations/#giam-be-mat","title":"Gi\u1ea3m b\u1ec1 m\u1eb7t","text":"<p>Gi\u1ea3m b\u1ec1 m\u1eb7t t\u1ea5n c\u00f4ng b\u1eb1ng c\u00e1ch:</p> <ul> <li>ch\u1ec9 th\u1ed1:</li> <li>proxy v\u00e0 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n cho ng\u01b0\u1eddi d\u00f9ng chung,</li> <li>giao di\u1ec7n qu\u1ea3n tr\u1ecb PayloadCMS cho qu\u1ea3n tr\u1ecb vi\u00ean (s\u1eed d\u1ee5ng l\u1ecdc IP, VPN ho\u1eb7c ki\u1ec3m so\u00e1t truy c\u1eadp),</li> <li>gi\u1eef broker v\u00e0 DB tr\u00ean m\u1ea1ng n\u1ed9i b\u1ed9,</li> <li>\u0111\u1ea3m b\u1ea3o c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt kh\u00f4ng th\u1ec3 truy c\u1eadp c\u00f4ng khai tr\u1eeb khi th\u1ef1c s\u1ef1 c\u1ea7n thi\u1ebft.</li> </ul>"},{"location":"vi/deployment/operations/#phan-ung-su-co","title":"Ph\u1ea3n \u1ee9ng s\u1ef1 c\u1ed1","text":"<p>S\u1ef1 c\u1ed1 s\u1ebd x\u1ea3y ra: broker ng\u1eebng ho\u1ea1t \u0111\u1ed9ng, th\u1ea5t b\u1ea1i API b\u00ean ngo\u00e0i, tri\u1ec3n khai t\u1ed3i, v.v.</p>"},{"location":"vi/deployment/operations/#so-tay-co-ban","title":"S\u1ed5 tay c\u01a1 b\u1ea3n","text":"<p>Chu\u1ea9n b\u1ecb danh s\u00e1ch ki\u1ec3m tra ng\u1eafn, th\u1ef1c t\u1ebf cho c\u00e1c s\u1ef1 c\u1ed1 th\u01b0\u1eddng g\u1eb7p:</p> <ul> <li> <p>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n kh\u00f4ng th\u1ec3 ti\u1ebfp c\u1eadn backend:</p> </li> <li> <p>ki\u1ec3m tra container proxy ho\u1eb7c tr\u1ea1ng th\u00e1i d\u1ecbch v\u1ee5,</p> </li> <li>ki\u1ec3m tra DNS v\u00e0 \u0111\u1ecbnh tuy\u1ebfn reverse proxy,</li> <li> <p>ki\u1ec3m tra t\u00ednh h\u1ee3p l\u1ec7 ch\u1ee9ng ch\u1ec9 TLS.</p> </li> <li> <p>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n kh\u00f4ng hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u:</p> </li> <li> <p>ki\u1ec3m tra nh\u1eadt k\u00fd m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt:</p> <ul> <li>c\u00f3 c\u1eadp nh\u1eadt g\u1ea7n \u0111\u00e2y kh\u00f4ng?</li> </ul> </li> <li>ki\u1ec3m tra c\u00e1c th\u1ef1c th\u1ec3 broker:<ul> <li>c\u00f3 m\u1eb7t nh\u01b0ng \u0111\u01b0\u1ee3c l\u1ecdc kh\u00f4ng \u0111\u00fang?</li> </ul> </li> <li> <p>ki\u1ec3m tra proxy:</p> <ul> <li>n\u00f3 c\u00f3 tr\u1ea3 v\u1ec1 th\u1ef1c th\u1ec3 cho c\u00e1c truy v\u1ea5n c\u01a1 b\u1ea3n kh\u00f4ng?</li> </ul> </li> <li> <p>PayloadCMS kh\u00f4ng th\u1ec3 truy c\u1eadp:</p> </li> <li> <p>ki\u1ec3m tra tr\u1ea1ng th\u00e1i d\u1ecbch v\u1ee5 Payload,</p> </li> <li>ki\u1ec3m tra k\u1ebft n\u1ed1i DB,</li> <li> <p>ki\u1ec3m tra t\u00ean mi\u1ec1n qu\u1ea3n tr\u1ecb v\u00e0 TLS.</p> </li> <li> <p>L\u1ed7i broker:</p> </li> <li>ki\u1ec3m tra s\u1eed d\u1ee5ng t\u00e0i nguy\u00ean (CPU, b\u1ed9 nh\u1edb, \u0111\u0129a),</li> <li>ki\u1ec3m tra nh\u1eadt k\u00fd l\u1ed7i ghi t\u1eeb c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt,</li> <li>ki\u1ec3m tra li\u1ec7u kh\u1ed1i l\u01b0\u1ee3ng th\u1ef1c th\u1ec3 ho\u1eb7c m\u1eabu y\u00eau c\u1ea7u c\u00f3 thay \u0111\u1ed5i.</li> </ul>"},{"location":"vi/deployment/operations/#giao-tiep","title":"Giao ti\u1ebfp","text":"<p>Cho c\u00e1c s\u1ef1 c\u1ed1 l\u1edbn h\u01a1n:</p> <ul> <li> <p>quy\u1ebft \u0111\u1ecbnh ai:</p> </li> <li> <p>ph\u00e2n lo\u1ea1i v\u00e0 gi\u1ea3m thi\u1ec3u,</p> </li> <li>truy\u1ec1n \u0111\u1ea1t tr\u1ea1ng th\u00e1i cho c\u00e1c b\u00ean li\u00ean quan,</li> <li> <p>ghi ch\u00e9p nh\u1eefng g\u00ec \u0111\u00e3 x\u1ea3y ra.</p> </li> <li> <p>ghi l\u1ea1i:</p> </li> <li>d\u00f2ng th\u1eddi gian c\u1ee7a s\u1ef1 c\u1ed1,</li> <li>nguy\u00ean nh\u00e2n g\u1ed1c r\u1ec5 (n\u1ebfu \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh),</li> <li>c\u00e1c h\u00e0nh \u0111\u1ed9ng \u0111\u00e3 th\u1ef1c hi\u1ec7n,</li> <li>c\u1ea3i ti\u1ebfn ti\u1ebfp theo.</li> </ul>"},{"location":"vi/deployment/operations/#nhiem-vu-van-hanh-thuong-xuyen","title":"Nhi\u1ec7m v\u1ee5 v\u1eadn h\u00e0nh th\u01b0\u1eddng xuy\u00ean","text":"<p>Cho tri\u1ec3n khai \u1ed5n \u0111\u1ecbnh, \u0111\u1ecbnh ngh\u0129a c\u00e1c nhi\u1ec7m v\u1ee5 \u0111\u1ec1u \u0111\u1eb7n:</p>"},{"location":"vi/deployment/operations/#hang-ngay-hoac-moi-ca","title":"H\u00e0ng ng\u00e0y ho\u1eb7c m\u1ed7i ca","text":"<ul> <li>ki\u1ec3m tra b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n cho l\u1ed7i r\u00f5 r\u00e0ng ho\u1eb7c d\u1eef li\u1ec7u thi\u1ebfu,</li> <li>xem qua nh\u1eadt k\u00fd broker v\u00e0 m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt cho b\u1ea5t k\u1ef3 l\u1ed7i l\u1eb7p l\u1ea1i n\u00e0o,</li> <li>x\u00e1c nh\u1eadn r\u1eb1ng \u00edt nh\u1ea5t m\u1ed9t chu k\u1ef3 c\u1eadp nh\u1eadt th\u00e0nh c\u00f4ng g\u1ea7n \u0111\u00e2y.</li> </ul>"},{"location":"vi/deployment/operations/#hang-tuan","title":"H\u00e0ng tu\u1ea7n","text":"<ul> <li>xem x\u00e9t c\u1ea3nh b\u00e1o v\u00e0 ng\u01b0\u1ee1ng; \u0111i\u1ec1u ch\u1ec9nh n\u1ebfu c\u00f3 m\u1ec7t m\u1ecfi c\u1ea3nh b\u00e1o,</li> <li>ki\u1ec3m tra c\u00e1c c\u1eadp nh\u1eadt c\u00f3 s\u1eb5n trong c\u00e1c ph\u1ee5 thu\u1ed9c quan tr\u1ecdng (n\u1ebfu b\u1ea1n theo d\u00f5i th\u1ee7 c\u00f4ng),</li> <li>ch\u1ea1y c\u00e1c truy v\u1ea5n s\u1ee9c kh\u1ecfe c\u01a1 b\u1ea3n \u0111\u1ed1i v\u1edbi broker.</li> </ul>"},{"location":"vi/deployment/operations/#hang-thang-hoac-hang-quy","title":"H\u00e0ng th\u00e1ng ho\u1eb7c h\u00e0ng qu\u00fd","text":"<ul> <li>ki\u1ec3m tra kh\u00f4i ph\u1ee5c DB PayloadCMS (trong m\u00f4i tr\u01b0\u1eddng kh\u00f4ng s\u1ea3n xu\u1ea5t),</li> <li>xoay v\u00f2ng c\u00e1c th\u00f4ng tin \u0111\u0103ng nh\u1eadp \u0111\u00e3 ch\u1ecdn (kh\u00f3a API, token ghi) nh\u01b0 th\u1ef1c h\u00e0nh,</li> <li>xem x\u00e9t t\u00e0i li\u1ec7u th\u1ef1c th\u1ec3 v\u00e0 c\u1eadp nh\u1eadt n\u1ebfu tri\u1ec3n khai l\u1ec7ch,</li> <li>\u0111\u00e1nh gi\u00e1 s\u1eed d\u1ee5ng t\u00e0i nguy\u00ean so v\u1edbi n\u0103ng l\u1ef1c.</li> </ul>"},{"location":"vi/deployment/operations/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>V\u1eadn h\u00e0nh v\u00e0 b\u1ea3o tr\u00ec cho LegoCity xoay quanh kh\u1ea3 d\u1ee5ng, \u0111\u1ed9 m\u1edbi d\u1eef li\u1ec7u, t\u00ednh nh\u1ea5t qu\u00e1n, b\u1ea3o m\u1eadt v\u00e0 kh\u1ea3 n\u0103ng kh\u00f4i ph\u1ee5c.</li> <li>Gi\u00e1m s\u00e1t n\u00ean bao g\u1ed3m broker, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt, PayloadCMS, proxy v\u00e0 b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n, v\u1edbi c\u1ea3nh b\u00e1o r\u00f5 r\u00e0ng cho th\u1ea5t b\u1ea1i v\u00e0 h\u00e0nh vi b\u1ea5t th\u01b0\u1eddng.</li> <li>Sao l\u01b0u, \u0111\u1eb7c bi\u1ec7t c\u1ee7a DB PayloadCMS v\u00e0 b\u1ea5t k\u1ef3 l\u01b0u tr\u1eef broker kh\u00f4ng th\u1ec3 d\u1ec5 d\u00e0ng t\u1ea1o l\u1ea1i, ph\u1ea3i \u0111\u1ecbnh k\u1ef3 v\u00e0 \u0111\u01b0\u1ee3c ki\u1ec3m tra.</li> <li>C\u1eadp nh\u1eadt n\u00ean ch\u1ea3y qua ph\u00e1t tri\u1ec3n (v\u00e0 staging, n\u1ebfu c\u00f3) tr\u01b0\u1edbc s\u1ea3n xu\u1ea5t, v\u1edbi s\u1ef1 ch\u0103m s\u00f3c \u0111\u1eb7c bi\u1ec7t khi thay \u0111\u1ed5i l\u01b0\u1ee3c \u0111\u1ed3 th\u1ef1c th\u1ec3 v\u00e0 API.</li> <li>C\u00e1c ho\u1ea1t \u0111\u1ed9ng b\u1ea3o m\u1eadt bao g\u1ed3m qu\u1ea3n l\u00fd kh\u00f3a ghi c\u1ee7a broker, quy\u1ec1n truy c\u1eadp qu\u1ea3n tr\u1ecb, kh\u00f3a API b\u00ean ngo\u00e0i v\u00e0 gi\u1edbi h\u1ea1n b\u1ec1 m\u1eb7t ti\u1ebfp x\u00fac.</li> <li>C\u00e1c s\u1ed5 tay x\u1eed l\u00fd s\u1ef1 c\u1ed1 r\u00f5 r\u00e0ng v\u00e0 c\u00e1c nhi\u1ec7m v\u1ee5 v\u1eadn h\u00e0nh th\u01b0\u1eddng xuy\u00ean gi\u00fap gi\u1eef tri\u1ec3n khai d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c v\u00e0 d\u1ec5 b\u1ea3o tr\u00ec h\u01a1n theo th\u1eddi gian.</li> </ul>"},{"location":"vi/deployment/vm-docker/","title":"M\u00e1y \u1ea3o v\u00e0 Docker","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch tri\u1ec3n khai LegoCity tr\u00ean m\u1ed9t ho\u1eb7c nhi\u1ec1u m\u00e1y \u1ea3o s\u1eed d\u1ee5ng Docker v\u00e0 Docker Compose.</p> <p>N\u00f3 t\u1eadp trung v\u00e0o m\u1eabu s\u1eb5n d\u00f9ng cho:</p> <ul> <li>c\u00e1c tri\u1ec3n khai nh\u1ecf \u0111\u1ebfn trung b\u00ecnh,</li> <li>demo v\u00e0 th\u00ed \u0111i\u1ec3m,</li> <li>c\u00e1c nh\u00f3m kh\u00f4ng c\u00f3 n\u1ec1n t\u1ea3ng DevOps chuy\u00ean d\u1ee5ng.</li> </ul> <p>N\u00f3 c\u0169ng bao g\u1ed3m c\u00e1c t\u00e1c v\u1ee5 b\u1ea3o tr\u00ec c\u01a1 b\u1ea3n: c\u1eadp nh\u1eadt d\u1ecbch v\u1ee5, xem nh\u1eadt k\u00fd v\u00e0 sao l\u01b0u d\u1eef li\u1ec7u.</p>"},{"location":"vi/deployment/vm-docker/#khi-nao-su-dung-cach-tiep-can-nay","title":"Khi n\u00e0o s\u1eed d\u1ee5ng c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y","text":"<p>Tri\u1ec3n khai VM + Docker l\u00e0 l\u1ef1a ch\u1ecdn t\u1ed1t khi:</p> <ul> <li>B\u1ea1n c\u00f3 quy\u1ec1n truy c\u1eadp m\u1ed9t ho\u1eb7c v\u00e0i m\u00e1y \u1ea3o (v\u00ed d\u1ee5 tr\u00ean m\u00e1y ch\u1ee7 tr\u01b0\u1eddng \u0111\u1ea1i h\u1ecdc ho\u1eb7c th\u00e0nh ph\u1ed1),</li> <li>B\u1ea1n mu\u1ed1n ch\u1ea1y t\u1ea5t c\u1ea3 th\u00e0nh ph\u1ea7n tr\u00ean c\u00f9ng m\u00e1y ch\u1ee7 ho\u1eb7c m\u1ed9t s\u1ed1 \u00edt m\u00e1y ch\u1ee7,</li> <li>B\u1ea1n \u01b0a th\u00edch thi\u1ebft l\u1eadp \u0111\u01a1n gi\u1ea3n h\u01a1n l\u00e0 gi\u1ea3i ph\u00e1p \u0111\u00e1m m\u00e2y \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd ho\u00e0n to\u00e0n.</li> </ul> <p>N\u00f3 c\u00f3 th\u1ec3 kh\u00f4ng l\u00fd t\u01b0\u1edfng khi:</p> <ul> <li>B\u1ea1n y\u00eau c\u1ea7u \u0111\u1ed9 s\u1eb5n s\u00e0ng cao tr\u00ean nhi\u1ec1u trung t\u00e2m d\u1eef li\u1ec7u,</li> <li>B\u1ea1n mong \u0111\u1ee3i l\u01b0u l\u01b0\u1ee3ng r\u1ea5t cao ho\u1eb7c SLA nghi\u00eam ng\u1eb7t,</li> <li>T\u1ed5 ch\u1ee9c c\u1ee7a b\u1ea1n b\u1eaft bu\u1ed9c c\u00e1c n\u1ec1n t\u1ea3ng \u0111\u00e1m m\u00e2y g\u1ed1c c\u1ee5 th\u1ec3 (Kubernetes, ECS, v.v.).</li> </ul>"},{"location":"vi/deployment/vm-docker/#cac-thanh-phan-trong-thiet-lap-nay","title":"C\u00e1c th\u00e0nh ph\u1ea7n trong thi\u1ebft l\u1eadp n\u00e0y","text":"<p>Trong tri\u1ec3n khai VM + Docker \u0111i\u1ec3n h\u00ecnh, b\u1ea1n ch\u1ea1y c\u00e1c th\u00e0nh ph\u1ea7n sau d\u01b0\u1edbi d\u1ea1ng container:</p> <ul> <li>context broker (NGSI-LD broker),</li> <li>PayloadCMS,</li> <li>c\u01a1 s\u1edf d\u1eef li\u1ec7u cho PayloadCMS (v\u00ed d\u1ee5 PostgreSQL ho\u1eb7c MongoDB),</li> <li>l\u1edbp proxy / API (backend gi\u1eefa giao di\u1ec7n ng\u01b0\u1eddi d\u00f9ng v\u00e0 broker),</li> <li>dashboard (giao di\u1ec7n Next.js / Mapbox),</li> <li>m\u1ed9t ho\u1eb7c nhi\u1ec1u m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt.</li> </ul> <p>M\u1ed9t thi\u1ebft l\u1eadp m\u00e1y \u1ea3o \u0111\u01a1n \u0111i\u1ec3n h\u00ecnh s\u1ebd c\u00f3:</p> <ul> <li>m\u1ed9t m\u00e1y ch\u1ee7 Docker,</li> <li>m\u1ed9t reverse proxy (t\u00f9y ch\u1ecdn nh\u01b0ng khuy\u1ebfn ngh\u1ecb),</li> <li>nhi\u1ec1u container cho c\u00e1c d\u1ecbch v\u1ee5 tr\u00ean.</li> </ul>"},{"location":"vi/deployment/vm-docker/#kien-truc-tong-quan-tren-may-ao-on","title":"Ki\u1ebfn tr\u00fac t\u1ed5ng quan tr\u00ean m\u00e1y \u1ea3o \u0111\u01a1n","text":"<p>Tr\u00ean m\u00e1y \u1ea3o \u0111\u01a1n, ki\u1ebfn tr\u00fac logic l\u00e0:</p> <ul> <li> <p>m\u1ea1ng b\u00ean ngo\u00e0i:</p> </li> <li> <p>ng\u01b0\u1eddi d\u00f9ng truy c\u1eadp:</p> <ul> <li>URL dashboard,</li> <li>URL API (proxy),</li> <li>URL qu\u1ea3n tr\u1ecb PayloadCMS (truy c\u1eadp \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t).</li> </ul> </li> <li> <p>m\u1ea1ng n\u1ed9i b\u1ed9 (m\u1ea1ng Docker):</p> </li> <li>context broker,</li> <li>c\u01a1 s\u1edf d\u1eef li\u1ec7u,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt.</li> </ul> <p>Truy c\u1eadp m\u1ea1ng:</p> <ul> <li>Ch\u1ec9 reverse proxy ho\u1eb7c m\u1ed9t t\u1eadp h\u1ee3p container gi\u1edbi h\u1ea1n m\u1edf c\u1ed5ng ra m\u00e1y ch\u1ee7,</li> <li>H\u1ea7u h\u1ebft c\u00e1c d\u1ecbch v\u1ee5 giao ti\u1ebfp tr\u00ean m\u1ea1ng Docker n\u1ed9i b\u1ed9,</li> <li>Broker v\u00e0 c\u01a1 s\u1edf d\u1eef li\u1ec7u kh\u00f4ng \u0111\u01b0\u1ee3c ph\u01a1i b\u00e0y tr\u1ef1c ti\u1ebfp ra internet.</li> </ul>"},{"location":"vi/deployment/vm-docker/#ieu-kien-tien-quyet","title":"\u0110i\u1ec1u ki\u1ec7n ti\u00ean quy\u1ebft","text":"<p>Tr\u00ean m\u00e1y \u1ea3o:</p> <ul> <li>M\u1ed9t b\u1ea3n ph\u00e2n ph\u1ed1i Linux \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 (v\u00ed d\u1ee5 Ubuntu LTS),</li> <li>Docker Engine \u0111\u00e3 c\u00e0i \u0111\u1eb7t,</li> <li>Docker Compose (v2 ho\u1eb7c t\u00edch h\u1ee3p trong Docker),</li> <li>Quy\u1ec1n truy c\u1eadp v\u00e0o VM v\u1edbi ng\u01b0\u1eddi d\u00f9ng c\u00f3 quy\u1ec1n ch\u1ea1y Docker (th\u01b0\u1eddng qua SSH),</li> <li>T\u00ean mi\u1ec1n ho\u1eb7c t\u00ean mi\u1ec1n ph\u1ee5 cho:</li> <li>dashboard (t\u00f9y ch\u1ecdn nh\u01b0ng khuy\u1ebfn ngh\u1ecb),</li> <li>API/proxy,</li> <li>qu\u1ea3n tr\u1ecb PayloadCMS.</li> </ul> <p>T\u00f9y ch\u1ecdn nh\u01b0ng khuy\u1ebfn ngh\u1ecb:</p> <ul> <li>Reverse proxy nh\u01b0 Nginx ho\u1eb7c Traefik \u0111\u1ec3 k\u1ebft th\u00fac TLS v\u00e0 \u0111\u1ecbnh tuy\u1ebfn c\u00e1c y\u00eau c\u1ea7u HTTP \u0111\u1ebfn \u0111\u1ebfn c\u00e1c container \u0111\u00fang.</li> </ul>"},{"location":"vi/deployment/vm-docker/#bo-cuc-thu-muc","title":"B\u1ed1 c\u1ee5c th\u01b0 m\u1ee5c","text":"<p>B\u1ed1 c\u1ee5c th\u01b0 m\u1ee5c \u0111\u01a1n gi\u1ea3n tr\u00ean VM c\u00f3 th\u1ec3 l\u00e0:</p> <pre><code>/opt/legocity/\n  docker-compose.yml\n  .env\n  reverse-proxy/\n    docker-compose.yml (if using separate compose)\n    config/...\n  data/\n    broker/\n    db/\n  logs/\n    ...\n</code></pre> <p>C\u00e1c b\u1ed1 c\u1ee5c thay th\u1ebf c\u00f3 th\u1ec3 ch\u1ea5p nh\u1eadn mi\u1ec5n l\u00e0:</p> <ul> <li>C\u00e1c volume cho d\u1eef li\u1ec7u b\u1ec1n v\u1eefng (c\u01a1 s\u1edf d\u1eef li\u1ec7u, l\u01b0u tr\u1eef broker) \u0111\u01b0\u1ee3c t\u00e1ch bi\u1ec7t r\u00f5 r\u00e0ng,</li> <li>C\u1ea5u h\u00ecnh (t\u1ec7p .env, t\u1ec7p compose) \u0111\u01b0\u1ee3c ki\u1ec3m tra v\u00e0o ki\u1ec3m so\u00e1t phi\u00ean b\u1ea3n (kh\u00f4ng c\u00f3 b\u00ed m\u1eadt).</li> </ul>"},{"location":"vi/deployment/vm-docker/#cau-hinh-moi-truong","title":"C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng","text":"<p>T\u1ea5t c\u1ea3 b\u00ed m\u1eadt v\u00e0 c\u1ea5u h\u00ecnh \u0111\u1eb7c th\u00f9 m\u00f4i tr\u01b0\u1eddng n\u00ean \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb t\u1ec7p <code>.env</code> ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, kh\u00f4ng \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a c\u1ee9ng trong <code>docker-compose.yml</code>.</p> <p>V\u00ed d\u1ee5 <code>.env</code> (minh h\u1ecda, kh\u00f4ng \u0111\u1ea7y \u0111\u1ee7):</p> <pre><code># General\nAPP_ENV=production\n\n# Broker\nBROKER_IMAGE=orion-ld:latest\nBROKER_PORT=1026\n\n# PayloadCMS\nPAYLOAD_IMAGE=legocity-payload:latest\nPAYLOAD_PORT=3000\nPAYLOAD_DB_URL=postgres://payload_user:payload_pass@db:5432/payload_db\n\n# Postgres (for PayloadCMS)\nPOSTGRES_IMAGE=postgres:16\nPOSTGRES_DB=payload_db\nPOSTGRES_USER=payload_user\nPOSTGRES_PASSWORD=payload_pass\n\n# Proxy/API\nPROXY_IMAGE=legocity-proxy:latest\nPROXY_PORT=4000\n\n# Dashboard\nDASHBOARD_IMAGE=legocity-dashboard:latest\nDASHBOARD_PORT=3001\n\n# C\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt (v\u00ed d\u1ee5)\nUPDATE_ENV_IMAGE=legocity-update-env:latest\n\n# X\u00e1c th\u1ef1c broker (v\u00ed d\u1ee5)\nBROKER_WRITE_KEY_ENV=change-me-env\nBROKER_WRITE_KEY_WATER=change-me-water\nBROKER_WRITE_KEY_MOBILITY=change-me-mobility\n\n# C\u00e1c API b\u00ean ngo\u00e0i (v\u00ed d\u1ee5)\nWEATHER_API_KEY=change-me-weather\n</code></pre> <p>Trong m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t, c\u00e1c b\u00ed m\u1eadt th\u1ef1c t\u1ebf n\u00ean \u0111\u01b0\u1ee3c:</p> <ul> <li>\u0110\u1eb7t qua t\u1ef1 \u0111\u1ed9ng h\u00f3a tri\u1ec3n khai ho\u1eb7c qu\u1ea3n l\u00fd c\u1ea5u h\u00ecnh,</li> <li>L\u01b0u tr\u1eef \u1edf v\u1ecb tr\u00ed an to\u00e0n (kh\u00f4ng commit v\u00e0o kho c\u00f4ng khai).</li> </ul>"},{"location":"vi/deployment/vm-docker/#cau-truc-docker-compose","title":"C\u1ea5u tr\u00fac Docker Compose","text":"<p>M\u1ed9t t\u1ec7p <code>docker-compose.yml</code> t\u1ed1i thi\u1ec3u cho tri\u1ec3n khai m\u00e1y \u1ea3o \u0111\u01a1n c\u00f3 th\u1ec3 bao g\u1ed3m c\u00e1c d\u1ecbch v\u1ee5 cho:</p> <ul> <li>broker,</li> <li>c\u01a1 s\u1edf d\u1eef li\u1ec7u,</li> <li>PayloadCMS,</li> <li>proxy,</li> <li>dashboard,</li> <li>m\u1ed9t m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt m\u1eabu.</li> </ul> <p>V\u1ec1 m\u1eb7t kh\u00e1i ni\u1ec7m:</p> <pre><code>version: \"3.9\"\n\nservices:\n  broker:\n    image: ${BROKER_IMAGE}\n    container_name: legocity-broker\n    ports:\n      - \"${BROKER_PORT}:1026\"\n    environment:\n      # broker-specific configuration here\n    volumes:\n      - ./data/broker:/data\n    networks:\n      - internal\n\n  db:\n    image: ${POSTGRES_IMAGE}\n    container_name: legocity-db\n    environment:\n      POSTGRES_DB: ${POSTGRES_DB}\n      POSTGRES_USER: ${POSTGRES_USER}\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n    volumes:\n      - ./data/db:/var/lib/postgresql/data\n    networks:\n      - internal\n\n  payload:\n    image: ${PAYLOAD_IMAGE}\n    container_name: legocity-payload\n    environment:\n      PAYLOAD_DB_URL: ${PAYLOAD_DB_URL}\n      APP_ENV: ${APP_ENV}\n      # more PayloadCMS variables as needed\n    ports:\n      - \"${PAYLOAD_PORT}:3000\"\n    depends_on:\n      - db\n    networks:\n      - internal\n\n  proxy:\n    image: ${PROXY_IMAGE}\n    container_name: legocity-proxy\n    environment:\n      BROKER_URL: http://broker:1026/ngsi-ld/v1\n      APP_ENV: ${APP_ENV}\n      # any API keys or config needed\n    ports:\n      - \"${PROXY_PORT}:4000\"\n    depends_on:\n      - broker\n    networks:\n      - internal\n\n  dashboard:\n    image: ${DASHBOARD_IMAGE}\n    container_name: legocity-dashboard\n    environment:\n      NEXT_PUBLIC_API_BASE_URL: http://proxy:4000\n      APP_ENV: ${APP_ENV}\n    ports:\n      - \"${DASHBOARD_PORT}:3001\"\n    depends_on:\n      - proxy\n    networks:\n      - internal\n\n  update-env:\n    image: ${UPDATE_ENV_IMAGE}\n    container_name: legocity-update-env\n    restart: unless-stopped\n    environment:\n      BROKER_URL: http://broker:1026/ngsi-ld/v1\n      BROKER_WRITE_KEY: ${BROKER_WRITE_KEY_ENV}\n      WEATHER_API_KEY: ${WEATHER_API_KEY}\n      APP_ENV: ${APP_ENV}\n    depends_on:\n      - broker\n    networks:\n      - internal\n\nnetworks:\n  internal:\n    driver: bridge\n</code></pre> <p>Ghi ch\u00fa:</p> <ul> <li> <p>V\u00ed d\u1ee5 gi\u1ea3 \u0111\u1ecbnh:</p> </li> <li> <p>broker \u0111\u01a1n gi\u1ea3n tr\u00ean c\u1ed5ng 1026,</p> </li> <li>PayloadCMS l\u1eafng nghe tr\u00ean c\u1ed5ng 3000 b\u00ean trong,</li> <li>proxy tr\u00ean c\u1ed5ng 4000,</li> <li> <p>dashboard tr\u00ean c\u1ed5ng 3001.</p> </li> <li> <p>Trong m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t, b\u1ea1n th\u01b0\u1eddng s\u1ebd \u0111\u1eb7t reverse proxy \u1edf ph\u00eda tr\u01b0\u1edbc \u0111\u1ec3:</p> </li> <li>k\u1ebft th\u00fac HTTPS,</li> <li>\u00e1nh x\u1ea1 c\u00e1c route c\u00f4ng khai t\u1edbi c\u00e1c c\u1ed5ng n\u1ed9i b\u1ed9 n\u00e0y.</li> </ul>"},{"location":"vi/deployment/vm-docker/#reverse-proxy-tuy-chon-nhung-khuyen-nghi","title":"Reverse proxy (t\u00f9y ch\u1ecdn nh\u01b0ng khuy\u1ebfn ngh\u1ecb)","text":"<p>Tr\u00ean c\u00f9ng VM, b\u1ea1n c\u00f3 th\u1ec3 ch\u1ea1y reverse proxy nh\u01b0 Nginx ho\u1eb7c Traefik:</p> <ul> <li>L\u1eafng nghe tr\u00ean c\u00e1c c\u1ed5ng 80/443,</li> <li>\u0110\u1ecbnh tuy\u1ebfn l\u01b0u l\u01b0\u1ee3ng d\u1ef1a tr\u00ean t\u00ean m\u00e1y ch\u1ee7 ho\u1eb7c \u0111\u01b0\u1eddng d\u1eabn.</li> </ul> <p>V\u00ed d\u1ee5:</p> <ul> <li><code>https://city.example/dashboard</code> \u2192 dashboard container (port 3001),</li> <li><code>https://city.example/api</code> \u2192 proxy container (port 4000),</li> <li><code>https://admin.city.example</code> \u2192 PayloadCMS (port 3000, restricted access).</li> </ul> <p>Reverse proxy c\u00f3 th\u1ec3:</p> <ul> <li>Qu\u1ea3n l\u00fd ch\u1ee9ng ch\u1ec9 TLS (v\u00ed d\u1ee5 qua Let's Encrypt),</li> <li>Th\u1ef1c thi m\u1ed9t s\u1ed1 ki\u1ec3m so\u00e1t truy c\u1eadp,</li> <li>Cung c\u1ea5p ghi nh\u1eadt k\u00fd c\u01a1 b\u1ea3n.</li> </ul> <p>Trong c\u00e1c thi\u1ebft l\u1eadp d\u1ef1a tr\u00ean Docker, b\u1ea3n th\u00e2n reverse proxy th\u01b0\u1eddng l\u00e0 m\u1ed9t container kh\u00e1c tr\u00ean c\u00f9ng m\u1ea1ng.</p>"},{"location":"vi/deployment/vm-docker/#trien-khai-tung-buoc-tren-may-ao-on","title":"Tri\u1ec3n khai t\u1eebng b\u01b0\u1edbc tr\u00ean m\u00e1y \u1ea3o \u0111\u01a1n","text":"<p>M\u1ed9t quy tr\u00ecnh tri\u1ec3n khai ban \u0111\u1ea7u \u0111i\u1ec3n h\u00ecnh:</p> <ol> <li> <p>Chu\u1ea9n b\u1ecb VM</p> </li> <li> <p>Cung c\u1ea5p VM (v\u00ed d\u1ee5 Ubuntu LTS),</p> </li> <li>C\u00e0i \u0111\u1eb7t c\u1eadp nh\u1eadt b\u1ea3o m\u1eadt,</li> <li>C\u00e0i \u0111\u1eb7t Docker v\u00e0 Docker Compose,</li> <li> <p>C\u1ea5u h\u00ecnh quy t\u1eafc t\u01b0\u1eddng l\u1eeda \u0111\u1ec3 ch\u1ec9 cho ph\u00e9p HTTP/HTTPS v\u00e0 SSH.</p> </li> <li> <p>T\u1ea1o th\u01b0 m\u1ee5c LegoCity</p> </li> <li> <p>T\u1ea1o th\u01b0 m\u1ee5c, v\u00ed d\u1ee5 <code>/opt/legocity</code>,</p> </li> <li>\u0110\u1eb7t <code>docker-compose.yml</code> v\u00e0 <code>.env</code> \u1edf \u0111\u00f3,</li> <li> <p>T\u1ea1o c\u00e1c th\u01b0 m\u1ee5c con cho d\u1eef li\u1ec7u b\u1ec1n v\u1eefng:</p> <pre><code>mkdir -p /opt/legocity/data/broker\nmkdir -p /opt/legocity/data/db\n</code></pre> </li> <li> <p>C\u1ea5u h\u00ecnh bi\u1ebfn m\u00f4i tr\u01b0\u1eddng</p> </li> <li> <p>Ch\u1ec9nh s\u1eeda <code>.env</code>:</p> <ul> <li>\u0110\u1eb7t th\u00f4ng tin x\u00e1c th\u1ef1c c\u01a1 s\u1edf d\u1eef li\u1ec7u,</li> <li>\u0110\u1eb7t h\u00ecnh \u1ea3nh v\u00e0 c\u1ed5ng broker,</li> <li>\u0110\u1eb7t URL c\u01a1 s\u1edf d\u1eef li\u1ec7u PayloadCMS,</li> <li>\u0110\u1eb7t kh\u00f3a ghi v\u00e0 b\u1ea5t k\u1ef3 kh\u00f3a API b\u00ean ngo\u00e0i n\u00e0o,</li> <li>\u0110\u1eb7t t\u00ean m\u00e1y ch\u1ee7 n\u1ebfu \u1ee9ng d\u1ee5ng c\u1ea7n.</li> </ul> </li> <li> <p>K\u00e9o c\u00e1c h\u00ecnh \u1ea3nh</p> </li> <li> <p>Ch\u1ea1y:</p> <pre><code>docker compose pull\n</code></pre> </li> <li> <p>L\u1ec7nh n\u00e0y s\u1ebd t\u1ea3i c\u00e1c h\u00ecnh \u1ea3nh \u0111\u01b0\u1ee3c tham chi\u1ebfu b\u1edfi <code>docker-compose.yml</code>.</p> </li> <li> <p>Kh\u1edfi \u0111\u1ed9ng c\u00e1c d\u1ecbch v\u1ee5</p> </li> <li> <p>Ch\u1ea1y:</p> <pre><code>docker compose up -d\n</code></pre> </li> <li> <p>Ch\u1edd c\u00e1c container kh\u1edfi \u0111\u1ed9ng. Ki\u1ec3m tra tr\u1ea1ng th\u00e1i:</p> <pre><code>docker compose ps\n</code></pre> </li> <li> <p>X\u00e1c minh c\u00e1c th\u00e0nh ph\u1ea7n</p> </li> <li> <p>broker:</p> <ul> <li>Ki\u1ec3m tra nh\u1eadt k\u00fd container,</li> <li>T\u00f9y ch\u1ecdn g\u1ecdi \u0111i\u1ec3m cu\u1ed1i s\u1ee9c kh\u1ecfe (n\u1ebfu c\u00f3) t\u1eeb VM.</li> </ul> </li> <li>c\u01a1 s\u1edf d\u1eef li\u1ec7u:<ul> <li>Ki\u1ec3m tra container DB \u0111ang ch\u1ea1y.</li> </ul> </li> <li>PayloadCMS:<ul> <li>Truy c\u1eadp c\u1ed5ng \u0111\u00e3 c\u1ea5u h\u00ecnh (ho\u1eb7c route reverse proxy) t\u1eeb tr\u00ecnh duy\u1ec7t,</li> <li>Ho\u00e0n th\u00e0nh b\u1ea5t k\u1ef3 thi\u1ebft l\u1eadp ban \u0111\u1ea7u n\u00e0o (ng\u01b0\u1eddi d\u00f9ng qu\u1ea3n tr\u1ecb).</li> </ul> </li> <li>proxy:<ul> <li>G\u1ecdi \u0111i\u1ec3m cu\u1ed1i API \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 x\u00e1c nh\u1eadn n\u00f3 c\u00f3 th\u1ec3 ti\u1ebfp c\u1eadn broker.</li> </ul> </li> <li>dashboard:<ul> <li>M\u1edf URL dashboard v\u00e0 x\u00e1c nh\u1eadn n\u00f3 t\u1ea3i,</li> <li>Ch\u1ea5p nh\u1eadn r\u1eb1ng b\u1ea3n \u0111\u1ed3 v\u00e0 d\u1eef li\u1ec7u c\u00f3 th\u1ec3 tr\u1ed1ng cho \u0111\u1ebfn khi c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt ch\u1ea1y.</li> </ul> </li> <li> <p>c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt:</p> <ul> <li>Ki\u1ec3m tra nh\u1eadt k\u00fd \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o ch\u00fang \u0111ang l\u1ea5y d\u1eef li\u1ec7u b\u00ean ngo\u00e0i v\u00e0 ghi c\u00e1c th\u1ef1c th\u1ec3.</li> </ul> </li> <li> <p>Thi\u1ebft l\u1eadp reverse proxy (n\u1ebfu ch\u01b0a c\u00f3)</p> </li> <li> <p>C\u1ea5u h\u00ecnh t\u00ean m\u00e1y ch\u1ee7 v\u00e0 c\u00e1c route,</p> </li> <li>L\u1ea5y ch\u1ee9ng ch\u1ec9 TLS,</li> <li>\u0110\u1ea3m b\u1ea3o ch\u1ec9 c\u00e1c c\u1ed5ng reverse proxy \u0111\u01b0\u1ee3c ph\u01a1i b\u00e0y ra b\u00ean ngo\u00e0i.</li> </ol>"},{"location":"vi/deployment/vm-docker/#nhat-ky-va-khac-phuc-su-co","title":"Nh\u1eadt k\u00fd v\u00e0 kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1","text":"<p>\u0110\u1ed1i v\u1edbi tri\u1ec3n khai \u0111ang ch\u1ea1y:</p> <ul> <li>Li\u1ec7t k\u00ea c\u00e1c container:</li> </ul> <pre><code>docker compose ps\n</code></pre> <ul> <li>Xem nh\u1eadt k\u00fd cho d\u1ecbch v\u1ee5 c\u1ee5 th\u1ec3:</li> </ul> <pre><code>docker compose logs -f broker\ndocker compose logs -f payload\ndocker compose logs -f proxy\ndocker compose logs -f dashboard\ndocker compose logs -f update-env\n</code></pre> <p>C\u00e1c b\u01b0\u1edbc kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1 \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li> <p>N\u1ebfu dashboard hi\u1ec3n th\u1ecb b\u1ea3n \u0111\u1ed3 tr\u1ed1ng:</p> </li> <li> <p>Ki\u1ec3m tra c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt \u0111ang ch\u1ea1y v\u00e0 ghi c\u00e1c th\u1ef1c th\u1ec3,</p> </li> <li> <p>Ki\u1ec3m tra proxy c\u00f3 th\u1ec3 truy v\u1ea5n broker.</p> </li> <li> <p>N\u1ebfu PayloadCMS kh\u00f4ng th\u1ec3 truy c\u1eadp:</p> </li> <li> <p>X\u00e1c nh\u1eadn container \u0111ang ch\u1ea1y,</p> </li> <li> <p>Ki\u1ec3m tra c\u1ea5u h\u00ecnh reverse proxy v\u00e0 \u00e1nh x\u1ea1 c\u1ed5ng.</p> </li> <li> <p>N\u1ebfu broker kh\u00f4ng ph\u1ea3n h\u1ed3i:</p> </li> <li>Ki\u1ec3m tra nh\u1eadt k\u00fd container c\u1ee7a n\u00f3,</li> <li>Ki\u1ec3m tra vi\u1ec7c s\u1eed d\u1ee5ng \u0111\u0129a cho volume l\u01b0u tr\u1eef c\u1ee7a n\u00f3.</li> </ul>"},{"location":"vi/deployment/vm-docker/#cap-nhat-dich-vu","title":"C\u1eadp nh\u1eadt d\u1ecbch v\u1ee5","text":"<p>\u0110\u1ec3 tri\u1ec3n khai phi\u00ean b\u1ea3n m\u1edbi c\u1ee7a b\u1ea5t k\u1ef3 th\u00e0nh ph\u1ea7n n\u00e0o (v\u00ed d\u1ee5: dashboard ho\u1eb7c proxy):</p> <ol> <li> <p>X\u00e2y d\u1ef1ng v\u00e0 xu\u1ea5t b\u1ea3n h\u00ecnh \u1ea3nh container m\u1edbi</p> </li> <li> <p>C\u1eadp nh\u1eadt th\u1ebb h\u00ecnh \u1ea3nh trong <code>.env</code> ho\u1eb7c <code>docker-compose.yml</code>,</p> </li> <li> <p>Ho\u1eb7c \u0111\u1ea3m b\u1ea3o <code>latest</code> tr\u1ecf t\u1edbi phi\u00ean b\u1ea3n m\u1edbi.</p> </li> <li> <p>K\u00e9o h\u00ecnh \u1ea3nh m\u1edbi tr\u00ean VM</p> </li> </ol> <pre><code>docker compose pull\n</code></pre> <ol> <li>Kh\u1edfi \u0111\u1ed9ng l\u1ea1i c\u00e1c d\u1ecbch v\u1ee5</li> </ol> <pre><code>docker compose up -d\n</code></pre> <ol> <li> <p>X\u00e1c minh h\u00e0nh vi</p> </li> <li> <p>Ki\u1ec3m tra nh\u1eadt k\u00fd c\u00f3 l\u1ed7i,</p> </li> <li>X\u00e1c th\u1ef1c dashboard v\u00e0 c\u00e1c API trong tr\u00ecnh duy\u1ec7t.</li> </ol> <p>\u0110\u1ec3 c\u1eadp nh\u1eadt an to\u00e0n h\u01a1n:</p> <ul> <li>C\u1eadp nh\u1eadt c\u00e1c d\u1ecbch v\u1ee5 kh\u00f4ng quan tr\u1ecdng tr\u01b0\u1edbc (v\u00ed d\u1ee5: dashboard),</li> <li>C\u1eadp nh\u1eadt c\u00e1c d\u1ecbch v\u1ee5 quan tr\u1ecdng (broker, c\u01a1 s\u1edf d\u1eef li\u1ec7u) v\u1edbi c\u1eeda s\u1ed5 b\u1ea3o tr\u00ec \u0111\u00e3 l\u00ean k\u1ebf ho\u1ea1ch,</li> <li>Gi\u1eef h\u1ed3 s\u01a1 v\u1ec1 phi\u00ean b\u1ea3n n\u00e0o \u0111ang ch\u1ea1y trong m\u1ed7i m\u00f4i tr\u01b0\u1eddng.</li> </ul>"},{"location":"vi/deployment/vm-docker/#sao-luu-va-tinh-ben-vung-cua-du-lieu","title":"Sao l\u01b0u v\u00e0 t\u00ednh b\u1ec1n v\u1eefng c\u1ee7a d\u1eef li\u1ec7u","text":"<p>\u1ede m\u1ee9c t\u1ed1i thi\u1ec3u, b\u1ea1n n\u00ean sao l\u01b0u:</p> <ul> <li>C\u01a1 s\u1edf d\u1eef li\u1ec7u PayloadCMS (PostgreSQL ho\u1eb7c MongoDB),</li> <li>B\u1ea5t k\u1ef3 volume b\u1ec1n v\u1eefng n\u00e0o c\u1ee7a broker (n\u1ebfu broker l\u01b0u tr\u1eef tr\u1ea1ng th\u00e1i tr\u00ean \u0111\u0129a),</li> <li>C\u00e1c t\u1ec7p c\u1ea5u h\u00ecnh (<code>docker-compose.yml</code>, <code>.env</code>, t\u00e0i li\u1ec7u).</li> </ul> <p>C\u00e1c chi\u1ebfn l\u01b0\u1ee3c sao l\u01b0u \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li> <p>\u0110\u1ed1i v\u1edbi c\u01a1 s\u1edf d\u1eef li\u1ec7u:</p> </li> <li> <p>S\u1eed d\u1ee5ng c\u00f4ng c\u1ee5 c\u1ea5p c\u01a1 s\u1edf d\u1eef li\u1ec7u (v\u00ed d\u1ee5 <code>pg_dump</code> cho PostgreSQL),</p> </li> <li>L\u00ean l\u1ecbch sao l\u01b0u qua c\u00f4ng vi\u1ec7c cron ho\u1eb7c c\u00f4ng c\u1ee5 b\u00ean ngo\u00e0i,</li> <li> <p>L\u01b0u tr\u1eef b\u1ea3n sao l\u01b0u tr\u00ean b\u1ed9 nh\u1edb ri\u00eang bi\u1ec7t ho\u1eb7c v\u1ecb tr\u00ed t\u1eeb xa.</p> </li> <li> <p>\u0110\u1ed1i v\u1edbi d\u1eef li\u1ec7u broker:</p> </li> <li>N\u1ebfu s\u1eed d\u1ee5ng c\u00e1c volume b\u1ec1n v\u1eefng, \u0111\u1ecbnh k\u1ef3 ch\u1ee5p \u1ea3nh ho\u1eb7c sao ch\u00e9p th\u01b0 m\u1ee5c l\u01b0u tr\u1eef,</li> <li>T\u00f9y thu\u1ed9c v\u00e0o c\u1ea5u h\u00ecnh broker, c\u00e2n nh\u1eafc xu\u1ea5t d\u1eef li\u1ec7u th\u1ef1c th\u1ec3 qua API.</li> </ul> <p>C\u00e1c b\u1ea3n sao l\u01b0u n\u00ean \u0111\u01b0\u1ee3c:</p> <ul> <li>Ki\u1ec3m tra \u0111\u1ecbnh k\u1ef3 (kh\u00f4i ph\u1ee5c trong m\u00f4i tr\u01b0\u1eddng ri\u00eang bi\u1ec7t),</li> <li>Ghi ch\u00e9p (c\u00e1i g\u00ec \u0111\u01b0\u1ee3c sao l\u01b0u, bao l\u00e2u m\u1ed9t l\u1ea7n, l\u01b0u tr\u1eef \u1edf \u0111\u00e2u).</li> </ul>"},{"location":"vi/deployment/vm-docker/#mo-rong-va-cac-phan-mo-rong-a-vm","title":"M\u1edf r\u1ed9ng v\u00e0 c\u00e1c ph\u1ea7n m\u1edf r\u1ed9ng \u0111a VM","text":"<p>M\u00e1y \u1ea3o \u0111\u01a1n \u0111\u1ee7 cho c\u00e1c tri\u1ec3n khai nh\u1ecf. Khi nhu c\u1ea7u t\u0103ng, b\u1ea1n c\u00f3 th\u1ec3:</p> <ul> <li> <p>Chuy\u1ec3n m\u1ed9t s\u1ed1 d\u1ecbch v\u1ee5 sang c\u00e1c VM ri\u00eang bi\u1ec7t:</p> </li> <li> <p>Ch\u1ea1y c\u01a1 s\u1edf d\u1eef li\u1ec7u tr\u00ean m\u00e1y ch\u1ee7 chuy\u00ean d\u1ee5ng,</p> </li> <li>Ch\u1ea1y broker v\u00e0 c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt tr\u00ean m\u00e1y kh\u00e1c,</li> <li> <p>Gi\u1eef PayloadCMS v\u00e0 dashboard tr\u00ean m\u00e1y th\u1ee9 ba.</p> </li> <li> <p>Ho\u1eb7c s\u1eed d\u1ee5ng nhi\u1ec1u m\u00e1y ch\u1ee7 Docker v\u1edbi \u0111i\u1ec1u ph\u1ed1i b\u1ed5 sung.</p> </li> </ul> <p>Ngay c\u1ea3 trong c\u00e1c k\u1ecbch b\u1ea3n \u0111a VM, b\u1ea1n v\u1eabn c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng Docker Compose n\u1ebfu:</p> <ul> <li>B\u1ea1n gi\u1eef c\u00e1c nh\u00f3m d\u1ecbch v\u1ee5 k\u1ebft n\u1ed1i ch\u1eb7t ch\u1ebd tr\u00ean m\u1ed7i m\u00e1y ch\u1ee7,</li> <li>B\u1ea1n s\u1eed d\u1ee5ng DNS ho\u1eb7c \u0111\u1ecba ch\u1ec9 IP gi\u1eefa c\u00e1c m\u00e1y ch\u1ee7.</li> </ul> <p>\u0110\u1ed1i v\u1edbi c\u00e1c tri\u1ec3n khai quy m\u00f4 l\u1edbn h\u01a1n ho\u1eb7c c\u00f3 t\u00ednh s\u1eb5n s\u00e0ng cao, h\u00e3y c\u00e2n nh\u1eafc:</p> <ul> <li>Chuy\u1ec3n sang n\u1ec1n t\u1ea3ng container \u0111\u01b0\u1ee3c qu\u1ea3n l\u00fd (xem trang tri\u1ec3n khai AWS),</li> <li>Ho\u1eb7c s\u1eed d\u1ee5ng h\u1ec7 th\u1ed1ng \u0111i\u1ec1u ph\u1ed1i nh\u01b0 Kubernetes.</li> </ul>"},{"location":"vi/deployment/vm-docker/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>Tri\u1ec3n khai VM + Docker l\u00e0 c\u00e1ch \u0111\u01a1n gi\u1ea3n nh\u1ea5t \u0111\u1ec3 ch\u1ea1y LegoCity trong m\u00f4i tr\u01b0\u1eddng th\u1ef1c t\u1ebf.</li> <li>T\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n c\u1ed1t l\u00f5i (broker, PayloadCMS, c\u01a1 s\u1edf d\u1eef li\u1ec7u, proxy, dashboard, c\u00e1c m\u00e1y ch\u1ee7 c\u1eadp nh\u1eadt) ch\u1ea1y nh\u01b0 c\u00e1c container tr\u00ean m\u00e1y ch\u1ee7 \u0111\u01a1n ho\u1eb7c m\u1ed9t s\u1ed1 \u00edt m\u00e1y ch\u1ee7.</li> <li>C\u1ea5u h\u00ecnh v\u00e0 b\u00ed m\u1eadt \u0111\u01b0\u1ee3c x\u1eed l\u00fd qua bi\u1ebfn m\u00f4i tr\u01b0\u1eddng v\u00e0 t\u1ec7p <code>.env</code>, kh\u00f4ng \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a c\u1ee9ng trong t\u1ec7p compose.</li> <li>C\u00e1c t\u00e1c v\u1ee5 b\u1ea3o tr\u00ec bao g\u1ed3m ki\u1ec3m tra nh\u1eadt k\u00fd container, c\u1eadp nh\u1eadt h\u00ecnh \u1ea3nh qua <code>docker compose pull</code> v\u00e0 <code>docker compose up -d</code>, v\u00e0 sao l\u01b0u c\u01a1 s\u1edf d\u1eef li\u1ec7u v\u00e0 l\u01b0u tr\u1eef broker.</li> <li>M\u1eabu n\u00e0y ph\u00f9 h\u1ee3p cho c\u00e1c th\u00ed \u0111i\u1ec3m, demo v\u00e0 c\u00e1c tri\u1ec3n khai nh\u1ecf, v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng sang c\u00e1c thi\u1ebft l\u1eadp \u0111a VM khi y\u00eau c\u1ea7u t\u0103ng l\u00ean.</li> </ul>"},{"location":"vi/development/","title":"H\u01b0\u1edbng d\u1eabn Ph\u00e1t tri\u1ec3n","text":"<p>H\u1ecdc c\u00e1ch m\u1edf r\u1ed9ng v\u00e0 t\u00f9y ch\u1ec9nh LegoCity cho nhu c\u1ea7u th\u00e0nh ph\u1ed1 c\u1ee7a b\u1ea1n.</p>"},{"location":"vi/development/#tong-quan","title":"T\u1ed5ng quan","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y bao g\u1ed3m:</p> <ul> <li>\ud83e\uddf1 Creating Blocks - X\u00e2y d\u1ef1ng c\u00e1c UI components t\u00f9y ch\u1ec9nh</li> <li>\ud83d\udd0c Writing Plugins - M\u1edf r\u1ed9ng ch\u1ee9c n\u0103ng PayloadCMS</li> <li>\ud83c\udf31 Seed Data - Populate sample data</li> <li>\ud83d\uddfa\ufe0f Map Customization - Add custom map layers (xem User Guide)</li> <li>\ud83e\uddea Testing - Write v\u00e0 run tests (coming soon)</li> </ul>"},{"location":"vi/development/#configuration-over-code","title":"Configuration Over Code","text":"<p>\u01afu ti\u00ean configuring trong PayloadCMS admin panel h\u01a1n l\u00e0 writing code:</p> <p>\u274c Don't: Hard-code page layouts trong components \u2705 Do: Create configurable blocks trong PayloadCMS</p> <p>\u274c Don't: Hard-code API endpoints trong frontend \u2705 Do: Use server-side API proxies</p>"},{"location":"vi/development/#extensibility","title":"Extensibility","text":"<p>Build features nh\u01b0 reusable blocks v\u00e0 plugins:</p> <p>\u274c Don't: Modify core components directly \u2705 Do: Create new blocks v\u00e0 extend existing ones</p> <p>\u274c Don't: Fork the repository cho customization \u2705 Do: Use plugin system v\u00e0 configuration</p>"},{"location":"vi/development/#type-safety","title":"Type Safety","text":"<p>Use TypeScript cho all custom code:</p> <p>\u274c Don't: Use <code>any</code> types \u2705 Do: Define proper interfaces v\u00e0 types</p> <pre><code>// \u274c Bad\nconst processData = (data: any) =&gt; { ... }\n\n// \u2705 Good\ninterface CityData {\n  id: string;\n  name: string;\n  sensors: Sensor[];\n}\n\nconst processData = (data: CityData) =&gt; { ... }\n</code></pre>"},{"location":"vi/development/#1-plan-your-feature","title":"1. Plan Your Feature","text":"<p>Tr\u01b0\u1edbc khi coding:</p> <ul> <li>\ud83d\udcdd Define requirements</li> <li>\ud83c\udfa8 Design UI mockups</li> <li>\ud83c\udfd7\ufe0f Choose architecture (block, plugin, component)</li> <li>\ud83d\udccb Break into tasks</li> </ul>"},{"location":"vi/development/#3-implement","title":"3. Implement","text":"<p>Follow these steps:</p> <ol> <li>Create Types (if needed)</li> </ol> <pre><code>// types/city-data.ts\nexport interface CityEntity {\n  id: string;\n  type: string;\n  location: GeoJSON.Point;\n}\n</code></pre> <ol> <li>Build Component/Block</li> </ol> <pre><code>// blocks/MyBlock/Component.tsx\nexport const MyBlock: React.FC&lt;Props&gt; = ({ data }) =&gt; {\n  return &lt;div&gt;{/* Implementation */}&lt;/div&gt;;\n};\n</code></pre> <ol> <li>Add Configuration</li> </ol> <pre><code>// blocks/MyBlock/config.ts\nexport const MyBlock: Block = {\n  slug: \"myBlock\",\n  fields: [\n    /* ... */\n  ],\n};\n</code></pre> <ol> <li>Write Tests</li> </ol> <pre><code>// blocks/MyBlock/MyBlock.test.tsx\ndescribe(\"MyBlock\", () =&gt; {\n  it(\"renders correctly\", () =&gt; {\n    // Test implementation\n  });\n});\n</code></pre> <ol> <li>Update Documentation</li> <li>Add t\u1edbi relevant docs</li> <li>Include usage examples</li> </ol>"},{"location":"vi/development/#5-create-pull-request","title":"5. Create Pull Request","text":"<pre><code>git add .\ngit commit -m \"feat: add custom block for city stats\"\ngit push origin feature/your-feature-name\n</code></pre> <p>Create PR tr\u00ean GitHub v\u1edbi:</p> <ul> <li>Clear description</li> <li>Screenshots (if UI changes)</li> <li>Test results</li> <li>Documentation updates</li> </ul>"},{"location":"vi/development/#creating-a-block","title":"Creating a Block","text":"<p>Xem Creating Blocks Guide cho detailed instructions.</p> <p>Quick example:</p> <pre><code>// blocks/CityStats/config.ts\nimport { Block } from \"payload/types\";\n\nexport const CityStats: Block = {\n  slug: \"cityStats\",\n  fields: [\n    {\n      name: \"title\",\n      type: \"text\",\n      required: true,\n    },\n    {\n      name: \"metrics\",\n      type: \"array\",\n      fields: [\n        { name: \"label\", type: \"text\" },\n        { name: \"value\", type: \"number\" },\n      ],\n    },\n  ],\n};\n</code></pre> <pre><code>// blocks/CityStats/Component.tsx\nexport const CityStatsBlock = ({ title, metrics }) =&gt; (\n  &lt;div&gt;\n    &lt;h2&gt;{title}&lt;/h2&gt;\n    {metrics.map((m) =&gt; (\n      &lt;div key={m.label}&gt;\n        &lt;span&gt;{m.label}&lt;/span&gt;: {m.value}\n      &lt;/div&gt;\n    ))}\n  &lt;/div&gt;\n);\n</code></pre>"},{"location":"vi/development/#creating-a-plugin","title":"Creating a Plugin","text":"<p>Xem Writing Plugins Guide cho details.</p> <p>Example:</p> <pre><code>// plugins/customPlugin.ts\nimport { Plugin } from \"payload/config\";\n\nexport const customPlugin = (): Plugin =&gt; ({\n  name: \"custom-plugin\",\n\n  init: (payload) =&gt; {\n    // Initialize plugin\n  },\n\n  hooks: {\n    beforeChange: [\n      (args) =&gt; {\n        // Hook logic\n      },\n    ],\n  },\n});\n</code></pre>"},{"location":"vi/development/#creating-a-collection","title":"Creating a Collection","text":"<pre><code>// collections/CityServices.ts\nimport { CollectionConfig } from \"payload/types\";\n\nexport const CityServices: CollectionConfig = {\n  slug: \"city-services\",\n  admin: {\n    useAsTitle: \"name\",\n    group: \"Content\",\n  },\n  access: {\n    read: () =&gt; true,\n  },\n  fields: [\n    {\n      name: \"name\",\n      type: \"text\",\n      required: true,\n    },\n    {\n      name: \"description\",\n      type: \"textarea\",\n    },\n    {\n      name: \"location\",\n      type: \"point\",\n    },\n  ],\n};\n</code></pre> <p>Register trong <code>payload.config.ts</code>:</p> <pre><code>import { CityServices } from \"./collections/CityServices\";\n\nexport default buildConfig({\n  collections: [\n    // ... existing\n    CityServices,\n  ],\n});\n</code></pre>"},{"location":"vi/development/#code-organization","title":"Code Organization","text":"<p>\u2705 One component per file \u2705 Colocate related files (component + styles + tests) \u2705 Use index files cho exports \u2705 Group by feature, not by type</p>"},{"location":"vi/development/#performance","title":"Performance","text":"<p>\u2705 Use React Server Components khi c\u00f3 th\u1ec3 \u2705 Lazy load heavy components \u2705 Optimize images v\u1edbi <code>next/image</code> \u2705 Implement data caching \u2705 Monitor bundle size</p>"},{"location":"vi/development/#accessibility","title":"Accessibility","text":"<p>\u2705 Use semantic HTML \u2705 Add ARIA labels \u2705 Support keyboard navigation \u2705 Test v\u1edbi screen readers \u2705 Maintain color contrast</p>"},{"location":"vi/development/#documentation","title":"Documentation","text":"<p>Khi adding features:</p> <ol> <li>Code Comments - Explain complex logic</li> <li>JSDoc - Document functions v\u00e0 types</li> <li>README - Update relevant READMEs</li> <li>Docs Site - Add t\u1edbi MkDocs documentation</li> </ol> <p>Example JSDoc:</p> <pre><code>/**\n * Fetches city data from NGSI-LD broker\n * @param cityId - Unique city identifier\n * @param options - Query options\n * @returns Promise resolving to city data\n * @throws Error if city not found\n */\nexport async function fetchCityData(\n  cityId: string,\n  options?: QueryOptions\n): Promise&lt;CityData&gt; {\n  // Implementation\n}\n</code></pre>"},{"location":"vi/development/#contributing","title":"Contributing","text":"<p>Xem CONTRIBUTING.md cho:</p> <ul> <li>Code of Conduct</li> <li>Git workflow</li> <li>PR guidelines</li> <li>Review process</li> </ul>"},{"location":"vi/development/blocks/","title":"T\u1ea1o Blocks m\u1edbi","text":"<p>Trang n\u00e0y gi\u1ea3i th\u00edch c\u00e1ch t\u1ea1o c\u00e1c UI blocks m\u1edbi trong LegoCity.</p> <p>Blocks l\u00e0 g\u00ec?</p> <p>Blocks l\u00e0 c\u00e1c \u0111\u01a1n v\u1ecb x\u00e2y d\u1ef1ng c\u1ee7a dashboard UI m\u00f4 t\u1ea3:</p> <pre><code>- Nh\u1eefng g\u00ec xu\u1ea5t hi\u1ec7n trong sidebar\n- Nh\u1eefng g\u00ec \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb trong detail panels\n- C\u00e1ch c\u00e1c layers \u0111\u01b0\u1ee3c toggle\n- C\u00e1ch filters v\u00e0 controls \u0111\u01b0\u1ee3c b\u1ed1 tr\u00ed\n</code></pre> <p>M\u1ee5c ti\u00eau l\u00e0 cho ph\u00e9p nh\u1eefng ng\u01b0\u1eddi kh\u00f4ng ph\u1ea3i developer c\u1ea5u h\u00ecnh views v\u00e0 blocks trong PayloadCMS, trong khi developers cung c\u1ea5p c\u00e1c building blocks c\u01a1 b\u1ea3n trong code.</p>"},{"location":"vi/development/blocks/#mo-hinh-khai-niem","title":"M\u00f4 h\u00ecnh kh\u00e1i ni\u1ec7m","text":"<p>M\u1ed9t block trong LegoCity c\u00f3 hai m\u1eb7t:</p>"},{"location":"vi/development/blocks/#content-model-payloadcms","title":"Content Model (PayloadCMS)","text":"<ul> <li>C\u00e1ch block \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n nh\u01b0 d\u1eef li\u1ec7u trong PayloadCMS</li> <li>C\u00e1c tr\u01b0\u1eddng n\u00e0o c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh (titles, descriptions, layer references, parameters)</li> <li>C\u00e1ch n\u00f3 \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef v\u00e0 versioned</li> </ul>"},{"location":"vi/development/blocks/#render-logic-dashboard-react-component","title":"Render Logic (Dashboard React Component)","text":"<ul> <li>C\u00e1ch block tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0o v\u00e0 ho\u1ea1t \u0111\u1ed9ng trong UI</li> <li>C\u00e1ch n\u00f3 t\u01b0\u01a1ng t\u00e1c v\u1edbi Mapbox v\u00e0 c\u00e1c blocks kh\u00e1c</li> <li>C\u00e1ch n\u00f3 \u0111\u1ecdc runtime data (t\u1eeb proxy, broker, ho\u1eb7c context)</li> </ul> <p>!!! tip \"Mapping Pattern\" - PayloadCMS: Block type string (v\u00ed d\u1ee5 <code>\"layerToggle\"</code>, <code>\"kpiCard\"</code>, <code>\"chart\"</code>) - Dashboard: React component \u0111\u00e3 \u0111\u0103ng k\u00fd cho m\u1ed7i block type</p>"},{"location":"vi/development/blocks/#block-lifecycle","title":"Block Lifecycle","text":"<p>Khi b\u1ea1n t\u1ea1o m\u1ed9t block type m\u1edbi, h\u00e3y l\u00e0m theo lifecycle n\u00e0y:</p>"},{"location":"vi/development/blocks/#1-inh-nghia-block-type-trong-payloadcms","title":"1. \u0110\u1ecbnh ngh\u0129a Block Type trong PayloadCMS","text":"<ul> <li>Th\u00eam m\u1ed9t block definition m\u1edbi v\u00e0o collection th\u00edch h\u1ee3p (v\u00ed d\u1ee5, \"Layouts\" ho\u1eb7c \"Blocks\")</li> <li>Ch\u1ec9 \u0111\u1ecbnh c\u00e1c tr\u01b0\u1eddng c\u1ea7n thi\u1ebft \u0111\u1ec3 c\u1ea5u h\u00ecnh block (title, references to layers, thresholds, v.v.)</li> </ul>"},{"location":"vi/development/blocks/#2-expose-block-cho-dashboard","title":"2. Expose Block cho Dashboard","text":"<ul> <li>\u0110\u1ea3m b\u1ea3o API endpoint \u0111\u01b0\u1ee3c dashboard s\u1eed d\u1ee5ng bao g\u1ed3m block configurations</li> <li>\u0110\u1ea3m b\u1ea3o block type names v\u00e0 shapes nh\u1ea5t qu\u00e1n</li> </ul>"},{"location":"vi/development/blocks/#3-implement-block-component","title":"3. Implement Block Component","text":"<ul> <li>T\u1ea1o m\u1ed9t React component cho block type</li> <li>\u0110\u0103ng k\u00fd n\u00f3 trong block registry ho\u1eb7c mapping</li> <li>X\u1eed l\u00fd props c\u1ea9n th\u1eadn v\u00e0 tr\u00e1nh coupling v\u1edbi PayloadCMS internals</li> </ul>"},{"location":"vi/development/blocks/#4-wire-to-map-va-data-sources","title":"4. Wire to Map v\u00e0 Data Sources","text":"<ul> <li>S\u1eed d\u1ee5ng proxy/API \u0111\u1ec3 fetch data n\u1ebfu c\u1ea7n</li> <li>T\u01b0\u01a1ng t\u00e1c v\u1edbi map (toggle layers, zoom to features) n\u1ebfu ph\u00f9 h\u1ee3p</li> </ul>"},{"location":"vi/development/blocks/#5-test-trong-real-view","title":"5. Test trong Real View","text":"<ul> <li>C\u1ea5u h\u00ecnh m\u1ed9t page ho\u1eb7c layout trong PayloadCMS s\u1eed d\u1ee5ng block c\u1ee7a b\u1ea1n</li> <li>Reload dashboard v\u00e0 verify behaviour</li> </ul>"},{"location":"vi/development/blocks/#defining-blocks-trong-payloadcms","title":"Defining Blocks trong PayloadCMS","text":"<p>Trong PayloadCMS, blocks th\u01b0\u1eddng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 m\u1ed9t ph\u1ea7n c\u1ee7a field cho ph\u00e9p nhi\u1ec1u block types.</p> <p>C\u1ea5u tr\u00fac v\u00ed d\u1ee5:</p> <pre><code>layout: array of blocks\n  \u2514\u2500 m\u1ed7i block c\u00f3 `blockType` v\u00e0 type-specific fields\n</code></pre>"},{"location":"vi/development/blocks/#tao-block-type-moi","title":"T\u1ea1o Block Type m\u1edbi","text":"Ch\u1ecdn Block Type <p>Ch\u1ecdn m\u1ed9t <code>blockType</code> ho\u1eb7c slug duy nh\u1ea5t:</p> <pre><code>- `layerToggle`\n- `kpiCard`\n- `mapLegend`\n- `chartWidget`\n</code></pre> \u0110\u1ecbnh ngh\u0129a Fields <p>\u0110\u1ecbnh ngh\u0129a c\u00e1c tr\u01b0\u1eddng m\u00e0 users c\u00f3 th\u1ec3 edit:</p> <pre><code>- `title` - Display name\n- `description` - Help text\n- `layerRefs` - Links to layer definitions\n- `thresholds` - Data ranges\n- B\u1ea5t k\u1ef3 c\u1ea5u h\u00ecnh n\u00e0o kh\u00e1c c\u1ea7n cho UI\n</code></pre>"},{"location":"vi/development/blocks/#nguyen-tac-thiet-ke-field","title":"Nguy\u00ean t\u1eafc thi\u1ebft k\u1ebf Field","text":"<p>!!! success \"Best Practices\" - \u2705 Ch\u1ec9 expose nh\u1eefng g\u00ec c\u1ea7n thi\u1ebft cho behaviour c\u1ee7a block - \u2705 Tr\u00e1nh hard-coding display strings ho\u1eb7c IDs trong code - \u2705 \u01afu ti\u00ean references t\u1edbi c\u00e1c collections kh\u00e1c (layers, views) - \u2705 Gi\u1eef c\u1ea5u h\u00ecnh \u0111\u01a1n gi\u1ea3n v\u00e0 tr\u1ef1c quan</p>"},{"location":"vi/development/blocks/#exposing-block-data-cho-dashboard","title":"Exposing Block Data cho Dashboard","text":"<p>Dashboard fetch configuration t\u1eeb:</p> <ul> <li>PayloadCMS REST ho\u1eb7c GraphQL endpoint</li> <li>Custom API layer transform Payload data</li> </ul>"},{"location":"vi/development/blocks/#yeu-cau-cau-truc-du-lieu","title":"Y\u00eau c\u1ea7u c\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<p>!!! warning \"Required Fields\" - Data ph\u1ea3i bao g\u1ed3m tr\u01b0\u1eddng <code>type</code> ho\u1eb7c <code>blockType</code> cho m\u1ed7i block - C\u00e1c tr\u01b0\u1eddng c\u00f2n l\u1ea1i (props) ph\u1ea3i theo m\u1ed9t shape c\u00f3 th\u1ec3 d\u1ef1 \u0111o\u00e1n</p> <p>V\u00ed d\u1ee5 JSON:</p> Block Configuration<pre><code>{\n  \"blocks\": [\n    {\n      \"type\": \"layerToggle\",\n      \"title\": \"Waterlogging risk\",\n      \"layers\": [\"env:flood-risk\", \"env:rain-intensity\"]\n    },\n    {\n      \"type\": \"kpiCard\",\n      \"title\": \"Active parking spots\",\n      \"metricKey\": \"mobility:parking:activeCount\"\n    }\n  ]\n}\n</code></pre> <p>Pattern:</p> <ul> <li><code>type</code> \u2192 React component n\u00e0o s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng</li> <li><code>props</code> \u2192 Configuration data cho component \u0111\u00f3</li> </ul>"},{"location":"vi/development/blocks/#block-registry","title":"Block Registry","text":"<p>T\u1ea1o m\u1ed9t mapping t\u1eeb block type t\u1edbi React component:</p> dashboard/src/blocks/registry.ts<pre><code>const BLOCK_REGISTRY: Record&lt;string, React.ComponentType&lt;BlockProps&gt;&gt; = {\n  layerToggle: LayerToggleBlock,\n  kpiCard: KpiCardBlock,\n  mapLegend: MapLegendBlock,\n  // Th\u00eam blocks m\u1edbi c\u1ee7a b\u1ea1n v\u00e0o \u0111\u00e2y\n};\n</code></pre>"},{"location":"vi/development/blocks/#block-renderer","title":"Block Renderer","text":"<p>T\u1ea1o m\u1ed9t component:</p> <ol> <li>Nh\u1eadn m\u1ed9t array of block definitions t\u1eeb PayloadCMS</li> <li>L\u1eb7p qua ch\u00fang</li> <li>Render component t\u01b0\u01a1ng \u1ee9ng t\u1eeb registry</li> </ol>"},{"location":"vi/development/blocks/#them-block-moi","title":"Th\u00eam Block m\u1edbi","text":"1. T\u1ea1o Component <p>V\u00ed d\u1ee5: LayerToggleBlock</p> <pre><code>```typescript title=\"dashboard/src/blocks/LayerToggleBlock.tsx\"\ninterface LayerToggleProps {\n  title: string;\n  layers: string[];\n  initialState?: boolean;\n}\n\nexport const LayerToggleBlock: React.FC&lt;LayerToggleProps&gt; = ({\n  title,\n  layers,\n  initialState = false\n}) =&gt; {\n  const { showLayer, hideLayer } = useMapController();\n  const [isVisible, setIsVisible] = useState(initialState);\n\n  const handleToggle = () =&gt; {\n    layers.forEach(layerId =&gt; {\n      isVisible ? hideLayer(layerId) : showLayer(layerId);\n    });\n    setIsVisible(!isVisible);\n  };\n\n  return (\n    &lt;div className=\"layer-toggle-block\"&gt;\n      &lt;h3&gt;{title}&lt;/h3&gt;\n      &lt;button onClick={handleToggle}&gt;\n        {isVisible ? '\u1ea8n' : 'Hi\u1ec7n'} Layers\n      &lt;/button&gt;\n    &lt;/div&gt;\n  );\n};\n```\n</code></pre> 2. \u0110\u0103ng k\u00fd Block <p>Th\u00eam v\u00e0o registry:</p> <pre><code>```typescript\nconst BLOCK_REGISTRY = {\n  // ... existing blocks\n  layerToggle: LayerToggleBlock,\n};\n```\n\n\u0110\u1ea3m b\u1ea3o type string kh\u1edbp v\u1edbi nh\u1eefng g\u00ec PayloadCMS g\u1eedi.\n</code></pre> 3. Type Safety <p>\u0110\u1ecbnh ngh\u0129a c\u00e1c specific props types:</p> <pre><code>```typescript\ninterface BlockProps {\n  type: string;\n  [key: string]: any;\n}\n\ninterface LayerToggleProps extends BlockProps {\n  type: 'layerToggle';\n  title: string;\n  layers: string[];\n  initialState?: boolean;\n}\n```\n</code></pre>"},{"location":"vi/development/blocks/#tuong-tac-voi-map-va-blocks","title":"T\u01b0\u01a1ng t\u00e1c v\u1edbi Map v\u00e0 Blocks","text":"<p>Nhi\u1ec1u blocks c\u1ea7n:</p> <ul> <li>Toggle Mapbox layers</li> <li>Zoom to bounding boxes</li> <li>Show/hide overlays</li> <li>Coordinate v\u1edbi c\u00e1c components kh\u00e1c</li> </ul>"},{"location":"vi/development/blocks/#map-controller-pattern","title":"Map Controller Pattern","text":"<p>T\u1ea1o m\u1ed9t map context ho\u1eb7c controller:</p> Map Controller Interface<pre><code>interface MapController {\n  showLayer: (id: string) =&gt; void;\n  hideLayer: (id: string) =&gt; void;\n  setLayerOpacity: (id: string, value: number) =&gt; void;\n  flyTo: (bounds: LngLatBoundsLike) =&gt; void;\n  setFilter: (layerId: string, filter: any) =&gt; void;\n}\n</code></pre>"},{"location":"vi/development/blocks/#vi-du-su-dung","title":"V\u00ed d\u1ee5 s\u1eed d\u1ee5ng","text":"<pre><code>const LayerToggleBlock: React.FC&lt;LayerToggleProps&gt; = ({ layers }) =&gt; {\n  const mapController = useMapController(); // T\u1eeb context\n\n  const handleShow = () =&gt; {\n    layers.forEach((id) =&gt; mapController.showLayer(id));\n  };\n\n  return &lt;button onClick={handleShow}&gt;Hi\u1ec7n Layers&lt;/button&gt;;\n};\n</code></pre>"},{"location":"vi/development/blocks/#nguyen-tac-thiet-ke","title":"Nguy\u00ean t\u1eafc thi\u1ebft k\u1ebf","text":"<p>!!! tip \"Gi\u1eef Blocks t\u1eadp trung\" - M\u1ed9t block toggles m\u1ed9t nh\u00f3m layers c\u1ee5 th\u1ec3 - Block kh\u00e1c visualizes m\u1ed9t KPI d\u1ef1a tr\u00ean data - Block kh\u00e1c selects m\u1ed9t filter ho\u1eb7c time range</p> <pre><code>Tr\u00e1nh coupling blocks tr\u1ef1c ti\u1ebfp v\u1edbi raw Mapbox internals\u2014route interactions qua shared map controller.\n</code></pre>"},{"location":"vi/development/blocks/#data-driven-blocks","title":"Data-Driven Blocks","text":"<p>M\u1ed9t s\u1ed1 blocks c\u1ea7n runtime data, kh\u00f4ng ch\u1ec9 configuration:</p> Block Type Y\u00eau c\u1ea7u d\u1eef li\u1ec7u KPI Cards Gi\u00e1 tr\u1ecb m\u1edbi nh\u1ea5t cho m\u1ed9t metric Charts Time series, distribution Table Views Lists of entities matching filters"},{"location":"vi/development/blocks/#configuration-trong-payloadcms","title":"Configuration trong PayloadCMS","text":"<p>Ch\u1ec9 \u0111\u1ecbnh:</p> <ul> <li>Domain ho\u1eb7c entity type n\u00e0o \u0111\u1ec3 query</li> <li>B\u1ea5t k\u1ef3 key filters (v\u00ed d\u1ee5, \"environment\", \"mobility:parking\")</li> <li>Time windows ho\u1eb7c thresholds</li> </ul>"},{"location":"vi/development/blocks/#can-nhac-thiet-ke-api","title":"C\u00e2n nh\u1eafc thi\u1ebft k\u1ebf API","text":"<p>!!! success \"Gi\u1eef UI \u0111\u01a1n gi\u1ea3n\" - Tr\u1ea3 v\u1ec1 aggregated results khi c\u00f3 th\u1ec3 - Tr\u00e1nh bu\u1ed9c UI implement heavy transformation logic - Cung c\u1ea5p loading v\u00e0 error states - Cache d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c truy c\u1eadp th\u01b0\u1eddng xuy\u00ean</p>"},{"location":"vi/development/blocks/#reusing-va-extending-blocks","title":"Reusing v\u00e0 Extending Blocks","text":"<p>Tr\u01b0\u1edbc khi t\u1ea1o m\u1ed9t block m\u1edbi, ki\u1ec3m tra xem m\u1ed9t block hi\u1ec7n c\u00f3 c\u00f3 th\u1ec3:</p> <ul> <li>\u2705 Reused as-is</li> <li>\u2705 Extended via configuration</li> <li>\u2705 Composed v\u1edbi c\u00e1c blocks kh\u00e1c</li> </ul>"},{"location":"vi/development/blocks/#generic-vs-specific-blocks","title":"Generic vs Specific Blocks","text":"<p>Good generic block:</p> <pre><code>// Generic metric card h\u1ed7 tr\u1ee3 nhi\u1ec1u domains b\u1eb1ng configuration\n&lt;MetricCard\n  title=\"Active Parking Spots\"\n  metricKey=\"mobility:parking:activeCount\"\n  unit=\"spots\"\n/&gt;\n</code></pre> <p>Tr\u00e1nh over-specialization:</p> <pre><code>// Bad: Qu\u00e1 specific\n&lt;ParkingSpotCard /&gt;\n&lt;BusStopCard /&gt;\n&lt;BikeStationCard /&gt;\n\n// Good: M\u1ed9t configurable block\n&lt;TransportMetricCard type=\"parking|bus|bike\" /&gt;\n</code></pre>"},{"location":"vi/development/blocks/#extracting-shared-logic","title":"Extracting Shared Logic","text":"<p>N\u1ebfu m\u1ed9t block m\u1edbi ~80% gi\u1ed1ng v\u1edbi m\u1ed9t block hi\u1ec7n c\u00f3:</p> <ul> <li>Extract shared logic v\u00e0o m\u1ed9t hook ho\u1eb7c shared component</li> <li>Document differences v\u00e0 t\u1ea1i sao c\u1ea7n m\u1ed9t block type m\u1edbi</li> </ul>"},{"location":"vi/development/blocks/#documentation-va-examples","title":"Documentation v\u00e0 Examples","text":"<p>M\u1ed7i khi b\u1ea1n th\u00eam m\u1ed9t block type m\u1edbi:</p>"},{"location":"vi/development/blocks/#update-documentation","title":"Update Documentation","text":"<ul> <li>[ ] Th\u00eam v\u00e0o Entities and blocks section</li> <li>[ ] Th\u00eam v\u00e0o block reference page (n\u1ebfu t\u1ed3n t\u1ea1i)</li> <li>[ ] Update trang n\u00e0y v\u1edbi examples m\u1edbi</li> </ul>"},{"location":"vi/development/blocks/#bao-gom-details","title":"Bao g\u1ed3m Details","text":"<p>Document:</p> Th\u00f4ng tin V\u00ed d\u1ee5 Block type name <code>layerToggle</code> Description Toggles visibility of map layers PayloadCMS fields <code>title</code>, <code>layers[]</code>, <code>initialState</code> Data assumptions Expects layer IDs to exist in map config"},{"location":"vi/development/blocks/#cung-cap-examples","title":"Cung c\u1ea5p Examples","text":"Screenshots <p>Bao g\u1ed3m screenshots c\u1ee7a block \u0111ang s\u1eed d\u1ee5ng</p> Configuration <p><code>json     {       \"type\": \"layerToggle\",       \"title\": \"Flood Risk Layers\",       \"layers\": [         \"env:flood-risk-high\",         \"env:flood-risk-medium\"       ],       \"initialState\": true     }</code></p> Component Usage <p><code>typescript     &lt;LayerToggleBlock       title=\"Flood Risk Layers\"       layers={[\"env:flood-risk-high\", \"env:flood-risk-medium\"]}       initialState={true}     /&gt;</code></p>"},{"location":"vi/development/blocks/#block-development-checklist","title":"Block Development Checklist","text":"<p>T\u1ea1o Block m\u1edbi</p> <p>PayloadCMS:</p> <pre><code>- [ ] \u0110\u1ecbnh ngh\u0129a block type v\u00e0 unique slug\n- [ ] Th\u00eam configurable fields\n- [ ] Test block creation trong admin panel\n- [ ] Document field purposes\n\n**Dashboard:**\n\n- [ ] T\u1ea1o React component\n- [ ] Th\u00eam v\u00e0o block registry\n- [ ] Implement prop types (TypeScript)\n- [ ] Handle loading/error states\n- [ ] Connect to map controller (n\u1ebfu c\u1ea7n)\n- [ ] Connect to data API (n\u1ebfu c\u1ea7n)\n\n**Testing:**\n\n- [ ] T\u1ea1o test view trong PayloadCMS\n- [ ] Verify block renders correctly\n- [ ] Test interactive features\n- [ ] Check mobile responsiveness\n\n**Documentation:**\n\n- [ ] Update block reference\n- [ ] Th\u00eam usage examples\n- [ ] Bao g\u1ed3m screenshots\n- [ ] Document known limitations\n</code></pre>"},{"location":"vi/development/blocks/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<p>Key Takeaways</p> <p>Blocks k\u1ebft n\u1ed1i PayloadCMS configuration v\u1edbi React components</p> <pre><code>**\u0110\u1ec3 t\u1ea1o m\u1ed9t block m\u1edbi:**\n\n1. \u0110\u1ecbnh ngh\u0129a block type v\u00e0 fields trong PayloadCMS\n2. \u0110\u1ea3m b\u1ea3o API exposes block data v\u1edbi `type` v\u00e0 `props`\n3. Implement React component v\u00e0 \u0111\u0103ng k\u00fd trong block registry\n4. Wire to map controller ho\u1eb7c data APIs n\u1ebfu c\u1ea7n\n5. Test trong real views v\u00e0 document usage\n\n**Best practices:**\n\n- Gi\u1eef blocks nh\u1ecf, focused, v\u00e0 data-driven\n- Enable non-developers compose complex dashboards t\u1eeb simple pieces\n- Lu\u00f4n update documentation cho c\u00e1c contributors kh\u00e1c\n</code></pre> <p>C\u00e1c trang li\u00ean quan:</p> <ul> <li>PayloadCMS Plugins</li> <li>Seed Data &amp; Scenarios</li> <li>Local Development Setup</li> </ul>"},{"location":"vi/development/plugins/","title":"Vi\u1ebft Payload plugins","text":"<p>Trang n\u00e0y gi\u1ea3i th\u00edch c\u00e1ch vi\u1ebft PayloadCMS plugins cho LegoCity.</p> <p>Plugins l\u00e0 c\u00e1ch ch\u00fang ta \u0111\u00f3ng g\u00f3i logic m\u00e0:</p> <ul> <li>\u0111\u01b0\u1ee3c t\u00e1i s\u1eed d\u1ee5ng tr\u00ean nhi\u1ec1u collections ho\u1eb7c projects,</li> <li>t\u00edch h\u1ee3p external tools (NGSI-LD helpers, AI, map config, v.v.),</li> <li>ch\u00fang ta c\u00f3 th\u1ec3 mu\u1ed1n publish sau n\u00e0y t\u1edbi Payload plugin ecosystem.</li> </ul> <p>\u00dd t\u01b0\u1edfng: gi\u1eef core LegoCity clean, v\u00e0 move shared behaviours v\u00e0o c\u00e1c plugins nh\u1ecf, well-defined.</p>"},{"location":"vi/development/plugins/#1-khi-nao-nen-tao-plugin","title":"1. Khi n\u00e0o n\u00ean t\u1ea1o plugin?","text":"<p>Use m\u1ed9t plugin thay v\u00ec inline code khi:</p> <ul> <li> <p>Same fields / hooks are needed trong many collections.   \u2192 e.g. NGSI-LD metadata (<code>entityType</code>, <code>entityIdPattern</code>, <code>geoLocation</code>).</p> </li> <li> <p>B\u1ea1n integrate m\u1ed9t external service ho\u1eb7c tool.   \u2192 e.g. AI helpers, monitoring, audit logging, external registries.</p> </li> <li> <p>B\u1ea1n mu\u1ed1n feature l\u00e0 optional ho\u1eb7c reusable trong other projects.   \u2192 plugin l\u00e0 easier \u0111\u1ec3 enable/disable via <code>plugins: []</code>.</p> </li> </ul> <p>N\u1ebfu logic l\u00e0 very specific cho m\u1ed9t single collection, keep n\u00f3 trong collection config \u0111\u00f3. Otherwise, promote n\u00f3 th\u00e0nh plugin.</p>"},{"location":"vi/development/plugins/#2-prerequisites","title":"2. Prerequisites","text":"<p>B\u1ea1n n\u00ean comfortable v\u1edbi:</p> <ul> <li>basic TypeScript ho\u1eb7c modern JavaScript,</li> <li>Payload configuration structure (<code>payload.config.ts</code>),</li> <li>how collections v\u00e0 fields are defined.</li> </ul> <p>Official references (read later khi needed):</p> <ul> <li>Payload docs: Plugins, Collections, Fields.</li> </ul>"},{"location":"vi/development/plugins/#3-recommended-layout","title":"3. Recommended layout","text":"<p>Trong LegoCity ch\u00fang ta keep custom plugins trong m\u1ed9t dedicated folder \u0111\u1ec3 ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c reused easily. M\u1ed9t common pattern l\u00e0:</p> <pre><code>LegoCity/\n  payload/\n    payload.config.ts\n    plugins/\n      payload-ngsi-ld/\n        index.ts\n      payload-map-config/\n        index.ts\n      payload-ai-helpers/\n        index.ts\n</code></pre> <p>B\u1ea1n c\u00f3 th\u1ec3 adapt exact path cho repo c\u1ee7a b\u1ea1n, nh\u01b0ng \u00fd t\u01b0\u1edfng l\u00e0:</p> <ul> <li>one folder per plugin,</li> <li>m\u1ed7i folder exports m\u1ed9t plugin factory function (e.g. <code>ngsiLdPlugin()</code>).</li> </ul>"},{"location":"vi/development/plugins/#4-minimal-plugin-example","title":"4. Minimal plugin example","text":"<p>M\u1ed9t Payload plugin ch\u1ec9 l\u00e0 m\u1ed9t function nh\u1eadn existing config v\u00e0 returns m\u1ed9t modified config.</p>"},{"location":"vi/development/plugins/#41-create-the-plugin-file","title":"4.1. Create the plugin file","text":"<p>Create <code>payload/plugins/payload-ngsi-ld/index.ts</code>:</p> <pre><code>// payload/plugins/payload-ngsi-ld/index.ts\n\nimport type { Config, Plugin } from \"payload\";\n\n// Optional options type cho plugin n\u00e0y\nexport type NgsiLdPluginOptions = {\n  /**\n   * Optional prefix cho entity IDs, e.g. \"urn:ngsi-ld:LegoCity:\"\n   */\n  entityIdPrefix?: string;\n};\n\n/**\n * Factory returns m\u1ed9t Payload plugin.\n * Usage trong payload.config.ts: ngsiLdPlugin({ entityIdPrefix: 'urn:...' })\n */\nexport const ngsiLdPlugin =\n  (options: NgsiLdPluginOptions = {}): Plugin&lt;Config&gt; =&gt;\n  (incomingConfig) =&gt; {\n    const config = { ...incomingConfig };\n\n    // Example: add m\u1ed9t reusable \"ngsiLdFields\" field group t\u1edbi all collections\n    // opt in via `ngsiLdEnabled: true` trong custom config c\u1ee7a ch\u00fang.\n    config.collections = (config.collections || []).map((collection) =&gt; {\n      if (!collection.admin?.meta?.ngsiLdEnabled) {\n        return collection;\n      }\n\n      return {\n        ...collection,\n        fields: [\n          // Group of NGSI-LD helper fields\n          {\n            name: \"ngsiLd\",\n            label: \"NGSI-LD metadata\",\n            type: \"group\",\n            fields: [\n              {\n                name: \"entityType\",\n                type: \"text\",\n                required: true,\n              },\n              {\n                name: \"entityIdSuffix\",\n                type: \"text\",\n                admin: {\n                  description:\n                    \"Suffix appended to the global entity ID prefix (configured in plugin options).\",\n                },\n              },\n              {\n                name: \"geo\",\n                type: \"point\",\n                label: \"Location (WGS84)\",\n              },\n            ],\n          },\n\n          // keep existing fields after our group\n          ...(collection.fields || []),\n        ],\n      };\n    });\n\n    // B\u1ea1n c\u00f3 th\u1ec3 store computed values trong config cho later use n\u1ebfu needed\n    config.custom = {\n      ...(config.custom || {}),\n      ngsiLdEntityIdPrefix: options.entityIdPrefix ?? \"urn:ngsi-ld:LegoCity:\",\n    };\n\n    return config;\n  };\n</code></pre> <p>Notes:</p> <ul> <li>Plugin kh\u00f4ng know v\u1ec1 LegoCity UI directly. N\u00f3 ch\u1ec9 extends   Payload config (fields, hooks, v.v.).</li> <li>Ch\u00fang ta use m\u1ed9t small <code>NgsiLdPluginOptions</code> type \u0111\u1ec3 make configuration explicit.</li> </ul>"},{"location":"vi/development/plugins/#5-registering-the-plugin","title":"5. Registering the plugin","text":"<p>Trong <code>payload.config.ts</code> c\u1ee7a b\u1ea1n (path c\u00f3 th\u1ec3 differ), import v\u00e0 register plugin:</p> <pre><code>// payload/payload.config.ts\n\nimport { buildConfig } from \"payload/config\";\nimport { ngsiLdPlugin } from \"./plugins/payload-ngsi-ld\";\n\nexport default buildConfig({\n  // ...existing config (collections, globals, etc.)\n\n  collections: [\n    {\n      slug: \"layers\",\n      labels: { singular: \"Layer\", plural: \"Layers\" },\n      // Custom flag: collection n\u00e0y wants NGSI-LD helper fields\n      admin: {\n        meta: {\n          ngsiLdEnabled: true,\n        },\n      },\n      fields: [\n        {\n          name: \"name\",\n          type: \"text\",\n          required: true,\n        },\n        // other layer-specific fields...\n      ],\n    },\n    // other collections...\n  ],\n\n  plugins: [\n    ngsiLdPlugin({\n      entityIdPrefix: \"urn:ngsi-ld:LegoCity:\",\n    }),\n    // other plugins (AI, map-config, etc.)\n  ],\n});\n</code></pre> <p>V\u1edbi setup n\u00e0y, b\u1ea5t k\u1ef3 collection n\u00e0o m\u00e0 <code>admin.meta.ngsiLdEnabled === true</code> receives <code>ngsiLd</code> group auto-injected b\u1edfi plugin. B\u1ea1n c\u00f3 th\u1ec3 reuse c\u00f9ng plugin trong another project simply b\u1eb1ng c\u00e1ch installing v\u00e0 adding n\u00f3 t\u1edbi <code>plugins</code>.</p>"},{"location":"vi/development/plugins/#6-adding-hooks-inside-a-plugin","title":"6. Adding hooks inside a plugin","text":"<p>Plugins c\u0169ng c\u00f3 th\u1ec3 add hooks (for example, \u0111\u1ec3 enforce rules ho\u1eb7c emit events).</p> <p>Trong c\u00f9ng plugin file:</p> <pre><code>// Inside ngsiLdPlugin factory, after computing `config`\n\nconfig.collections = (config.collections || []).map((collection) =&gt; {\n  if (!collection.admin?.meta?.ngsiLdEnabled) return collection;\n\n  return {\n    ...collection,\n    // Keep existing hooks v\u00e0 add ours\n    hooks: {\n      ...(collection.hooks || {}),\n      beforeChange: [\n        // our hook\n        async ({ data, originalDoc, req }) =&gt; {\n          const prefix = config.custom?.ngsiLdEntityIdPrefix as string;\n\n          if (!data.ngsiLd?.entityIdSuffix) {\n            return data; // nothing to do\n          }\n\n          data.ngsiLd.entityId = `${prefix}${data.ngsiLd.entityIdSuffix}`;\n\n          return data;\n        },\n        // keep any existing hooks\n        ...(collection.hooks?.beforeChange || []),\n      ],\n    },\n  };\n});\n</code></pre> <p>Example n\u00e0y:</p> <ul> <li>automatically computes m\u1ed9t full <code>ngsiLd.entityId</code> before saving,</li> <li>uses m\u1ed9t prefix t\u1eeb plugin options,</li> <li>keeps existing hooks intact.</li> </ul> <p>Use hooks carefully; avoid heavy external calls trong <code>beforeChange</code> n\u1ebfu kh\u00f4ng needed.</p>"},{"location":"vi/development/plugins/#7-configuration-and-options","title":"7. Configuration and options","text":"<p>Design plugin options \u0111\u1ec3 LegoCity (ho\u1eb7c any other project) c\u00f3 th\u1ec3 configure behaviour without editing plugin code. Good patterns:</p> <ul> <li>Booleans \u0111\u1ec3 toggle features (e.g. <code>enableHooks</code>)</li> <li>Lists c\u1ee7a collection slugs \u0111\u1ec3 include/exclude (<code>includeCollections</code>)</li> <li>Strings cho prefixes, base URLs, v.v.</li> </ul> <p>Example options type:</p> <pre><code>export type NgsiLdPluginOptions = {\n  entityIdPrefix?: string;\n  includeCollections?: string[]; // n\u1ebfu set, ch\u1ec9 apply plugin t\u1edbi these slugs\n};\n</code></pre> <p>Trong plugin, check <code>options.includeCollections</code> khi mapping collections v\u00e0 skip collections kh\u00f4ng listed.</p>"},{"location":"vi/development/plugins/#8-local-development-testing","title":"8. Local development &amp; testing","text":"<p>Khi working on m\u1ed9t plugin inside LegoCity:</p> <ol> <li>Start Payload dev server:</li> </ol> <pre><code># inside the Payload project\npnpm dev\n</code></pre> <ol> <li>Open Payload admin v\u00e0 navigate t\u1edbi m\u1ed9t collection uses plugin.</li> <li> <p>Create/edit documents v\u00e0 verify:</p> </li> <li> <p>Plugin-injected fields appear nh\u01b0 expected</p> </li> <li>Hooks run correctly (IDs ho\u1eb7c metadata are filled in)</li> <li>No TypeScript ho\u1eb7c console errors</li> </ol> <p>N\u1ebfu b\u1ea1n later extract plugin v\u00e0o m\u1ed9t separate package, create m\u1ed9t small test project installs n\u00f3 v\u00e0 verify plugin works outside LegoCity.</p>"},{"location":"vi/development/plugins/#9-packaging-publishing-optional","title":"9. Packaging &amp; publishing (optional)","text":"<p>N\u1ebfu m\u1ed9t plugin l\u00e0 generic, consider publishing n\u00f3 t\u1edbi npm ho\u1eb7c Payload plugin directory. High-level checklist:</p> <ul> <li>Add m\u1ed9t <code>package.json</code> trong plugin folder v\u1edbi <code>name</code>, <code>version</code>, <code>main</code>/<code>exports</code>, v\u00e0 <code>peerDependencies</code> (include <code>payload</code>).</li> <li>Add m\u1ed9t build step (compile TypeScript t\u1edbi <code>dist/</code> n\u1ebfu using TS).</li> <li>Create m\u1ed9t <code>README.md</code> documenting installation v\u00e0 options.</li> <li>Publish v\u1edbi <code>npm publish</code> (follow org policy), v\u00e0 optionally register trong Payload plugin directory.</li> </ul> <p>Cho LegoCity itself, publishing l\u00e0 optional; keep plugins well scoped v\u00e0 reusable.</p>"},{"location":"vi/development/plugins/#10-summary","title":"10. Summary","text":"<ul> <li>Plugins l\u00e0 functions nh\u1eadn <code>incomingConfig</code> v\u00e0 return m\u1ed9t modified <code>Config</code>.</li> <li>Use plugins cho shared behaviours, integrations, v\u00e0 optional features.</li> <li>Keep options explicit, test locally, v\u00e0 preserve existing config/hook behaviour.</li> </ul> <p>N\u1ebfu b\u1ea1n mu\u1ed1n, t\u00f4i c\u00f3 th\u1ec3:</p> <ul> <li>extract <code>ngsiLdPlugin</code> example v\u00e0o <code>payload/plugins/payload-ngsi-ld/index.ts</code>,</li> <li>add m\u1ed9t test harness ho\u1eb7c simple unit tests, ho\u1eb7c</li> <li>add m\u1ed9t <code>README.md</code> template cho new plugins.</li> </ul>"},{"location":"vi/development/seed-data/","title":"Seed Data v\u00e0 Example Scenarios","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch t\u1ea1o v\u00e0 s\u1eed d\u1ee5ng seed data trong LegoCity cho:</p> <ul> <li>Context broker (entities)</li> <li>PayloadCMS (views, blocks, layers)</li> <li>Demos v\u00e0 test cases c\u00f3 th\u1ec3 l\u1eb7p l\u1ea1i</li> </ul> <p>T\u1ea1i sao Seed Data?</p> <p>Seed data cho ph\u00e9p b\u1ea1n:</p> <pre><code>- \ud83d\ude80 Thi\u1ebft l\u1eadp m\u1ed9t m\u00f4i tr\u01b0\u1eddng smart city th\u1ef1c t\u1ebf nhanh ch\u00f3ng\n- \ud83e\uddea Test c\u00e1c features m\u1edbi v\u1edbi c\u00e1c scenarios \u0111\u00e3 bi\u1ebft\n- \ud83d\udcda Cung c\u1ea5p c\u00e1c v\u00ed d\u1ee5 s\u1eb5n c\u00f3 cho ng\u01b0\u1eddi d\u00f9ng m\u1edbi\n</code></pre>"},{"location":"vi/development/seed-data/#muc-tieu-cua-seed-data","title":"M\u1ee5c ti\u00eau c\u1ee7a Seed Data","text":"<p>Seed data n\u00ean:</p>"},{"location":"vi/development/seed-data/#representative","title":"Representative","text":"<ul> <li>\u2705 Cover c\u00e1c use cases smart city th\u1ef1c t\u1ebf (environment, water, mobility)</li> <li>\u2705 Include c\u00e1c entity types v\u00e0 scenarios \u0111a d\u1ea1ng</li> <li>\u2705 Demonstrate c\u00e1c features ch\u00ednh c\u1ee7a platform</li> </ul>"},{"location":"vi/development/seed-data/#safe","title":"Safe","text":"<ul> <li>\u2705 Kh\u00f4ng c\u00f3 d\u1eef li\u1ec7u c\u00e1 nh\u00e2n nh\u1ea1y c\u1ea3m ho\u1eb7c th\u1ef1c</li> <li>\u2705 Gi\u00e1 tr\u1ecb h\u01b0 c\u1ea5u nh\u01b0ng th\u1ef1c t\u1ebf</li> <li>\u2705 An to\u00e0n cho c\u00e1c demonstrations c\u00f4ng khai</li> </ul>"},{"location":"vi/development/seed-data/#repeatable","title":"Repeatable","text":"<ul> <li>\u2705 Reset v\u00e0 reseed m\u1ed9t environment d\u1ec5 d\u00e0ng</li> <li>\u2705 Identifiers \u1ed5n \u0111\u1ecbnh cho docs v\u00e0 tests</li> <li>\u2705 Nh\u1ea5t qu\u00e1n gi\u1eefa c\u00e1c environments</li> </ul> <p>H\u01b0\u1edbng \u0111\u1ebfn Ch\u1ea5t l\u01b0\u1ee3ng h\u01a1n S\u1ed1 l\u01b0\u1ee3ng</p> <p>\u0110\u1eebng model m\u1ed9t entire city\u2014cung c\u1ea5p:</p> <pre><code>- M\u1ed9t s\u1ed1 l\u01b0\u1ee3ng nh\u1ecf districts ho\u1eb7c areas\n- M\u1ed9t t\u1eadp h\u1ee3p gi\u1edbi h\u1ea1n sensors v\u00e0 assets\n- M\u1ed9t v\u00e0i PayloadCMS configurations \u0111\u01b0\u1ee3c ch\u1ecdn k\u1ef9\n</code></pre>"},{"location":"vi/development/seed-data/#cac-loai-seed-data","title":"C\u00e1c lo\u1ea1i Seed Data","text":"<p>LegoCity s\u1eed d\u1ee5ng ba categories ch\u00ednh c\u1ee7a seed data:</p>"},{"location":"vi/development/seed-data/#1-broker-entities","title":"1. Broker Entities","text":"NGSI-LD Entities <p>NGSI-LD entities \u0111\u1ea1i di\u1ec7n cho d\u1eef li\u1ec7u th\u00e0nh ph\u1ed1:</p> <pre><code>- `WeatherObserved` - Weather stations\n- `AirQualityObserved` - Air quality sensors\n- `ParkingSpot` - Parking facilities\n- `FloodRiskZone` - Flood risk areas\n- `TrafficFlowObserved` - Traffic sensors\n</code></pre> Entity Structure <p><code>json     {       \"id\": \"urn:ngsi-ld:WeatherObserved:demo:ctu-campus\",       \"type\": \"WeatherObserved\",       \"temperature\": {         \"type\": \"Property\",         \"value\": 28.5,         \"unitCode\": \"CEL\"       },       \"location\": {         \"type\": \"GeoProperty\",         \"value\": {           \"type\": \"Point\",           \"coordinates\": [105.7698, 10.0301]         }       }     }</code></p>"},{"location":"vi/development/seed-data/#2-payloadcms-configuration","title":"2. PayloadCMS Configuration","text":"<p>=== \"Collections\" - Layers - Data sources v\u00e0 styling - Views - Map dashboards v\u00e0 layouts - Blocks - UI components configuration - Users - Demo users v\u00e0 roles (n\u1ebfu c\u1ea7n)</p> Example Layer <p><code>json     {       \"name\": \"Weather Stations\",       \"slug\": \"weather-stations\",       \"entityType\": \"WeatherObserved\",       \"domain\": \"environment\",       \"mapboxLayerId\": \"weather-layer\",       \"visible\": true     }</code></p>"},{"location":"vi/development/seed-data/#3-supporting-reference-data","title":"3. Supporting Reference Data","text":"<ul> <li>\ud83d\udccd Lists c\u1ee7a districts ho\u1eb7c wards</li> <li>\ud83d\uddfa\ufe0f Simplified district geometry (polygons)</li> <li>\ud83d\udcca Static lookup tables (codes to names)</li> <li>\ud83d\udd17 Entity relationships v\u00e0 hierarchies</li> </ul>"},{"location":"vi/development/seed-data/#conceptual-approach","title":"Conceptual Approach","text":"<p>Broker seeds th\u01b0\u1eddng l\u00e0:</p> <ul> <li>JSON files m\u00f4 t\u1ea3 entities</li> <li>Scripts construct v\u00e0 push entities qua broker API</li> </ul>"},{"location":"vi/development/seed-data/#entity-id-patterns","title":"Entity ID Patterns","text":"<p>S\u1eed d\u1ee5ng stable, meaningful IDs:</p> <pre><code>urn:ngsi-ld:{EntityType}:demo:{location}\n</code></pre> <p>Examples:</p> Entity Type ID Example Weather <code>urn:ngsi-ld:WeatherObserved:demo:ctu-campus</code> Parking <code>urn:ngsi-ld:ParkingSpot:demo:downtown-p1</code> Flood Zone <code>urn:ngsi-ld:FloodRiskZone:demo:river-district</code>"},{"location":"vi/development/seed-data/#environment-domain","title":"Environment Domain","text":"Weather Stations <p>Create m\u1ed9t v\u00e0i <code>WeatherObserved</code> entities:</p> <pre><code>- At points of interest (university, city center, suburbs)\n- With temperature, humidity, precipitation\n- Different times of day ho\u1eb7c weather conditions\n</code></pre> Air Quality <p>Create <code>AirQualityObserved</code> entities:</p> <pre><code>- Near major roads ho\u1eb7c industrial areas\n- With PM2.5, PM10, NO2 measurements\n- Various quality levels (good, moderate, unhealthy)\n</code></pre>"},{"location":"vi/development/seed-data/#water-and-flooding-domain","title":"Water and Flooding Domain","text":"Flood Risk Zones <p>Create <code>FloodRiskZone</code> entities:</p> <pre><code>- Polygons representing vulnerable areas\n- Risk levels (low, medium, high)\n- Near rivers ho\u1eb7c low-lying areas\n</code></pre> Water Quality <p>Create <code>WaterQualityObserved</code> entities:</p> <pre><code>- At river monitoring points\n- pH, turbidity, dissolved oxygen\n- Upstream v\u00e0 downstream comparisons\n</code></pre>"},{"location":"vi/development/seed-data/#mobility-domain","title":"Mobility Domain","text":"Parking <p>Create <code>ParkingSpot</code> ho\u1eb7c <code>ParkingArea</code> entities:</p> <pre><code>- Small number c\u1ee7a parking areas (5-10)\n- Available vs total spot numbers\n- Different occupancy levels\n</code></pre> Traffic <p>Create <code>TrafficFlowObserved</code> entities:</p> <pre><code>- Major intersections\n- Vehicle count, average speed\n- Different time periods (rush hour, off-peak)\n</code></pre>"},{"location":"vi/development/seed-data/#running-broker-seed-scripts","title":"Running Broker Seed Scripts","text":"<p>Common patterns cho seeding:</p> Makefile Target <p><code>bash     make seed-broker</code></p> npm Script <p><code>bash     npm run seed:broker</code></p> Docker Container <p><code>bash     docker compose run --rm seed-broker</code></p>"},{"location":"vi/development/seed-data/#seed-script-workflow","title":"Seed Script Workflow","text":"<p>Typical seed script process:</p> <pre><code>graph LR\n    A[Read Entity Files] --&gt; B[Validate Format]\n    B --&gt; C[Connect to Gateway&lt;br/&gt;with Auth]\n    C --&gt; D[POST to Broker&lt;br/&gt;via Gateway]\n    D --&gt; E[Broker Stores&lt;br/&gt;in MongoDB]\n    E --&gt; F[Log Results]</code></pre> <p>Script responsibilities:</p> <ol> <li>Read entity definitions t\u1eeb <code>seeds/broker/</code> directory</li> <li>Validate NGSI-LD format</li> <li>Call broker endpoints \u0111\u1ec3 create/upsert entities</li> <li>Log successes v\u00e0 failures</li> <li>Handle errors gracefully</li> </ol>"},{"location":"vi/development/seed-data/#seeding-payloadcms","title":"Seeding PayloadCMS","text":"<p>PayloadCMS seed data covers configuration v\u00e0 content:</p>"},{"location":"vi/development/seed-data/#layer-definitions","title":"Layer Definitions","text":"<p>Purpose: Connect broker domains t\u1edbi map visualization</p> <p>Fields:</p> <ul> <li>Entity type v\u00e0 domain</li> <li>Map layer IDs v\u00e0 styling</li> <li>Colors, legends, icons</li> <li>Visibility defaults</li> </ul> <p>Example:</p> seeds/payload/layers.ts<pre><code>{\n  name: \"Weather Stations\",\n  slug: \"weather-stations\",\n  entityType: \"WeatherObserved\",\n  domain: \"environment\",\n  mapboxLayerId: \"weather-layer\",\n  style: {\n    circleColor: \"#FF6B35\",\n    circleRadius: 8\n  },\n  visible: true\n}\n</code></pre>"},{"location":"vi/development/seed-data/#views-and-layouts","title":"Views and Layouts","text":"<p>Purpose: Define high-level dashboards</p> <p>Fields:</p> <ul> <li>View name v\u00e0 slug</li> <li>Initial map bounds</li> <li>Layer references</li> <li>Block arrangements</li> </ul> <p>Example:</p> seeds/payload/views.ts<pre><code>{\n  name: \"City Overview\",\n  slug: \"city-overview\",\n  bounds: [105.7, 10.0, 105.8, 10.1],\n  layers: [\n    \"weather-stations\",\n    \"parking-areas\",\n    \"flood-zones\"\n  ],\n  sidebar: [\n    { type: \"layerToggle\", layers: [\"weather-stations\"] },\n    { type: \"kpiCard\", metric: \"parking:availability\" }\n  ]\n}\n</code></pre>"},{"location":"vi/development/seed-data/#seeding-approach","title":"Seeding Approach","text":"JSON Fixtures <p>Import qua PayloadCMS code:</p> <pre><code>```typescript\nimport { seed } from '@payloadcms/payload'\nimport layersData from './seeds/layers.json'\n\nawait seed('layers', layersData)\n```\n</code></pre> API Scripts <p>Call PayloadCMS REST API:</p> <pre><code>```typescript\nconst response = await fetch('/api/layers', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify(layerData)\n})\n```\n</code></pre> Database Direct <p>Insert directly t\u1edbi database (development only):</p> <pre><code>```typescript\nawait db.collection('layers').insertMany(layersData)\n```\n</code></pre>"},{"location":"vi/development/seed-data/#coordinating-broker-and-payloadcms-seeds","title":"Coordinating Broker and PayloadCMS Seeds","text":"<p>\u0110\u1ec3 \u0111\u1ea3m b\u1ea3o seeds ho\u1ea1t \u0111\u1ed9ng c\u00f9ng nhau:</p>"},{"location":"vi/development/seed-data/#broker-entity-requirements","title":"Broker Entity Requirements","text":"<p>!!! warning \"Critical Alignment\" - \u2705 Use entity types m\u00e0 PayloadCMS expects - \u2705 Use stable, documented IDs - \u2705 Place entities within map bounds c\u1ee7a seeded views - \u2705 Use attribute names matching layer configurations</p>"},{"location":"vi/development/seed-data/#payloadcms-configuration-requirements","title":"PayloadCMS Configuration Requirements","text":"<p>!!! warning \"Critical Alignment\" - \u2705 Refer t\u1edbi correct entity types v\u00e0 domains - \u2705 Use correct Mapbox layer IDs (n\u1ebfu applicable) - \u2705 Define bounding boxes bao g\u1ed3m seeded entities - \u2705 Match attribute names trong filters v\u00e0 displays</p>"},{"location":"vi/development/seed-data/#demo-city-profile","title":"Demo City Profile","text":"<p>Good practice: Maintain m\u1ed9t documented \"demo city profile\"</p> seeds/demo-profile.yml<pre><code>name: \"Demo Smart City\"\nlocation: \"Fictional City, Based on Can Tho\"\ncoordinates:\n  center: [105.7698, 10.0301]\n  bounds: [[105.75, 10.02], [105.79, 10.04]]\n\ndistricts:\n  - id: \"ninh-kieu\"\n    name: \"Ninh Kieu District\"\n    geometry: \"polygon...\"\n  - id: \"cai-rang\"\n    name: \"Cai Rang District\"\n    geometry: \"polygon...\"\n\nreference_points:\n  - name: \"CTU Campus\"\n    coordinates: [105.7698, 10.0301]\n  - name: \"City Center\"\n    coordinates: [105.7800, 10.0350]\n\nentities:\n  weather:\n    - id: \"weather:ctu-campus\"\n      location: \"CTU Campus\"\n      purpose: \"Demonstrate temperature visualization\"\n  parking:\n    - id: \"parking:downtown-p1\"\n      location: \"City Center\"\n      purpose: \"Show real-time availability\"\n</code></pre>"},{"location":"vi/development/seed-data/#single-command-seeding","title":"Single Command Seeding","text":"<p>Provide m\u1ed9t convenient command \u0111\u1ec3 seed everything:</p> Makefile <p><code>bash     make seed-all</code></p> <pre><code>Internally runs:\n```makefile\nseed-all: clean-data seed-broker seed-payload\n    @echo \"All seeds complete!\"\n```\n</code></pre> npm Scripts <p><code>bash     npm run seed</code></p> <pre><code>In `package.json`:\n```json\n{\n  \"scripts\": {\n    \"seed\": \"npm run seed:clean &amp;&amp; npm run seed:broker &amp;&amp; npm run seed:payload\",\n    \"seed:clean\": \"node scripts/clean-data.js\",\n    \"seed:broker\": \"node scripts/seed-broker.js\",\n    \"seed:payload\": \"node scripts/seed-payload.js\"\n  }\n}\n```\n</code></pre> Docker Compose <p><code>bash     docker compose run --rm seed</code></p> <pre><code>In `docker-compose.yml`:\n```yaml\nservices:\n  seed:\n    image: legocity-seed\n    depends_on:\n      - broker\n      - mongodb\n    command: [\"sh\", \"-c\", \"npm run seed:all\"]\n```\n</code></pre>"},{"location":"vi/development/seed-data/#best-practices","title":"Best Practices","text":"Keep It Small <p>!!! success \"Focus on Quality\" - Only seed entities needed \u0111\u1ec3 demonstrate functionality - Avoid large datasets kh\u00f3 hi\u1ec3u - 5-10 entities per type th\u01b0\u1eddng \u0111\u1ee7 - Quality examples &gt; Quantity</p> Version Control <p>!!! success \"Treat as Code\" - Store seeds trong version control - Review changes qua pull requests - Use meaningful commit messages - Tag seeds v\u1edbi version numbers</p> Documentation <p>!!! success \"Keep Docs Updated\" - Document new entity types - Mention new example views - Update scenario descriptions - Link seeds t\u1edbi use cases</p> Versioning <p>!!! success \"Align with Releases\" - Tag seed sets v\u1edbi release versions - Maintain compatibility v\u1edbi docs - Provide migration guides cho seed changes - Archive old seed versions</p>"},{"location":"vi/development/seed-data/#scenario-1-flooding-risk-during-heavy-rainfall","title":"Scenario 1: Flooding Risk During Heavy Rainfall","text":"Description <p>Question: \"How does flooding risk evolve during heavy rainfall?\"</p> <pre><code>**Data needed:**\n- Environment: Weather stations v\u1edbi precipitation data\n- Water: Flood risk zones v\u1edbi varying risk levels\n- Maps: Overlays showing risk zones v\u00e0 rainfall intensity\n</code></pre> Entities <p>```json // WeatherObserved with heavy rain { \"id\": \"urn:ngsi-ld:WeatherObserved:demo:riverside\", \"type\": \"WeatherObserved\", \"precipitation\": { \"value\": 50, \"unitCode\": \"MMT\" }, \"location\": { \"coordinates\": [105.77, 10.03] } }</p> <pre><code>// FloodRiskZone - high risk\n{\n  \"id\": \"urn:ngsi-ld:FloodRiskZone:demo:riverside-district\",\n  \"type\": \"FloodRiskZone\",\n  \"riskLevel\": { \"value\": \"high\" },\n  \"location\": { \"type\": \"Polygon\", \"coordinates\": [...] }\n}\n```\n</code></pre> PayloadCMS View <p><code>typescript     {       name: \"Flood Monitoring\",       slug: \"flood-monitoring\",       layers: [         \"weather-stations\",         \"flood-risk-zones\",         \"rainfall-intensity\"       ],       blocks: [         { type: \"legend\", layers: [\"flood-risk-zones\"] },         { type: \"kpiCard\", metric: \"rainfall:current\" }       ]     }</code></p>"},{"location":"vi/development/seed-data/#scenario-2-parking-availability-at-peak-hours","title":"Scenario 2: Parking Availability at Peak Hours","text":"Description <p>Question: \"Which parking areas are near capacity at peak hours?\"</p> <pre><code>**Data needed:**\n- Mobility: Parking areas v\u1edbi occupancy data\n- UI: KPI blocks v\u00e0 visual indicators\n- Maps: Color-coded parking availability\n</code></pre> Entities <p>```json // High occupancy parking { \"id\": \"urn:ngsi-ld:ParkingSpot:demo:downtown-p1\", \"type\": \"ParkingSpot\", \"availableSpotNumber\": { \"value\": 5 }, \"totalSpotNumber\": { \"value\": 100 }, \"location\": { \"coordinates\": [105.78, 10.035] } }</p> <pre><code>// Low occupancy parking\n{\n  \"id\": \"urn:ngsi-ld:ParkingSpot:demo:suburb-p3\",\n  \"type\": \"ParkingSpot\",\n  \"availableSpotNumber\": { \"value\": 85 },\n  \"totalSpotNumber\": { \"value\": 100 },\n  \"location\": { \"coordinates\": [105.76, 10.025] }\n}\n```\n</code></pre> PayloadCMS View <p><code>typescript     {       name: \"Parking Management\",       slug: \"parking-management\",       layers: [\"parking-areas\"],       blocks: [         {           type: \"kpiCard\",           title: \"Available Spots\",           metric: \"parking:total-available\"         },         {           type: \"chart\",           title: \"Occupancy by Hour\",           metric: \"parking:occupancy-rate\"         }       ]     }</code></p>"},{"location":"vi/development/seed-data/#scenario-3-air-quality-near-major-roads","title":"Scenario 3: Air Quality Near Major Roads","text":"Description <p>Question: \"What is the air quality near major roads?\"</p> <pre><code>**Data needed:**\n- Environment: Air quality sensors v\u1edbi PM2.5, NO2\n- Reference: Road network overlay\n- UI: Color-coded quality indicators\n</code></pre> Entities <p>```json // Poor air quality near highway { \"id\": \"urn:ngsi-ld:AirQualityObserved:demo:highway-junction\", \"type\": \"AirQualityObserved\", \"pm25\": { \"value\": 75, \"unitCode\": \"GQ\" }, \"no2\": { \"value\": 120, \"unitCode\": \"GQ\" }, \"airQualityLevel\": { \"value\": \"unhealthy\" }, \"location\": { \"coordinates\": [105.78, 10.04] } }</p> <pre><code>// Good air quality in park\n{\n  \"id\": \"urn:ngsi-ld:AirQualityObserved:demo:city-park\",\n  \"type\": \"AirQualityObserved\",\n  \"pm25\": { \"value\": 15, \"unitCode\": \"GQ\" },\n  \"no2\": { \"value\": 30, \"unitCode\": \"GQ\" },\n  \"airQualityLevel\": { \"value\": \"good\" },\n  \"location\": { \"coordinates\": [105.76, 10.03] }\n}\n```\n</code></pre> PayloadCMS View <p><code>typescript     {       name: \"Air Quality Dashboard\",       slug: \"air-quality\",       layers: [         \"air-quality-sensors\",         \"road-network\"       ],       blocks: [         { type: \"legend\", layers: [\"air-quality-sensors\"] },         {           type: \"kpiCard\",           title: \"Average PM2.5\",           metric: \"airquality:pm25-avg\"         }       ]     }</code></p>"},{"location":"vi/development/seed-data/#seed-data-checklist","title":"Seed Data Checklist","text":"<p>Before Committing Seeds</p> <p>Validation:</p> <pre><code>- [ ] All entity IDs follow naming convention\n- [ ] Coordinates are within demo city bounds\n- [ ] Entity types match PayloadCMS layer configs\n- [ ] Attribute names are consistent\n- [ ] No sensitive ho\u1eb7c personal data included\n\n**Testing:**\n\n- [ ] Seeds run without errors\n- [ ] All entities visible on map\n- [ ] PayloadCMS views load correctly\n- [ ] Blocks display expected data\n- [ ] Scenarios are demonstrable\n\n**Documentation:**\n\n- [ ] Seed scenarios documented\n- [ ] Entity IDs listed trong reference\n- [ ] Demo profile updated\n- [ ] README.md includes seed instructions\n</code></pre>"},{"location":"vi/development/seed-data/#summary","title":"Summary","text":"<p>Key Takeaways</p> <p>Seed data enables rapid environment setup v\u00e0 testing</p> <pre><code>**Three categories:**\n\n1. **Broker entities** - NGSI-LD entities v\u1edbi stable IDs\n2. **PayloadCMS config** - Layers, views, blocks\n3. **Reference data** - Districts, geometry, lookups\n\n**Best practices:**\n\n- Keep seeds small, realistic, v\u00e0 scenario-based\n- Provide single-command seeding (`make seed-all`)\n- Maintain seeds trong version control\n- Document seed scenarios v\u00e0 use cases\n- Align broker entities v\u1edbi PayloadCMS configuration\n</code></pre> <p>Related Pages:</p> <ul> <li>Creating New Blocks</li> <li>Entity Types and Management</li> <li>Local Development Setup</li> </ul>"},{"location":"vi/getting-started/","title":"B\u1eaft \u0111\u1ea7u v\u1edbi LegoCity","text":"<p>Ch\u00e0o m\u1eebng b\u1ea1n \u0111\u1ebfn v\u1edbi LegoCity! H\u01b0\u1edbng d\u1eabn n\u00e0y s\u1ebd gi\u00fap b\u1ea1n b\u1eaft \u0111\u1ea7u nhanh ch\u00f3ng.</p>"},{"location":"vi/getting-started/#legocity-la-gi","title":"LegoCity l\u00e0 g\u00ec?","text":"<p>LegoCity l\u00e0 m\u1ed9t Smart City Builder cung c\u1ea5p m\u1ed9t n\u1ec1n t\u1ea3ng c\u00f3 th\u1ec3 t\u00e1i s\u1eed d\u1ee5ng \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c dashboard v\u00e0 applications th\u00e0nh ph\u1ed1 tr\u00ean FIWARE / NGSI-LD v\u00e0 c\u00e1c c\u00f4ng ngh\u1ec7 web hi\u1ec7n \u0111\u1ea1i.</p>"},{"location":"vi/getting-started/#tinh-nang-chinh","title":"T\u00ednh n\u0103ng Ch\u00ednh","text":"<ul> <li>\ud83c\udfd9\ufe0f Smart City Ready - X\u00e2y d\u1ef1ng tr\u00ean c\u00e1c chu\u1ea9n FIWARE/NGSI-LD</li> <li>\ud83d\uddfa\ufe0f Interactive Maps - \u0110\u01b0\u1ee3c h\u1ed7 tr\u1ee3 b\u1edfi Mapbox GL JS</li> <li>\ud83d\udcca Flexible Dashboard - Configure v\u1edbi PayloadCMS</li> <li>\ud83d\udd0c Extensible - Ki\u1ebfn tr\u00fac plugin cho c\u00e1c t\u00ednh n\u0103ng t\u00f9y ch\u1ec9nh</li> <li>\ud83e\udd16 AI-Powered - H\u1ed7 tr\u1ee3 AI t\u00f9y ch\u1ecdn cho vi\u1ec7c t\u1ea1o content</li> <li>\ud83c\udf0d Multi-tenant - C\u00f3 th\u1ec3 t\u00e1i s\u1eed d\u1ee5ng tr\u00ean c\u00e1c th\u00e0nh ph\u1ed1 kh\u00e1c nhau</li> </ul>"},{"location":"vi/getting-started/#core-components","title":"Core Components","text":"<p>Ki\u1ebfn tr\u00fac 3 l\u1edbp c\u1ee7a LegoCity: Data Sources, Smart City Context Broker, v\u00e0 Dashboard Management</p>"},{"location":"vi/getting-started/#quick-start","title":"Quick Start","text":""},{"location":"vi/getting-started/#prerequisites","title":"Prerequisites","text":"<p>Tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u, \u0111\u1ea3m b\u1ea3o b\u1ea1n c\u00f3:</p> <ul> <li>Node.js 18.x ho\u1eb7c m\u1edbi h\u01a1n</li> <li>pnpm 8.x ho\u1eb7c m\u1edbi h\u01a1n (package manager)</li> <li>MongoDB 6.x ho\u1eb7c m\u1edbi h\u01a1n</li> <li>Git cho version control</li> </ul>"},{"location":"vi/getting-started/#installation-steps","title":"Installation Steps","text":"<ol> <li>Clone the repository</li> </ol> <pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity/dashboard\n</code></pre> <ol> <li>Install dependencies</li> </ol> <pre><code>pnpm install\n</code></pre> <ol> <li>Configure environment</li> </ol> <pre><code>cp .env.example .env\n</code></pre> <p>Edit <code>.env</code> v\u00e0 set:</p> <pre><code>DATABASE_URI=mongodb://127.0.0.1/legocity\nPAYLOAD_SECRET=your-secret-key-here\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n</code></pre> <ol> <li>Start development server</li> </ol> <pre><code>pnpm dev\n</code></pre> <ol> <li>Access the dashboard</li> <li>Dashboard: http://localhost:3000</li> <li>Admin Panel: http://localhost:3000/admin</li> </ol>"},{"location":"vi/getting-started/#next-steps","title":"Next Steps","text":"<p>Sau khi ho\u00e0n th\u00e0nh quick start:</p> <ol> <li>Complete Installation Guide - H\u01b0\u1edbng d\u1eabn setup chi ti\u1ebft</li> <li>User Guide - H\u1ecdc c\u00e1ch s\u1eed d\u1ee5ng LegoCity</li> <li>Configuration - Configure data sources v\u00e0 APIs</li> <li>Development Guide - B\u1eaft \u0111\u1ea7u x\u00e2y d\u1ef1ng c\u00e1c t\u00ednh n\u0103ng t\u00f9y ch\u1ec9nh</li> </ol>"},{"location":"vi/getting-started/#architecture-overview","title":"Architecture Overview","text":"<p>LegoCity \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng tr\u00ean ba l\u1edbp ch\u00ednh:</p>"},{"location":"vi/getting-started/#3-integration-layer","title":"3. Integration Layer","text":"<ul> <li>API proxies v\u00e0 security</li> <li>AI assistants (optional)</li> <li>External services</li> </ul>"},{"location":"vi/getting-started/#context-centric-design","title":"Context-Centric Design","text":"<p>Th\u00f4ng tin th\u00e0nh ph\u1ed1 \u0111\u01b0\u1ee3c model nh\u01b0 c\u00e1c NGSI-LD entities trong context brokers - ngu\u1ed3n s\u1ef1 th\u1eadt duy nh\u1ea5t.</p>"},{"location":"vi/getting-started/#configuration-driven-ui","title":"Configuration-Driven UI","text":"<p>Dashboards \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng t\u1eeb c\u00e1c configurable blocks trong PayloadCMS, kh\u00f4ng ph\u1ea3i hard-coded.</p>"},{"location":"vi/getting-started/#reusability","title":"Reusability","text":"<p>C\u00f9ng m\u1ed9t codebase ho\u1ea1t \u0111\u1ed9ng tr\u00ean nhi\u1ec1u th\u00e0nh ph\u1ed1 b\u1eb1ng c\u00e1ch thay \u0111\u1ed5i configuration, kh\u00f4ng ph\u1ea3i code.</p>"},{"location":"vi/getting-started/#ai-as-optional","title":"AI as Optional","text":"<p>LegoCity ho\u1ea1t \u0111\u1ed9ng ho\u00e0n to\u00e0n kh\u00f4ng c\u1ea7n AI. AI integration l\u00e0 m\u1ed9t t\u00ednh n\u0103ng ph\u1ee5 cho vi\u1ec7c authoring content.</p> <p>S\u1eb5n s\u00e0ng t\u00ecm hi\u1ec3u s\u00e2u h\u01a1n? Ti\u1ebfp t\u1ee5c \u0111\u1ebfn Installation Guide cho h\u01b0\u1edbng d\u1eabn setup chi ti\u1ebft.</p>"},{"location":"vi/getting-started/architecture/","title":"T\u1ed5ng quan Ki\u1ebfn tr\u00fac","text":"<p>Hi\u1ec3u ki\u1ebfn tr\u00fac c\u1ee7a LegoCity gi\u00fap b\u1ea1n \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh s\u00e1ng su\u1ed1t v\u1ec1 customization v\u00e0 deployment.</p>"},{"location":"vi/getting-started/architecture/#kien-truc-he-thong","title":"Ki\u1ebfn tr\u00fac H\u1ec7 th\u1ed1ng","text":"<p>Ki\u1ebfn tr\u00fac 3 l\u1edbp: Ngu\u1ed3n D\u1eef li\u1ec7u \u2192 Smart City Context Broker \u2192 Dashboard &amp; Qu\u1ea3n l\u00fd</p>"},{"location":"vi/getting-started/architecture/#thiet-ke-ba-lop","title":"Thi\u1ebft k\u1ebf Ba L\u1edbp","text":""},{"location":"vi/getting-started/architecture/#1-context-data-layer","title":"1. Context &amp; Data Layer","text":"<p>M\u1ee5c \u0111\u00edch: Ngu\u1ed3n s\u1ef1 th\u1eadt duy nh\u1ea5t cho th\u00f4ng tin th\u00e0nh ph\u1ed1</p> <p>Components:</p> <ul> <li>NGSI-LD Context Broker (Orion-LD)</li> <li>Smart Data Models - Schemas chu\u1ea9n h\u00f3a</li> <li>Real-time Updates - Subscriptions v\u00e0 notifications</li> </ul> <p>Key Concepts:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Sensor:001\",\n  \"type\": \"AirQualitySensor\",\n  \"location\": {\n    \"type\": \"Point\",\n    \"coordinates\": [105.7851, 10.0303]\n  },\n  \"pm25\": {\n    \"type\": \"Property\",\n    \"value\": 35.2,\n    \"observedAt\": \"2024-01-15T10:30:00Z\"\n  }\n}\n</code></pre> <p>Responsibilities:</p> <ul> <li>Store city entities (sensors, zones, services)</li> <li>Manage relationships gi\u1eefa c\u00e1c entities</li> <li>Handle temporal queries</li> <li>Provide standardized API (NGSI-LD)</li> </ul>"},{"location":"vi/getting-started/architecture/#2-ui-content-layer","title":"2. UI &amp; Content Layer","text":"<p>M\u1ee5c \u0111\u00edch: Configure v\u00e0 render dashboard interfaces</p> <p>Components:</p> <ul> <li>Next.js 15 - React framework v\u1edbi App Router</li> <li>PayloadCMS 3.x - Headless CMS</li> <li>MongoDB - Content database</li> <li>Mapbox GL JS - Interactive maps</li> </ul> <p>Key Features:</p> <p>a) Block-Based UI</p> <pre><code>// Pages composed from blocks\ninterface Page {\n  title: string;\n  blocks: Array&lt;ArchiveBlock | MediaBlock | CallToActionBlock | ContentBlock&gt;;\n}\n</code></pre> <p>b) Dynamic Configuration</p> <ul> <li>Pages, map views, layers stored trong PayloadCMS</li> <li>No hard-coded dashboards</li> <li>Runtime configuration changes</li> </ul> <p>c) Responsive Design</p> <ul> <li>Mobile-first approach</li> <li>Tailwind CSS styling</li> <li>Accessible components</li> </ul>"},{"location":"vi/getting-started/architecture/#3-integration-layer","title":"3. Integration Layer","text":"<p>M\u1ee5c \u0111\u00edch: Connect external services v\u00e0 enhance functionality</p> <p>Components:</p> <ul> <li>API Proxies - Secure external API access</li> <li>Authentication - JWT-based auth</li> <li>AI Assistants - Optional content helpers</li> <li>Search - Full-text search integration</li> </ul> <p>Security Patterns:</p> <pre><code>// API keys stored server-side\n// Frontend proxies requests\nfetch(\"/api/proxy/geocode\", {\n  body: JSON.stringify({ address }),\n  headers: { \"Content-Type\": \"application/json\" },\n});\n</code></pre>"},{"location":"vi/getting-started/architecture/#ay-du-lieu-tu-nguon-iot","title":"\u0110\u1ea9y D\u1eef li\u1ec7u t\u1eeb Ngu\u1ed3n IoT","text":"<pre><code>sequenceDiagram\n    participant Source as Source Server&lt;br/&gt;(IoT/Sensor/Camera)\n    participant Gateway as Security Gateway&lt;br/&gt;(Nginx)\n    participant Broker as Orion-LD&lt;br/&gt;(Context Broker)\n    participant MongoDB\n    participant OtherNodes as C\u00e1c Broker Node kh\u00e1c\n\n    Source-&gt;&gt;Gateway: HTTP POST&lt;br/&gt;(NGSI-LD Payload)&lt;br/&gt;Push Data + Auth Header\n    Gateway-&gt;&gt;Gateway: X\u00e1c th\u1ef1c Auth Header\n    Gateway-&gt;&gt;Broker: Chuy\u1ec3n ti\u1ebfp d\u1eef li\u1ec7u entity\n    Broker-&gt;&gt;MongoDB: L\u01b0u/C\u1eadp nh\u1eadt entity\n    MongoDB--&gt;&gt;Broker: X\u00e1c nh\u1eadn\n    Broker-&gt;&gt;OtherNodes: Sao ch\u00e9p state (t\u00f9y ch\u1ecdn)\n    Broker--&gt;&gt;Gateway: 201 Created / 204 Updated\n    Gateway--&gt;&gt;Source: Ph\u1ea3n h\u1ed3i th\u00e0nh c\u00f4ng</code></pre>"},{"location":"vi/getting-started/architecture/#reading-city-data","title":"Reading City Data","text":"<pre><code>sequenceDiagram\n    participant User as Ng\u01b0\u1eddi d\u00f9ng\n    participant AppServer as Application Server&lt;br/&gt;(NextJS + PayloadCMS)\n    participant Gateway as Security Gateway&lt;br/&gt;(Nginx)\n    participant Broker as Orion-LD&lt;br/&gt;(Context Broker)\n    participant MongoDB\n\n    User-&gt;&gt;AppServer: T\u1ea3i trang dashboard\n    AppServer-&gt;&gt;AppServer: L\u1ea5y config t\u1eeb PayloadCMS\n    AppServer-&gt;&gt;Gateway: HTTP GET/SUB&lt;br/&gt;(NGSI-LD Query)&lt;br/&gt;+ Auth Header\n    Gateway-&gt;&gt;Gateway: X\u00e1c th\u1ef1c JWT\n    Gateway-&gt;&gt;Broker: Chuy\u1ec3n ti\u1ebfp query\n    Broker-&gt;&gt;MongoDB: L\u1ea5y d\u1eef li\u1ec7u entity\n    MongoDB--&gt;&gt;Broker: Tr\u1ea3 v\u1ec1 entities\n    Broker--&gt;&gt;Gateway: NGSI-LD Response\n    Gateway--&gt;&gt;AppServer: Tr\u1ea3 v\u1ec1 d\u1eef li\u1ec7u sensor\n    AppServer-&gt;&gt;AppServer: NextJS render v\u1edbi d\u1eef li\u1ec7u\n    AppServer--&gt;&gt;User: Hi\u1ec3n th\u1ecb dashboard</code></pre>"},{"location":"vi/getting-started/architecture/#updating-content","title":"Updating Content","text":"<pre><code>sequenceDiagram\n    participant Admin as Qu\u1ea3n tr\u1ecb vi\u00ean\n    participant AppServer as Application Server&lt;br/&gt;(PayloadCMS)\n    participant DashDB as Dashboard Database&lt;br/&gt;(MongoDB/Postgres/SQLite)\n    participant NextJS\n\n    Admin-&gt;&gt;AppServer: Ch\u1ec9nh s\u1eeda page/block qua Admin UI\n    AppServer-&gt;&gt;DashDB: CRUD Data&lt;br/&gt;(L\u01b0u thay \u0111\u1ed5i)\n    DashDB--&gt;&gt;AppServer: X\u00e1c nh\u1eadn l\u01b0u\n    AppServer-&gt;&gt;NextJS: K\u00edch ho\u1ea1t revalidation\n    NextJS-&gt;&gt;NextJS: Rebuild pages (ISR)\n    NextJS--&gt;&gt;Admin: Trang \u0111\u00e3 c\u1eadp nh\u1eadt</code></pre>"},{"location":"vi/getting-started/architecture/#frontend","title":"Frontend","text":"<ul> <li>Next.js 15 - React framework v\u1edbi App Router v\u00e0 Server Components</li> <li>TypeScript - Type safety</li> <li>Tailwind CSS - Utility-first styling</li> <li>Mapbox GL JS - WebGL-powered maps</li> </ul>"},{"location":"vi/getting-started/architecture/#backend","title":"Backend","text":"<ul> <li>PayloadCMS 3.x - Headless CMS v\u1edbi admin UI</li> <li>MongoDB 6.x - Document database</li> <li>Node.js 18+ - JavaScript runtime</li> </ul>"},{"location":"vi/getting-started/architecture/#infrastructure","title":"Infrastructure","text":"<ul> <li>FIWARE Orion-LD - NGSI-LD context broker</li> <li>MongoDB - Context v\u00e0 content storage</li> <li>Reverse Proxy - Nginx ho\u1eb7c similar</li> </ul>"},{"location":"vi/getting-started/architecture/#optional-services","title":"Optional Services","text":"<ul> <li>OpenRouter - AI model gateway</li> <li>Mapbox - Map tiles v\u00e0 geocoding</li> <li>Redis - Caching layer</li> </ul>"},{"location":"vi/getting-started/architecture/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>Next.js Application:</p> <ul> <li>Stateless application servers</li> <li>Load balancer distribution</li> <li>Edge caching (CDN)</li> </ul> <p>MongoDB:</p> <ul> <li>Replica sets cho high availability</li> <li>Sharding cho large datasets</li> </ul> <p>NGSI-LD Broker:</p> <ul> <li>Multiple broker instances</li> <li>Federation cho multi-region</li> </ul>"},{"location":"vi/getting-started/architecture/#vertical-scaling","title":"Vertical Scaling","text":"<p>Memory:</p> <ul> <li>Next.js: 2-4 GB per instance</li> <li>MongoDB: Based on dataset size</li> <li>Broker: Based on entity count</li> </ul> <p>CPU:</p> <ul> <li>Map rendering is CPU-intensive</li> <li>Consider GPU acceleration cho complex visualizations</li> </ul>"},{"location":"vi/getting-started/architecture/#authentication-authorization","title":"Authentication &amp; Authorization","text":"<pre><code>flowchart LR\n    subgraph Layer1[\"LAYER 1: NGU\u1ed2N D\u1eee LI\u1ec6U\"]\n        IoT[Thi\u1ebft b\u1ecb IoT]\n    end\n\n    subgraph Layer2[\"LAYER 2: BROKER\"]\n        Gateway[Security Gateway&lt;br/&gt;Nginx + Auth]\n        Broker[Orion-LD]\n    end\n\n    subgraph Layer3[\"LAYER 3: DASHBOARD\"]\n        Auth[PayloadCMS Auth]\n        MW[Next.js Middleware]\n        Routes[Protected Routes]\n        Admin[Admin Panel]\n    end\n\n    IoT --&gt;|Auth Header| Gateway\n    Gateway --&gt;|X\u00e1c th\u1ef1c| Broker\n\n    Auth --&gt;|JWT| MW\n    MW --&gt;|Verify| Routes\n    MW --&gt;|Ki\u1ec3m tra Role| Admin\n    MW --&gt;|API Call + JWT| Gateway</code></pre>"},{"location":"vi/getting-started/architecture/#configuration-management","title":"Configuration Management","text":"<p>\u2705 Store config trong PayloadCMS, not code \u2705 Use environment variables cho secrets \u2705 Version control schema definitions</p>"},{"location":"vi/getting-started/architecture/#security","title":"Security","text":"<p>\u2705 Never expose API keys t\u1edbi frontend \u2705 Validate all user inputs \u2705 Implement rate limiting \u2705 Use HTTPS trong production</p>"},{"location":"vi/getting-started/architecture/#monitoring","title":"Monitoring","text":"<p>\u2705 Log errors t\u1edbi external service \u2705 Track performance metrics \u2705 Monitor broker health \u2705 Set up alerts</p> <p>Next: Installation Guide \u0111\u1ec3 thi\u1ebft l\u1eadp development environment c\u1ee7a b\u1ea1n.</p>"},{"location":"vi/getting-started/quickstart/","title":"H\u01b0\u1edbng d\u1eabn kh\u1edfi \u0111\u1ed9ng nhanh","text":"<p>Ch\u1ea1y LegoCity trong 5 ph\u00fat.</p>"},{"location":"vi/getting-started/quickstart/#1-kiem-tra-yeu-cau","title":"1. Ki\u1ec3m tra y\u00eau c\u1ea7u","text":"<p>X\u00e1c minh b\u1ea1n c\u00f3 c\u00e1c c\u00f4ng c\u1ee5 c\u1ea7n thi\u1ebft:</p> <pre><code># Ki\u1ec3m tra phi\u00ean b\u1ea3n Node.js (c\u1ea7n 18+)\nnode --version\n\n# Ki\u1ec3m tra pnpm (c\u00e0i n\u1ebfu ch\u01b0a c\u00f3)\npnpm --version\n\n# N\u1ebfu ch\u01b0a c\u00e0i pnpm:\nnpm install -g pnpm\n\n# Ki\u1ec3m tra MongoDB \u0111ang ch\u1ea1y\nmongosh --eval \"db.version()\"\n</code></pre>"},{"location":"vi/getting-started/quickstart/#2-clone-cai-at","title":"2. Clone &amp; C\u00e0i \u0111\u1eb7t","text":"<pre><code># Clone kho l\u01b0u tr\u1eef\ngit clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity/dashboard\n\n# C\u00e0i c\u00e1c g\u00f3i ph\u1ee5 thu\u1ed9c\npnpm install\n</code></pre>"},{"location":"vi/getting-started/quickstart/#3-cau-hinh-moi-truong","title":"3. C\u1ea5u h\u00ecnh m\u00f4i tr\u01b0\u1eddng","text":"<p>T\u1ea1o file <code>.env</code>:</p> <pre><code>cp .env.example .env\n</code></pre> <p>C\u1ea5u h\u00ecnh t\u1ed1i thi\u1ec3u:</p> <pre><code># Database\nDATABASE_URI=mongodb://127.0.0.1/legocity\n\n# B\u1ea3o m\u1eadt\nPAYLOAD_SECRET=your-secret-key-min-32-chars\n\n# Server\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n</code></pre> <p>T\u1ea1o Secret Key</p> <p><code>bash     node -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"</code></p>"},{"location":"vi/getting-started/quickstart/#4-khoi-ong-server-phat-trien","title":"4. Kh\u1edfi \u0111\u1ed9ng Server Ph\u00e1t tri\u1ec3n","text":"<pre><code>pnpm dev\n</code></pre> <p>B\u1ea1n s\u1ebd th\u1ea5y:</p> <pre><code>\u2713 Ready in 3.2s\n\u25cb Local:   http://localhost:3000\n</code></pre>"},{"location":"vi/getting-started/quickstart/#5-truy-cap-bang-ieu-khien","title":"5. Truy c\u1eadp B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n","text":"<p>M\u1edf tr\u00ecnh duy\u1ec7t:</p> <ul> <li>Giao di\u1ec7n ng\u01b0\u1eddi d\u00f9ng: http://localhost:3000</li> <li>B\u1ea3ng qu\u1ea3n tr\u1ecb: http://localhost:3000/admin</li> </ul>"},{"location":"vi/getting-started/quickstart/#ang-nhap-lan-au","title":"\u0110\u0103ng nh\u1eadp l\u1ea7n \u0111\u1ea7u","text":"<p>T\u1ea1o t\u00e0i kho\u1ea3n admin \u0111\u1ea7u ti\u00ean khi truy c\u1eadp <code>/admin</code>:</p> <ul> <li>Email: admin@example.com</li> <li>Password: (ch\u1ecdn m\u1eadt kh\u1ea9u m\u1ea1nh)</li> </ul>"},{"location":"vi/getting-started/quickstart/#6-kham-pha-bang-ieu-khien","title":"6. Kh\u00e1m ph\u00e1 B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n","text":""},{"location":"vi/getting-started/quickstart/#cac-tinh-nang-chinh","title":"C\u00e1c t\u00ednh n\u0103ng ch\u00ednh","text":"<ul> <li>\ud83d\udcc4 Pages - T\u1ea1o v\u00e0 qu\u1ea3n l\u00fd trang</li> <li>\ud83d\udcdd Posts - Vi\u1ebft blog v\u00e0 b\u00e0i vi\u1ebft</li> <li>\ud83d\uddbc\ufe0f Media - T\u1ea3i l\u00ean v\u00e0 qu\u1ea3n l\u00fd \u1ea3nh, video</li> <li>\ud83d\udc65 Users - Qu\u1ea3n l\u00fd ng\u01b0\u1eddi d\u00f9ng</li> <li>\ud83d\uddfa\ufe0f Map View - Xem d\u1eef li\u1ec7u tr\u00ean b\u1ea3n \u0111\u1ed3</li> </ul>"},{"location":"vi/getting-started/quickstart/#tao-trang-au-tien","title":"T\u1ea1o trang \u0111\u1ea7u ti\u00ean","text":"<ol> <li>\u0110i \u0111\u1ebfn <code>/admin/collections/pages</code></li> <li>Click \"Create New\"</li> <li>\u0110i\u1ec1n ti\u00eau \u0111\u1ec1 v\u00e0 n\u1ed9i dung</li> <li>Publish!</li> </ol>"},{"location":"vi/getting-started/quickstart/#cac-buoc-tiep-theo","title":"C\u00e1c b\u01b0\u1edbc ti\u1ebfp theo","text":""},{"location":"vi/getting-started/quickstart/#tuy-chinh","title":"T\u00f9y ch\u1ec9nh","text":"<ul> <li>\ud83c\udfa8 T\u1ea1o Custom Blocks</li> <li>\ud83d\udd0c Vi\u1ebft Plugins</li> <li>\u2699\ufe0f C\u1ea5u h\u00ecnh n\u00e2ng cao</li> </ul>"},{"location":"vi/getting-started/quickstart/#tich-hop-du-lieu","title":"T\u00edch h\u1ee3p d\u1eef li\u1ec7u","text":"<ul> <li>\ud83d\udce1 K\u1ebft n\u1ed1i IoT Sensors</li> <li>\ud83d\udd17 L\u00e0m vi\u1ec7c v\u1edbi NGSI-LD</li> <li>\ud83d\uddfa\ufe0f C\u1ea5u h\u00ecnh Map Services</li> </ul>"},{"location":"vi/getting-started/quickstart/#trien-khai","title":"Tri\u1ec3n khai","text":"<ul> <li>\ud83d\udc33 S\u1eed d\u1ee5ng Docker</li> <li>\u2601\ufe0f Tri\u1ec3n khai l\u00ean AWS</li> <li>\ud83d\ude80 Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t cho m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t</li> </ul>"},{"location":"vi/getting-started/quickstart/#xu-ly-su-co","title":"X\u1eed l\u00fd s\u1ef1 c\u1ed1","text":""},{"location":"vi/getting-started/quickstart/#port-a-uoc-su-dung","title":"Port \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng","text":"<pre><code># Thay \u0111\u1ed5i port trong .env\nNEXT_PUBLIC_SERVER_URL=http://localhost:3001\n</code></pre> <p>Sau \u0111\u00f3 ch\u1ea1y:</p> <pre><code>PORT=3001 pnpm dev\n</code></pre>"},{"location":"vi/getting-started/quickstart/#mongodb-connection-error","title":"MongoDB connection error","text":"<p>Ki\u1ec3m tra MongoDB \u0111ang ch\u1ea1y:</p> <pre><code># Windows\nnet start MongoDB\n\n# macOS/Linux\nsudo systemctl start mongod\n</code></pre>"},{"location":"vi/getting-started/quickstart/#module-khong-tim-thay","title":"Module kh\u00f4ng t\u00ecm th\u1ea5y","text":"<p>X\u00f3a v\u00e0 c\u00e0i l\u1ea1i:</p> <pre><code>rm -rf node_modules\npnpm install\n</code></pre>"},{"location":"vi/getting-started/quickstart/#can-tro-giup","title":"C\u1ea7n tr\u1ee3 gi\u00fap?","text":"<ul> <li>\ud83d\udcda H\u01b0\u1edbng d\u1eabn kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1</li> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udc1b Report Issues</li> </ul>"},{"location":"vi/getting-started/quickstart/#hoc-them","title":"H\u1ecdc th\u00eam","text":"<ul> <li>\ud83c\udfd7\ufe0f Ki\u1ebfn tr\u00fac h\u1ec7 th\u1ed1ng</li> <li>\ud83d\udcd6 H\u01b0\u1edbng d\u1eabn \u0111\u1ea7y \u0111\u1ee7</li> <li>\ud83d\udc68\u200d\ud83d\udcbb H\u01b0\u1edbng d\u1eabn ph\u00e1t tri\u1ec3n</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/","title":"K\u1ebft n\u1ed1i Server Ri\u00eang c\u1ee7a B\u1ea1n","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y h\u01b0\u1edbng d\u1eabn b\u1ea1n k\u1ebft n\u1ed1i \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n v\u1edbi m\u1ed9t instance SematX hi\u1ec7n c\u00f3. B\u1ea1n s\u1ebd h\u1ecdc c\u00e1ch x\u00e1c th\u1ef1c, t\u1ea1o entities, \u0111\u1ea9y d\u1eef li\u1ec7u v\u00e0 x\u00e2y d\u1ef1ng visualizations tr\u00ean remote SematX server.</p> <p>\u23f1\ufe0f Th\u1eddi gian \u01b0\u1edbc t\u00ednh: 30-45 ph\u00fat \ud83d\udcbb Y\u00eau c\u1ea7u: SematX instance URL, th\u00f4ng tin \u0111\u0103ng nh\u1eadp API \ud83c\udfaf M\u1ee5c ti\u00eau: T\u00edch h\u1ee3p app c\u1ee7a b\u1ea1n v\u1edbi production SematX server</p>"},{"location":"vi/getting-started/bring-your-own-server/#nhung-gi-ban-se-hoc","title":"Nh\u1eefng g\u00ec B\u1ea1n s\u1ebd H\u1ecdc","text":"<p>Khi k\u1ebft th\u00fac h\u01b0\u1edbng d\u1eabn n\u00e0y, b\u1ea1n s\u1ebd c\u00f3 th\u1ec3: - T\u1ea1o t\u00e0i kho\u1ea3n SematX v\u00e0 l\u1ea5y th\u00f4ng tin \u0111\u0103ng nh\u1eadp API - Thi\u1ebft l\u1eadp c\u1ea5u h\u00ecnh service cho \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n - T\u1ea1o v\u00e0 qu\u1ea3n l\u00fd NGSI-LD entities - \u0110\u1ea9y d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c t\u1eeb \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n - X\u00e2y d\u1ef1ng dashboard cards \u0111\u1ec3 tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n - C\u1ea5u h\u00ecnh subscriptions cho th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c</p>"},{"location":"vi/getting-started/bring-your-own-server/#tong-quan-huong-dan","title":"T\u1ed5ng quan H\u01b0\u1edbng d\u1eabn","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y \u0111\u01b0\u1ee3c chia th\u00e0nh 6 b\u01b0\u1edbc:</p> <ol> <li>T\u1ea1o T\u00e0i kho\u1ea3n - \u0110\u0103ng k\u00fd v\u00e0 l\u1ea5y th\u00f4ng tin \u0111\u0103ng nh\u1eadp</li> <li>T\u1ea1o Service - Thi\u1ebft l\u1eadp service cho \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n</li> <li>T\u1ea1o Entity \u0110\u1ea7u ti\u00ean - \u0110\u1ecbnh ngh\u0129a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u</li> <li>\u0110\u1ea9y D\u1eef li\u1ec7u - G\u1eedi d\u1eef li\u1ec7u t\u1eeb \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n</li> <li>T\u1ea1o Dashboard Cards - Tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n</li> <li>Thi\u1ebft l\u1eadp Subscriptions - Nh\u1eadn th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c</li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/#ieu-kien-tien-quyet","title":"\u0110i\u1ec1u ki\u1ec7n Ti\u00ean quy\u1ebft","text":""},{"location":"vi/getting-started/bring-your-own-server/#yeu-cau","title":"Y\u00eau c\u1ea7u","text":"<ul> <li>SematX Instance URL: URL c\u01a1 s\u1edf c\u1ee7a SematX server</li> <li>V\u00ed d\u1ee5: <code>https://sematx.example.com</code></li> <li>Th\u00f4ng tin \u0110\u0103ng nh\u1eadp: Email v\u00e0 password cho t\u00e0i kho\u1ea3n SematX</li> <li>N\u1ebfu b\u1ea1n ch\u01b0a c\u00f3 t\u00e0i kho\u1ea3n, b\u1ea1n s\u1ebd c\u1ea7n l\u1eddi m\u1eddi t\u1eeb qu\u1ea3n tr\u1ecb vi\u00ean</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/#khuyen-nghi","title":"Khuy\u1ebfn ngh\u1ecb","text":"<ul> <li>HTTP Client: \u0110\u1ec3 test API calls</li> <li>curl (command line)</li> <li>Postman (GUI)</li> <li>HTTPie (command line, user-friendly)</li> <li>Code Editor: \u0110\u1ec3 vi\u1ebft integration code</li> <li>VS Code</li> <li>Ng\u00f4n ng\u1eef L\u1eadp tr\u00ecnh: B\u1ea5t k\u1ef3 ng\u00f4n ng\u1eef n\u00e0o c\u00f3 h\u1ed7 tr\u1ee3 HTTP</li> <li>JavaScript/TypeScript (Node.js, browser)</li> <li>Python</li> <li>Java</li> <li>Go</li> <li>Rust</li> <li>PHP</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/#kien-truc","title":"Ki\u1ebfn tr\u00fac","text":"<p>Khi s\u1eed d\u1ee5ng remote SematX server, \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n giao ti\u1ebfp v\u1edbi n\u1ec1n t\u1ea3ng qua HTTPS:</p> <p></p> <p>\u0110i\u1ec3m ch\u00ednh: - T\u1ea5t c\u1ea3 giao ti\u1ebfp qua HTTPS (b\u1ea3o m\u1eadt) - JWT tokens x\u00e1c th\u1ef1c c\u00e1c requests c\u1ee7a b\u1ea1n - B\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh n\u00e0o - Server x\u1eed l\u00fd l\u01b0u tr\u1eef v\u00e0 x\u1eed l\u00fd d\u1eef li\u1ec7u</p>"},{"location":"vi/getting-started/bring-your-own-server/#cac-truong-hop-su-dung","title":"C\u00e1c Tr\u01b0\u1eddng h\u1ee3p S\u1eed d\u1ee5ng","text":""},{"location":"vi/getting-started/bring-your-own-server/#thu-thap-du-lieu-iot","title":"Thu th\u1eadp D\u1eef li\u1ec7u IoT","text":"<p>G\u1eedi sensor readings t\u1eeb thi\u1ebft b\u1ecb \u0111\u1ebfn SematX: - Environmental sensors (nhi\u1ec7t \u0111\u1ed9, \u0111\u1ed9 \u1ea9m, ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed) - Gi\u00e1m s\u00e1t thi\u1ebft b\u1ecb c\u00f4ng nghi\u1ec7p - H\u1ec7 th\u1ed1ng t\u00f2a nh\u00e0 th\u00f4ng minh - Theo d\u00f5i xe</p>"},{"location":"vi/getting-started/bring-your-own-server/#tich-hop-ung-dung-web","title":"T\u00edch h\u1ee3p \u1ee8ng d\u1ee5ng Web","text":"<p>K\u1ebft n\u1ed1i \u1ee9ng d\u1ee5ng web c\u1ee7a b\u1ea1n v\u1edbi d\u1eef li\u1ec7u SematX: - Hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u sensor th\u1eddi gian th\u1ef1c - T\u1ea1o custom analytics dashboards - X\u00e2y d\u1ef1ng d\u1ecbch v\u1ee5 d\u1ef1a tr\u00ean v\u1ecb tr\u00ed - T\u00edch h\u1ee3p v\u1edbi h\u1ec7 th\u1ed1ng hi\u1ec7n c\u00f3</p>"},{"location":"vi/getting-started/bring-your-own-server/#backend-cho-ung-dung-mobile","title":"Backend cho \u1ee8ng d\u1ee5ng Mobile","text":"<p>S\u1eed d\u1ee5ng SematX l\u00e0m backend cho mobile app: - L\u01b0u tr\u1eef d\u1eef li\u1ec7u do ng\u01b0\u1eddi d\u00f9ng t\u1ea1o - \u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u tr\u00ean c\u00e1c thi\u1ebft b\u1ecb - Push notifications cho events - Truy v\u1ea5n d\u1ef1a tr\u00ean v\u1ecb tr\u00ed</p>"},{"location":"vi/getting-started/bring-your-own-server/#tich-hop-data-pipeline","title":"T\u00edch h\u1ee3p Data Pipeline","text":"<p>K\u1ebft h\u1ee3p SematX v\u00e0o data pipeline c\u1ee7a b\u1ea1n: - Nh\u1eadp d\u1eef li\u1ec7u t\u1eeb nhi\u1ec1u ngu\u1ed3n - Transform v\u00e0 normalize d\u1eef li\u1ec7u - K\u00edch ho\u1ea1t webhooks cho x\u1eed l\u00fd downstream - Export d\u1eef li\u1ec7u \u0111\u1ec3 ph\u00e2n t\u00edch</p>"},{"location":"vi/getting-started/bring-your-own-server/#luong-xac-thuc","title":"Lu\u1ed3ng X\u00e1c th\u1ef1c","text":"<p>Hi\u1ec3u c\u00e1ch x\u00e1c th\u1ef1c ho\u1ea1t \u0111\u1ed9ng s\u1ebd gi\u00fap b\u1ea1n t\u00edch h\u1ee3p th\u00e0nh c\u00f4ng:</p> <pre><code>1. User \u0111\u0103ng nh\u1eadp v\u00e0o Dashboard\n   \u2193\n2. Dashboard t\u1ea1o JWT token (API Key)\n   \u2193\n3. User copy API Key\n   \u2193\n4. \u1ee8ng d\u1ee5ng bao g\u1ed3m API Key trong requests\n   \u2193\n5. Nginx x\u00e1c th\u1ef1c JWT token\n   \u2193\n6. Request \u0111\u01b0\u1ee3c chuy\u1ec3n ti\u1ebfp \u0111\u1ebfn Orion-LD ho\u1eb7c Dashboard API\n   \u2193\n7. Response \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 cho \u1ee9ng d\u1ee5ng\n</code></pre> <p>C\u1ea5u tr\u00fac JWT Token: <pre><code>{\n  \"userId\": \"user_123\",\n  \"email\": \"user@example.com\",\n  \"permissions\": [\"read:entities\", \"write:entities\"],\n  \"exp\": 1735689600,\n  \"iat\": 1704153600\n}\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/#api-endpoints","title":"API Endpoints","text":"<p>B\u1ea1n s\u1ebd s\u1eed d\u1ee5ng c\u00e1c API endpoints ch\u00ednh n\u00e0y:</p>"},{"location":"vi/getting-started/bring-your-own-server/#ngsi-ld-api-orion-ld","title":"NGSI-LD API (Orion-LD)","text":"<p>Base URL: <code>https://your-sematx-server.com/ngsi-ld/v1</code></p> Endpoint Method M\u1ee5c \u0111\u00edch <code>/entities</code> POST T\u1ea1o entity <code>/entities</code> GET Truy v\u1ea5n entities <code>/entities/{id}</code> GET L\u1ea5y entity theo ID <code>/entities/{id}/attrs</code> PATCH C\u1eadp nh\u1eadt thu\u1ed9c t\u00ednh entity <code>/entities/{id}</code> DELETE X\u00f3a entity <code>/subscriptions</code> POST T\u1ea1o subscription <code>/subscriptions</code> GET Li\u1ec7t k\u00ea subscriptions"},{"location":"vi/getting-started/bring-your-own-server/#dashboard-api","title":"Dashboard API","text":"<p>Base URL: <code>https://your-sematx-server.com/api</code></p> Endpoint Method M\u1ee5c \u0111\u00edch <code>/api-keys</code> POST T\u1ea1o API key <code>/api-keys</code> GET Li\u1ec7t k\u00ea API keys <code>/cards</code> POST T\u1ea1o dashboard card <code>/cards</code> GET Li\u1ec7t k\u00ea cards <code>/users/login</code> POST \u0110\u0103ng nh\u1eadp user"},{"location":"vi/getting-started/bring-your-own-server/#rate-limits","title":"Rate Limits","text":"<p>H\u1ea7u h\u1ebft c\u00e1c SematX instances th\u1ef1c thi rate limits:</p> <ul> <li>M\u1eb7c \u0111\u1ecbnh: 100 requests m\u1ed7i ph\u00fat cho m\u1ed7i API key</li> <li>Burst: 20 requests m\u1ed7i gi\u00e2y cho bursts ng\u1eafn</li> <li>Headers: Th\u00f4ng tin rate limit trong response headers   <pre><code>X-RateLimit-Limit: 100\nX-RateLimit-Remaining: 95\nX-RateLimit-Reset: 1704153660\n</code></pre></li> </ul> <p>M\u1eb9o cho Rate Limiting: - Cache d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c truy c\u1eadp th\u01b0\u1eddng xuy\u00ean - S\u1eed d\u1ee5ng subscriptions thay v\u00ec polling - Batch updates khi c\u00f3 th\u1ec3 - Tri\u1ec3n khai exponential backoff cho retries</p>"},{"location":"vi/getting-started/bring-your-own-server/#vi-du-code","title":"V\u00ed d\u1ee5 Code","text":"<p>Ch\u00fang t\u00f4i cung c\u1ea5p v\u00ed d\u1ee5 code b\u1eb1ng nhi\u1ec1u ng\u00f4n ng\u1eef trong su\u1ed1t h\u01b0\u1edbng d\u1eabn:</p> <ul> <li>JavaScript/TypeScript: V\u00ed d\u1ee5 Node.js v\u00e0 browser</li> <li>Python: S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n <code>requests</code></li> <li>curl: V\u00ed d\u1ee5 command-line</li> <li>Postman: Collection files \u0111\u1ec3 import</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/#nhan-tro-giup","title":"Nh\u1eadn Tr\u1ee3 gi\u00fap","text":"<p>N\u1ebfu b\u1ea1n g\u1eb7p kh\u00f3 kh\u0103n trong h\u01b0\u1edbng d\u1eabn n\u00e0y:</p> <ul> <li>Ki\u1ec3m tra logs: H\u1ea7u h\u1ebft c\u00e1c l\u1ed7i bao g\u1ed3m th\u00f4ng b\u00e1o h\u1eefu \u00edch</li> <li>X\u00e1c minh credentials: \u0110\u1ea3m b\u1ea3o API keys h\u1ee3p l\u1ec7 v\u00e0 ch\u01b0a h\u1ebft h\u1ea1n</li> <li>Test connectivity: S\u1eed d\u1ee5ng curl \u0111\u1ec3 x\u00e1c minh kh\u1ea3 n\u0103ng truy c\u1eadp server</li> <li>Xem l\u1ea1i docs: Tham kh\u1ea3o H\u01b0\u1edbng d\u1eabn Kh\u1eafc ph\u1ee5c S\u1ef1 c\u1ed1 n\u1ebfu g\u1eb7p v\u1ea5n \u0111\u1ec1</li> <li>Y\u00eau c\u1ea7u tr\u1ee3 gi\u00fap: Tham gia GitHub Discussions</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/#san-sang-bat-au","title":"S\u1eb5n s\u00e0ng B\u1eaft \u0111\u1ea7u?","text":"<p>H\u00e3y b\u1eaft \u0111\u1ea7u b\u1eb1ng c\u00e1ch t\u1ea1o t\u00e0i kho\u1ea3n c\u1ee7a b\u1ea1n:</p> <p>B\u01b0\u1edbc 1: T\u1ea1o T\u00e0i kho\u1ea3n \u2192</p>"},{"location":"vi/getting-started/bring-your-own-server/#thay-the-bat-au-voi-local-truoc","title":"Thay th\u1ebf: B\u1eaft \u0111\u1ea7u v\u1edbi Local tr\u01b0\u1edbc","text":"<p>N\u1ebfu b\u1ea1n ch\u01b0a c\u00f3 quy\u1ec1n truy c\u1eadp v\u00e0o SematX server, b\u1ea1n c\u00f3 th\u1ec3:</p> <ol> <li>Kh\u1edfi \u0111\u1ed9ng local server cho development</li> <li>Ho\u00e0n th\u00e0nh h\u01b0\u1edbng d\u1eabn n\u00e0y s\u1eed d\u1ee5ng local instance</li> <li>Tri\u1ec3n khai production khi s\u1eb5n s\u00e0ng</li> </ol> <p>API gi\u1ed1ng h\u1ec7t nhau cho d\u00f9 s\u1eed d\u1ee5ng local hay remote servers!</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/","title":"B\u01b0\u1edbc 1: T\u1ea1o T\u00e0i Kho\u1ea3n","text":"<p>B\u01b0\u1edbc \u0111\u1ea7u ti\u00ean \u0111\u1ec3 s\u1eed d\u1ee5ng SematX l\u00e0 t\u1ea1o t\u00e0i kho\u1ea3n tr\u00ean instance SematX c\u1ee7a t\u1ed5 ch\u1ee9c b\u1ea1n.</p> <p>\u23f1\ufe0f Th\u1eddi gian: 5 ph\u00fat \ud83c\udfaf M\u1ee5c ti\u00eau: Truy c\u1eadp dashboard SematX v\u00e0 t\u1ea1o API credentials</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#truoc-khi-bat-au","title":"Tr\u01b0\u1edbc Khi B\u1eaft \u0110\u1ea7u","text":""},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#lay-url-cua-sematx-server","title":"L\u1ea5y URL c\u1ee7a SematX Server","text":"<p>B\u1ea1n c\u1ea7n URL c\u1ee7a SematX server c\u1ee7a t\u1ed5 ch\u1ee9c. Th\u01b0\u1eddng c\u00f3 d\u1ea1ng:</p> <ul> <li><code>https://sematx.example.com</code></li> <li><code>https://dashboard.your-company.com</code></li> <li><code>https://smart-city.example.org</code></li> </ul> <p>Ch\u01b0a c\u00f3 server? B\u1ea1n c\u00f3 th\u1ec3: - H\u1ecfi qu\u1ea3n tr\u1ecb vi\u00ean h\u1ec7 th\u1ed1ng \u0111\u1ec3 l\u1ea5y URL - Tri\u1ec3n khai instance ri\u00eang - Kh\u1edfi \u0111\u1ed9ng local server \u0111\u1ec3 ph\u00e1t tri\u1ec3n</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#kiem-tra-yeu-cau-truy-cap","title":"Ki\u1ec3m Tra Y\u00eau C\u1ea7u Truy C\u1eadp","text":"<p>M\u1ed9t s\u1ed1 instance SematX y\u00eau c\u1ea7u: - L\u1eddi m\u1eddi: Qu\u1ea3n tr\u1ecb vi\u00ean ph\u1ea3i t\u1ea1o t\u00e0i kho\u1ea3n cho b\u1ea1n - H\u1ea1n ch\u1ebf domain: Email ph\u1ea3i kh\u1edbp v\u1edbi domain t\u1ed5 ch\u1ee9c - VPN: C\u00f3 th\u1ec3 c\u1ea7n VPN cho m\u1ea1ng ri\u00eang</p> <p>Li\u00ean h\u1ec7 qu\u1ea3n tr\u1ecb vi\u00ean n\u1ebfu kh\u00f4ng ch\u1eafc v\u1ec1 y\u00eau c\u1ea7u truy c\u1eadp.</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#tao-tai-khoan","title":"T\u1ea1o T\u00e0i Kho\u1ea3n","text":""},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#truy-cap-dashboard","title":"Truy C\u1eadp Dashboard","text":"<ol> <li>M\u1edf tr\u00ecnh duy\u1ec7t web</li> <li>V\u00e0o URL instance SematX c\u1ee7a b\u1ea1n</li> <li>Th\u00eam <code>/admin</code> \u0111\u1ec3 truy c\u1eadp dashboard:    <pre><code>https://your-sematx-server.com/admin\n</code></pre></li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#ang-ky-self-registration","title":"\u0110\u0103ng K\u00fd (Self-Registration)","text":"<p>N\u1ebfu t\u00ednh n\u0103ng t\u1ef1 \u0111\u0103ng k\u00fd \u0111\u01b0\u1ee3c b\u1eadt, b\u1ea1n s\u1ebd th\u1ea5y form Create First User ho\u1eb7c Sign Up:</p> <ol> <li> <p>Email: Nh\u1eadp \u0111\u1ecba ch\u1ec9 email    <pre><code>user@example.com\n</code></pre></p> </li> <li> <p>Password: T\u1ea1o m\u1eadt kh\u1ea9u m\u1ea1nh</p> </li> <li>T\u1ed1i thi\u1ec3u 8 k\u00fd t\u1ef1</li> <li>K\u1ebft h\u1ee3p ch\u1eef hoa, ch\u1eef th\u01b0\u1eddng, s\u1ed1, k\u00fd t\u1ef1 \u0111\u1eb7c bi\u1ec7t</li> <li> <p>V\u00ed d\u1ee5: <code>Sm@rtC1ty2025!</code></p> </li> <li> <p>Confirm Password: Nh\u1eadp l\u1ea1i m\u1eadt kh\u1ea9u</p> </li> <li> <p>Name (t\u00f9y ch\u1ecdn): T\u00ean \u0111\u1ea7y \u0111\u1ee7 c\u1ee7a b\u1ea1n    <pre><code>John Doe\n</code></pre></p> </li> <li> <p>Nh\u1ea5n Create Account ho\u1eb7c Sign Up</p> </li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#tai-khoan-do-quan-tri-vien-tao","title":"T\u00e0i Kho\u1ea3n Do Qu\u1ea3n Tr\u1ecb Vi\u00ean T\u1ea1o","text":"<p>N\u1ebfu t\u00e0i kho\u1ea3n \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi qu\u1ea3n tr\u1ecb vi\u00ean:</p> <ol> <li>Ki\u1ec3m tra email \u0111\u1ec3 nh\u1eadn l\u1eddi m\u1eddi</li> <li>Nh\u1ea5n v\u00e0o link k\u00edch ho\u1ea1t</li> <li>\u0110\u1eb7t m\u1eadt kh\u1ea9u c\u1ee7a b\u1ea1n</li> <li>\u0110\u0103ng nh\u1eadp v\u1edbi th\u00f4ng tin \u0111\u0103ng nh\u1eadp</li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#ang-nhap","title":"\u0110\u0103ng Nh\u1eadp","text":"<p>Sau khi t\u1ea1o t\u00e0i kho\u1ea3n, \u0111\u0103ng nh\u1eadp v\u00e0o dashboard:</p> <ol> <li> <p>Truy c\u1eadp trang \u0111\u0103ng nh\u1eadp:    <pre><code>https://your-sematx-server.com/admin/login\n</code></pre></p> </li> <li> <p>Nh\u1eadp th\u00f4ng tin \u0111\u0103ng nh\u1eadp:</p> </li> <li>Email: Email \u0111\u00e3 \u0111\u0103ng k\u00fd</li> <li> <p>Password: M\u1eadt kh\u1ea9u t\u00e0i kho\u1ea3n</p> </li> <li> <p>Nh\u1ea5n Log In</p> </li> </ol> <p>B\u00e2y gi\u1edd b\u1ea1n s\u1ebd th\u1ea5y giao di\u1ec7n dashboard SematX!</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#cac-phan-chinh","title":"C\u00e1c Ph\u1ea7n Ch\u00ednh","text":"<ul> <li>Dashboard: Xem tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n</li> <li>Maps: Tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u \u0111\u1ecba l\u00fd</li> <li>Entities: Duy\u1ec7t v\u00e0 qu\u1ea3n l\u00fd c\u00e1c entity NGSI-LD</li> <li>API Keys: T\u1ea1o token \u0111\u1ec3 truy c\u1eadp API</li> <li>Cards: T\u1ea1o v\u00e0 c\u1ea5u h\u00ecnh c\u00e1c card dashboard</li> <li>Subscriptions: Thi\u1ebft l\u1eadp th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c</li> <li>Users: Qu\u1ea3n l\u00fd th\u00e0nh vi\u00ean nh\u00f3m (ch\u1ec9 admin)</li> <li>Settings: C\u1ea5u h\u00ecnh t\u00f9y ch\u1ecdn c\u1ee7a b\u1ea1n</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#tao-api-key-au-tien","title":"T\u1ea1o API Key \u0110\u1ea7u Ti\u00ean","text":"<p>\u0110\u1ec3 t\u01b0\u01a1ng t\u00e1c v\u1edbi SematX API t\u1eeb \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n, b\u1ea1n c\u1ea7n m\u1ed9t API key (JWT token).</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#truy-cap-api-keys","title":"Truy C\u1eadp API Keys","text":"<ol> <li>Nh\u1ea5n API Keys trong thanh b\u00ean tr\u00e1i</li> <li>Nh\u1ea5n n\u00fat Create New</li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#cau-hinh-api-key","title":"C\u1ea5u H\u00ecnh API Key","text":"<p>\u0110i\u1ec1n th\u00f4ng tin API key:</p> <ol> <li>Name: \u0110\u1eb7t t\u00ean m\u00f4 t\u1ea3 cho API key    <pre><code>My Application - Production\n</code></pre></li> </ol> <p>M\u1eb9o: S\u1eed d\u1ee5ng t\u00ean c\u00f3 \u00fd ngh\u0129a \u0111\u1ec3 d\u1ec5 nh\u1eadn bi\u1ebft sau n\u00e0y:    - <code>IoT Sensors - Building A</code>    - <code>Mobile App - iOS</code>    - <code>Data Pipeline - Staging</code></p> <ol> <li> <p>Description (t\u00f9y ch\u1ecdn): Th\u00eam ghi ch\u00fa v\u1ec1 c\u00e1ch s\u1eed d\u1ee5ng    <pre><code>API key for production IoT sensor data collection\n</code></pre></p> </li> <li> <p>Expires: \u0110\u1eb7t ng\u00e0y h\u1ebft h\u1ea1n</p> </li> <li>Khuy\u1ebfn ngh\u1ecb: 90 ng\u00e0y cho production</li> <li>Ng\u1eafn h\u1ea1n: 7-30 ng\u00e0y cho testing</li> <li> <p>Kh\u00f4ng h\u1ebft h\u1ea1n: Ch\u1ec9 cho development (kh\u00f4ng khuy\u1ebfn ngh\u1ecb cho production)</p> </li> <li> <p>Permissions: Ch\u1ecdn m\u1ee9c truy c\u1eadp</p> </li> <li>Read Only: Ch\u1ec9 c\u00f3 th\u1ec3 truy v\u1ea5n d\u1eef li\u1ec7u</li> <li>Read/Write: C\u00f3 th\u1ec3 t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt entity</li> <li>Full Access: C\u00f3 th\u1ec3 qu\u1ea3n l\u00fd t\u1ea5t c\u1ea3 t\u00e0i nguy\u00ean</li> </ol> <p>Cho tutorial n\u00e0y: Ch\u1ecdn Read/Write ho\u1eb7c Full Access</p> <ol> <li>Rate Limit (n\u1ebfu c\u00f3): \u0110\u1eb7t gi\u1edbi h\u1ea1n request</li> <li>M\u1eb7c \u0111\u1ecbnh: 100 request m\u1ed7i ph\u00fat</li> <li>L\u01b0u l\u01b0\u1ee3ng cao: 1000 request m\u1ed7i ph\u00fat</li> <li> <p>L\u01b0u l\u01b0\u1ee3ng th\u1ea5p: 10 request m\u1ed7i ph\u00fat</p> </li> <li> <p>Nh\u1ea5n Create</p> </li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#luu-api-key","title":"L\u01b0u API Key","text":"<p>Quan tr\u1ecdng: B\u1ea1n ch\u1ec9 th\u1ea5y API key m\u1ed9t l\u1ea7n duy nh\u1ea5t!</p> <ol> <li> <p>Copy to\u00e0n b\u1ed9 token:    <pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2NTg3ZjJhMTIzNDU2Nzg5IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwicGVybWlzc2lvbnMiOlsicmVhZDplbnRpdGllcyIsIndyaXRlOmVudGl0aWVzIl0sImlhdCI6MTcwNDE1MzYwMCwiZXhwIjoxNzEyMDE1NjAwfQ.xGZHY8PK2yWQJ3uT6E9hxK4rN7mV8lB0nQ5sA1wF2cD\n</code></pre></p> </li> <li> <p>L\u01b0u tr\u1eef an to\u00e0n:</p> </li> <li>Cho development: L\u01b0u trong file <code>.env</code> (kh\u00f4ng commit l\u00ean git!)</li> <li>Cho production: L\u01b0u trong secrets manager (AWS Secrets Manager, Azure Key Vault, v.v.)</li> <li> <p>Kh\u00f4ng bao gi\u1edd: Chia s\u1ebb qua email, Slack, ho\u1eb7c k\u00eanh c\u00f4ng khai</p> </li> <li> <p>Nh\u1ea5n Done</p> </li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#kiem-tra-ket-noi","title":"Ki\u1ec3m Tra K\u1ebft N\u1ed1i","text":"<p>H\u00e3y x\u00e1c minh b\u1ea1n c\u00f3 th\u1ec3 k\u1ebft n\u1ed1i v\u1edbi SematX API b\u1eb1ng API key m\u1edbi.</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#su-dung-curl","title":"S\u1eed D\u1ee5ng curl","text":"<p>M\u1edf terminal v\u00e0 ch\u1ea1y:</p> <pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?limit=1\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre> <p>Thay th\u1ebf: - <code>your-sematx-server.com</code> v\u1edbi URL server th\u1ef1c t\u1ebf - <code>YOUR_API_KEY_HERE</code> v\u1edbi API key c\u1ee7a b\u1ea1n</p> <p>K\u1ebft qu\u1ea3 mong \u0111\u1ee3i:</p> <pre><code>[]\n</code></pre> <p>Ho\u1eb7c n\u1ebfu \u0111\u00e3 c\u00f3 entity:</p> <pre><code>[\n  {\n    \"id\": \"urn:ngsi-ld:Sensor:001\",\n    \"type\": \"Sensor\",\n    ...\n  }\n]\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#su-dung-javascript","title":"S\u1eed D\u1ee5ng JavaScript","text":"<pre><code>const SEMATX_URL = 'https://your-sematx-server.com';\nconst API_KEY = 'YOUR_API_KEY_HERE';\n\nasync function testConnection() {\n  const response = await fetch(\n    `${SEMATX_URL}/ngsi-ld/v1/entities?limit=1`,\n    {\n      headers: {\n        'Authorization': `Bearer ${API_KEY}`,\n        'Accept': 'application/ld+json'\n      }\n    }\n  );\n\n  if (response.ok) {\n    const data = await response.json();\n    console.log('\u2705 Connected successfully!');\n    console.log('Entities:', data);\n  } else {\n    console.error('\u274c Connection failed:', response.status);\n  }\n}\n\ntestConnection();\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#su-dung-python","title":"S\u1eed D\u1ee5ng Python","text":"<pre><code>import requests\n\nSEMATX_URL = 'https://your-sematx-server.com'\nAPI_KEY = 'YOUR_API_KEY_HERE'\n\ndef test_connection():\n    response = requests.get(\n        f'{SEMATX_URL}/ngsi-ld/v1/entities',\n        params={'limit': 1},\n        headers={\n            'Authorization': f'Bearer {API_KEY}',\n            'Accept': 'application/ld+json'\n        }\n    )\n\n    if response.ok:\n        print('\u2705 Connected successfully!')\n        print('Entities:', response.json())\n    else:\n        print(f'\u274c Connection failed: {response.status_code}')\n        print(response.text)\n\ntest_connection()\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#xu-ly-su-co","title":"X\u1eed L\u00fd S\u1ef1 C\u1ed1","text":""},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#401-unauthorized","title":"401 Unauthorized","text":"<p>V\u1ea5n \u0111\u1ec1: API tr\u1ea3 v\u1ec1 m\u00e3 l\u1ed7i 401</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra API key: \u0110\u1ea3m b\u1ea3o b\u1ea1n \u0111\u00e3 copy \u0111\u1ea7y \u0111\u1ee7 2. Ki\u1ec3m tra h\u1ebft h\u1ea1n: Key c\u00f3 th\u1ec3 \u0111\u00e3 h\u1ebft h\u1ea1n 3. Ki\u1ec3m tra \u0111\u1ecbnh d\u1ea1ng: Header ph\u1ea3i l\u00e0 <code>Authorization: Bearer &lt;token&gt;</code> 4. T\u1ea1o l\u1ea1i: T\u1ea1o API key m\u1edbi n\u1ebfu c\u1ea7n</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#403-forbidden","title":"403 Forbidden","text":"<p>V\u1ea5n \u0111\u1ec1: API tr\u1ea3 v\u1ec1 m\u00e3 l\u1ed7i 403</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra quy\u1ec1n: API key c\u00f3 th\u1ec3 thi\u1ebfu quy\u1ec1n c\u1ea7n thi\u1ebft 2. Ki\u1ec3m tra t\u00e0i kho\u1ea3n: T\u00e0i kho\u1ea3n c\u1ee7a b\u1ea1n c\u00f3 th\u1ec3 b\u1ecb v\u00f4 hi\u1ec7u h\u00f3a 3. Li\u00ean h\u1ec7 admin: C\u00f3 th\u1ec3 c\u1ea7n quy\u1ec1n cao h\u01a1n</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#network-error-timeout","title":"Network Error / Timeout","text":"<p>V\u1ea5n \u0111\u1ec1: Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i server</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra URL: X\u00e1c minh \u0111\u1ecba ch\u1ec9 server \u0111\u00fang 2. Ki\u1ec3m tra m\u1ea1ng: \u0110\u1ea3m b\u1ea3o b\u1ea1n \u0111\u00e3 k\u1ebft n\u1ed1i internet 3. Ki\u1ec3m tra VPN: C\u00f3 th\u1ec3 c\u1ea7n VPN cho m\u1ea1ng ri\u00eang 4. Ki\u1ec3m tra firewall: Firewall c\u00f3 th\u1ec3 ch\u1eb7n k\u1ebft n\u1ed1i 5. Ki\u1ec3m tra DNS: Th\u1eed \u0111\u1ecba ch\u1ec9 IP thay v\u00ec t\u00ean mi\u1ec1n</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#ssltls-error","title":"SSL/TLS Error","text":"<p>V\u1ea5n \u0111\u1ec1: X\u00e1c minh certificate th\u1ea5t b\u1ea1i</p> <p>Gi\u1ea3i ph\u00e1p: 1. Self-signed cert: Admin c\u00f3 th\u1ec3 d\u00f9ng certificate t\u1ef1 k\u00fd 2. Ch\u1ec9 development: V\u00f4 hi\u1ec7u h\u00f3a x\u00e1c minh SSL (kh\u00f4ng d\u00f9ng cho production!)    <pre><code>curl -k https://your-sematx-server.com/...\n</code></pre> 3. Production: C\u00e0i \u0111\u1eb7t SSL certificate \u0111\u00fang c\u00e1ch</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#cannot-access-dashboard","title":"Cannot Access Dashboard","text":"<p>V\u1ea5n \u0111\u1ec1: Trang dashboard kh\u00f4ng load</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra URL: Ph\u1ea3i bao g\u1ed3m \u0111\u01b0\u1eddng d\u1eabn <code>/admin</code> 2. Ki\u1ec3m tra tr\u00ecnh duy\u1ec7t: Th\u1eed tr\u00ecnh duy\u1ec7t kh\u00e1c ho\u1eb7c ch\u1ebf \u0111\u1ed9 \u1ea9n danh 3. X\u00f3a cache: X\u00f3a cache v\u00e0 cookie tr\u00ecnh duy\u1ec7t 4. Ki\u1ec3m tra server: Server c\u00f3 th\u1ec3 b\u1ecb down - li\u00ean h\u1ec7 admin</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#thuc-hanh-bao-mat-tot-nhat","title":"Th\u1ef1c H\u00e0nh B\u1ea3o M\u1eadt T\u1ed1t Nh\u1ea5t","text":""},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#quan-ly-api-key","title":"Qu\u1ea3n L\u00fd API Key","text":"<p>\u2705 N\u00ean: - D\u00f9ng bi\u1ebfn m\u00f4i tr\u01b0\u1eddng cho API key - Xoay v\u00f2ng key \u0111\u1ecbnh k\u1ef3 (m\u1ed7i 90 ng\u00e0y) - D\u00f9ng key kh\u00e1c nhau cho m\u00f4i tr\u01b0\u1eddng kh\u00e1c nhau - Thu h\u1ed3i key khi kh\u00f4ng c\u00f2n c\u1ea7n - \u0110\u1eb7t ng\u00e0y h\u1ebft h\u1ea1n cho t\u1ea5t c\u1ea3 key - D\u00f9ng quy\u1ec1n t\u1ed1i thi\u1ec3u c\u1ea7n thi\u1ebft</p> <p>\u274c Kh\u00f4ng n\u00ean: - Commit API key v\u00e0o version control - Chia s\u1ebb key qua email ho\u1eb7c chat - D\u00f9ng key production trong development - Cho quy\u1ec1n full access khi ch\u1ec9 c\u1ea7n read-only - T\u1ea1o key kh\u00f4ng c\u00f3 ng\u00e0y h\u1ebft h\u1ea1n - D\u00f9ng l\u1ea1i key cho nhi\u1ec1u project</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#bao-mat-mat-khau","title":"B\u1ea3o M\u1eadt M\u1eadt Kh\u1ea9u","text":"<p>\u2705 N\u00ean: - D\u00f9ng m\u1eadt kh\u1ea9u m\u1ea1nh, \u0111\u1ed9c nh\u1ea5t - B\u1eadt 2FA n\u1ebfu c\u00f3 - D\u00f9ng password manager - \u0110\u1ed5i m\u1eadt kh\u1ea9u n\u1ebfu b\u1ecb l\u1ed9</p> <p>\u274c Kh\u00f4ng n\u00ean: - D\u00f9ng l\u1ea1i m\u1eadt kh\u1ea9u cho nhi\u1ec1u d\u1ecbch v\u1ee5 - Chia s\u1ebb th\u00f4ng tin \u0111\u0103ng nh\u1eadp t\u00e0i kho\u1ea3n - D\u00f9ng m\u1eadt kh\u1ea9u \u0111\u01a1n gi\u1ea3n ho\u1eb7c ph\u1ed5 bi\u1ebfn - Vi\u1ebft m\u1eadt kh\u1ea9u d\u1ea1ng plain text</p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng G\u00ec B\u1ea1n \u0110\u00e3 H\u1ecdc","text":"<p>\u2705 C\u00e1ch truy c\u1eadp dashboard SematX \u2705 C\u00e1ch t\u1ea1o t\u00e0i kho\u1ea3n ng\u01b0\u1eddi d\u00f9ng \u2705 C\u00e1ch t\u1ea1o API key \u2705 C\u00e1ch ki\u1ec3m tra k\u1ebft n\u1ed1i API \u2705 Th\u1ef1c h\u00e0nh b\u1ea3o m\u1eadt t\u1ed1t nh\u1ea5t cho API key  </p>"},{"location":"vi/getting-started/bring-your-own-server/1-create-account/#buoc-tiep-theo","title":"B\u01b0\u1edbc Ti\u1ebfp Theo","text":"<p>B\u00e2y gi\u1edd b\u1ea1n \u0111\u00e3 c\u00f3 t\u00e0i kho\u1ea3n v\u00e0 API key, h\u00e3y t\u1ea1o service cho \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n:</p> <p>B\u01b0\u1edbc 2: T\u1ea1o Service \u2192</p> <p>C\u1ea7n quay l\u1ea1i? V\u1ec1 t\u1ed5ng quan tutorial</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/","title":"B\u01b0\u1edbc 2: T\u1ea1o Service","text":"<p>Trong SematX, m\u1ed9t service \u0111\u1ea1i di\u1ec7n cho nh\u00f3m logic c\u00e1c entity t\u1eeb \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n. \u0110i\u1ec1u n\u00e0y gi\u00fap t\u1ed5 ch\u1ee9c d\u1eef li\u1ec7u v\u00e0 qu\u1ea3n l\u00fd ki\u1ec3m so\u00e1t truy c\u1eadp.</p> <p>\u23f1\ufe0f Th\u1eddi gian: 5-10 ph\u00fat \ud83c\udfaf M\u1ee5c ti\u00eau: Thi\u1ebft l\u1eadp c\u1ea5u h\u00ecnh service cho \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#service-la-gi","title":"Service L\u00e0 G\u00ec?","text":"<p>Service trong SematX l\u00e0 m\u1ed9t namespace cho c\u00e1c entity c\u1ee7a b\u1ea1n. Ngh\u0129 v\u1ec1 n\u00f3 nh\u01b0:</p> <ul> <li>D\u1ef1 \u00e1n IoT: \"Smart Building Sensors\"</li> <li>Ph\u00f2ng ban: \"Environmental Monitoring Team\"</li> <li>\u1ee8ng d\u1ee5ng: \"Mobile App Backend\"</li> <li>\u0110\u1ecba \u0111i\u1ec3m: \"Downtown Campus\"</li> </ul> <p>Service gi\u00fap b\u1ea1n: - T\u1ed5 ch\u1ee9c entity theo project ho\u1eb7c \u1ee9ng d\u1ee5ng - \u00c1p d\u1ee5ng ch\u00ednh s\u00e1ch ki\u1ec3m so\u00e1t truy c\u1eadp - L\u1ecdc d\u1eef li\u1ec7u trong truy v\u1ea5n - Qu\u1ea3n l\u00fd v\u00f2ng \u0111\u1eddi entity</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#hieu-ve-ngsi-ld-multi-tenancy","title":"Hi\u1ec3u v\u1ec1 NGSI-LD Multi-Tenancy","text":"<p>SematX s\u1eed d\u1ee5ng header NGSI-LD-Tenant cho multi-tenancy:</p> <pre><code>GET /ngsi-ld/v1/entities\nAuthorization: Bearer &lt;api-key&gt;\nNGSILD-Tenant: my-service\n</code></pre> <p>T\u1ea5t c\u1ea3 entity \u0111\u01b0\u1ee3c t\u1ea1o v\u1edbi tenant header c\u1ee5 th\u1ec3 s\u1ebd \u0111\u01b0\u1ee3c t\u00e1ch bi\u1ec7t v\u00e0o tenant \u0111\u00f3.</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#tao-service","title":"T\u1ea1o Service","text":""},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#lua-chon-1-implicit-service-khuyen-nghi-cho-nguoi-moi","title":"L\u1ef1a Ch\u1ecdn 1: Implicit Service (Khuy\u1ebfn ngh\u1ecb cho ng\u01b0\u1eddi m\u1edbi)","text":"<p>C\u00e1ch \u0111\u01a1n gi\u1ea3n nh\u1ea5t l\u00e0 kh\u00f4ng d\u00f9ng tenant header. T\u1ea5t c\u1ea3 entity s\u1ebd \u0111\u01b0\u1ee3c t\u1ea1o trong tenant m\u1eb7c \u0111\u1ecbnh.</p> <p>\u01afu \u0111i\u1ec3m: - Kh\u00f4ng c\u1ea7n c\u1ea5u h\u00ecnh - \u0110\u01a1n gi\u1ea3n \u0111\u1ec3 b\u1eaft \u0111\u1ea7u - T\u1ed1t cho tri\u1ec3n khai \u1ee9ng d\u1ee5ng \u0111\u01a1n</p> <p>Nh\u01b0\u1ee3c \u0111i\u1ec3m: - T\u1ea5t c\u1ea3 entity d\u00f9ng chung namespace - Kh\u00f3 t\u1ed5 ch\u1ee9c d\u1eef li\u1ec7u multi-project</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#lua-chon-2-explicit-service","title":"L\u1ef1a Ch\u1ecdn 2: Explicit Service","text":"<p>\u0110\u1ec3 t\u1ed5 ch\u1ee9c t\u1ed1t h\u01a1n, t\u1ea1o service c\u00f3 t\u00ean cho \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n.</p> <p>Ch\u1ecdn T\u00ean Service:</p> <pre><code>my-iot-project\nsmart-building-a\nenvironmental-sensors\nmobile-app-backend\n</code></pre> <p>Quy t\u1eafc: - Ch\u1ec9 ch\u1eef th\u01b0\u1eddng, s\u1ed1, d\u1ea5u g\u1ea1ch ngang - Kh\u00f4ng c\u00f3 kho\u1ea3ng tr\u1eafng ho\u1eb7c k\u00fd t\u1ef1 \u0111\u1eb7c bi\u1ec7t - T\u1ed1i \u0111a 64 k\u00fd t\u1ef1 - M\u00f4 t\u1ea3 v\u00e0 \u0111\u1ed9c nh\u1ea5t</p> <p>L\u01b0u t\u00ean service:</p> <pre><code># Trong file .env\nSEMATX_SERVICE=my-iot-project\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#cau-hinh-ung-dung","title":"C\u1ea5u H\u00ecnh \u1ee8ng D\u1ee5ng","text":""},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#bien-moi-truong","title":"Bi\u1ebfn M\u00f4i Tr\u01b0\u1eddng","text":"<p>Thi\u1ebft l\u1eadp c\u1ea5u h\u00ecnh \u1ee9ng d\u1ee5ng:</p> <pre><code># .env file\nSEMATX_URL=https://your-sematx-server.com\nSEMATX_API_KEY=eyJhbGciOiJIUzI1NiIsInR...\nSEMATX_SERVICE=my-iot-project\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#cau-hinh-javascripttypescript","title":"C\u1ea5u H\u00ecnh JavaScript/TypeScript","text":"<pre><code>// config.js\nexport const sematxConfig = {\n  url: process.env.SEMATX_URL || 'https://your-sematx-server.com',\n  apiKey: process.env.SEMATX_API_KEY,\n  service: process.env.SEMATX_SERVICE || 'default',\n  headers: {\n    'Authorization': `Bearer ${process.env.SEMATX_API_KEY}`,\n    'Content-Type': 'application/ld+json',\n    'Accept': 'application/ld+json',\n    'NGSILD-Tenant': process.env.SEMATX_SERVICE || 'default'\n  }\n};\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#cau-hinh-python","title":"C\u1ea5u H\u00ecnh Python","text":"<pre><code># config.py\nimport os\nfrom dataclasses import dataclass\n\n@dataclass\nclass SematXConfig:\n    url: str = os.getenv('SEMATX_URL', 'https://your-sematx-server.com')\n    api_key: str = os.getenv('SEMATX_API_KEY')\n    service: str = os.getenv('SEMATX_SERVICE', 'default')\n\n    @property\n    def headers(self):\n        return {\n            'Authorization': f'Bearer {self.api_key}',\n            'Content-Type': 'application/ld+json',\n            'Accept': 'application/ld+json',\n            'NGSILD-Tenant': self.service\n        }\n\nconfig = SematXConfig()\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#tao-helper-function","title":"T\u1ea1o Helper Function","text":"<p>T\u1ea1o function c\u00f3 th\u1ec3 t\u00e1i s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n API request:</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#kiem-tra-cau-hinh-service","title":"Ki\u1ec3m Tra C\u1ea5u H\u00ecnh Service","text":"<p>H\u00e3y x\u00e1c minh c\u1ea5u h\u00ecnh service ho\u1ea1t \u0111\u1ed9ng:</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#test-1-truy-van-service-rong","title":"Test 1: Truy v\u1ea5n Service R\u1ed7ng","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre> <p>K\u1ebft qu\u1ea3 mong \u0111\u1ee3i: M\u1ea3ng r\u1ed7ng <code>[]</code> (ch\u01b0a c\u00f3 entity)</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#test-2-dung-helper-function","title":"Test 2: D\u00f9ng Helper Function","text":""},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#cac-mau-to-chuc-service","title":"C\u00e1c M\u1eabu T\u1ed5 Ch\u1ee9c Service","text":""},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#mau-1-single-service-on-gian","title":"M\u1eabu 1: Single Service (\u0110\u01a1n Gi\u1ea3n)","text":"<pre><code>Service: my-app\n  \u251c\u2500\u2500 Sensor:001\n  \u251c\u2500\u2500 Sensor:002\n  \u251c\u2500\u2500 Building:001\n  \u2514\u2500\u2500 Vehicle:001\n</code></pre> <p>D\u00f9ng khi: - \u1ee8ng d\u1ee5ng \u0111\u01a1n - S\u1ed1 l\u01b0\u1ee3ng entity nh\u1ecf - Kh\u00f4ng c\u1ea7n multi-tenancy</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#mau-2-service-theo-moi-truong","title":"M\u1eabu 2: Service Theo M\u00f4i Tr\u01b0\u1eddng","text":"<pre><code>Service: my-app-dev\n  \u2514\u2500\u2500 Test entities\n\nService: my-app-staging\n  \u2514\u2500\u2500 Staging entities\n\nService: my-app-prod\n  \u2514\u2500\u2500 Production entities\n</code></pre> <p>D\u00f9ng khi: - C\u1ea7n m\u00f4i tr\u01b0\u1eddng t\u00e1ch bi\u1ec7t - Testing tr\u01b0\u1edbc production - Ki\u1ec3m so\u00e1t truy c\u1eadp kh\u00e1c nhau m\u1ed7i m\u00f4i tr\u01b0\u1eddng</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#mau-3-service-theo-ia-iem","title":"M\u1eabu 3: Service Theo \u0110\u1ecba \u0110i\u1ec3m","text":"<pre><code>Service: building-a\n  \u2514\u2500\u2500 Building A entities\n\nService: building-b\n  \u2514\u2500\u2500 Building B entities\n\nService: downtown-campus\n  \u2514\u2500\u2500 Campus entities\n</code></pre> <p>D\u00f9ng khi: - Ph\u00e2n t\u00e1ch theo \u0111\u1ecba l\u00fd - Ki\u1ec3m so\u00e1t truy c\u1eadp theo v\u1ecb tr\u00ed - Tri\u1ec3n khai theo khu v\u1ef1c</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#mau-4-service-theo-teamphong-ban","title":"M\u1eabu 4: Service Theo Team/Ph\u00f2ng Ban","text":"<pre><code>Service: facilities-team\n  \u2514\u2500\u2500 Facilities entities\n\nService: security-team\n  \u2514\u2500\u2500 Security entities\n\nService: iot-team\n  \u2514\u2500\u2500 IoT sensors\n</code></pre> <p>D\u00f9ng khi: - Nhi\u1ec1u team d\u00f9ng chung h\u1ea1 t\u1ea7ng - Ki\u1ec3m so\u00e1t truy c\u1eadp theo ph\u00f2ng ban - Ranh gi\u1edbi t\u1ed5 ch\u1ee9c</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#thuc-hanh-tot-nhat","title":"Th\u1ef1c H\u00e0nh T\u1ed1t Nh\u1ea5t","text":""},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#quy-uoc-at-ten","title":"Quy \u01af\u1edbc \u0110\u1eb7t T\u00ean","text":"<p>\u2705 T\u00ean T\u1ed1t: <pre><code>smart-building-sensors\nenvironmental-monitoring\nmobile-app-backend\niot-dev-environment\n</code></pre></p> <p>\u274c T\u00ean Kh\u00f4ng T\u1ed1t: <pre><code>test\nmyService\nService1\nabc123\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#vong-oi-service","title":"V\u00f2ng \u0110\u1eddi Service","text":"<ol> <li>Create: Thi\u1ebft l\u1eadp service khi project b\u1eaft \u0111\u1ea7u</li> <li>Use: T\u1ea5t c\u1ea3 entity d\u00f9ng c\u00f9ng t\u00ean service nh\u1ea5t qu\u00e1n</li> <li>Monitor: Theo d\u00f5i s\u1ed1 l\u01b0\u1ee3ng entity v\u00e0 API usage</li> <li>Archive: Export d\u1eef li\u1ec7u tr\u01b0\u1edbc khi x\u00f3a service</li> <li>Delete: X\u00f3a service khi project k\u1ebft th\u00fac</li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#can-nhac-bao-mat","title":"C\u00e2n Nh\u1eafc B\u1ea3o M\u1eadt","text":"<ul> <li>Access Control: Service c\u00f3 th\u1ec3 c\u00f3 ch\u00ednh s\u00e1ch truy c\u1eadp kh\u00e1c nhau</li> <li>API Keys: T\u1ea1o key ri\u00eang cho m\u1ed7i service</li> <li>Isolation: Service \u0111\u01b0\u1ee3c t\u00e1ch bi\u1ec7t v\u1ec1 logic</li> <li>Audit: T\u00ean service xu\u1ea5t hi\u1ec7n trong log \u0111\u1ec3 theo d\u00f5i</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#xu-ly-su-co","title":"X\u1eed L\u00fd S\u1ef1 C\u1ed1","text":""},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#entities-not-found","title":"Entities Not Found","text":"<p>V\u1ea5n \u0111\u1ec1: Kh\u00f4ng th\u1ea5y entity \u0111\u00e3 t\u1ea1o tr\u01b0\u1edbc \u0111\u00f3</p> <p>Gi\u1ea3i ph\u00e1p: Ki\u1ec3m tra b\u1ea1n \u0111ang d\u00f9ng c\u00f9ng <code>NGSILD-Tenant</code> header: <pre><code># Li\u1ec7t k\u00ea t\u1ea5t c\u1ea3 tenant (ch\u1ec9 admin)\ncurl -X GET \"https://your-sematx-server.com/admin/tenants\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\"\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#invalid-service-name","title":"Invalid Service Name","text":"<p>V\u1ea5n \u0111\u1ec1: API t\u1eeb ch\u1ed1i t\u00ean service</p> <p>Gi\u1ea3i ph\u00e1p: Ch\u1ec9 d\u00f9ng ch\u1eef th\u01b0\u1eddng, s\u1ed1, v\u00e0 d\u1ea5u g\u1ea1ch ngang: <pre><code>H\u1ee3p l\u1ec7:   my-service-123\nKh\u00f4ng h\u1ee3p l\u1ec7: My Service!, my_service, MyService\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#permission-denied","title":"Permission Denied","text":"<p>V\u1ea5n \u0111\u1ec1: 403 Forbidden khi truy c\u1eadp service</p> <p>Gi\u1ea3i ph\u00e1p: API key c\u00f3 th\u1ec3 kh\u00f4ng c\u00f3 quy\u1ec1n truy c\u1eadp service n\u00e0y. Li\u00ean h\u1ec7 admin ho\u1eb7c d\u00f9ng key \u0111\u00fang.</p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng G\u00ec B\u1ea1n \u0110\u00e3 H\u1ecdc","text":"<p>\u2705 Service l\u00e0 g\u00ec v\u00e0 t\u1ea1i sao ch\u00fang h\u1eefu \u00edch \u2705 C\u00e1ch ch\u1ecdn t\u00ean service \u2705 C\u00e1ch c\u1ea5u h\u00ecnh service trong \u1ee9ng d\u1ee5ng \u2705 C\u00e1ch t\u1ea1o helper function cho API call \u2705 C\u00e1c m\u1eabu t\u1ed5 ch\u1ee9c service \u2705 Th\u1ef1c h\u00e0nh b\u1ea3o m\u1eadt t\u1ed1t nh\u1ea5t cho service  </p>"},{"location":"vi/getting-started/bring-your-own-server/2-create-service/#buoc-tiep-theo","title":"B\u01b0\u1edbc Ti\u1ebfp Theo","text":"<p>B\u00e2y gi\u1edd service \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh, h\u00e3y t\u1ea1o entity \u0111\u1ea7u ti\u00ean:</p> <p>B\u01b0\u1edbc 3: T\u1ea1o Entity \u0110\u1ea7u Ti\u00ean \u2192</p> <p>C\u1ea7n quay l\u1ea1i? V\u1ec1 B\u01b0\u1edbc 1: T\u1ea1o T\u00e0i Kho\u1ea3n</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/","title":"B\u01b0\u1edbc 3: T\u1ea1o Entity \u0110\u1ea7u Ti\u00ean","text":"<p>B\u00e2y gi\u1edd service \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh, h\u00e3y t\u1ea1o entity NGSI-LD \u0111\u1ea7u ti\u00ean. Entity l\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u c\u1ed1t l\u00f5i trong SematX.</p> <p>\u23f1\ufe0f Th\u1eddi gian: 10-15 ph\u00fat \ud83c\udfaf M\u1ee5c ti\u00eau: T\u1ea1o v\u00e0 truy v\u1ea5n entity NGSI-LD \u0111\u1ea7u ti\u00ean</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#entity-la-gi","title":"Entity L\u00e0 G\u00ec?","text":"<p>M\u1ed9t entity \u0111\u1ea1i di\u1ec7n cho m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng th\u1ef1c t\u1ebf trong \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n:</p> <ul> <li>\u0110\u1ed1i T\u01b0\u1ee3ng V\u1eadt L\u00fd: Sensor, thi\u1ebft b\u1ecb, ph\u01b0\u01a1ng ti\u1ec7n, t\u00f2a nh\u00e0</li> <li>\u0110\u1ed1i T\u01b0\u1ee3ng Kh\u00e1i Ni\u1ec7m: C\u1ea3nh b\u00e1o, s\u1ef1 ki\u1ec7n, quan s\u00e1t</li> <li>\u0110\u1ecba \u0110i\u1ec3m: Th\u00e0nh ph\u1ed1, ph\u00f2ng, b\u00e3i \u0111\u1ed7 xe</li> <li>T\u1ed5 Ch\u1ee9c: Ph\u00f2ng ban, team, c\u00f4ng ty</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#cau-truc-entity-ngsi-ld","title":"C\u1ea5u Tr\u00fac Entity NGSI-LD","text":"<p>M\u1ed7i entity c\u00f3 ba th\u00e0nh ph\u1ea7n b\u1eaft bu\u1ed9c:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:EntityType:uniqueId\",\n  \"type\": \"EntityType\",\n  \"@context\": [\"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"]\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#1-entity-id-id","title":"1. Entity ID (<code>id</code>)","text":"<p>M\u00e3 \u0111\u1ecbnh danh duy nh\u1ea5t theo \u0111\u1ecbnh d\u1ea1ng URN:</p> <pre><code>urn:ngsi-ld:EntityType:uniqueIdentifier\n</code></pre> <p>V\u00ed d\u1ee5: <pre><code>urn:ngsi-ld:Sensor:temperature-001\nurn:ngsi-ld:Building:main-campus\nurn:ngsi-ld:Vehicle:bus-42\nurn:ngsi-ld:AirQualityObserved:station-downtown-2025-12-02\n</code></pre></p> <p>Quy t\u1eafc: - Ph\u1ea3i duy nh\u1ea5t trong service - N\u00ean m\u00f4 t\u1ea3 r\u00f5 r\u00e0ng - D\u00f9ng d\u1ea5u g\u1ea1ch ngang \u0111\u1ec3 ph\u00e2n t\u00e1ch t\u1eeb - Bao g\u1ed3m lo\u1ea1i entity \u0111\u1ec3 r\u00f5 r\u00e0ng</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#2-entity-type-type","title":"2. Entity Type (<code>type</code>)","text":"<p>Danh m\u1ee5c ho\u1eb7c l\u1edbp c\u1ee7a entity:</p> <pre><code>Sensor\nBuilding\nVehicle\nAirQualityObserved\nTemperatureObservation\n</code></pre> <p>Quy t\u1eafc: - D\u00f9ng PascalCase (vi\u1ebft hoa m\u1ed7i t\u1eeb) - C\u1ee5 th\u1ec3 (\u01b0u ti\u00ean <code>TemperatureSensor</code> h\u01a1n <code>Sensor</code>) - Tu\u00e2n theo data model chu\u1ea9n khi c\u00f3 th\u1ec3 (FIWARE, SmartDataModels)</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#3-context-context","title":"3. Context (<code>@context</code>)","text":"<p>\u0110\u1ecbnh ngh\u0129a \u00fd ngh\u0129a ng\u1eef ngh\u0129a c\u1ee7a d\u1eef li\u1ec7u:</p> <pre><code>\"@context\": [\n  \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n]\n</code></pre> <p>Trong tutorial n\u00e0y, ch\u00fang ta s\u1ebd d\u00f9ng context NGSI-LD chu\u1ea9n.</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#cac-thuoc-tinh-entity","title":"C\u00e1c Thu\u1ed9c T\u00ednh Entity","text":"<p>Entity c\u00f3 th\u1ec3 c\u00f3 ba lo\u1ea1i thu\u1ed9c t\u00ednh:</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#properties","title":"Properties","text":"<p>Gi\u00e1 tr\u1ecb d\u1eef li\u1ec7u \u0111\u01a1n gi\u1ea3n:</p> <pre><code>\"temperature\": {\n  \"type\": \"Property\",\n  \"value\": 23.5,\n  \"unitCode\": \"CEL\"\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#geoproperties","title":"GeoProperties","text":"<p>V\u1ecb tr\u00ed \u0111\u1ecba l\u00fd:</p> <pre><code>\"location\": {\n  \"type\": \"GeoProperty\",\n  \"value\": {\n    \"type\": \"Point\",\n    \"coordinates\": [105.7800, 10.0300]\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#relationships","title":"Relationships","text":"<p>Li\u00ean k\u1ebft \u0111\u1ebfn entity kh\u00e1c:</p> <pre><code>\"refBuilding\": {\n  \"type\": \"Relationship\",\n  \"object\": \"urn:ngsi-ld:Building:001\"\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#tao-entity-temperature-sensor","title":"T\u1ea1o Entity Temperature Sensor","text":"<p>H\u00e3y t\u1ea1o m\u1ed9t v\u00ed d\u1ee5 th\u1ef1c t\u1ebf: c\u1ea3m bi\u1ebfn nhi\u1ec7t \u0111\u1ed9.</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#thiet-ke-entity","title":"Thi\u1ebft K\u1ebf Entity","text":"<p>Nh\u1eefng g\u00ec ch\u00fang ta \u0111ang m\u00f4 h\u00ecnh h\u00f3a: - M\u1ed9t c\u1ea3m bi\u1ebfn nhi\u1ec7t \u0111\u1ed9 trong Ph\u00f2ng 101 - \u0110\u1eb7t t\u1ea1i t\u1ecda \u0111\u1ed9 c\u1ee5 th\u1ec3 - \u0110o nhi\u1ec7t \u0111\u1ed9 b\u1eb1ng \u0111\u1ed9 C - S\u1ed1 \u0111o cu\u1ed1i: 23.5\u00b0C</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#entity-json-hoan-chinh","title":"Entity JSON Ho\u00e0n Ch\u1ec9nh","text":"<pre><code>{\n  \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n  \"type\": \"TemperatureSensor\",\n  \"@context\": [\n    \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n  ],\n  \"name\": {\n    \"type\": \"Property\",\n    \"value\": \"Temperature Sensor - Room 101\"\n  },\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 23.5,\n    \"unitCode\": \"CEL\",\n    \"observedAt\": \"2025-12-02T10:00:00Z\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"status\": {\n    \"type\": \"Property\",\n    \"value\": \"active\"\n  },\n  \"batteryLevel\": {\n    \"type\": \"Property\",\n    \"value\": 85,\n    \"unitCode\": \"P1\"\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#tao-entity-qua-api","title":"T\u1ea1o Entity qua API","text":""},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#dung-curl","title":"D\u00f9ng curl","text":"<pre><code>curl -X POST \"https://your-sematx-server.com/ngsi-ld/v1/entities\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n    \"type\": \"TemperatureSensor\",\n    \"@context\": [\n      \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n    ],\n    \"name\": {\n      \"type\": \"Property\",\n      \"value\": \"Temperature Sensor - Room 101\"\n    },\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 23.5,\n      \"unitCode\": \"CEL\",\n      \"observedAt\": \"2025-12-02T10:00:00Z\"\n    },\n    \"location\": {\n      \"type\": \"GeoProperty\",\n      \"value\": {\n        \"type\": \"Point\",\n        \"coordinates\": [105.7800, 10.0300]\n      }\n    },\n    \"status\": {\n      \"type\": \"Property\",\n      \"value\": \"active\"\n    },\n    \"batteryLevel\": {\n      \"type\": \"Property\",\n      \"value\": 85,\n      \"unitCode\": \"P1\"\n    }\n  }'\n</code></pre> <p>Ph\u1ea3n h\u1ed3i mong \u0111\u1ee3i: <pre><code>HTTP/1.1 201 Created\nLocation: /ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#dung-javascript","title":"D\u00f9ng JavaScript","text":"<pre><code>import { client } from './sematx-client.js';\n\nasync function createSensor() {\n  const entity = {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-101',\n    type: 'TemperatureSensor',\n    '@context': [\n      'https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld'\n    ],\n    name: {\n      type: 'Property',\n      value: 'Temperature Sensor - Room 101'\n    },\n    temperature: {\n      type: 'Property',\n      value: 23.5,\n      unitCode: 'CEL',\n      observedAt: new Date().toISOString()\n    },\n    location: {\n      type: 'GeoProperty',\n      value: {\n        type: 'Point',\n        coordinates: [105.7800, 10.0300]\n      }\n    },\n    status: {\n      type: 'Property',\n      value: 'active'\n    },\n    batteryLevel: {\n      type: 'Property',\n      value: 85,\n      unitCode: 'P1'\n    }\n  };\n\n  try {\n    await client.createEntity(entity);\n    console.log('\u2705 Entity created successfully!');\n  } catch (error) {\n    console.error('\u274c Failed to create entity:', error.message);\n  }\n}\n\ncreateSensor();\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#dung-python","title":"D\u00f9ng Python","text":"<pre><code>from sematx_client import client\nfrom datetime import datetime\n\ndef create_sensor():\n    entity = {\n        'id': 'urn:ngsi-ld:TemperatureSensor:room-101',\n        'type': 'TemperatureSensor',\n        '@context': [\n            'https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld'\n        ],\n        'name': {\n            'type': 'Property',\n            'value': 'Temperature Sensor - Room 101'\n        },\n        'temperature': {\n            'type': 'Property',\n            'value': 23.5,\n            'unitCode': 'CEL',\n            'observedAt': datetime.utcnow().isoformat() + 'Z'\n        },\n        'location': {\n            'type': 'GeoProperty',\n            'value': {\n                'type': 'Point',\n                'coordinates': [105.7800, 10.0300]\n            }\n        },\n        'status': {\n            'type': 'Property',\n            'value': 'active'\n        },\n        'batteryLevel': {\n            'type': 'Property',\n            'value': 85,\n            'unitCode': 'P1'\n        }\n    }\n\n    try:\n        client.create_entity(entity)\n        print('\u2705 Entity created successfully!')\n    except Exception as error:\n        print(f'\u274c Failed to create entity: {error}')\n\ncreate_sensor()\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#truy-van-entity","title":"Truy V\u1ea5n Entity","text":""},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#lay-entity-theo-id","title":"L\u1ea5y Entity Theo ID","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#truy-van-entity-theo-type","title":"Truy V\u1ea5n Entity Theo Type","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?type=TemperatureSensor\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Accept: application/ld+json\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#truy-van-voi-bo-loc","title":"Truy V\u1ea5n V\u1edbi B\u1ed9 L\u1ecdc","text":"<p>L\u1ecdc entity theo gi\u00e1 tr\u1ecb thu\u1ed9c t\u00ednh:</p> <pre><code># Sensor c\u00f3 nhi\u1ec7t \u0111\u1ed9 &gt; 25\ncurl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?type=TemperatureSensor&amp;q=temperature&gt;25\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#truy-van-theo-vi-tri","title":"Truy V\u1ea5n Theo V\u1ecb Tr\u00ed","text":"<p>T\u00ecm entity g\u1ea7n m\u1ed9t \u0111i\u1ec3m:</p> <pre><code># Sensor trong b\u00e1n k\u00ednh 1km t\u1eeb t\u1ecda \u0111\u1ed9\ncurl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/entities?type=TemperatureSensor&amp;geometry=Point&amp;coordinates=[105.7800,10.0300]&amp;georel=near;maxDistance==1000\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#hieu-ve-unit-code","title":"Hi\u1ec3u v\u1ec1 Unit Code","text":"<p>NGSI-LD d\u00f9ng m\u00e3 \u0111\u01a1n v\u1ecb chu\u1ea9n t\u1eeb UN/CEFACT:</p> \u0110\u01a1n v\u1ecb M\u00e3 V\u00ed d\u1ee5 Celsius <code>CEL</code> Nhi\u1ec7t \u0111\u1ed9 Fahrenheit <code>FAH</code> Nhi\u1ec7t \u0111\u1ed9 Percent <code>P1</code> Pin, \u0111\u1ed9 \u1ea9m Meters <code>MTR</code> Kho\u1ea3ng c\u00e1ch Kilometers <code>KMT</code> Kho\u1ea3ng c\u00e1ch Kilograms <code>KGM</code> Kh\u1ed1i l\u01b0\u1ee3ng Liters <code>LTR</code> Th\u1ec3 t\u00edch Watts <code>WTT</code> C\u00f4ng su\u1ea5t Lux <code>LUX</code> C\u01b0\u1eddng \u0111\u1ed9 \u00e1nh s\u00e1ng Pascal <code>PAL</code> \u00c1p su\u1ea5t Parts per million <code>59</code> Ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#cac-mau-entity-pho-bien","title":"C\u00e1c M\u1eabu Entity Ph\u1ed5 Bi\u1ebfn","text":""},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#observation-entity","title":"Observation Entity","text":"<p>Cho s\u1ed1 \u0111o c\u1ea3m bi\u1ebfn:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:AirQualityObserved:station-01-20251202\",\n  \"type\": \"AirQualityObserved\",\n  \"dateObserved\": {\n    \"type\": \"Property\",\n    \"value\": {\"@type\": \"DateTime\", \"@value\": \"2025-12-02T10:00:00Z\"}\n  },\n  \"PM25\": {\n    \"type\": \"Property\",\n    \"value\": 35,\n    \"unitCode\": \"GQ\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\"type\": \"Point\", \"coordinates\": [105.78, 10.03]}\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#device-entity","title":"Device Entity","text":"<p>Cho thi\u1ebft b\u1ecb IoT:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Device:sensor-001\",\n  \"type\": \"Device\",\n  \"name\": {\"type\": \"Property\", \"value\": \"Environmental Sensor\"},\n  \"serialNumber\": {\"type\": \"Property\", \"value\": \"SN12345678\"},\n  \"hardwareVersion\": {\"type\": \"Property\", \"value\": \"v2.1\"},\n  \"firmwareVersion\": {\"type\": \"Property\", \"value\": \"v1.5.2\"},\n  \"batteryLevel\": {\"type\": \"Property\", \"value\": 85, \"unitCode\": \"P1\"},\n  \"rssi\": {\"type\": \"Property\", \"value\": -75, \"unitCode\": \"DBM\"}\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#building-entity","title":"Building Entity","text":"<p>Cho c\u00f4ng tr\u00ecnh:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Building:campus-main\",\n  \"type\": \"Building\",\n  \"name\": {\"type\": \"Property\", \"value\": \"Main Campus Building\"},\n  \"address\": {\n    \"type\": \"Property\",\n    \"value\": {\n      \"streetAddress\": \"123 University Ave\",\n      \"addressLocality\": \"Can Tho\",\n      \"postalCode\": \"900000\",\n      \"addressCountry\": \"VN\"\n    }\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\"type\": \"Point\", \"coordinates\": [105.78, 10.03]}\n  },\n  \"category\": {\"type\": \"Property\", \"value\": [\"educational\"]},\n  \"floorsAboveGround\": {\"type\": \"Property\", \"value\": 5}\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#thuc-hanh-tot-nhat","title":"Th\u1ef1c H\u00e0nh T\u1ed1t Nh\u1ea5t","text":""},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#thiet-ke-entity-id","title":"Thi\u1ebft K\u1ebf Entity ID","text":"<p>\u2705 ID T\u1ed1t: <pre><code>urn:ngsi-ld:Sensor:temperature-room-101\nurn:ngsi-ld:Vehicle:bus-line-3-unit-42\nurn:ngsi-ld:AirQualityObserved:station-downtown-2025-12-02T10:00:00Z\n</code></pre></p> <p>\u274c ID Kh\u00f4ng T\u1ed1t: <pre><code>123\ntemp_sensor\nsensor1\nurn:ngsi-ld:Entity:001  (qu\u00e1 chung chung)\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#at-ten-thuoc-tinh","title":"\u0110\u1eb7t T\u00ean Thu\u1ed9c T\u00ednh","text":"<p>\u2705 T\u00ean T\u1ed1t: - <code>temperature</code> (ch\u1eef th\u01b0\u1eddng, m\u00f4 t\u1ea3 r\u00f5) - <code>batteryLevel</code> (camelCase) - <code>PM25</code> (vi\u1ebft t\u1eaft chu\u1ea9n)</p> <p>\u274c T\u00ean Kh\u00f4ng T\u1ed1t: - <code>temp</code> (vi\u1ebft t\u1eaft) - <code>Temperature</code> (n\u00ean l\u00e0 ch\u1eef th\u01b0\u1eddng) - <code>battery_level</code> (d\u00f9ng camelCase, kh\u00f4ng ph\u1ea3i snake_case)</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#dung-standard-data-model","title":"D\u00f9ng Standard Data Model","text":"<p>Khi c\u00f3 th\u1ec3, d\u00f9ng FIWARE Smart Data Models:</p> <ul> <li>Ch\u1ea5t L\u01b0\u1ee3ng Kh\u00f4ng Kh\u00ed: <code>AirQualityObserved</code></li> <li>Th\u1eddi Ti\u1ebft: <code>WeatherObserved</code></li> <li>B\u00e3i \u0110\u1ed7 Xe: <code>ParkingSpot</code>, <code>ParkingLot</code></li> <li>Giao Th\u00f4ng: <code>TrafficFlowObserved</code></li> <li>R\u00e1c Th\u1ea3i: <code>WasteContainer</code></li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#xu-ly-su-co","title":"X\u1eed L\u00fd S\u1ef1 C\u1ed1","text":""},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#409-conflict-entity-already-exists","title":"409 Conflict - Entity Already Exists","text":"<p>V\u1ea5n \u0111\u1ec1: Entity v\u1edbi c\u00f9ng ID \u0111\u00e3 t\u1ed3n t\u1ea1i</p> <p>Gi\u1ea3i ph\u00e1p: 1. D\u00f9ng ID kh\u00e1c 2. X\u00f3a entity hi\u1ec7n c\u00f3 tr\u01b0\u1edbc 3. C\u1eadp nh\u1eadt entity hi\u1ec7n c\u00f3 thay v\u00ec t\u1ea1o m\u1edbi</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#400-bad-request-invalid-entity","title":"400 Bad Request - Invalid Entity","text":"<p>V\u1ea5n \u0111\u1ec1: \u0110\u1ecbnh d\u1ea1ng entity kh\u00f4ng h\u1ee3p l\u1ec7</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra c\u00fa ph\u00e1p JSON (d\u00f9ng JSON validator) 2. X\u00e1c minh c\u00e1c tr\u01b0\u1eddng b\u1eaft bu\u1ed9c (<code>id</code>, <code>type</code>, <code>@context</code>) 3. Ki\u1ec3m tra c\u1ea5u tr\u00fac thu\u1ed9c t\u00ednh (<code>type</code>, <code>value</code>) 4. X\u00e1c th\u1ef1c \u0111\u1ecbnh d\u1ea1ng t\u1ecda \u0111\u1ed9 <code>[longitude, latitude]</code></p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#422-unprocessable-entity","title":"422 Unprocessable Entity","text":"<p>V\u1ea5n \u0111\u1ec1: JSON h\u1ee3p l\u1ec7 nh\u01b0ng \u0111\u1ecbnh d\u1ea1ng NGSI-LD kh\u00f4ng h\u1ee3p l\u1ec7</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra vi\u1ebft hoa entity type 2. X\u00e1c minh \u0111\u1ecbnh d\u1ea1ng URN cho entity ID 3. \u0110\u1ea3m b\u1ea3o property c\u00f3 <code>type</code> v\u00e0 <code>value</code> 4. Ki\u1ec3m tra \u0111\u1ecbnh d\u1ea1ng GeoJSON cho v\u1ecb tr\u00ed</p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng G\u00ec B\u1ea1n \u0110\u00e3 H\u1ecdc","text":"<p>\u2705 C\u1ea5u tr\u00fac v\u00e0 th\u00e0nh ph\u1ea7n entity NGSI-LD \u2705 C\u00e1ch thi\u1ebft k\u1ebf entity ID v\u00e0 type \u2705 Thu\u1ed9c t\u00ednh Property, GeoProperty, v\u00e0 Relationship \u2705 C\u00e1ch t\u1ea1o entity qua API \u2705 C\u00e1ch truy v\u1ea5n entity v\u1edbi b\u1ed9 l\u1ecdc \u2705 M\u00e3 \u0111\u01a1n v\u1ecb chu\u1ea9n v\u00e0 data model \u2705 C\u00e1c m\u1eabu entity ph\u1ed5 bi\u1ebfn v\u00e0 th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t  </p>"},{"location":"vi/getting-started/bring-your-own-server/3-create-entity/#buoc-tiep-theo","title":"B\u01b0\u1edbc Ti\u1ebfp Theo","text":"<p>B\u00e2y gi\u1edd b\u1ea1n c\u00f3 th\u1ec3 t\u1ea1o entity, h\u00e3y h\u1ecdc c\u00e1ch \u0111\u1ea9y d\u1eef li\u1ec7u t\u1eeb \u1ee9ng d\u1ee5ng:</p> <p>B\u01b0\u1edbc 4: \u0110\u1ea9y D\u1eef Li\u1ec7u \u2192</p> <p>C\u1ea7n quay l\u1ea1i? V\u1ec1 B\u01b0\u1edbc 2: T\u1ea1o Service</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/","title":"B\u01b0\u1edbc 4: \u0110\u1ea9y D\u1eef Li\u1ec7u","text":"<p>B\u00e2y gi\u1edd b\u1ea1n \u0111\u00e3 t\u1ea1o entity, h\u00e3y h\u1ecdc c\u00e1ch \u0111\u1ea9y d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c t\u1eeb \u1ee9ng d\u1ee5ng \u0111\u1ebfn SematX. \u0110\u00e2y l\u00e0 l\u00fac \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n tr\u1edf n\u00ean s\u1ed1ng \u0111\u1ed9ng!</p> <p>\u23f1\ufe0f Th\u1eddi gian: 15-20 ph\u00fat \ud83c\udfaf M\u1ee5c ti\u00eau: G\u1eedi c\u1eadp nh\u1eadt d\u1eef li\u1ec7u li\u00ean t\u1ee5c t\u1eeb \u1ee9ng d\u1ee5ng</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#update-vs-create","title":"Update vs Create","text":"<p>C\u00f3 hai c\u00e1ch \u0111\u1ec3 g\u1eedi d\u1eef li\u1ec7u \u0111\u1ebfn SematX:</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#update-entity-attributes-patch","title":"Update Entity Attributes (PATCH)","text":"<p>D\u00f9ng khi: Entity \u0111\u00e3 t\u1ed3n t\u1ea1i, ch\u1ec9 c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb</p> <pre><code>PATCH /ngsi-ld/v1/entities/{entityId}/attrs\n</code></pre> <p>\u01afu \u0111i\u1ec3m: - Nhanh h\u01a1n (kh\u00f4ng c\u1ea7n entity \u0111\u1ea7y \u0111\u1ee7) - Ch\u1ec9 c\u1eadp nh\u1eadt thu\u1ed9c t\u00ednh \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh - Gi\u1eef nguy\u00ean c\u00e1c thu\u1ed9c t\u00ednh kh\u00e1c - Idempotent (an to\u00e0n \u0111\u1ec3 retry)</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#upsert-entity-post","title":"Upsert Entity (POST)","text":"<p>D\u00f9ng khi: Entity c\u00f3 th\u1ec3 t\u1ed3n t\u1ea1i ho\u1eb7c kh\u00f4ng</p> <pre><code>POST /ngsi-ld/v1/entityOperations/upsert\n</code></pre> <p>\u01afu \u0111i\u1ec3m: - T\u1ea1o entity n\u1ebfu thi\u1ebfu - C\u1eadp nh\u1eadt n\u1ebfu t\u1ed3n t\u1ea1i - T\u1ed1t cho batch operation - X\u1eed l\u00fd l\u1ed7i \u0111\u01a1n gi\u1ea3n h\u01a1n</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#ay-du-lieu-on-gian","title":"\u0110\u1ea9y D\u1eef Li\u1ec7u \u0110\u01a1n Gi\u1ea3n","text":""},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#cap-nhat-so-o-nhiet-o","title":"C\u1eadp Nh\u1eadt S\u1ed1 \u0110o Nhi\u1ec7t \u0110\u1ed9","text":"<p>H\u00e3y c\u1eadp nh\u1eadt c\u1ea3m bi\u1ebfn nhi\u1ec7t \u0111\u1ed9 v\u1edbi s\u1ed1 \u0111o m\u1edbi:</p> <pre><code>curl -X PATCH \"https://your-sematx-server.com/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101/attrs\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 24.8,\n      \"unitCode\": \"CEL\",\n      \"observedAt\": \"2025-12-02T10:15:00Z\"\n    }\n  }'\n</code></pre> <p>Ph\u1ea3n h\u1ed3i: <code>204 No Content</code> (th\u00e0nh c\u00f4ng)</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#trien-khai-javascript","title":"Tri\u1ec3n Khai JavaScript","text":"<pre><code>import { client } from './sematx-client.js';\n\nasync function updateTemperature(entityId, temperature) {\n  const attributes = {\n    temperature: {\n      type: 'Property',\n      value: temperature,\n      unitCode: 'CEL',\n      observedAt: new Date().toISOString()\n    }\n  };\n\n  try {\n    await client.updateEntity(entityId, attributes);\n    console.log(`\u2705 Updated ${entityId}: ${temperature}\u00b0C`);\n    return true;\n  } catch (error) {\n    console.error(`\u274c Failed to update: ${error.message}`);\n    return false;\n  }\n}\n\n// V\u00ed d\u1ee5 s\u1eed d\u1ee5ng\nawait updateTemperature('urn:ngsi-ld:TemperatureSensor:room-101', 24.8);\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#trien-khai-python","title":"Tri\u1ec3n Khai Python","text":"<pre><code>from sematx_client import client\nfrom datetime import datetime\n\ndef update_temperature(entity_id: str, temperature: float) -&gt; bool:\n    attributes = {\n        'temperature': {\n            'type': 'Property',\n            'value': temperature,\n            'unitCode': 'CEL',\n            'observedAt': datetime.utcnow().isoformat() + 'Z'\n        }\n    }\n\n    try:\n        client.update_entity(entity_id, attributes)\n        print(f'\u2705 Updated {entity_id}: {temperature}\u00b0C')\n        return True\n    except Exception as error:\n        print(f'\u274c Failed to update: {error}')\n        return False\n\n# V\u00ed d\u1ee5 s\u1eed d\u1ee5ng\nupdate_temperature('urn:ngsi-ld:TemperatureSensor:room-101', 24.8)\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#streaming-du-lieu-lien-tuc","title":"Streaming D\u1eef Li\u1ec7u Li\u00ean T\u1ee5c","text":""},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#polling-du-lieu-sensor","title":"Polling D\u1eef Li\u1ec7u Sensor","text":"<p>\u0110\u1ecdc t\u1eeb sensor v\u00e0 \u0111\u1ea9y \u0111\u1ebfn SematX li\u00ean t\u1ee5c:</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#javascript","title":"JavaScript","text":"<pre><code>import { client } from './sematx-client.js';\n\nclass SensorDataPusher {\n  constructor(entityId, intervalMs = 60000) {\n    this.entityId = entityId;\n    this.intervalMs = intervalMs;\n    this.isRunning = false;\n    this.intervalId = null;\n  }\n\n  // M\u00f4 ph\u1ecfng \u0111\u1ecdc t\u1eeb sensor th\u1ef1c t\u1ebf\n  async readSensor() {\n    // Thay th\u1ebf b\u1eb1ng logic \u0111\u1ecdc sensor th\u1ef1c t\u1ebf\n    return {\n      temperature: 20 + Math.random() * 10, // 20-30\u00b0C\n      humidity: 40 + Math.random() * 30,    // 40-70%\n      pressure: 1000 + Math.random() * 30   // 1000-1030 hPa\n    };\n  }\n\n  async pushData() {\n    try {\n      const reading = await this.readSensor();\n\n      const attributes = {\n        temperature: {\n          type: 'Property',\n          value: reading.temperature,\n          unitCode: 'CEL',\n          observedAt: new Date().toISOString()\n        },\n        humidity: {\n          type: 'Property',\n          value: reading.humidity,\n          unitCode: 'P1',\n          observedAt: new Date().toISOString()\n        },\n        pressure: {\n          type: 'Property',\n          value: reading.pressure,\n          unitCode: 'PAL',\n          observedAt: new Date().toISOString()\n        }\n      };\n\n      await client.updateEntity(this.entityId, attributes);\n\n      console.log(`[${new Date().toISOString()}] Pushed data:`, {\n        temp: reading.temperature.toFixed(1),\n        humidity: reading.humidity.toFixed(1),\n        pressure: reading.pressure.toFixed(0)\n      });\n\n      return true;\n    } catch (error) {\n      console.error(`[${new Date().toISOString()}] Error:`, error.message);\n      return false;\n    }\n  }\n\n  start() {\n    if (this.isRunning) {\n      console.log('\u26a0\ufe0f Data pusher already running');\n      return;\n    }\n\n    this.isRunning = true;\n    console.log(`\ud83d\ude80 Starting data pusher (interval: ${this.intervalMs}ms)`);\n\n    // \u0110\u1ea9y ngay l\u1eadp t\u1ee9c\n    this.pushData();\n\n    // Sau \u0111\u00f3 \u0111\u1ea9y theo kho\u1ea3ng th\u1eddi gian\n    this.intervalId = setInterval(() =&gt; {\n      this.pushData();\n    }, this.intervalMs);\n  }\n\n  stop() {\n    if (!this.isRunning) {\n      return;\n    }\n\n    clearInterval(this.intervalId);\n    this.isRunning = false;\n    console.log('\ud83d\uded1 Data pusher stopped');\n  }\n}\n\n// S\u1eed d\u1ee5ng\nconst pusher = new SensorDataPusher(\n  'urn:ngsi-ld:TemperatureSensor:room-101',\n  60000  // \u0110\u1ea9y m\u1ed7i 60 gi\u00e2y\n);\n\npusher.start();\n\n// D\u1eebng sau 5 ph\u00fat (cho demo)\nsetTimeout(() =&gt; pusher.stop(), 5 * 60 * 1000);\n\n// T\u1eaft graceful\nprocess.on('SIGINT', () =&gt; {\n  console.log('\\\\n\ud83d\uded1 Shutting down...');\n  pusher.stop();\n  process.exit(0);\n});\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#python","title":"Python","text":"<pre><code>import time\nimport signal\nimport random\nfrom datetime import datetime\nfrom sematx_client import client\n\nclass SensorDataPusher:\n    def __init__(self, entity_id: str, interval_seconds: int = 60):\n        self.entity_id = entity_id\n        self.interval_seconds = interval_seconds\n        self.is_running = False\n\n    def read_sensor(self) -&gt; dict:\n        \"\"\"M\u00f4 ph\u1ecfng \u0111\u1ecdc t\u1eeb sensor th\u1ef1c t\u1ebf\"\"\"\n        # Thay th\u1ebf b\u1eb1ng logic \u0111\u1ecdc sensor th\u1ef1c t\u1ebf\n        return {\n            'temperature': 20 + random.random() * 10,  # 20-30\u00b0C\n            'humidity': 40 + random.random() * 30,     # 40-70%\n            'pressure': 1000 + random.random() * 30    # 1000-1030 hPa\n        }\n\n    def push_data(self) -&gt; bool:\n        \"\"\"\u0110\u1ecdc sensor v\u00e0 \u0111\u1ea9y \u0111\u1ebfn SematX\"\"\"\n        try:\n            reading = self.read_sensor()\n\n            attributes = {\n                'temperature': {\n                    'type': 'Property',\n                    'value': reading['temperature'],\n                    'unitCode': 'CEL',\n                    'observedAt': datetime.utcnow().isoformat() + 'Z'\n                },\n                'humidity': {\n                    'type': 'Property',\n                    'value': reading['humidity'],\n                    'unitCode': 'P1',\n                    'observedAt': datetime.utcnow().isoformat() + 'Z'\n                },\n                'pressure': {\n                    'type': 'Property',\n                    'value': reading['pressure'],\n                    'unitCode': 'PAL',\n                    'observedAt': datetime.utcnow().isoformat() + 'Z'\n                }\n            }\n\n            client.update_entity(self.entity_id, attributes)\n\n            timestamp = datetime.utcnow().isoformat()\n            print(f'[{timestamp}] Pushed data:', {\n                'temp': f\"{reading['temperature']:.1f}\",\n                'humidity': f\"{reading['humidity']:.1f}\",\n                'pressure': f\"{reading['pressure']:.0f}\"\n            })\n\n            return True\n        except Exception as error:\n            timestamp = datetime.utcnow().isoformat()\n            print(f'[{timestamp}] Error: {error}')\n            return False\n\n    def start(self):\n        \"\"\"B\u1eaft \u0111\u1ea7u \u0111\u1ea9y d\u1eef li\u1ec7u theo kho\u1ea3ng th\u1eddi gian\"\"\"\n        if self.is_running:\n            print('\u26a0\ufe0f Data pusher already running')\n            return\n\n        self.is_running = True\n        print(f'\ud83d\ude80 Starting data pusher (interval: {self.interval_seconds}s)')\n\n        # Thi\u1ebft l\u1eadp signal handler \u0111\u1ec3 t\u1eaft graceful\n        signal.signal(signal.SIGINT, lambda s, f: self.stop())\n\n        # \u0110\u1ea9y ngay l\u1eadp t\u1ee9c\n        self.push_data()\n\n        # Sau \u0111\u00f3 \u0111\u1ea9y theo kho\u1ea3ng th\u1eddi gian\n        try:\n            while self.is_running:\n                time.sleep(self.interval_seconds)\n                if self.is_running:\n                    self.push_data()\n        except KeyboardInterrupt:\n            self.stop()\n\n    def stop(self):\n        \"\"\"D\u1eebng \u0111\u1ea9y d\u1eef li\u1ec7u\"\"\"\n        if not self.is_running:\n            return\n\n        self.is_running = False\n        print('\\\\n\ud83d\uded1 Data pusher stopped')\n\n# S\u1eed d\u1ee5ng\nif __name__ == '__main__':\n    pusher = SensorDataPusher(\n        'urn:ngsi-ld:TemperatureSensor:room-101',\n        interval_seconds=60  # \u0110\u1ea9y m\u1ed7i 60 gi\u00e2y\n    )\n\n    pusher.start()\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#cap-nhat-hang-loat","title":"C\u1eadp Nh\u1eadt H\u00e0ng Lo\u1ea1t","text":"<p>Cho nhi\u1ec1u entity, d\u00f9ng batch operation:</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#cap-nhat-nhieu-entity","title":"C\u1eadp Nh\u1eadt Nhi\u1ec1u Entity","text":"<pre><code>async function batchUpdate(updates) {\n  const payload = {\n    actionType: 'update',\n    entities: updates\n  };\n\n  const response = await fetch(\n    `${sematxConfig.url}/ngsi-ld/v1/entityOperations/upsert`,\n    {\n      method: 'POST',\n      headers: sematxConfig.headers,\n      body: JSON.stringify(payload)\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error(`Batch update failed: ${response.status}`);\n  }\n\n  const result = await response.json();\n  console.log(`\u2705 Updated ${result.success?.length || 0} entities`);\n\n  if (result.errors?.length &gt; 0) {\n    console.error(`\u274c Failed ${result.errors.length} entities`);\n  }\n}\n\n// V\u00ed d\u1ee5: C\u1eadp nh\u1eadt nhi\u1ec1u sensor\nconst updates = [\n  {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-101',\n    type: 'TemperatureSensor',\n    temperature: { type: 'Property', value: 24.5, unitCode: 'CEL' }\n  },\n  {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-102',\n    type: 'TemperatureSensor',\n    temperature: { type: 'Property', value: 23.8, unitCode: 'CEL' }\n  },\n  {\n    id: 'urn:ngsi-ld:TemperatureSensor:room-103',\n    type: 'TemperatureSensor',\n    temperature: { type: 'Property', value: 25.2, unitCode: 'CEL' }\n  }\n];\n\nawait batchUpdate(updates);\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#xu-ly-loi","title":"X\u1eed L\u00fd L\u1ed7i","text":""},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#retry-voi-exponential-backoff","title":"Retry v\u1edbi Exponential Backoff","text":"<pre><code>class DataPusher {\n  async pushWithRetry(entityId, attributes, maxRetries = 3) {\n    for (let attempt = 0; attempt &lt; maxRetries; attempt++) {\n      try {\n        await client.updateEntity(entityId, attributes);\n        return true;\n      } catch (error) {\n        if (attempt === maxRetries - 1) {\n          console.error(`\u274c Failed after ${maxRetries} attempts`);\n          throw error;\n        }\n\n        const delay = Math.pow(2, attempt) * 1000; // 1s, 2s, 4s\n        console.log(`\u26a0\ufe0f Attempt ${attempt + 1} failed, retrying in ${delay}ms...`);\n        await new Promise(resolve =&gt; setTimeout(resolve, delay));\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#queue-failed-updates","title":"Queue Failed Updates","text":"<pre><code>class DataPusher {\n  constructor(entityId) {\n    this.entityId = entityId;\n    this.failedQueue = [];\n  }\n\n  async pushData(attributes) {\n    try {\n      await client.updateEntity(this.entityId, attributes);\n\n      // N\u1ebfu th\u00e0nh c\u00f4ng v\u00e0 queue c\u00f3 item, th\u1eed flush queue\n      if (this.failedQueue.length &gt; 0) {\n        await this.flushQueue();\n      }\n\n      return true;\n    } catch (error) {\n      console.error('\u274c Push failed, queueing for retry:', error.message);\n      this.failedQueue.push({ attributes, timestamp: Date.now() });\n      return false;\n    }\n  }\n\n  async flushQueue() {\n    console.log(`\ud83d\udd04 Flushing ${this.failedQueue.length} queued updates...`);\n\n    const queue = [...this.failedQueue];\n    this.failedQueue = [];\n\n    for (const item of queue) {\n      try {\n        await client.updateEntity(this.entityId, item.attributes);\n        console.log('\u2705 Queued update successful');\n      } catch (error) {\n        console.error('\u274c Queued update still failing');\n        this.failedQueue.push(item);\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#xac-thuc-du-lieu","title":"X\u00e1c Th\u1ef1c D\u1eef Li\u1ec7u","text":""},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#xac-thuc-truoc-khi-ay","title":"X\u00e1c Th\u1ef1c Tr\u01b0\u1edbc Khi \u0110\u1ea9y","text":"<pre><code>function validateReading(reading) {\n  const errors = [];\n\n  // Ki\u1ec3m tra d\u1ea3i nhi\u1ec7t \u0111\u1ed9\n  if (reading.temperature &lt; -50 || reading.temperature &gt; 100) {\n    errors.push(`Invalid temperature: ${reading.temperature}`);\n  }\n\n  // Ki\u1ec3m tra d\u1ea3i \u0111\u1ed9 \u1ea9m\n  if (reading.humidity &lt; 0 || reading.humidity &gt; 100) {\n    errors.push(`Invalid humidity: ${reading.humidity}`);\n  }\n\n  // Ki\u1ec3m tra d\u1ea3i \u00e1p su\u1ea5t\n  if (reading.pressure &lt; 900 || reading.pressure &gt; 1100) {\n    errors.push(`Invalid pressure: ${reading.pressure}`);\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n}\n\nasync function pushValidatedData(entityId, reading) {\n  const validation = validateReading(reading);\n\n  if (!validation.isValid) {\n    console.error('\u274c Invalid reading:', validation.errors);\n    return false;\n  }\n\n  return await client.updateEntity(entityId, {\n    temperature: {\n      type: 'Property',\n      value: reading.temperature,\n      unitCode: 'CEL',\n      observedAt: new Date().toISOString()\n    },\n    humidity: {\n      type: 'Property',\n      value: reading.humidity,\n      unitCode: 'P1',\n      observedAt: new Date().toISOString()\n    },\n    pressure: {\n      type: 'Property',\n      value: reading.pressure,\n      unitCode: 'PAL',\n      observedAt: new Date().toISOString()\n    }\n  });\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#thuc-hanh-tot-nhat","title":"Th\u1ef1c H\u00e0nh T\u1ed1t Nh\u1ea5t","text":""},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#tan-suat-cap-nhat","title":"T\u1ea7n Su\u1ea5t C\u1eadp Nh\u1eadt","text":"<p>H\u01b0\u1edbng d\u1eabn: - D\u1eef li\u1ec7u thay \u0111\u1ed5i nhanh: M\u1ed7i 1-5 gi\u00e2y (v\u1ecb tr\u00ed xe, gi\u00e1m s\u00e1t th\u1eddi gian th\u1ef1c) - C\u1eadp nh\u1eadt b\u00ecnh th\u01b0\u1eddng: M\u1ed7i 30-60 gi\u00e2y (s\u1ed1 \u0111o c\u1ea3m bi\u1ebfn) - D\u1eef li\u1ec7u thay \u0111\u1ed5i ch\u1eadm: M\u1ed7i 5-15 ph\u00fat (th\u1eddi ti\u1ebft, ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed) - C\u1eadp nh\u1eadt hi\u1ebfm: Ch\u1ec9 khi thay \u0111\u1ed5i (tr\u1ea1ng th\u00e1i thi\u1ebft b\u1ecb, c\u1ea5u h\u00ecnh)</p> <p>C\u00e2n nh\u1eafc: - Rate limit tr\u00ean API key - B\u0103ng th\u00f4ng m\u1ea1ng - Tu\u1ed5i th\u1ecd pin (cho thi\u1ebft b\u1ecb d\u00f9ng pin) - Chi ph\u00ed l\u01b0u tr\u1eef</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#quan-ly-timestamp","title":"Qu\u1ea3n L\u00fd Timestamp","text":"<p>Lu\u00f4n bao g\u1ed3m timestamp <code>observedAt</code>:</p> <pre><code>{\n  temperature: {\n    type: 'Property',\n    value: 24.5,\n    unitCode: 'CEL',\n    observedAt: new Date().toISOString()  // \u2705 Bao g\u1ed3m timestamp\n  }\n}\n</code></pre> <p>\u0110i\u1ec1u n\u00e0y cho ph\u00e9p: - Truy v\u1ea5n theo th\u1eddi gian (d\u1eef li\u1ec7u l\u1ecbch s\u1eed) - X\u1eed l\u00fd d\u1eef li\u1ec7u kh\u00f4ng theo th\u1ee9 t\u1ef1 - Ph\u00e2n t\u00edch ch\u1ea5t l\u01b0\u1ee3ng d\u1eef li\u1ec7u - Tr\u1ef1c quan h\u00f3a chu\u1ed7i th\u1eddi gian</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#quan-ly-ket-noi","title":"Qu\u1ea3n L\u00fd K\u1ebft N\u1ed1i","text":"<pre><code>// \u2705 T\u1ed1t: D\u00f9ng l\u1ea1i k\u1ebft n\u1ed1i\nconst client = new SematXClient(config);\n\n// \u274c Kh\u00f4ng t\u1ed1t: T\u1ea1o k\u1ebft n\u1ed1i m\u1edbi m\u1ed7i l\u1ea7n\nfunction updateData() {\n  const client = new SematXClient(config); // \u0110\u1eebng l\u00e0m th\u1ebf n\u00e0y!\n  client.updateEntity(...)\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#giam-sat-hieu-suat","title":"Gi\u00e1m S\u00e1t Hi\u1ec7u Su\u1ea5t","text":"<pre><code>class DataPusher {\n  constructor() {\n    this.stats = {\n      totalPushes: 0,\n      successCount: 0,\n      errorCount: 0,\n      avgLatency: 0\n    };\n  }\n\n  async pushData(entityId, attributes) {\n    const startTime = Date.now();\n\n    try {\n      await client.updateEntity(entityId, attributes);\n\n      const latency = Date.now() - startTime;\n      this.stats.totalPushes++;\n      this.stats.successCount++;\n      this.stats.avgLatency = \n        (this.stats.avgLatency * (this.stats.totalPushes - 1) + latency) / \n        this.stats.totalPushes;\n\n      return true;\n    } catch (error) {\n      this.stats.totalPushes++;\n      this.stats.errorCount++;\n      return false;\n    }\n  }\n\n  printStats() {\n    console.log('\ud83d\udcca Statistics:');\n    console.log(`  Total pushes: ${this.stats.totalPushes}`);\n    console.log(`  Success rate: ${(this.stats.successCount / this.stats.totalPushes * 100).toFixed(1)}%`);\n    console.log(`  Avg latency: ${this.stats.avgLatency.toFixed(0)}ms`);\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#xu-ly-su-co","title":"X\u1eed L\u00fd S\u1ef1 C\u1ed1","text":""},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#404-not-found","title":"404 Not Found","text":"<p>V\u1ea5n \u0111\u1ec1: Entity kh\u00f4ng t\u1ed3n t\u1ea1i</p> <p>Gi\u1ea3i ph\u00e1p: T\u1ea1o entity tr\u01b0\u1edbc, ho\u1eb7c d\u00f9ng upsert operation</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#429-too-many-requests","title":"429 Too Many Requests","text":"<p>V\u1ea5n \u0111\u1ec1: V\u01b0\u1ee3t qu\u00e1 rate limit</p> <p>Gi\u1ea3i ph\u00e1p: 1. Gi\u1ea3m t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt 2. Tri\u1ec3n khai exponential backoff 3. Y\u00eau c\u1ea7u rate limit cao h\u01a1n 4. D\u00f9ng batch operation</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#network-error","title":"Network Error","text":"<p>V\u1ea5n \u0111\u1ec1: Timeout ho\u1eb7c v\u1ea5n \u0111\u1ec1 m\u1ea1ng</p> <p>Gi\u1ea3i ph\u00e1p: 1. Tri\u1ec3n khai retry logic 2. Queue failed update 3. D\u00f9ng circuit breaker pattern 4. Gi\u00e1m s\u00e1t k\u1ebft n\u1ed1i m\u1ea1ng</p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng G\u00ec B\u1ea1n \u0110\u00e3 H\u1ecdc","text":"<p>\u2705 C\u00e1ch c\u1eadp nh\u1eadt thu\u1ed9c t\u00ednh entity \u2705 M\u1eabu streaming d\u1eef li\u1ec7u li\u00ean t\u1ee5c \u2705 Batch update operation \u2705 X\u1eed l\u00fd l\u1ed7i v\u00e0 retry logic \u2705 K\u1ef9 thu\u1eadt x\u00e1c th\u1ef1c d\u1eef li\u1ec7u \u2705 Gi\u00e1m s\u00e1t hi\u1ec7u su\u1ea5t \u2705 Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t cho \u0111\u1ea9y d\u1eef li\u1ec7u  </p>"},{"location":"vi/getting-started/bring-your-own-server/4-push-data/#buoc-tiep-theo","title":"B\u01b0\u1edbc Ti\u1ebfp Theo","text":"<p>B\u00e2y gi\u1edd d\u1eef li\u1ec7u \u0111ang ch\u1ea3y, h\u00e3y t\u1ea1o dashboard card \u0111\u1ec3 tr\u1ef1c quan h\u00f3a:</p> <p>B\u01b0\u1edbc 5: T\u1ea1o Dashboard Card \u2192</p> <p>C\u1ea7n quay l\u1ea1i? V\u1ec1 B\u01b0\u1edbc 3: T\u1ea1o Entity \u0110\u1ea7u Ti\u00ean</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/","title":"B\u01b0\u1edbc 5: T\u1ea1o Dashboard Card","text":"<p>B\u00e2y gi\u1edd d\u1eef li\u1ec7u \u0111ang ch\u1ea3y v\u00e0o SematX, h\u00e3y t\u1ea1o c\u00e1c card dashboard tr\u1ef1c quan \u0111\u1ec3 hi\u1ec3n th\u1ecb \u0111\u1eb9p m\u1eaft.</p> <p>\u23f1\ufe0f Th\u1eddi gian: 15-20 ph\u00fat \ud83c\udfaf M\u1ee5c ti\u00eau: X\u00e2y d\u1ef1ng card t\u01b0\u01a1ng t\u00e1c \u0111\u1ec3 tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u entity</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#dashboard-card-la-gi","title":"Dashboard Card L\u00e0 G\u00ec?","text":"<p>Dashboard card l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n tr\u1ef1c quan hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u entity NGSI-LD \u1edf nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng kh\u00e1c nhau:</p> <ul> <li>\ud83d\udcca Chart: Bi\u1ec3u \u0111\u1ed3 \u0111\u01b0\u1eddng, c\u1ed9t, tr\u00f2n cho xu h\u01b0\u1edbng</li> <li>\ud83d\uddfa\ufe0f Map: Tr\u1ef1c quan h\u00f3a \u0111\u1ecba l\u00fd c\u1ee7a d\u1eef li\u1ec7u GeoProperty</li> <li>\ud83d\udcc8 Metric: Hi\u1ec3n th\u1ecb gi\u00e1 tr\u1ecb \u0111\u01a1n v\u1edbi ng\u01b0\u1ee1ng</li> <li>\ud83d\udccb Table: D\u1eef li\u1ec7u d\u1ea1ng b\u1ea3ng v\u1edbi s\u1eafp x\u1ebfp v\u00e0 l\u1ecdc</li> <li>\ud83c\udf9b\ufe0f Gauge: Thanh ti\u1ebfn tr\u00ecnh, \u0111\u1ed3ng h\u1ed3 t\u1ed1c \u0111\u1ed9 cho d\u1ea3i gi\u00e1 tr\u1ecb</li> <li>\ud83d\udcdd List: Danh s\u00e1ch entity v\u1edbi \u0111\u1ecbnh d\u1ea1ng t\u00f9y ch\u1ec9nh</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#truy-cap-dashboard","title":"Truy C\u1eadp Dashboard","text":"<ol> <li> <p>\u0110\u0103ng nh\u1eadp v\u00e0o dashboard SematX:    <pre><code>https://your-sematx-server.com/admin\n</code></pre></p> </li> <li> <p>V\u00e0o Cards trong thanh b\u00ean tr\u00e1i</p> </li> <li> <p>Nh\u1ea5n n\u00fat Create New</p> </li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#tao-metric-card","title":"T\u1ea1o Metric Card","text":"<p>H\u00e3y t\u1ea1o m\u1ed9t metric card \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 hi\u1ec3n th\u1ecb nhi\u1ec7t \u0111\u1ed9 hi\u1ec7n t\u1ea1i.</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-1-thong-tin-co-ban","title":"B\u01b0\u1edbc 1: Th\u00f4ng Tin C\u01a1 B\u1ea3n","text":"<p>\u0110i\u1ec1n th\u00f4ng tin card:</p> <p>Name: <code>Room 101 Temperature</code> Description (t\u00f9y ch\u1ecdn): <code>Current temperature reading from Room 101 sensor</code> Type: Ch\u1ecdn Metric</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-2-nguon-du-lieu","title":"B\u01b0\u1edbc 2: Ngu\u1ed3n D\u1eef Li\u1ec7u","text":"<p>C\u1ea5u h\u00ecnh entity n\u00e0o \u0111\u1ec3 hi\u1ec3n th\u1ecb:</p> <p>Entity Type: <code>TemperatureSensor</code> Entity ID: <code>urn:ngsi-ld:TemperatureSensor:room-101</code> Attribute: <code>temperature</code></p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-3-cau-hinh-hien-thi","title":"B\u01b0\u1edbc 3: C\u1ea5u H\u00ecnh Hi\u1ec3n Th\u1ecb","text":"<p>C\u1ea5u h\u00ecnh c\u00e1ch metric \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb:</p> <pre><code>{\n  \"label\": \"Current Temperature\",\n  \"unit\": \"\u00b0C\",\n  \"decimals\": 1,\n  \"color\": \"#FF6B6B\",\n  \"icon\": \"thermometer\",\n  \"threshold\": {\n    \"normal\": { \"min\": 18, \"max\": 26, \"color\": \"#51CF66\" },\n    \"warning\": { \"min\": 26, \"max\": 30, \"color\": \"#FFA500\" },\n    \"critical\": { \"min\": 30, \"max\": 50, \"color\": \"#FF0000\" }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-4-layout","title":"B\u01b0\u1edbc 4: Layout","text":"<p>Width: Full (12 c\u1ed9t) Height: Medium (200px) Order: 1</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-5-luu","title":"B\u01b0\u1edbc 5: L\u01b0u","text":"<p>Nh\u1ea5n Create \u0111\u1ec3 l\u01b0u card.</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#xem-dashboard","title":"Xem Dashboard","text":"<ol> <li>Nh\u1ea5n Dashboard trong navigation tr\u00ean c\u00f9ng</li> <li>B\u1ea1n s\u1ebd th\u1ea5y card nhi\u1ec7t \u0111\u1ed9 hi\u1ec3n th\u1ecb gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i</li> <li>M\u00e0u s\u1eafc s\u1ebd thay \u0111\u1ed5i d\u1ef1a tr\u00ean c\u1ea5u h\u00ecnh ng\u01b0\u1ee1ng</li> </ol> <p>V\u00ed d\u1ee5 hi\u1ec3n th\u1ecb:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Current Temperature             \u2502\n\u2502                                  \u2502\n\u2502         24.5\u00b0C                   \u2502\n\u2502     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501         \u2502\n\u2502                                  \u2502\n\u2502  \ud83c\udf21\ufe0f Normal Range                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#tao-chart-card","title":"T\u1ea1o Chart Card","text":"<p>B\u00e2y gi\u1edd h\u00e3y t\u1ea1o bi\u1ec3u \u0111\u1ed3 \u0111\u01b0\u1eddng \u0111\u1ec3 hi\u1ec3n th\u1ecb xu h\u01b0\u1edbng nhi\u1ec7t \u0111\u1ed9 theo th\u1eddi gian.</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-1-thong-tin-co-ban_1","title":"B\u01b0\u1edbc 1: Th\u00f4ng Tin C\u01a1 B\u1ea3n","text":"<p>Name: <code>Temperature Trend</code> Type: Ch\u1ecdn Chart Chart Type: Line Chart</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-2-nguon-du-lieu_1","title":"B\u01b0\u1edbc 2: Ngu\u1ed3n D\u1eef Li\u1ec7u","text":"<p>Entity Type: <code>TemperatureSensor</code> Entity ID: <code>urn:ngsi-ld:TemperatureSensor:room-101</code> Attributes: <code>temperature</code></p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-3-cau-hinh-chart","title":"B\u01b0\u1edbc 3: C\u1ea5u H\u00ecnh Chart","text":"<pre><code>{\n  \"timeRange\": \"24h\",\n  \"refreshInterval\": 60,\n  \"xAxis\": {\n    \"label\": \"Time\",\n    \"type\": \"time\"\n  },\n  \"yAxis\": {\n    \"label\": \"Temperature (\u00b0C)\",\n    \"min\": 15,\n    \"max\": 35\n  },\n  \"series\": [\n    {\n      \"name\": \"Temperature\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#FF6B6B\",\n      \"lineWidth\": 2,\n      \"showPoints\": true\n    }\n  ],\n  \"legend\": {\n    \"show\": true,\n    \"position\": \"bottom\"\n  },\n  \"tooltip\": {\n    \"enabled\": true,\n    \"format\": \"{value}\u00b0C at {time}\"\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-4-layout_1","title":"B\u01b0\u1edbc 4: Layout","text":"<p>Width: Full (12 c\u1ed9t) Height: Large (400px) Order: 2</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#ket-qua","title":"K\u1ebft Qu\u1ea3","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Temperature Trend (Last 24 Hours)          \u2502\n\u2502                                              \u2502\n\u2502  35\u00b0C \u2524                                      \u2502\n\u2502       \u2502              \u2571\u2572                      \u2502\n\u2502  30\u00b0C \u2524            \u2571    \u2572   \u2571\u2572              \u2502\n\u2502       \u2502          \u2571        \u2572\u2571  \u2572             \u2502\n\u2502  25\u00b0C \u2524      \u2571\u2572\u2571                \u2572           \u2502\n\u2502       \u2502    \u2571                      \u2572         \u2502\n\u2502  20\u00b0C \u2524  \u2571                          \u2572       \u2502\n\u2502       \u2502\u2571                              \u2572     \u2502\n\u2502  15\u00b0C \u2534\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2534\u2500\u2500   \u2502\n\u2502         00:00  06:00  12:00  18:00  24:00   \u2502\n\u2502                                              \u2502\n\u2502  \u2501\u2501 Temperature                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#tao-map-card","title":"T\u1ea1o Map Card","text":"<p>N\u1ebfu entity c\u00f3 d\u1eef li\u1ec7u v\u1ecb tr\u00ed, t\u1ea1o b\u1ea3n \u0111\u1ed3 \u0111\u1ec3 tr\u1ef1c quan h\u00f3a.</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-1-thong-tin-co-ban_2","title":"B\u01b0\u1edbc 1: Th\u00f4ng Tin C\u01a1 B\u1ea3n","text":"<p>Name: <code>Sensor Locations</code> Type: Ch\u1ecdn Map</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-2-nguon-du-lieu_2","title":"B\u01b0\u1edbc 2: Ngu\u1ed3n D\u1eef Li\u1ec7u","text":"<p>Entity Type: <code>TemperatureSensor</code> GeoProperty: <code>location</code> Filter (t\u00f9y ch\u1ecdn): <code>status==\"active\"</code></p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-3-cau-hinh-map","title":"B\u01b0\u1edbc 3: C\u1ea5u H\u00ecnh Map","text":"<pre><code>{\n  \"center\": {\n    \"lat\": 10.0300,\n    \"lng\": 105.7800\n  },\n  \"zoom\": 15,\n  \"style\": \"streets\",\n  \"markers\": {\n    \"icon\": \"temperature\",\n    \"color\": \"dynamic\",\n    \"colorAttribute\": \"temperature\",\n    \"colorScale\": [\n      { \"value\": 20, \"color\": \"#0000FF\" },\n      { \"value\": 25, \"color\": \"#00FF00\" },\n      { \"value\": 30, \"color\": \"#FF0000\" }\n    ],\n    \"popup\": {\n      \"template\": \"&lt;b&gt;{name}&lt;/b&gt;&lt;br/&gt;Temperature: {temperature}\u00b0C&lt;br/&gt;Battery: {batteryLevel}%\"\n    }\n  },\n  \"clustering\": {\n    \"enabled\": true,\n    \"maxZoom\": 16\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#ket-qua_1","title":"K\u1ebft Qu\u1ea3","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \ud83d\uddfa\ufe0f  Sensor Locations                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502        \ud83d\udfe2 (5 sensors)                \u2502    \u2502\n\u2502  \u2502                                      \u2502    \u2502\n\u2502  \u2502              \ud83d\udd34                      \u2502    \u2502\n\u2502  \u2502         \ud83d\udfe1                           \u2502    \u2502\n\u2502  \u2502                   \ud83d\udfe2                 \u2502    \u2502\n\u2502  \u2502                                      \u2502    \u2502\n\u2502  \u2502    \ud83d\udfe1                                \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502  \ud83d\udd34 &gt; 30\u00b0C  \ud83d\udfe1 25-30\u00b0C  \ud83d\udfe2 &lt; 25\u00b0C           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#tao-table-card","title":"T\u1ea1o Table Card","text":"<p>Hi\u1ec3n th\u1ecb nhi\u1ec1u sensor trong b\u1ea3ng c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp.</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-1-thong-tin-co-ban_3","title":"B\u01b0\u1edbc 1: Th\u00f4ng Tin C\u01a1 B\u1ea3n","text":"<p>Name: <code>All Sensors Status</code> Type: Ch\u1ecdn Table</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-2-nguon-du-lieu_3","title":"B\u01b0\u1edbc 2: Ngu\u1ed3n D\u1eef Li\u1ec7u","text":"<p>Entity Type: <code>TemperatureSensor</code> Limit: 100 Sort By: <code>name</code></p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-3-cau-hinh-table","title":"B\u01b0\u1edbc 3: C\u1ea5u H\u00ecnh Table","text":"<pre><code>{\n  \"columns\": [\n    {\n      \"field\": \"name\",\n      \"header\": \"Sensor Name\",\n      \"width\": \"40%\",\n      \"sortable\": true\n    },\n    {\n      \"field\": \"temperature\",\n      \"header\": \"Temperature\",\n      \"width\": \"20%\",\n      \"sortable\": true,\n      \"format\": \"{value}\u00b0C\",\n      \"align\": \"right\"\n    },\n    {\n      \"field\": \"batteryLevel\",\n      \"header\": \"Battery\",\n      \"width\": \"20%\",\n      \"sortable\": true,\n      \"format\": \"{value}%\",\n      \"align\": \"right\",\n      \"colorize\": {\n        \"&lt; 20\": \"#FF0000\",\n        \"&lt; 50\": \"#FFA500\",\n        \"&gt;= 50\": \"#51CF66\"\n      }\n    },\n    {\n      \"field\": \"status\",\n      \"header\": \"Status\",\n      \"width\": \"20%\",\n      \"badge\": {\n        \"active\": { \"text\": \"Active\", \"color\": \"green\" },\n        \"inactive\": { \"text\": \"Inactive\", \"color\": \"red\" },\n        \"maintenance\": { \"text\": \"Maintenance\", \"color\": \"orange\" }\n      }\n    }\n  ],\n  \"pagination\": {\n    \"enabled\": true,\n    \"pageSize\": 20\n  },\n  \"search\": {\n    \"enabled\": true,\n    \"placeholder\": \"Search sensors...\"\n  },\n  \"actions\": [\n    {\n      \"label\": \"View Details\",\n      \"icon\": \"eye\",\n      \"link\": \"/entities/{id}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#ket-qua_2","title":"K\u1ebft Qu\u1ea3","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  All Sensors Status                 \ud83d\udd0d Search...       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Sensor Name     \u2502 Temperature\u2502 Battery \u2502 Status      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Room 101        \u2502    24.5\u00b0C  \u2502   85%   \u2502 \ud83d\udfe2 Active   \u2502\n\u2502 Room 102        \u2502    23.8\u00b0C  \u2502   42%   \u2502 \ud83d\udfe2 Active   \u2502\n\u2502 Room 103        \u2502    25.2\u00b0C  \u2502   15%   \u2502 \ud83d\udfe0 Active   \u2502\n\u2502 Lobby           \u2502    22.1\u00b0C  \u2502   78%   \u2502 \ud83d\udfe2 Active   \u2502\n\u2502 Parking         \u2502    28.5\u00b0C  \u2502    5%   \u2502 \ud83d\udd34 Active   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502 Showing 1-5 of 12                        &lt; 1 2 3 &gt;   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#tao-multi-series-chart","title":"T\u1ea1o Multi-Series Chart","text":"<p>So s\u00e1nh nhi\u1ec1u sensor tr\u00ean m\u1ed9t bi\u1ec3u \u0111\u1ed3.</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#cau-hinh","title":"C\u1ea5u H\u00ecnh","text":"<pre><code>{\n  \"title\": \"Temperature Comparison\",\n  \"timeRange\": \"24h\",\n  \"yAxis\": {\n    \"label\": \"Temperature (\u00b0C)\",\n    \"min\": 15,\n    \"max\": 35\n  },\n  \"series\": [\n    {\n      \"name\": \"Room 101\",\n      \"entityId\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#FF6B6B\"\n    },\n    {\n      \"name\": \"Room 102\",\n      \"entityId\": \"urn:ngsi-ld:TemperatureSensor:room-102\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#4ECDC4\"\n    },\n    {\n      \"name\": \"Room 103\",\n      \"entityId\": \"urn:ngsi-ld:TemperatureSensor:room-103\",\n      \"attribute\": \"temperature\",\n      \"color\": \"#95E1D3\"\n    }\n  ],\n  \"legend\": {\n    \"show\": true,\n    \"position\": \"bottom\"\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#cap-nhat-thoi-gian-thuc","title":"C\u1eadp Nh\u1eadt Th\u1eddi Gian Th\u1ef1c","text":""},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#bat-auto-refresh","title":"B\u1eadt Auto-Refresh","text":"<p>C\u1ea5u h\u00ecnh card \u0111\u1ec3 c\u1eadp nh\u1eadt t\u1ef1 \u0111\u1ed9ng:</p> <pre><code>{\n  \"autoRefresh\": {\n    \"enabled\": true,\n    \"interval\": 30,\n    \"showIndicator\": true\n  }\n}\n</code></pre> <p>Kho\u1ea3ng th\u1eddi gian: - 10 gi\u00e2y: D\u1eef li\u1ec7u quan tr\u1ecdng th\u1eddi gian th\u1ef1c - 30 gi\u00e2y: Gi\u00e1m s\u00e1t t\u00edch c\u1ef1c - 60 gi\u00e2y: C\u1eadp nh\u1eadt b\u00ecnh th\u01b0\u1eddng - 5 ph\u00fat: D\u1eef li\u1ec7u thay \u0111\u1ed5i ch\u1eadm</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#websocket-subscription","title":"WebSocket Subscription","text":"<p>Cho c\u1eadp nh\u1eadt t\u1ee9c th\u1eddi, b\u1eadt WebSocket subscription:</p> <pre><code>{\n  \"realtime\": {\n    \"enabled\": true,\n    \"transport\": \"websocket\",\n    \"fallbackInterval\": 60\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#layout-card","title":"Layout Card","text":""},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#he-thong-grid","title":"H\u1ec7 Th\u1ed1ng Grid","text":"<p>Dashboard d\u00f9ng grid 12 c\u1ed9t:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Card A (12 cols)                         \u2502  To\u00e0n b\u1ed9 chi\u1ec1u r\u1ed9ng\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Card B (6 cols)      \u2502 Card C (6 cols)   \u2502  M\u1ed7i card m\u1ed9t n\u1eeda\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Card D (4 cols) \u2502 E (4 cols) \u2502 F (4)     \u2502  M\u1ed7i card m\u1ed9t ph\u1ea7n ba\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#layout-responsive","title":"Layout Responsive","text":"<p>Card th\u00edch \u1ee9ng v\u1edbi k\u00edch th\u01b0\u1edbc m\u00e0n h\u00ecnh:</p> <ul> <li>Desktop: Layout grid \u0111\u1ea7y \u0111\u1ee7</li> <li>Tablet: 6-12 c\u1ed9t</li> <li>Mobile: X\u1ebfp ch\u1ed3ng (t\u1ea5t c\u1ea3 12 c\u1ed9t)</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#to-chuc-dashboard","title":"T\u1ed5 Ch\u1ee9c Dashboard","text":""},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#tao-nhieu-dashboard","title":"T\u1ea1o Nhi\u1ec1u Dashboard","text":"<p>T\u1ed5 ch\u1ee9c card th\u00e0nh c\u00e1c dashboard kh\u00e1c nhau:</p> <ul> <li>Overview: Metric v\u00e0 KPI c\u1ea5p cao</li> <li>Monitoring: Bi\u1ec3u \u0111\u1ed3 v\u00e0 b\u1ea3ng chi ti\u1ebft</li> <li>Locations: View d\u1ef1a tr\u00ean b\u1ea3n \u0111\u1ed3</li> <li>Alerts: Card tr\u1ea1ng th\u00e1i v\u00e0 th\u00f4ng b\u00e1o</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#chia-se-dashboard","title":"Chia S\u1ebb Dashboard","text":"<p>Chia s\u1ebb dashboard v\u1edbi th\u00e0nh vi\u00ean nh\u00f3m:</p> <ol> <li>Nh\u1ea5n n\u00fat Share tr\u00ean dashboard</li> <li>\u0110\u1eb7t quy\u1ec1n: View only ho\u1eb7c Edit</li> <li>T\u1ea1o link chia s\u1ebb</li> <li>\u0110\u1eb7t ng\u00e0y h\u1ebft h\u1ea1n (t\u00f9y ch\u1ecdn)</li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#thuc-hanh-tot-nhat","title":"Th\u1ef1c H\u00e0nh T\u1ed1t Nh\u1ea5t","text":""},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#hieu-suat","title":"Hi\u1ec7u Su\u1ea5t","text":"<p>\u2705 N\u00ean: - Gi\u1edbi h\u1ea1n entity m\u1ed7i card (&lt; 100 cho table) - D\u00f9ng kho\u1ea3ng refresh h\u1ee3p l\u00fd (\u2265 30s) - B\u1eadt pagination cho dataset l\u1edbn - Cache d\u1eef li\u1ec7u truy c\u1eadp th\u01b0\u1eddng xuy\u00ean</p> <p>\u274c Kh\u00f4ng n\u00ean: - Load h\u00e0ng ngh\u00ecn entity trong m\u1ed9t card - Refresh m\u1ed7i gi\u00e2y (g\u00e2y t\u1ea3i cao) - T\u1ea1o qu\u00e1 nhi\u1ec1u real-time subscription - D\u00f9ng truy v\u1ea5n ph\u1ee9c t\u1ea1p trong card t\u1ea7n su\u1ea5t cao</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#trai-nghiem-nguoi-dung","title":"Tr\u1ea3i Nghi\u1ec7m Ng\u01b0\u1eddi D\u00f9ng","text":"<p>\u2705 N\u00ean: - D\u00f9ng b\u1ea3ng m\u00e0u nh\u1ea5t qu\u00e1n - Cung c\u1ea5p nh\u00e3n v\u00e0 \u0111\u01a1n v\u1ecb r\u00f5 r\u00e0ng - Hi\u1ec3n th\u1ecb tr\u1ea1ng th\u00e1i loading - X\u1eed l\u00fd l\u1ed7i graceful - D\u00f9ng lo\u1ea1i bi\u1ec3u \u0111\u1ed3 ph\u00f9 h\u1ee3p cho d\u1eef li\u1ec7u</p> <p>\u274c Kh\u00f4ng n\u00ean: - D\u00f9ng qu\u00e1 nhi\u1ec1u m\u00e0u (&lt; 5 m\u1ed7i bi\u1ec3u \u0111\u1ed3) - Dashboard qu\u00e1 \u0111\u00f4ng (&lt; 10 card) - D\u00f9ng tr\u1ef1c quan h\u00f3a g\u00e2y hi\u1ec3u l\u1ea7m - B\u1ecf qua responsive cho mobile</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#truc-quan-hoa-du-lieu","title":"Tr\u1ef1c Quan H\u00f3a D\u1eef Li\u1ec7u","text":"<p>Ch\u1ecdn lo\u1ea1i card ph\u00f9 h\u1ee3p:</p> Lo\u1ea1i D\u1eef Li\u1ec7u Lo\u1ea1i Card T\u1ed1t Nh\u1ea5t Gi\u00e1 tr\u1ecb \u0111\u01a1n Metric Xu h\u01b0\u1edbng theo th\u1eddi gian Line chart So s\u00e1nh Bar chart T\u1ef7 l\u1ec7 Pie chart \u0110\u1ecba l\u00fd Map Nhi\u1ec1u entity Table D\u1ea3i gi\u00e1 tr\u1ecb Gauge"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#xu-ly-su-co","title":"X\u1eed L\u00fd S\u1ef1 C\u1ed1","text":""},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#card-shows-no-data","title":"Card Shows \"No Data\"","text":"<p>V\u1ea5n \u0111\u1ec1: Card hi\u1ec3n th\u1ecb \"No data available\"</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra entity t\u1ed3n t\u1ea1i: X\u00e1c minh entity ID \u0111\u00fang 2. Ki\u1ec3m tra quy\u1ec1n: \u0110\u1ea3m b\u1ea3o API key c\u00f3 quy\u1ec1n \u0111\u1ecdc 3. Ki\u1ec3m tra service: X\u00e1c minh NGSILD-Tenant \u0111\u00fang 4. Ki\u1ec3m tra attribute: \u0110\u1ea3m b\u1ea3o t\u00ean thu\u1ed9c t\u00ednh kh\u1edbp entity</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#card-not-updating","title":"Card Not Updating","text":"<p>V\u1ea5n \u0111\u1ec1: Card hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u c\u0169</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra refresh interval: C\u00f3 th\u1ec3 qu\u00e1 d\u00e0i 2. Ki\u1ec3m tra entity update: X\u00e1c minh d\u1eef li\u1ec7u \u0111ang \u0111\u01b0\u1ee3c \u0111\u1ea9y 3. X\u00f3a cache: Refresh tr\u00ecnh duy\u1ec7t ho\u1eb7c x\u00f3a cache 4. Ki\u1ec3m tra WebSocket: K\u1ebft n\u1ed1i c\u00f3 th\u1ec3 b\u1ecb ng\u1eaft</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#performance-issues","title":"Performance Issues","text":"<p>V\u1ea5n \u0111\u1ec1: Dashboard load ch\u1eadm</p> <p>Gi\u1ea3i ph\u00e1p: 1. Gi\u1ea3m s\u1ed1 entity: Gi\u1edbi h\u1ea1n truy v\u1ea5n v\u1edbi pagination 2. T\u0103ng refresh interval: Gi\u1ea3m t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt 3. T\u1ed1i \u01b0u truy v\u1ea5n: D\u00f9ng filter \u0111\u1ec3 gi\u1ea3m d\u1eef li\u1ec7u 4. Chia dashboard: T\u1ea1o nhi\u1ec1u dashboard t\u1eadp trung</p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng G\u00ec B\u1ea1n \u0110\u00e3 H\u1ecdc","text":"<p>\u2705 C\u00e1ch t\u1ea1o c\u00e1c lo\u1ea1i dashboard card kh\u00e1c nhau \u2705 C\u00e1ch c\u1ea5u h\u00ecnh ngu\u1ed3n d\u1eef li\u1ec7u card \u2705 C\u00e1ch t\u00f9y ch\u1ec9nh giao di\u1ec7n card \u2705 M\u1eabu c\u1eadp nh\u1eadt th\u1eddi gian th\u1ef1c \u2705 Chi\u1ebfn l\u01b0\u1ee3c t\u1ed5 ch\u1ee9c dashboard \u2705 K\u1ef9 thu\u1eadt t\u1ed1i \u01b0u hi\u1ec7u su\u1ea5t \u2705 Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t cho tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u  </p>"},{"location":"vi/getting-started/bring-your-own-server/5-create-card/#buoc-tiep-theo","title":"B\u01b0\u1edbc Ti\u1ebfp Theo","text":"<p>B\u00e2y gi\u1edd h\u00e3y thi\u1ebft l\u1eadp subscription \u0111\u1ec3 nh\u1eadn th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c:</p> <p>B\u01b0\u1edbc 6: Thi\u1ebft L\u1eadp Subscription \u2192</p> <p>C\u1ea7n quay l\u1ea1i? V\u1ec1 B\u01b0\u1edbc 4: \u0110\u1ea9y D\u1eef Li\u1ec7u</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/","title":"B\u01b0\u1edbc 6: Thi\u1ebft L\u1eadp Subscription","text":"<p>Subscription cho ph\u00e9p \u1ee9ng d\u1ee5ng nh\u1eadn th\u00f4ng b\u00e1o th\u1eddi gian th\u1ef1c khi entity thay \u0111\u1ed5i. Thay v\u00ec li\u00ean t\u1ee5c polling, SematX s\u1ebd \u0111\u1ea9y thay \u0111\u1ed5i \u0111\u1ebfn b\u1ea1n!</p> <p>\u23f1\ufe0f Th\u1eddi gian: 15-20 ph\u00fat \ud83c\udfaf M\u1ee5c ti\u00eau: Thi\u1ebft l\u1eadp webhook \u0111\u1ec3 nh\u1eadn th\u00f4ng b\u00e1o entity th\u1eddi gian th\u1ef1c</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#subscription-la-gi","title":"Subscription L\u00e0 G\u00ec?","text":"<p>NGSI-LD Subscription l\u00e0 t\u00ednh n\u0103ng m\u1ea1nh m\u1ebd cho ph\u00e9p:</p> <ul> <li>Theo d\u00f5i thay \u0111\u1ed5i entity t\u1ef1 \u0111\u1ed9ng</li> <li>G\u1eedi th\u00f4ng b\u00e1o HTTP POST \u0111\u1ebfn endpoint c\u1ee7a b\u1ea1n</li> <li>L\u1ecdc theo lo\u1ea1i entity, thu\u1ed9c t\u00ednh, ho\u1eb7c \u0111i\u1ec1u ki\u1ec7n</li> <li>H\u1ed7 tr\u1ee3 nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng th\u00f4ng b\u00e1o</li> <li>B\u1eadt ki\u1ebfn tr\u00fac h\u01b0\u1edbng s\u1ef1 ki\u1ec7n</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#truong-hop-su-dung","title":"Tr\u01b0\u1eddng H\u1ee3p S\u1eed D\u1ee5ng","text":"<ul> <li>H\u1ec7 Th\u1ed1ng C\u1ea3nh B\u00e1o: Th\u00f4ng b\u00e1o khi sensor v\u01b0\u1ee3t ng\u01b0\u1ee1ng</li> <li>Data Pipeline: K\u00edch ho\u1ea1t x\u1eed l\u00fd khi d\u1eef li\u1ec7u \u0111\u1ebfn</li> <li>T\u00edch H\u1ee3p: \u0110\u1ed3ng b\u1ed9 v\u1edbi h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i</li> <li>Dashboard: C\u1eadp nh\u1eadt th\u1eddi gian th\u1ef1c kh\u00f4ng c\u1ea7n polling</li> <li>Logging: Audit trail c\u1ee7a t\u1ea5t c\u1ea3 thay \u0111\u1ed5i</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#subscription-hoat-ong-nhu-the-nao","title":"Subscription Ho\u1ea1t \u0110\u1ed9ng Nh\u01b0 Th\u1ebf N\u00e0o","text":"<pre><code>1. T\u1ea1o Subscription\n   \u2514\u2500&gt; \u0110\u1ecbnh ngh\u0129a nh\u1eefng g\u00ec c\u1ea7n theo d\u00f5i (lo\u1ea1i entity, thu\u1ed9c t\u00ednh)\n   \u2514\u2500&gt; Ch\u1ec9 \u0111\u1ecbnh webhook URL\n   \u2514\u2500&gt; \u0110\u1eb7t \u0111i\u1ec1u ki\u1ec7n (t\u00f9y ch\u1ecdn)\n\n2. Entity Thay \u0110\u1ed5i\n   \u2514\u2500&gt; User/Device c\u1eadp nh\u1eadt entity\n   \u2514\u2500&gt; Orion-LD ph\u00e1t hi\u1ec7n thay \u0111\u1ed5i\n\n3. G\u1eedi Th\u00f4ng B\u00e1o\n   \u2514\u2500&gt; HTTP POST \u0111\u1ebfn webhook c\u1ee7a b\u1ea1n\n   \u2514\u2500&gt; Ch\u1ee9a d\u1eef li\u1ec7u entity\n   \u2514\u2500&gt; Bao g\u1ed3m th\u00f4ng tin thay \u0111\u1ed5i\n\n4. \u1ee8ng D\u1ee5ng C\u1ee7a B\u1ea1n\n   \u2514\u2500&gt; Nh\u1eadn th\u00f4ng b\u00e1o\n   \u2514\u2500&gt; X\u1eed l\u00fd d\u1eef li\u1ec7u\n   \u2514\u2500&gt; Th\u1ef1c hi\u1ec7n h\u00e0nh \u0111\u1ed9ng\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#yeu-cau-truoc","title":"Y\u00eau C\u1ea7u Tr\u01b0\u1edbc","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#thiet-lap-webhook-endpoint","title":"Thi\u1ebft L\u1eadp Webhook Endpoint","text":"<p>B\u1ea1n c\u1ea7n endpoint HTTPS c\u00f4ng khai \u0111\u1ec3 nh\u1eadn th\u00f4ng b\u00e1o.</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#lua-chon-1-dung-webhooksite-testing","title":"L\u1ef1a Ch\u1ecdn 1: D\u00f9ng webhook.site (Testing)","text":"<p>Cho testing, d\u00f9ng webhook.site:</p> <ol> <li>V\u00e0o https://webhook.site</li> <li>B\u1ea1n s\u1ebd nh\u1eadn URL duy nh\u1ea5t nh\u01b0:    <pre><code>https://webhook.site/12345678-1234-1234-1234-123456789abc\n</code></pre></li> <li>D\u00f9ng URL n\u00e0y cho subscription</li> <li>Xem th\u00f4ng b\u00e1o nh\u1eadn \u0111\u01b0\u1ee3c th\u1eddi gian th\u1ef1c</li> </ol>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#lua-chon-2-ngrok-local-development","title":"L\u1ef1a Ch\u1ecdn 2: ngrok (Local Development)","text":"<p>Expose local server ra internet:</p> <pre><code># C\u00e0i \u0111\u1eb7t ngrok\n# Download t\u1eeb https://ngrok.com/download\n\n# Kh\u1edfi \u0111\u1ed9ng local server\nnode server.js  # Port 3000\n\n# Trong terminal kh\u00e1c, expose n\u00f3\nngrok http 3000\n\n# D\u00f9ng HTTPS URL \u0111\u01b0\u1ee3c cung c\u1ea5p:\n# https://abc123.ngrok.io/webhook\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#lua-chon-3-production-webhook","title":"L\u1ef1a Ch\u1ecdn 3: Production Webhook","text":"<p>Tri\u1ec3n khai webhook endpoint tr\u00ean server:</p> <pre><code>// webhook-server.js\nconst express = require('express');\nconst app = express();\n\napp.use(express.json());\n\napp.post('/webhook', (req, res) =&gt; {\n  console.log('Received notification:', JSON.stringify(req.body, null, 2));\n\n  // X\u1eed l\u00fd th\u00f4ng b\u00e1o\n  const notification = req.body;\n  notification.data.forEach(entity =&gt; {\n    console.log(`Entity ${entity.id} changed`);\n    // Logic c\u1ee7a b\u1ea1n \u1edf \u0111\u00e2y\n  });\n\n  // Lu\u00f4n ph\u1ea3n h\u1ed3i nhanh (trong 5 gi\u00e2y)\n  res.status(200).send('OK');\n});\n\napp.listen(3000, () =&gt; {\n  console.log('Webhook server listening on port 3000');\n});\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#tao-subscription-on-gian","title":"T\u1ea1o Subscription \u0110\u01a1n Gi\u1ea3n","text":"<p>H\u00e3y t\u1ea1o subscription \u0111\u1ec3 theo d\u00f5i c\u1ea3m bi\u1ebfn nhi\u1ec7t \u0111\u1ed9.</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#cau-truc-subscription","title":"C\u1ea5u Tr\u00fac Subscription","text":"<pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Notify on temperature sensor changes\",\n  \"entities\": [\n    {\n      \"type\": \"TemperatureSensor\"\n    }\n  ],\n  \"watchedAttributes\": [\"temperature\"],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook-url.com/webhook\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#tao-qua-api","title":"T\u1ea1o qua API","text":"<pre><code>curl -X POST \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"@context\": \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\",\n    \"type\": \"Subscription\",\n    \"description\": \"Temperature sensor monitoring\",\n    \"entities\": [\n      {\n        \"type\": \"TemperatureSensor\"\n      }\n    ],\n    \"watchedAttributes\": [\"temperature\"],\n    \"notification\": {\n      \"endpoint\": {\n        \"uri\": \"https://webhook.site/your-unique-id\",\n        \"accept\": \"application/json\"\n      }\n    }\n  }'\n</code></pre> <p>Ph\u1ea3n h\u1ed3i: <pre><code>HTTP/1.1 201 Created\nLocation: /ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#luu-subscription-id","title":"L\u01b0u Subscription ID","text":"<p>Tr\u00edch xu\u1ea5t subscription ID t\u1eeb header <code>Location</code>: <pre><code>urn:ngsi-ld:Subscription:12345\n</code></pre></p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#kiem-tra-subscription","title":"Ki\u1ec3m Tra Subscription","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#kich-hoat-thong-bao","title":"K\u00edch Ho\u1ea1t Th\u00f4ng B\u00e1o","text":"<p>C\u1eadp nh\u1eadt entity \u0111\u1ec3 k\u00edch ho\u1ea1t subscription:</p> <pre><code>curl -X PATCH \"https://your-sematx-server.com/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:room-101/attrs\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 27.5,\n      \"unitCode\": \"CEL\"\n    }\n  }'\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#kiem-tra-webhook","title":"Ki\u1ec3m Tra Webhook","text":"<p>Webhook s\u1ebd nh\u1eadn th\u00f4ng b\u00e1o nh\u01b0:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:Notification:123456\",\n  \"type\": \"Notification\",\n  \"subscriptionId\": \"urn:ngsi-ld:Subscription:12345\",\n  \"notifiedAt\": \"2025-12-02T10:30:00.000Z\",\n  \"data\": [\n    {\n      \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\",\n      \"type\": \"TemperatureSensor\",\n      \"temperature\": {\n        \"type\": \"Property\",\n        \"value\": 27.5,\n        \"unitCode\": \"CEL\",\n        \"observedAt\": \"2025-12-02T10:30:00Z\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#subscription-nang-cao","title":"Subscription N\u00e2ng Cao","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#thong-bao-dua-tren-ieu-kien","title":"Th\u00f4ng B\u00e1o D\u1ef1a Tr\u00ean \u0110i\u1ec1u Ki\u1ec7n","text":"<p>Ch\u1ec9 th\u00f4ng b\u00e1o khi nhi\u1ec7t \u0111\u1ed9 v\u01b0\u1ee3t 30\u00b0C:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"High temperature alert\",\n  \"entities\": [{\"type\": \"TemperatureSensor\"}],\n  \"watchedAttributes\": [\"temperature\"],\n  \"q\": \"temperature&gt;30\",\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/high-temp-alert\",\n      \"accept\": \"application/json\"\n    },\n    \"attributes\": [\"temperature\", \"location\", \"name\"]\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#nhieu-loai-entity","title":"Nhi\u1ec1u Lo\u1ea1i Entity","text":"<p>Theo d\u00f5i c\u00e1c lo\u1ea1i entity kh\u00e1c nhau:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Environmental monitoring\",\n  \"entities\": [\n    {\"type\": \"TemperatureSensor\"},\n    {\"type\": \"HumiditySensor\"},\n    {\"type\": \"AirQualityObserved\"}\n  ],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/environmental\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#entity-cu-the","title":"Entity C\u1ee5 Th\u1ec3","text":"<p>Theo d\u00f5i m\u1ed9t entity duy nh\u1ea5t:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Room 101 monitoring\",\n  \"entities\": [\n    {\n      \"id\": \"urn:ngsi-ld:TemperatureSensor:room-101\"\n    }\n  ],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/room-101\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#subscription-ia-ly","title":"Subscription \u0110\u1ecba L\u00fd","text":"<p>Th\u00f4ng b\u00e1o cho entity trong khu v\u1ef1c c\u1ee5 th\u1ec3:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"description\": \"Downtown area sensors\",\n  \"entities\": [{\"type\": \"TemperatureSensor\"}],\n  \"geoQ\": {\n    \"georel\": \"within\",\n    \"geometry\": \"Polygon\",\n    \"coordinates\": [\n      [\n        [105.7700, 10.0200],\n        [105.7900, 10.0200],\n        [105.7900, 10.0400],\n        [105.7700, 10.0400],\n        [105.7700, 10.0200]\n      ]\n    ]\n  },\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/downtown\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#throttling","title":"Throttling","text":"<p>Gi\u1edbi h\u1ea1n t\u1ea7n su\u1ea5t th\u00f4ng b\u00e1o:</p> <pre><code>{\n  \"type\": \"Subscription\",\n  \"throttling\": 60,\n  \"entities\": [{\"type\": \"TemperatureSensor\"}],\n  \"notification\": {\n    \"endpoint\": {\n      \"uri\": \"https://your-webhook.com/throttled\",\n      \"accept\": \"application/json\"\n    }\n  }\n}\n</code></pre> <p>\u0110i\u1ec1u n\u00e0y gi\u1edbi h\u1ea1n th\u00f4ng b\u00e1o m\u1ed9t l\u1ea7n m\u1ed7i 60 gi\u00e2y, ngay c\u1ea3 khi entity thay \u0111\u1ed5i th\u01b0\u1eddng xuy\u00ean h\u01a1n.</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#xu-ly-thong-bao","title":"X\u1eed L\u00fd Th\u00f4ng B\u00e1o","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#javascriptnodejs-webhook","title":"JavaScript/Node.js Webhook","text":"<pre><code>const express = require('express');\nconst app = express();\n\napp.use(express.json());\n\n// Handler th\u00f4ng b\u00e1o\napp.post('/webhook', async (req, res) =&gt; {\n  try {\n    const notification = req.body;\n\n    console.log(`Received notification: ${notification.id}`);\n    console.log(`Subscription: ${notification.subscriptionId}`);\n    console.log(`Time: ${notification.notifiedAt}`);\n\n    // X\u1eed l\u00fd m\u1ed7i entity trong th\u00f4ng b\u00e1o\n    for (const entity of notification.data) {\n      await processEntity(entity);\n    }\n\n    // QUAN TR\u1eccNG: Ph\u1ea3n h\u1ed3i nhanh (&lt; 5 gi\u00e2y)\n    res.status(200).send('OK');\n\n  } catch (error) {\n    console.error('Error processing notification:', error);\n    res.status(500).send('Error');\n  }\n});\n\nasync function processEntity(entity) {\n  console.log(`Processing entity: ${entity.id}`);\n\n  // V\u00ed d\u1ee5: C\u1ea3nh b\u00e1o nhi\u1ec7t \u0111\u1ed9\n  if (entity.type === 'TemperatureSensor') {\n    const temp = entity.temperature?.value;\n\n    if (temp &gt; 30) {\n      await sendAlert({\n        level: 'warning',\n        message: `High temperature: ${temp}\u00b0C`,\n        entityId: entity.id\n      });\n    }\n  }\n\n  // L\u01b0u v\u00e0o database\n  await saveToDatabase(entity);\n\n  // K\u00edch ho\u1ea1t h\u00e0nh \u0111\u1ed9ng kh\u00e1c\n  await updateDashboard(entity);\n}\n\nasync function sendAlert(alert) {\n  // G\u1eedi email, SMS, push notification, v.v.\n  console.log('ALERT:', alert.message);\n}\n\nasync function saveToDatabase(entity) {\n  // L\u01b0u v\u00e0o database\n  console.log('Saving entity to database');\n}\n\nasync function updateDashboard(entity) {\n  // C\u1eadp nh\u1eadt dashboard th\u1eddi gian th\u1ef1c\n  console.log('Updating dashboard');\n}\n\napp.listen(3000, () =&gt; {\n  console.log('Webhook server running on port 3000');\n});\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#python-webhook-flask","title":"Python Webhook (Flask)","text":"<pre><code>from flask import Flask, request, jsonify\nimport logging\n\napp = Flask(__name__)\nlogging.basicConfig(level=logging.INFO)\n\n@app.route('/webhook', methods=['POST'])\ndef webhook():\n    try:\n        notification = request.json\n\n        logging.info(f\"Received notification: {notification['id']}\")\n        logging.info(f\"Subscription: {notification['subscriptionId']}\")\n        logging.info(f\"Time: {notification['notifiedAt']}\")\n\n        # X\u1eed l\u00fd m\u1ed7i entity\n        for entity in notification['data']:\n            process_entity(entity)\n\n        # QUAN TR\u1eccNG: Ph\u1ea3n h\u1ed3i nhanh (&lt; 5 gi\u00e2y)\n        return jsonify({'status': 'ok'}), 200\n\n    except Exception as error:\n        logging.error(f\"Error processing notification: {error}\")\n        return jsonify({'status': 'error'}), 500\n\ndef process_entity(entity):\n    logging.info(f\"Processing entity: {entity['id']}\")\n\n    # V\u00ed d\u1ee5: C\u1ea3nh b\u00e1o nhi\u1ec7t \u0111\u1ed9\n    if entity['type'] == 'TemperatureSensor':\n        temp = entity.get('temperature', {}).get('value')\n\n        if temp and temp &gt; 30:\n            send_alert({\n                'level': 'warning',\n                'message': f\"High temperature: {temp}\u00b0C\",\n                'entity_id': entity['id']\n            })\n\n    # L\u01b0u v\u00e0o database\n    save_to_database(entity)\n\n    # K\u00edch ho\u1ea1t h\u00e0nh \u0111\u1ed9ng kh\u00e1c\n    update_dashboard(entity)\n\ndef send_alert(alert):\n    # G\u1eedi email, SMS, push notification, v.v.\n    logging.warning(f\"ALERT: {alert['message']}\")\n\ndef save_to_database(entity):\n    # L\u01b0u v\u00e0o database\n    logging.info(\"Saving entity to database\")\n\ndef update_dashboard(entity):\n    # C\u1eadp nh\u1eadt dashboard th\u1eddi gian th\u1ef1c\n    logging.info(\"Updating dashboard\")\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=3000)\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#quan-ly-subscription","title":"Qu\u1ea3n L\u00fd Subscription","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#liet-ke-tat-ca-subscription","title":"Li\u1ec7t K\u00ea T\u1ea5t C\u1ea3 Subscription","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#lay-chi-tiet-subscription","title":"L\u1ea5y Chi Ti\u1ebft Subscription","text":"<pre><code>curl -X GET \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#cap-nhat-subscription","title":"C\u1eadp Nh\u1eadt Subscription","text":"<pre><code>curl -X PATCH \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"throttling\": 120,\n    \"description\": \"Updated subscription with 2-minute throttling\"\n  }'\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#xoa-subscription","title":"X\u00f3a Subscription","text":"<pre><code>curl -X DELETE \"https://your-sematx-server.com/ngsi-ld/v1/subscriptions/urn:ngsi-ld:Subscription:12345\" \\\n  -H \"Authorization: Bearer YOUR_API_KEY\" \\\n  -H \"NGSILD-Tenant: my-iot-project\"\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#thuc-hanh-tot-nhat","title":"Th\u1ef1c H\u00e0nh T\u1ed1t Nh\u1ea5t","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#thiet-ke-webhook","title":"Thi\u1ebft K\u1ebf Webhook","text":"<p>\u2705 N\u00ean: - Ph\u1ea3n h\u1ed3i trong 5 gi\u00e2y - Tr\u1ea3 v\u1ec1 200 OK ngay c\u1ea3 khi x\u1eed l\u00fd th\u1ea5t b\u1ea1i - X\u1eed l\u00fd th\u00f4ng b\u00e1o b\u1ea5t \u0111\u1ed3ng b\u1ed9 - Tri\u1ec3n khai idempotency (x\u1eed l\u00fd tr\u00f9ng l\u1eb7p) - Log t\u1ea5t c\u1ea3 th\u00f4ng b\u00e1o - Gi\u00e1m s\u00e1t health webhook</p> <p>\u274c Kh\u00f4ng n\u00ean: - X\u1eed l\u00fd n\u1eb7ng trong webhook handler - Tr\u1ea3 v\u1ec1 l\u1ed7i cho v\u1ea5n \u0111\u1ec1 t\u1ea1m th\u1eddi - Gi\u1ea3 \u0111\u1ecbnh th\u00f4ng b\u00e1o \u0111\u1ebfn theo th\u1ee9 t\u1ef1 - B\u1ecf qua notification ID - Block ph\u1ea3n h\u1ed3i</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#bao-mat","title":"B\u1ea3o M\u1eadt","text":"<p>X\u00e1c Minh Th\u00f4ng B\u00e1o:</p> <pre><code>// Th\u00eam x\u00e1c minh custom header\napp.post('/webhook', (req, res) =&gt; {\n  const secret = req.headers['x-subscription-secret'];\n\n  if (secret !== process.env.WEBHOOK_SECRET) {\n    return res.status(401).send('Unauthorized');\n  }\n\n  // X\u1eed l\u00fd th\u00f4ng b\u00e1o\n});\n</code></pre> <p>D\u00f9ng HTTPS: Lu\u00f4n d\u00f9ng HTTPS cho webhook endpoint</p> <p>Tri\u1ec3n Khai Authentication: Th\u00eam Bearer token ho\u1eb7c API key</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#xu-ly-loi","title":"X\u1eed L\u00fd L\u1ed7i","text":"<p>Retry Logic: SematX s\u1ebd retry th\u00f4ng b\u00e1o th\u1ea5t b\u1ea1i:</p> <ul> <li>Retry 1: Sau 5 gi\u00e2y</li> <li>Retry 2: Sau 30 gi\u00e2y</li> <li>Retry 3: Sau 2 ph\u00fat</li> <li>Sau \u0111\u00f3 t\u1eeb b\u1ecf</li> </ul> <p>X\u1eed L\u00fd Th\u1ea5t B\u1ea1i Graceful:</p> <pre><code>app.post('/webhook', async (req, res) =&gt; {\n  // Ph\u1ea3n h\u1ed3i ngay l\u1eadp t\u1ee9c\n  res.status(200).send('OK');\n\n  // X\u1eed l\u00fd b\u1ea5t \u0111\u1ed3ng b\u1ed9\n  processNotification(req.body)\n    .catch(error =&gt; {\n      console.error('Processing failed:', error);\n      // L\u01b0u \u0111\u1ec3 retry th\u1ee7 c\u00f4ng\n      saveFailedNotification(req.body);\n    });\n});\n</code></pre>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#hieu-suat","title":"Hi\u1ec7u Su\u1ea5t","text":"<p>D\u00f9ng Throttling: Ng\u0103n th\u00f4ng b\u00e1o tr\u00e0n</p> <p>L\u1ecdc T\u00edch C\u1ef1c: Ch\u1ec9 subscribe nh\u1eefng g\u00ec c\u1ea7n</p> <p>Batch Processing: X\u1eed l\u00fd nhi\u1ec1u th\u00f4ng b\u00e1o c\u00f9ng l\u00fac</p> <p>Scale Webhook: D\u00f9ng load balancer cho l\u01b0u l\u01b0\u1ee3ng cao</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#xu-ly-su-co","title":"X\u1eed L\u00fd S\u1ef1 C\u1ed1","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#not-receiving-notifications","title":"Not Receiving Notifications","text":"<p>V\u1ea5n \u0111\u1ec1: Webhook kh\u00f4ng bao gi\u1edd nh\u1eadn th\u00f4ng b\u00e1o</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra webhook URL: Ph\u1ea3i accessible c\u00f4ng khai 2. Ki\u1ec3m tra HTTPS: Ph\u1ea3i d\u00f9ng HTTPS (ho\u1eb7c HTTP cho localhost) 3. Test webhook: D\u00f9ng curl \u0111\u1ec3 POST th\u1ee7 c\u00f4ng 4. Ki\u1ec3m tra firewall: C\u00f3 th\u1ec3 ch\u1eb7n request \u0111\u1ebfn 5. Ki\u1ec3m tra subscription: X\u00e1c minh n\u00f3 active 6. K\u00edch ho\u1ea1t thay \u0111\u1ed5i: C\u1eadp nh\u1eadt entity \u0111\u1ec3 test</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#duplicate-notifications","title":"Duplicate Notifications","text":"<p>V\u1ea5n \u0111\u1ec1: Nh\u1eadn c\u00f9ng th\u00f4ng b\u00e1o nhi\u1ec1u l\u1ea7n</p> <p>Gi\u1ea3i ph\u00e1p: 1. Tri\u1ec3n khai idempotency: Ki\u1ec3m tra notification ID 2. H\u00e0nh vi mong \u0111\u1ee3i: Retry c\u00f3 th\u1ec3 g\u00e2y tr\u00f9ng l\u1eb7p 3. L\u01b0u processed ID: Theo d\u00f5i nh\u1eefng g\u00ec \u0111\u00e3 x\u1eed l\u00fd</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#missing-notifications","title":"Missing Notifications","text":"<p>V\u1ea5n \u0111\u1ec1: M\u1ed9t s\u1ed1 th\u00f4ng b\u00e1o kh\u00f4ng nh\u1eadn \u0111\u01b0\u1ee3c</p> <p>Gi\u1ea3i ph\u00e1p: 1. Ki\u1ec3m tra throttling: C\u00f3 th\u1ec3 gi\u1edbi h\u1ea1n th\u00f4ng b\u00e1o 2. Ki\u1ec3m tra ph\u1ea3n h\u1ed3i webhook: Ph\u1ea3i tr\u1ea3 v\u1ec1 200 OK 3. Ki\u1ec3m tra timeout: Ph\u1ea3n h\u1ed3i trong 5 gi\u00e2y 4. Ki\u1ec3m tra \u0111i\u1ec1u ki\u1ec7n: C\u00f3 th\u1ec3 kh\u00f4ng kh\u1edbp thay \u0111\u1ed5i entity</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng G\u00ec B\u1ea1n \u0110\u00e3 H\u1ecdc","text":"<p>\u2705 NGSI-LD subscription ho\u1ea1t \u0111\u1ed9ng nh\u01b0 th\u1ebf n\u00e0o \u2705 C\u00e1ch t\u1ea1o subscription qua API \u2705 C\u00e1ch x\u00e2y d\u1ef1ng webhook endpoint \u2705 M\u1eabu subscription n\u00e2ng cao \u2705 C\u00e1ch x\u1eed l\u00fd th\u00f4ng b\u00e1o \u2705 X\u1eed l\u00fd l\u1ed7i v\u00e0 retry logic \u2705 Th\u1ef1c h\u00e0nh t\u1ed1t nh\u1ea5t cho production webhook  </p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#chuc-mung","title":"Ch\u00fac M\u1eebng! \ud83c\udf89","text":"<p>B\u1ea1n \u0111\u00e3 ho\u00e0n th\u00e0nh tutorial \"Bring Your Own Server\"!</p> <p>B\u00e2y gi\u1edd b\u1ea1n bi\u1ebft c\u00e1ch: - \u2705 T\u1ea1o t\u00e0i kho\u1ea3n SematX v\u00e0 t\u1ea1o API key - \u2705 C\u1ea5u h\u00ecnh service cho \u1ee9ng d\u1ee5ng - \u2705 T\u1ea1o v\u00e0 qu\u1ea3n l\u00fd entity NGSI-LD - \u2705 \u0110\u1ea9y d\u1eef li\u1ec7u th\u1eddi gian th\u1ef1c t\u1eeb \u1ee9ng d\u1ee5ng - \u2705 X\u00e2y d\u1ef1ng dashboard card \u0111\u1eb9p - \u2705 Thi\u1ebft l\u1eadp subscription cho ki\u1ebfn tr\u00fac h\u01b0\u1edbng s\u1ef1 ki\u1ec7n</p>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#buoc-tiep-theo","title":"B\u01b0\u1edbc Ti\u1ebfp Theo","text":""},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#hoc-them","title":"H\u1ecdc Th\u00eam","text":"<ul> <li>Core Concepts - \u0110i s\u00e2u v\u00e0o ki\u1ebfn tr\u00fac SematX</li> <li>Troubleshooting - C\u00e1c v\u1ea5n \u0111\u1ec1 th\u01b0\u1eddng g\u1eb7p v\u00e0 gi\u1ea3i ph\u00e1p</li> <li>Deployment Guide - Deploy SematX l\u00ean production</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#xay-dung-gi-o","title":"X\u00e2y D\u1ef1ng G\u00ec \u0110\u00f3","text":"<ul> <li>Development Guide - M\u1edf r\u1ed9ng v\u00e0 t\u00f9y ch\u1ec9nh LegoCity</li> <li>Custom Blocks - M\u1edf r\u1ed9ng dashboard</li> <li>Plugins - Th\u00eam t\u00ednh n\u0103ng t\u00f9y ch\u1ec9nh</li> </ul>"},{"location":"vi/getting-started/bring-your-own-server/6-subscriptions/#nhan-tro-giup","title":"Nh\u1eadn Tr\u1ee3 Gi\u00fap","text":"<ul> <li>GitHub Discussions: \u0110\u1eb7t c\u00e2u h\u1ecfi</li> <li>GitHub Issues: B\u00e1o c\u00e1o l\u1ed7i</li> <li>Documentation: Duy\u1ec7t docs</li> </ul> <p>Ch\u00fac vui v\u1ebb khi x\u00e2y d\u1ef1ng v\u1edbi SematX! \ud83d\ude80</p> <p>C\u1ea7n quay l\u1ea1i? V\u1ec1 B\u01b0\u1edbc 5: T\u1ea1o Dashboard Card</p>"},{"location":"vi/getting-started/start-server/","title":"Kh\u1edfi \u0111\u1ed9ng Local Server","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n ch\u1ea1y SematX tr\u00ean m\u00e1y local c\u1ee7a b\u1ea1n b\u1eb1ng Docker. \u0110\u00e2y l\u00e0 c\u00e1ch nhanh nh\u1ea5t \u0111\u1ec3 b\u1eaft \u0111\u1ea7u v\u00e0 kh\u00e1m ph\u00e1 n\u1ec1n t\u1ea3ng.</p> <p>\u23f1\ufe0f Th\u1eddi gian \u01b0\u1edbc t\u00ednh: 10-15 ph\u00fat \ud83d\udcbb Y\u00eau c\u1ea7u: Docker Desktop \ud83c\udfaf M\u1ee5c ti\u00eau: Ch\u1ea1y SematX locally v\u00e0 t\u1ea1o entity \u0111\u1ea7u ti\u00ean</p>"},{"location":"vi/getting-started/start-server/#nhung-gi-ban-se-xay-dung","title":"Nh\u1eefng g\u00ec B\u1ea1n s\u1ebd X\u00e2y d\u1ef1ng","text":"<p>Khi k\u1ebft th\u00fac h\u01b0\u1edbng d\u1eabn n\u00e0y, b\u1ea1n s\u1ebd c\u00f3: - M\u1ed9t instance SematX ho\u1ea1t \u0111\u1ed9ng \u0111\u1ea7y \u0111\u1ee7 ch\u1ea1y locally - Truy c\u1eadp v\u00e0o giao di\u1ec7n web Lego Dashboard - Entity NGSI-LD \u0111\u1ea7u ti\u00ean c\u1ee7a b\u1ea1n \u0111\u01b0\u1ee3c t\u1ea1o - M\u1ed9t dashboard card tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n</p>"},{"location":"vi/getting-started/start-server/#ieu-kien-tien-quyet","title":"\u0110i\u1ec1u ki\u1ec7n Ti\u00ean quy\u1ebft","text":""},{"location":"vi/getting-started/start-server/#cai-at-docker-desktop","title":"C\u00e0i \u0111\u1eb7t Docker Desktop","text":"<p>Docker Desktop bao g\u1ed3m Docker Engine v\u00e0 Docker Compose, b\u1ea1n s\u1ebd c\u1ea7n \u0111\u1ec3 ch\u1ea1y SematX.</p> <p>T\u1ea3i Docker Desktop: - Windows: Download Docker Desktop for Windows - Mac: Download Docker Desktop for Mac - Linux: Install Docker Engine v\u00e0 Docker Compose</p> <p>X\u00e1c minh C\u00e0i \u0111\u1eb7t:</p> <p>M\u1edf terminal v\u00e0 ch\u1ea1y:</p> <pre><code>docker --version\ndocker compose version\n</code></pre> <p>B\u1ea1n s\u1ebd th\u1ea5y output nh\u01b0: <pre><code>Docker version 24.0.0\nDocker Compose version v2.20.0\n</code></pre></p>"},{"location":"vi/getting-started/start-server/#cai-at-git","title":"C\u00e0i \u0111\u1eb7t Git","text":"<p>B\u1ea1n s\u1ebd c\u1ea7n Git \u0111\u1ec3 clone repository SematX.</p> <p>T\u1ea3i Git: https://git-scm.com/downloads</p> <p>X\u00e1c minh C\u00e0i \u0111\u1eb7t:</p> <pre><code>git --version\n</code></pre>"},{"location":"vi/getting-started/start-server/#buoc-1-clone-repository","title":"B\u01b0\u1edbc 1: Clone Repository","text":"<p>M\u1edf terminal v\u00e0 clone repository SematX:</p> <pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity\n</code></pre>"},{"location":"vi/getting-started/start-server/#buoc-2-cau-hinh-environment-variables","title":"B\u01b0\u1edbc 2: C\u1ea5u h\u00ecnh Environment Variables","text":"<p>T\u1ea1o file <code>.env</code> trong th\u01b0 m\u1ee5c root:</p> <pre><code># Copy file environment m\u1eabu\ncp .env.example .env\n</code></pre> <p>Ch\u1ec9nh s\u1eeda file <code>.env</code> v\u1edbi text editor b\u1ea1n \u01b0a th\u00edch:</p> <pre><code># For VS Code\ncode .env\n\n# For nano\nnano .env\n\n# For vim\nvim .env\n</code></pre> <p>C\u1ea5u h\u00ecnh T\u1ed1i thi\u1ec3u Y\u00eau c\u1ea7u:</p> <pre><code># Database\nDATABASE_URI=mongodb://mongodb:27017/payload\nMONGODB_URL=mongodb://mongodb:27017\n\n# Payload CMS\nPAYLOAD_SECRET=your-secret-key-here-change-this\nPAYLOAD_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Orion-LD\nORION_URL=http://orion:1026\n\n# Optional: AI Features\nOPENROUTER_API_KEY=your-api-key-if-using-ai\n</code></pre> <p>Quan tr\u1ecdng: Thay \u0111\u1ed5i <code>PAYLOAD_SECRET</code> th\u00e0nh chu\u1ed7i ng\u1eabu nhi\u00ean. B\u1ea1n c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t c\u00e1i v\u1edbi:</p> <pre><code># On Linux/Mac\nopenssl rand -base64 32\n\n# On Windows (PowerShell)\n[Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Minimum 0 -Maximum 255 }))\n</code></pre>"},{"location":"vi/getting-started/start-server/#buoc-3-khoi-ong-services","title":"B\u01b0\u1edbc 3: Kh\u1edfi \u0111\u1ed9ng Services","text":"<p>Kh\u1edfi \u0111\u1ed9ng t\u1ea5t c\u1ea3 services SematX s\u1eed d\u1ee5ng Docker Compose:</p> <pre><code>docker compose up -d\n</code></pre> <p>L\u1ec7nh n\u00e0y s\u1ebd: 1. Pull c\u00e1c Docker images y\u00eau c\u1ea7u (ch\u1ec9 l\u1ea7n \u0111\u1ea7u ti\u00ean) 2. T\u1ea1o v\u00e0 kh\u1edfi \u0111\u1ed9ng containers cho:    - MongoDB (database)    - Orion-LD (context broker)    - Nginx (API gateway)    - Dashboard (PayloadCMS)</p> <p>Output mong \u0111\u1ee3i: <pre><code>[+] Running 5/5\n \u2714 Network legocity_default      Created\n \u2714 Container legocity-mongodb-1  Started\n \u2714 Container legocity-orion-1    Started\n \u2714 Container legocity-dashboard-1 Started\n \u2714 Container legocity-nginx-1    Started\n</code></pre></p> <p>Ki\u1ec3m tra Tr\u1ea1ng th\u00e1i Service:</p> <pre><code>docker compose ps\n</code></pre> <p>T\u1ea5t c\u1ea3 services n\u00ean hi\u1ec3n th\u1ecb tr\u1ea1ng th\u00e1i \"Up\":</p> <pre><code>NAME                    STATUS\nlegocity-mongodb-1      Up\nlegocity-orion-1        Up\nlegocity-dashboard-1    Up\nlegocity-nginx-1        Up\n</code></pre>"},{"location":"vi/getting-started/start-server/#buoc-4-truy-cap-dashboard","title":"B\u01b0\u1edbc 4: Truy c\u1eadp Dashboard","text":"<p>M\u1edf tr\u00ecnh duy\u1ec7t v\u00e0 \u0111i\u1ec1u h\u01b0\u1edbng \u0111\u1ebfn:</p> <pre><code>http://localhost:3000/admin\n</code></pre>"},{"location":"vi/getting-started/start-server/#tao-tai-khoan-admin","title":"T\u1ea1o T\u00e0i kho\u1ea3n Admin","text":"<p>L\u1ea7n truy c\u1eadp \u0111\u1ea7u ti\u00ean, b\u1ea1n s\u1ebd th\u1ea5y m\u00e0n h\u00ecnh t\u1ea1o t\u00e0i kho\u1ea3n:</p> <ol> <li>Email: Nh\u1eadp \u0111\u1ecba ch\u1ec9 email c\u1ee7a b\u1ea1n</li> <li>Password: T\u1ea1o m\u1eadt kh\u1ea9u an to\u00e0n (t\u1ed1i thi\u1ec3u 8 k\u00fd t\u1ef1)</li> <li>Confirm Password: Nh\u1eadp l\u1ea1i m\u1eadt kh\u1ea9u</li> <li>Name (t\u00f9y ch\u1ecdn): H\u1ecd t\u00ean \u0111\u1ea7y \u0111\u1ee7 c\u1ee7a b\u1ea1n</li> </ol> <p>Nh\u1ea5p Create First User \u0111\u1ec3 t\u1ea1o t\u00e0i kho\u1ea3n admin.</p>"},{"location":"vi/getting-started/start-server/#ang-nhap","title":"\u0110\u0103ng nh\u1eadp","text":"<p>Sau khi t\u1ea1o t\u00e0i kho\u1ea3n, \u0111\u0103ng nh\u1eadp v\u1edbi th\u00f4ng tin \u0111\u0103ng nh\u1eadp c\u1ee7a b\u1ea1n:</p> <pre><code>http://localhost:3000/admin/login\n</code></pre>"},{"location":"vi/getting-started/start-server/#buoc-5-tao-entity-au-tien","title":"B\u01b0\u1edbc 5: T\u1ea1o Entity \u0110\u1ea7u ti\u00ean","text":"<p>B\u00e2y gi\u1edd b\u1ea1n \u0111\u00e3 \u0111\u0103ng nh\u1eadp, h\u00e3y t\u1ea1o entity NGSI-LD \u0111\u1ea7u ti\u00ean s\u1eed d\u1ee5ng API.</p>"},{"location":"vi/getting-started/start-server/#tao-api-key","title":"T\u1ea1o API Key","text":"<ol> <li>Trong dashboard, nh\u1ea5p API Keys \u1edf sidebar b\u00ean tr\u00e1i</li> <li>Nh\u1ea5p Create New</li> <li>\u0110i\u1ec1n th\u00f4ng tin chi ti\u1ebft:</li> <li>Name: \"My First API Key\"</li> <li>Expires: Ch\u1ecdn ng\u00e0y h\u1ebft h\u1ea1n (ho\u1eb7c \u0111\u1ec3 tr\u1ed1ng n\u1ebfu kh\u00f4ng h\u1ebft h\u1ea1n)</li> <li>Permissions: Ch\u1ecdn \"Full Access\" hi\u1ec7n t\u1ea1i</li> <li>Nh\u1ea5p Create</li> <li>Copy API key - b\u1ea1n s\u1ebd kh\u00f4ng th\u1ec3 xem l\u1ea1i n\u00f3!</li> </ol>"},{"location":"vi/getting-started/start-server/#tao-entity-qua-api","title":"T\u1ea1o Entity qua API","text":"<p>M\u1edf terminal m\u1edbi v\u00e0 s\u1eed d\u1ee5ng curl \u0111\u1ec3 t\u1ea1o entity:</p> <pre><code>curl -X POST http://localhost:1026/ngsi-ld/v1/entities \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"id\": \"urn:ngsi-ld:TemperatureSensor:001\",\n    \"type\": \"TemperatureSensor\",\n    \"@context\": [\n      \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\"\n    ],\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 23.5,\n      \"unitCode\": \"CEL\"\n    },\n    \"location\": {\n      \"type\": \"GeoProperty\",\n      \"value\": {\n        \"type\": \"Point\",\n        \"coordinates\": [105.7800, 10.0300]\n      }\n    },\n    \"name\": {\n      \"type\": \"Property\",\n      \"value\": \"Temperature Sensor - Room 101\"\n    }\n  }'\n</code></pre> <p>Thay <code>YOUR_API_KEY_HERE</code> b\u1eb1ng API key b\u1ea1n \u0111\u00e3 copy tr\u01b0\u1edbc \u0111\u00f3.</p> <p>Response mong \u0111\u1ee3i:</p> <pre><code>HTTP/1.1 201 Created\nLocation: /ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:001\n</code></pre>"},{"location":"vi/getting-started/start-server/#xac-minh-entity","title":"X\u00e1c minh Entity","text":"<p>Truy v\u1ea5n entity \u0111\u1ec3 x\u00e1c minh n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o:</p> <pre><code>curl -X GET http://localhost:1026/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:001 \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\"\n</code></pre> <p>Response mong \u0111\u1ee3i:</p> <pre><code>{\n  \"id\": \"urn:ngsi-ld:TemperatureSensor:001\",\n  \"type\": \"TemperatureSensor\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 23.5,\n    \"unitCode\": \"CEL\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.7800, 10.0300]\n    }\n  },\n  \"name\": {\n    \"type\": \"Property\",\n    \"value\": \"Temperature Sensor - Room 101\"\n  }\n}\n</code></pre>"},{"location":"vi/getting-started/start-server/#buoc-6-tao-dashboard-card","title":"B\u01b0\u1edbc 6: T\u1ea1o Dashboard Card","text":"<p>B\u00e2y gi\u1edd h\u00e3y tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u n\u00e0y trong dashboard.</p>"},{"location":"vi/getting-started/start-server/#ieu-huong-en-cards","title":"\u0110i\u1ec1u h\u01b0\u1edbng \u0111\u1ebfn Cards","text":"<ol> <li>Trong dashboard, nh\u1ea5p Cards \u1edf sidebar b\u00ean tr\u00e1i</li> <li>Nh\u1ea5p Create New</li> </ol>"},{"location":"vi/getting-started/start-server/#cau-hinh-card","title":"C\u1ea5u h\u00ecnh Card","text":"<p>\u0110i\u1ec1n th\u00f4ng tin chi ti\u1ebft card:</p> <ol> <li>Name: \"Room 101 Temperature\"</li> <li>Type: Ch\u1ecdn \"Metric\" (\u0111\u1ec3 hi\u1ec3n th\u1ecb m\u1ed9t gi\u00e1 tr\u1ecb duy nh\u1ea5t)</li> <li>Entity Type: \"TemperatureSensor\"</li> <li>Entity ID: \"urn:ngsi-ld:TemperatureSensor:001\"</li> <li>Property: \"temperature\"</li> <li> <p>Configuration (JSON):    <pre><code>{\n  \"unit\": \"\u00b0C\",\n  \"label\": \"Current Temperature\",\n  \"color\": \"#FF6B6B\",\n  \"threshold\": {\n    \"warning\": 30,\n    \"critical\": 35\n  }\n}\n</code></pre></p> </li> <li> <p>Nh\u1ea5p Create</p> </li> </ol>"},{"location":"vi/getting-started/start-server/#xem-dashboard","title":"Xem Dashboard","text":"<ol> <li>Nh\u1ea5p Dashboard \u1edf thanh navigation tr\u00ean c\u00f9ng</li> <li>B\u1ea1n s\u1ebd th\u1ea5y temperature card hi\u1ec3n th\u1ecb \"23.5\u00b0C\"</li> </ol>"},{"location":"vi/getting-started/start-server/#buoc-7-cap-nhat-du-lieu-entity","title":"B\u01b0\u1edbc 7: C\u1eadp nh\u1eadt D\u1eef li\u1ec7u Entity","text":"<p>H\u00e3y m\u00f4 ph\u1ecfng m\u1ed9t thay \u0111\u1ed5i nhi\u1ec7t \u0111\u1ed9:</p> <pre><code>curl -X PATCH http://localhost:1026/ngsi-ld/v1/entities/urn:ngsi-ld:TemperatureSensor:001/attrs \\\n  -H \"Authorization: Bearer YOUR_API_KEY_HERE\" \\\n  -H \"Content-Type: application/ld+json\" \\\n  -d '{\n    \"temperature\": {\n      \"type\": \"Property\",\n      \"value\": 28.3,\n      \"unitCode\": \"CEL\"\n    }\n  }'\n</code></pre> <p>Refresh dashboard c\u1ee7a b\u1ea1n - card b\u00e2y gi\u1edd s\u1ebd hi\u1ec3n th\u1ecb \"28.3\u00b0C\"!</p>"},{"location":"vi/getting-started/start-server/#cac-lenh-thuong-dung","title":"C\u00e1c L\u1ec7nh Th\u01b0\u1eddng d\u00f9ng","text":""},{"location":"vi/getting-started/start-server/#xem-logs","title":"Xem Logs","text":"<pre><code># All services\ndocker compose logs -f\n\n# Specific service\ndocker compose logs -f dashboard\ndocker compose logs -f orion\n</code></pre>"},{"location":"vi/getting-started/start-server/#dung-services","title":"D\u1eebng Services","text":"<pre><code># D\u1eebng t\u1ea5t c\u1ea3 services (gi\u1eef d\u1eef li\u1ec7u)\ndocker compose stop\n\n# D\u1eebng v\u00e0 x\u00f3a containers (gi\u1eef d\u1eef li\u1ec7u)\ndocker compose down\n\n# D\u1eebng v\u00e0 x\u00f3a m\u1ecdi th\u1ee9 bao g\u1ed3m c\u1ea3 d\u1eef li\u1ec7u\ndocker compose down -v\n</code></pre>"},{"location":"vi/getting-started/start-server/#khoi-ong-lai-services","title":"Kh\u1edfi \u0111\u1ed9ng l\u1ea1i Services","text":"<pre><code># Kh\u1edfi \u0111\u1ed9ng l\u1ea1i t\u1ea5t c\u1ea3 services\ndocker compose restart\n\n# Kh\u1edfi \u0111\u1ed9ng l\u1ea1i service c\u1ee5 th\u1ec3\ndocker compose restart dashboard\n</code></pre>"},{"location":"vi/getting-started/start-server/#truy-cap-mongodb","title":"Truy c\u1eadp MongoDB","text":"<pre><code># M\u1edf MongoDB shell\ndocker compose exec mongodb mongosh\n\n# Li\u1ec7t k\u00ea databases\nshow dbs\n\n# S\u1eed d\u1ee5ng Orion database\nuse orion\n\n# Li\u1ec7t k\u00ea collections\nshow collections\n\n# Truy v\u1ea5n entities\ndb.entities.find().pretty()\n</code></pre>"},{"location":"vi/getting-started/start-server/#xu-ly-su-co","title":"X\u1eed l\u00fd S\u1ef1 c\u1ed1","text":""},{"location":"vi/getting-started/start-server/#port-a-uoc-su-dung","title":"Port \u0110\u00e3 \u0110\u01b0\u1ee3c S\u1eed d\u1ee5ng","text":"<p>N\u1ebfu b\u1ea1n th\u1ea5y l\u1ed7i nh\u01b0 \"port is already allocated\":</p> <pre><code># T\u00ecm process n\u00e0o \u0111ang s\u1eed d\u1ee5ng port 3000\n# On Linux/Mac\nlsof -i :3000\n\n# On Windows\nnetstat -ano | findstr :3000\n\n# Thay \u0111\u1ed5i port trong docker-compose.yml\n# Ho\u1eb7c d\u1eebng service \u0111ang xung \u0111\u1ed9t\n</code></pre>"},{"location":"vi/getting-started/start-server/#services-khong-khoi-ong","title":"Services Kh\u00f4ng Kh\u1edfi \u0111\u1ed9ng","text":"<pre><code># Ki\u1ec3m tra service logs\ndocker compose logs\n\n# X\u00f3a v\u00e0 t\u1ea1o l\u1ea1i containers\ndocker compose down\ndocker compose up -d\n\n# Rebuild images n\u1ebfu c\u1ea7n\ndocker compose build --no-cache\ndocker compose up -d\n</code></pre>"},{"location":"vi/getting-started/start-server/#khong-truy-cap-uoc-dashboard","title":"Kh\u00f4ng Truy c\u1eadp \u0111\u01b0\u1ee3c Dashboard","text":"<ol> <li>Ki\u1ec3m tra services \u0111ang ch\u1ea1y: <code>docker compose ps</code></li> <li>Ki\u1ec3m tra logs: <code>docker compose logs dashboard</code></li> <li>X\u00e1c minh port mapping: Dashboard n\u00ean \u1edf <code>localhost:3000</code></li> <li>Th\u1eed tr\u00ecnh duy\u1ec7t kh\u00e1c: X\u00f3a cache ho\u1eb7c s\u1eed d\u1ee5ng ch\u1ebf \u0111\u1ed9 \u1ea9n danh</li> </ol>"},{"location":"vi/getting-started/start-server/#api-tra-ve-401-unauthorized","title":"API Tr\u1ea3 v\u1ec1 401 Unauthorized","text":"<ol> <li>Ki\u1ec3m tra API key: \u0110\u1ea3m b\u1ea3o b\u1ea1n \u0111\u00e3 copy \u0111\u00fang</li> <li>Ki\u1ec3m tra h\u1ebft h\u1ea1n: API key c\u00f3 th\u1ec3 \u0111\u00e3 h\u1ebft h\u1ea1n</li> <li>T\u1ea1o key m\u1edbi: T\u1ea1o API key m\u1edbi t\u1eeb dashboard</li> </ol>"},{"location":"vi/getting-started/start-server/#cac-buoc-tiep-theo","title":"C\u00e1c B\u01b0\u1edbc Ti\u1ebfp theo","text":"<p>Ch\u00fac m\u1eebng! B\u00e2y gi\u1edd b\u1ea1n \u0111\u00e3 c\u00f3 SematX ch\u1ea1y locally. \u0110\u00e2y l\u00e0 nh\u1eefng g\u00ec \u0111\u1ec3 kh\u00e1m ph\u00e1 ti\u1ebfp:</p>"},{"location":"vi/getting-started/start-server/#hoc-core-concepts","title":"H\u1ecdc Core Concepts","text":"<ul> <li>Hi\u1ec3u v\u1ec1 Orion Nginx</li> <li>Lego Dashboard Internals</li> </ul>"},{"location":"vi/getting-started/start-server/#xay-dung-cai-gi-o","title":"X\u00e2y d\u1ef1ng C\u00e1i g\u00ec \u0111\u00f3","text":"<ul> <li>T\u1ea1o Th\u00eam Entities</li> <li>Thi\u1ebft l\u1eadp Subscriptions</li> <li>X\u00e2y d\u1ef1ng Custom Dashboards</li> </ul>"},{"location":"vi/getting-started/start-server/#trien-khai-production","title":"Tri\u1ec3n khai Production","text":"<ul> <li>K\u1ebft n\u1ed1i Server Ri\u00eang</li> <li>H\u01b0\u1edbng d\u1eabn Tri\u1ec3n khai</li> </ul>"},{"location":"vi/getting-started/start-server/#nhung-gi-ban-a-hoc","title":"Nh\u1eefng g\u00ec B\u1ea1n \u0111\u00e3 H\u1ecdc","text":"<p>\u2705 C\u00e1ch c\u00e0i \u0111\u1eb7t Docker v\u00e0 Docker Compose \u2705 C\u00e1ch kh\u1edfi \u0111\u1ed9ng SematX services locally \u2705 C\u00e1ch truy c\u1eadp Lego Dashboard \u2705 C\u00e1ch t\u1ea1o NGSI-LD entities qua API \u2705 C\u00e1ch x\u00e2y d\u1ef1ng dashboard cards \u0111\u1ec3 tr\u1ef1c quan h\u00f3a \u2705 C\u00e1ch c\u1eadp nh\u1eadt d\u1eef li\u1ec7u entity theo th\u1eddi gian th\u1ef1c \u2705 C\u00e1c l\u1ec7nh Docker Compose c\u01a1 b\u1ea3n \u0111\u1ec3 qu\u1ea3n l\u00fd services  </p>"},{"location":"vi/getting-started/start-server/#don-dep","title":"D\u1ecdn d\u1eb9p","text":"<p>Khi b\u1ea1n ho\u00e0n th\u00e0nh vi\u1ec7c th\u1eed nghi\u1ec7m, b\u1ea1n c\u00f3 th\u1ec3 d\u1eebng v\u00e0 x\u00f3a t\u1ea5t c\u1ea3 services:</p> <pre><code># D\u1eebng services nh\u01b0ng gi\u1eef d\u1eef li\u1ec7u\ndocker compose down\n\n# X\u00f3a m\u1ecdi th\u1ee9 bao g\u1ed3m c\u1ea3 data volumes\ndocker compose down -v\n\n# X\u00f3a downloaded images (t\u00f9y ch\u1ecdn)\ndocker rmi $(docker images -q fiware/orion-ld)\ndocker rmi $(docker images -q mongo)\n</code></pre> <p>Ch\u00fac b\u1ea1n x\u00e2y d\u1ef1ng vui v\u1ebb v\u1edbi SematX! \ud83d\ude80</p>"},{"location":"vi/installation/","title":"T\u1ed5ng quan C\u00e0i \u0111\u1eb7t","text":"<p>LegoCity c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t trong c\u00e1c m\u00f4i tr\u01b0\u1eddng kh\u00e1c nhau t\u00f9y thu\u1ed9c v\u00e0o nhu c\u1ea7u c\u1ee7a b\u1ea1n.</p>"},{"location":"vi/installation/#cac-lo-trinh-cai-at","title":"C\u00e1c l\u1ed9 tr\u00ecnh C\u00e0i \u0111\u1eb7t","text":""},{"location":"vi/installation/#danh-cho-nguoi-dung-van-hanh","title":"D\u00e0nh cho Ng\u01b0\u1eddi d\u00f9ng &amp; V\u1eadn h\u00e0nh","text":"<p>N\u1ebfu b\u1ea1n mu\u1ed1n tri\u1ec3n khai v\u00e0 s\u1eed d\u1ee5ng LegoCity:</p> <ol> <li>Kh\u1edfi \u0111\u1ed9ng Nhanh - Ch\u1ea1y trong 5 ph\u00fat</li> <li>C\u00e0i \u0111\u1eb7t Local - Thi\u1ebft l\u1eadp ph\u00e1t tri\u1ec3n local \u0111\u1ea7y \u0111\u1ee7</li> <li>Tri\u1ec3n khai Production - Tri\u1ec3n khai l\u00ean servers</li> </ol>"},{"location":"vi/installation/#danh-cho-developers-contributors","title":"D\u00e0nh cho Developers &amp; Contributors","text":"<p>N\u1ebfu b\u1ea1n mu\u1ed1n ph\u00e1t tri\u1ec3n v\u00e0 \u0111\u00f3ng g\u00f3p cho LegoCity:</p> <ol> <li>M\u00f4i tr\u01b0\u1eddng Ph\u00e1t tri\u1ec3n - Thi\u1ebft l\u1eadp dev \u0111\u1ea7y \u0111\u1ee7</li> <li>C\u00e0i \u0111\u1eb7t Local - Thi\u1ebft l\u1eadp m\u00f4i tr\u01b0\u1eddng local</li> <li>H\u01b0\u1edbng d\u1eabn Ph\u00e1t tri\u1ec3n - B\u1eaft \u0111\u1ea7u x\u00e2y d\u1ef1ng</li> </ol>"},{"location":"vi/installation/#chon-thiet-lap-cua-ban","title":"Ch\u1ecdn Thi\u1ebft l\u1eadp c\u1ee7a b\u1ea1n","text":""},{"location":"vi/installation/#phat-trien-local-uoc-khuyen-nghi-cho-phat-trien","title":"Ph\u00e1t tri\u1ec3n Local (\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho Ph\u00e1t tri\u1ec3n)","text":"<p>T\u1ed1t nh\u1ea5t cho: Developers, contributors, testing changes</p> <p>B\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c g\u00ec:</p> <ul> <li>\u2705 Ki\u1ec3m so\u00e1t ho\u00e0n to\u00e0n codebase</li> <li>\u2705 Hot reload trong qu\u00e1 tr\u00ecnh ph\u00e1t tri\u1ec3n</li> <li>\u2705 Debug d\u1ec5 d\u00e0ng</li> <li>\u2705 Ch\u1ea1y tests locally</li> </ul> <p>Y\u00eau c\u1ea7u:</p> <ul> <li>Node.js 18+</li> <li>pnpm package manager</li> <li>MongoDB 6+</li> <li>Git</li> </ul> <p>Th\u1eddi gian thi\u1ebft l\u1eadp: ~15 ph\u00fat</p> <p>\ud83d\udc49 H\u01b0\u1edbng d\u1eabn C\u00e0i \u0111\u1eb7t Local</p>"},{"location":"vi/installation/#docker-compose-thiet-lap-nhanh-nhat","title":"Docker Compose (Thi\u1ebft l\u1eadp nhanh nh\u1ea5t)","text":"<p>T\u1ed1t nh\u1ea5t cho: Testing nhanh, demonstrations, m\u00f4i tr\u01b0\u1eddng c\u00f4 l\u1eadp</p> <p>B\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c g\u00ec:</p> <ul> <li>\u2705 Thi\u1ebft l\u1eadp m\u1ed9t l\u1ec7nh</li> <li>\u2705 T\u1ea5t c\u1ea3 services \u0111\u01b0\u1ee3c containerized</li> <li>\u2705 D\u1ecdn d\u1eb9p d\u1ec5 d\u00e0ng</li> <li>\u2705 M\u00f4i tr\u01b0\u1eddng c\u00f3 th\u1ec3 t\u00e1i t\u1ea1o</li> </ul> <p>Y\u00eau c\u1ea7u:</p> <ul> <li>Docker Desktop ho\u1eb7c Docker Engine</li> <li>Docker Compose</li> </ul> <p>Th\u1eddi gian thi\u1ebft l\u1eadp: ~5 ph\u00fat</p> <p>\ud83d\udc49 H\u01b0\u1edbng d\u1eabn Thi\u1ebft l\u1eadp Docker</p>"},{"location":"vi/installation/#production-server-cho-trien-khai","title":"Production Server (Cho Tri\u1ec3n khai)","text":"<p>T\u1ed1t nh\u1ea5t cho: Staging, production, tri\u1ec3n khai c\u00f4ng khai</p> <p>B\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c g\u00ec:</p> <ul> <li>\u2705 Builds \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u h\u00f3a</li> <li>\u2705 Ki\u1ebfn tr\u00fac c\u00f3 kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng</li> <li>\u2705 C\u1ea5u h\u00ecnh s\u1eb5n s\u00e0ng production</li> <li>\u2705 H\u1ed7 tr\u1ee3 SSL/HTTPS</li> </ul> <p>Y\u00eau c\u1ea7u:</p> <ul> <li>Linux server (Ubuntu/Debian \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb)</li> <li>Node.js, MongoDB, Nginx</li> <li>T\u00ean mi\u1ec1n (t\u00f9y ch\u1ecdn)</li> </ul> <p>Th\u1eddi gian thi\u1ebft l\u1eadp: ~30 ph\u00fat</p> <p>\ud83d\udc49 H\u01b0\u1edbng d\u1eabn Tri\u1ec3n khai Production</p>"},{"location":"vi/installation/#yeu-cau-he-thong","title":"Y\u00eau c\u1ea7u H\u1ec7 th\u1ed1ng","text":""},{"location":"vi/installation/#yeu-cau-toi-thieu","title":"Y\u00eau c\u1ea7u T\u1ed1i thi\u1ec3u","text":"Component Y\u00eau c\u1ea7u CPU 2 cores RAM 4 GB Storage 10 GB dung l\u01b0\u1ee3ng tr\u1ed1ng OS Windows 10+, macOS 11+, Linux"},{"location":"vi/installation/#yeu-cau-uoc-khuyen-nghi","title":"Y\u00eau c\u1ea7u \u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb","text":"Component Y\u00eau c\u1ea7u CPU 4+ cores RAM 8+ GB Storage 20+ GB SSD Network K\u1ebft n\u1ed1i internet \u1ed5n \u0111\u1ecbnh"},{"location":"vi/installation/#phu-thuoc-phan-mem","title":"Ph\u1ee5 thu\u1ed9c Ph\u1ea7n m\u1ec1m","text":""},{"location":"vi/installation/#bat-buoc","title":"B\u1eaft bu\u1ed9c","text":"<ul> <li>Node.js: 18.x ho\u1eb7c 20.x (phi\u00ean b\u1ea3n LTS)</li> <li>pnpm: 8.x ho\u1eb7c m\u1edbi h\u01a1n</li> <li>MongoDB: 6.x ho\u1eb7c m\u1edbi h\u01a1n</li> <li>Git: 2.x ho\u1eb7c m\u1edbi h\u01a1n</li> </ul>"},{"location":"vi/installation/#tuy-chon","title":"T\u00f9y ch\u1ecdn","text":"<ul> <li>Docker: 24.x ho\u1eb7c m\u1edbi h\u01a1n (cho thi\u1ebft l\u1eadp containerized)</li> <li>Nginx: 1.18+ (cho production proxy)</li> <li>Redis: 7.x (cho caching)</li> </ul>"},{"location":"vi/installation/#so-sanh-phuong-phap-cai-at","title":"So s\u00e1nh Ph\u01b0\u01a1ng ph\u00e1p C\u00e0i \u0111\u1eb7t","text":"T\u00ednh n\u0103ng Local Dev Docker Compose Production Th\u1eddi gian thi\u1ebft l\u1eadp 15 ph\u00fat 5 ph\u00fat 30 ph\u00fat \u0110\u1ed9 kh\u00f3 Trung b\u00ecnh D\u1ec5 Kh\u00f3 T\u00f9y ch\u1ec9nh Cao Trung b\u00ecnh Cao Hi\u1ec7u su\u1ea5t T\u1ed1t nh\u1ea5t T\u1ed1t T\u1ed1t nh\u1ea5t Kh\u1ea3 n\u0103ng m\u1edf r\u1ed9ng Th\u1ea5p Th\u1ea5p Cao Cho Ph\u00e1t tri\u1ec3n \u2705 \u26a0\ufe0f \u274c Cho Production \u274c \u26a0\ufe0f \u2705"},{"location":"vi/installation/#checklist-truoc-khi-cai-at","title":"Checklist Tr\u01b0\u1edbc khi C\u00e0i \u0111\u1eb7t","text":"<p>Tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u c\u00e0i \u0111\u1eb7t:</p> <ul> <li>[ ] X\u00e1c minh \u0111\u00e1p \u1ee9ng y\u00eau c\u1ea7u h\u1ec7 th\u1ed1ng</li> <li>[ ] C\u00e0i \u0111\u1eb7t ph\u1ea7n m\u1ec1m c\u1ea7n thi\u1ebft (Node.js, pnpm, MongoDB)</li> <li>[ ] C\u00f3 s\u1eb5n Mapbox access token (cho maps)</li> <li>[ ] Chu\u1ea9n b\u1ecb t\u00ean mi\u1ec1n (ch\u1ec9 cho production)</li> <li>[ ] Xem l\u1ea1i T\u1ed5ng quan Ki\u1ebfn tr\u00fac</li> </ul>"},{"location":"vi/installation/#van-e-cai-at-thuong-gap","title":"V\u1ea5n \u0111\u1ec1 C\u00e0i \u0111\u1eb7t Th\u01b0\u1eddng g\u1eb7p","text":""},{"location":"vi/installation/#khong-khop-phien-ban-nodejs","title":"Kh\u00f4ng kh\u1edbp Phi\u00ean b\u1ea3n Node.js","text":"<p>V\u1ea5n \u0111\u1ec1: S\u1eed d\u1ee5ng phi\u00ean b\u1ea3n Node.js kh\u00f4ng \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># C\u00e0i \u0111\u1eb7t nvm (Node Version Manager)\n# Sau \u0111\u00f3 s\u1eed d\u1ee5ng phi\u00ean b\u1ea3n node c\u1ee7a project\nnvm install 18\nnvm use 18\n</code></pre>"},{"location":"vi/installation/#ket-noi-mongodb-that-bai","title":"K\u1ebft n\u1ed1i MongoDB Th\u1ea5t b\u1ea1i","text":"<p>V\u1ea5n \u0111\u1ec1: MongoDB kh\u00f4ng ch\u1ea1y ho\u1eb7c connection string sai</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># Windows\nnet start MongoDB\n\n# Linux/macOS\nsudo systemctl start mongod\n\n# Ho\u1eb7c s\u1eed d\u1ee5ng Docker\ndocker run -d -p 27017:27017 mongo:6\n</code></pre>"},{"location":"vi/installation/#port-a-uoc-su-dung","title":"Port \u0110\u00e3 \u0111\u01b0\u1ee3c S\u1eed d\u1ee5ng","text":"<p>V\u1ea5n \u0111\u1ec1: Port 3000 \u0111\u00e3 b\u1ecb chi\u1ebfm</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># T\u00ecm v\u00e0 kill process\nnpx kill-port 3000\n\n# Ho\u1eb7c s\u1eed d\u1ee5ng port kh\u00e1c\nPORT=3001 pnpm dev\n</code></pre>"},{"location":"vi/installation/#khong-tim-thay-pnpm","title":"Kh\u00f4ng t\u00ecm th\u1ea5y pnpm","text":"<p>V\u1ea5n \u0111\u1ec1: pnpm ch\u01b0a \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t globally</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code>npm install -g pnpm\n</code></pre>"},{"location":"vi/installation/#sau-khi-cai-at","title":"Sau khi C\u00e0i \u0111\u1eb7t","text":"<p>Sau khi c\u00e0i \u0111\u1eb7t th\u00e0nh c\u00f4ng:</p> <ol> <li> <p>X\u00e1c minh Thi\u1ebft l\u1eadp</p> </li> <li> <p>[ ] Dashboard t\u1ea3i t\u1ea1i http://localhost:3000</p> </li> <li>[ ] Admin panel c\u00f3 th\u1ec3 truy c\u1eadp t\u1ea1i /admin</li> <li>[ ] C\u00f3 th\u1ec3 t\u1ea1o t\u00e0i kho\u1ea3n ng\u01b0\u1eddi d\u00f9ng \u0111\u1ea7u ti\u00ean</li> <li> <p>[ ] Maps render \u0111\u00fang</p> </li> <li> <p>C\u1ea5u h\u00ecnh Ban \u0111\u1ea7u</p> </li> <li> <p>[ ] Thi\u1ebft l\u1eadp t\u00e0i kho\u1ea3n admin</p> </li> <li>[ ] C\u1ea5u h\u00ecnh data sources (H\u01b0\u1edbng d\u1eabn C\u1ea5u h\u00ecnh)</li> <li> <p>[ ] T\u1ea3i d\u1eef li\u1ec7u m\u1eabu (t\u00f9y ch\u1ecdn)</p> </li> <li> <p>C\u00e1c b\u01b0\u1edbc Ti\u1ebfp theo</p> </li> <li>\u0110\u1ecdc H\u01b0\u1edbng d\u1eabn S\u1eed d\u1ee5ng \u0111\u1ec3 h\u1ecdc c\u00e1c t\u00ednh n\u0103ng</li> <li>Kh\u00e1m ph\u00e1 H\u01b0\u1edbng d\u1eabn Ph\u00e1t tri\u1ec3n \u0111\u1ec3 t\u00f9y ch\u1ec9nh</li> <li>Ki\u1ec3m tra C\u1ea5u h\u00ecnh cho thi\u1ebft l\u1eadp n\u00e2ng cao</li> </ol>"},{"location":"vi/installation/#nhan-tro-giup","title":"Nh\u1eadn Tr\u1ee3 gi\u00fap","text":"<p>N\u1ebfu b\u1ea1n g\u1eb7p v\u1ea5n \u0111\u1ec1:</p> <ul> <li>\ud83d\udcd6 H\u01b0\u1edbng d\u1eabn Kh\u1eafc ph\u1ee5c S\u1ef1 c\u1ed1</li> <li>\ud83d\udc1b GitHub Issues</li> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udce7 Li\u00ean h\u1ec7: CTU-SematX Team</li> </ul> <p>S\u1eb5n s\u00e0ng c\u00e0i \u0111\u1eb7t? Ch\u1ecdn ph\u01b0\u01a1ng ph\u00e1p c\u00e0i \u0111\u1eb7t c\u1ee7a b\u1ea1n:</p> <ul> <li>Thi\u1ebft l\u1eadp Ph\u00e1t tri\u1ec3n Local - D\u00e0nh cho developers</li> <li>Thi\u1ebft l\u1eadp Docker - Kh\u1edfi \u0111\u1ed9ng nhanh v\u1edbi containers</li> <li>Tri\u1ec3n khai Production - Cho staging/production</li> </ul>"},{"location":"vi/installation/development/","title":"Thi\u1ebft l\u1eadp Development Environment","text":"<p>H\u01b0\u1edbng d\u1eabn ho\u00e0n ch\u1ec9nh cho vi\u1ec7c thi\u1ebft l\u1eadp m\u1ed9t development environment \u0111\u1ec3 contribute v\u00e0o LegoCity.</p>"},{"location":"vi/installation/development/#tong-quan","title":"T\u1ed5ng quan","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y d\u00e0nh cho developers mu\u1ed1n:</p> <ul> <li>\ud83d\udee0\ufe0f X\u00e2y d\u1ef1ng features m\u1edbi</li> <li>\ud83d\udc1b S\u1eeda bugs v\u00e0 issues</li> <li>\ud83e\uddea Vi\u1ebft v\u00e0 ch\u1ea1y tests</li> <li>\ud83d\udce6 T\u1ea1o custom blocks v\u00e0 plugins</li> <li>\ud83d\udd0d Debug v\u00e0 profile code</li> </ul>"},{"location":"vi/installation/development/#ieu-kien-tien-quyet","title":"\u0110i\u1ec1u ki\u1ec7n Ti\u00ean quy\u1ebft","text":""},{"location":"vi/installation/development/#cong-cu-bat-buoc","title":"C\u00f4ng c\u1ee5 B\u1eaft bu\u1ed9c","text":"<p>C\u00e0i \u0111\u1eb7t nh\u1eefng c\u00f4ng c\u1ee5 n\u00e0y tr\u01b0\u1edbc khi ti\u1ebfp t\u1ee5c:</p> Node.js &amp; pnpmGitMongoDBVS Code (\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb) <pre><code># Ki\u1ec3m tra phi\u00ean b\u1ea3n Node.js (c\u1ea7n 18.x ho\u1eb7c 20.x)\nnode --version\n\n# C\u00e0i \u0111\u1eb7t pnpm globally\nnpm install -g pnpm\n\n# X\u00e1c minh pnpm\npnpm --version\n</code></pre> <pre><code># Ki\u1ec3m tra c\u00e0i \u0111\u1eb7t Git\ngit --version\n\n# C\u1ea5u h\u00ecnh Git\ngit config --global user.name \"Your Name\"\ngit config --global user.email \"your.email@example.com\"\n</code></pre> <p>Option 1: C\u00e0i \u0111\u1eb7t Local <pre><code># Windows (qua Chocolatey)\nchoco install mongodb\n\n# macOS (qua Homebrew)\nbrew install mongodb-community\n\n# Linux (Ubuntu/Debian)\nsudo apt install mongodb\n</code></pre></p> <p>Option 2: Docker <pre><code>docker run -d -p 27017:27017 --name mongodb mongo:6\n</code></pre></p> <p>C\u00e0i \u0111\u1eb7t Visual Studio Code v\u1edbi extensions:</p> <ul> <li>ESLint</li> <li>Prettier</li> <li>TypeScript and JavaScript Language Features</li> <li>Tailwind CSS IntelliSense</li> <li>MongoDB for VS Code</li> </ul>"},{"location":"vi/installation/development/#cong-cu-tuy-chon","title":"C\u00f4ng c\u1ee5 T\u00f9y ch\u1ecdn","text":"<p>N\u00e2ng cao tr\u1ea3i nghi\u1ec7m development c\u1ee7a b\u1ea1n:</p> <ul> <li>Docker Desktop - Cho containerized services</li> <li>Postman ho\u1eb7c Insomnia - API testing</li> <li>MongoDB Compass - Database GUI</li> <li>Redux DevTools - State debugging</li> </ul>"},{"location":"vi/installation/development/#thiet-lap-ban-au","title":"Thi\u1ebft l\u1eadp Ban \u0111\u1ea7u","text":""},{"location":"vi/installation/development/#1-fork-clone-repository","title":"1. Fork &amp; Clone Repository","text":"<pre><code># Fork tr\u00ean GitHub tr\u01b0\u1edbc, sau \u0111\u00f3:\ngit clone https://github.com/YOUR_USERNAME/LegoCity.git\ncd LegoCity\n\n# Th\u00eam upstream remote\ngit remote add upstream https://github.com/CTU-SematX/LegoCity.git\n\n# X\u00e1c minh remotes\ngit remote -v\n</code></pre>"},{"location":"vi/installation/development/#2-cai-at-dependencies","title":"2. C\u00e0i \u0111\u1eb7t Dependencies","text":"<pre><code>cd dashboard\npnpm install\n</code></pre> <p>\u0110i\u1ec1u n\u00e0y c\u00e0i \u0111\u1eb7t:</p> <ul> <li>Next.js framework</li> <li>PayloadCMS v\u00e0 plugins</li> <li>React v\u00e0 UI libraries</li> <li>Development tools</li> </ul>"},{"location":"vi/installation/development/#3-thiet-lap-environment","title":"3. Thi\u1ebft l\u1eadp Environment","text":"<pre><code># Copy example env file\ncp .env.example .env\n</code></pre> <p>Ch\u1ec9nh s\u1eeda <code>.env</code> v\u1edbi development settings:</p> <pre><code># Database\nDATABASE_URI=mongodb://127.0.0.1/legocity-dev\n\n# Security (t\u1ea1o v\u1edbi: openssl rand -hex 32)\nPAYLOAD_SECRET=dev-secret-min-32-characters-long-replace-in-production\n\n# Server\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Mapbox (l\u1ea5y token t\u1eeb mapbox.com)\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_token\n\n# NGSI-LD Context Broker (n\u1ebfu ch\u1ea1y locally)\nNGSI_LD_BROKER_URL=http://localhost:1026\n\n# Development\nNODE_ENV=development\n</code></pre>"},{"location":"vi/installation/development/#4-khoi-ong-development-server","title":"4. Kh\u1edfi \u0111\u1ed9ng Development Server","text":"<pre><code># Kh\u1edfi \u0111\u1ed9ng v\u1edbi hot reload\npnpm dev\n\n# Ho\u1eb7c v\u1edbi turbopack (nhanh h\u01a1n)\npnpm dev --turbo\n</code></pre> <p>Truy c\u1eadp t\u1ea1i:</p> <ul> <li>Frontend: http://localhost:3000</li> <li>Admin: http://localhost:3000/admin</li> <li>API: http://localhost:3000/api</li> </ul>"},{"location":"vi/installation/development/#5-tao-admin-account","title":"5. T\u1ea1o Admin Account","text":"<p>Khi l\u1ea7n \u0111\u1ea7u truy c\u1eadp <code>/admin</code>, b\u1ea1n s\u1ebd t\u1ea1o user \u0111\u1ea7u ti\u00ean:</p> <pre><code>Email: dev@example.com\nPassword: [ch\u1ecdn password m\u1ea1nh]\n</code></pre>"},{"location":"vi/installation/development/#branch-strategy","title":"Branch Strategy","text":"<pre><code># Lu\u00f4n b\u1eaft \u0111\u1ea7u t\u1eeb main m\u1edbi nh\u1ea5t\ngit checkout main\ngit pull upstream main\n\n# T\u1ea1o feature branch\ngit checkout -b feature/your-feature-name\n\n# Ho\u1eb7c bug fix branch\ngit checkout -b fix/issue-123\n</code></pre>"},{"location":"vi/installation/development/#thuc-hien-thay-oi","title":"Th\u1ef1c hi\u1ec7n Thay \u0111\u1ed5i","text":"<ol> <li>Edit Code - Th\u1ef1c hi\u1ec7n thay \u0111\u1ed5i trong <code>dashboard/src/</code></li> <li>Hot Reload - Thay \u0111\u1ed5i xu\u1ea5t hi\u1ec7n t\u1ef1 \u0111\u1ed9ng</li> <li>Check Console - Theo d\u00f5i errors</li> <li>Test Changes - X\u00e1c minh functionality ho\u1ea1t \u0111\u1ed9ng</li> </ol>"},{"location":"vi/installation/development/#code-style","title":"Code Style","text":"<p>LegoCity s\u1eed d\u1ee5ng ESLint v\u00e0 Prettier:</p> <pre><code># Ki\u1ec3m tra linting\npnpm lint\n\n# T\u1ef1 \u0111\u1ed9ng s\u1eeda issues\npnpm lint:fix\n\n# Format code\npnpm format\n</code></pre>"},{"location":"vi/installation/development/#type-checking","title":"Type Checking","text":"<pre><code># Ki\u1ec3m tra TypeScript types\npnpm type-check\n\n# Build \u0111\u1ec3 x\u00e1c minh kh\u00f4ng c\u00f3 errors\npnpm build\n</code></pre>"},{"location":"vi/installation/development/#cau-truc-project","title":"C\u1ea5u tr\u00fac Project","text":"<pre><code>dashboard/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/              # Next.js App Router\n\u2502   \u2502   \u251c\u2500\u2500 (frontend)/   # Public pages\n\u2502   \u2502   \u2514\u2500\u2500 (payload)/    # Admin routes\n\u2502   \u251c\u2500\u2500 blocks/           # PayloadCMS blocks\n\u2502   \u251c\u2500\u2500 collections/      # Content types\n\u2502   \u251c\u2500\u2500 components/       # React components\n\u2502   \u251c\u2500\u2500 fields/           # Custom fields\n\u2502   \u251c\u2500\u2500 hooks/            # React hooks\n\u2502   \u251c\u2500\u2500 plugins/          # PayloadCMS plugins\n\u2502   \u251c\u2500\u2500 providers/        # Context providers\n\u2502   \u2514\u2500\u2500 utilities/        # Helper functions\n\u251c\u2500\u2500 public/               # Static assets\n\u251c\u2500\u2500 payload.config.ts     # C\u1ea5u h\u00ecnh CMS\n\u2514\u2500\u2500 next.config.js        # C\u1ea5u h\u00ecnh Next.js\n</code></pre>"},{"location":"vi/installation/development/#them-mot-block-moi","title":"Th\u00eam m\u1ed9t Block M\u1edbi","text":"<ol> <li>T\u1ea1o block directory:</li> </ol> <pre><code>mkdir -p src/blocks/MyBlock\n</code></pre> <ol> <li>T\u1ea1o config:</li> </ol> <pre><code>// src/blocks/MyBlock/config.ts\nimport { Block } from \"payload/types\";\n\nexport const MyBlock: Block = {\n  slug: \"myBlock\",\n  fields: [\n    {\n      name: \"title\",\n      type: \"text\",\n      required: true,\n    },\n  ],\n};\n</code></pre> <ol> <li>T\u1ea1o component:</li> </ol> <pre><code>// src/blocks/MyBlock/Component.tsx\nexport const MyBlockComponent = ({ title }) =&gt; &lt;div&gt;{title}&lt;/div&gt;;\n</code></pre> <ol> <li>\u0110\u0103ng k\u00fd trong <code>RenderBlocks.tsx</code></li> </ol> <p>Xem Creating Blocks Guide cho chi ti\u1ebft.</p>"},{"location":"vi/installation/development/#tao-mot-collection","title":"T\u1ea1o m\u1ed9t Collection","text":"<pre><code>// src/collections/MyCollection.ts\nimport { CollectionConfig } from \"payload/types\";\n\nexport const MyCollection: CollectionConfig = {\n  slug: \"my-collection\",\n  admin: {\n    useAsTitle: \"name\",\n  },\n  fields: [\n    {\n      name: \"name\",\n      type: \"text\",\n      required: true,\n    },\n  ],\n};\n</code></pre> <p>\u0110\u0103ng k\u00fd trong <code>payload.config.ts</code>:</p> <pre><code>collections: [\n  // ... existing\n  MyCollection,\n],\n</code></pre>"},{"location":"vi/installation/development/#viet-tests","title":"Vi\u1ebft Tests","text":"<pre><code># Ch\u1ea1y t\u1ea5t c\u1ea3 tests\npnpm test\n\n# Ch\u1ea1y specific test\npnpm test blocks\n\n# Watch mode\npnpm test:watch\n\n# Coverage report\npnpm test:coverage\n</code></pre> <p>Example test:</p> <pre><code>// src/blocks/MyBlock/MyBlock.test.ts\nimport { render } from \"@testing-library/react\";\nimport { MyBlockComponent } from \"./Component\";\n\ndescribe(\"MyBlock\", () =&gt; {\n  it(\"renders title\", () =&gt; {\n    const { getByText } = render(&lt;MyBlockComponent title=\"Test\" /&gt;);\n    expect(getByText(\"Test\")).toBeInTheDocument();\n  });\n});\n</code></pre>"},{"location":"vi/installation/development/#vs-code-debug-configuration","title":"VS Code Debug Configuration","text":"<p>T\u1ea1o <code>.vscode/launch.json</code>:</p> <pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Next.js: debug server-side\",\n      \"type\": \"node-terminal\",\n      \"request\": \"launch\",\n      \"command\": \"pnpm dev\"\n    },\n    {\n      \"name\": \"Next.js: debug client-side\",\n      \"type\": \"chrome\",\n      \"request\": \"launch\",\n      \"url\": \"http://localhost:3000\"\n    }\n  ]\n}\n</code></pre>"},{"location":"vi/installation/development/#browser-devtools","title":"Browser DevTools","text":"<ul> <li>React DevTools - Inspect component tree</li> <li>Network Tab - Debug API calls</li> <li>Console - Xem logs v\u00e0 errors</li> </ul>"},{"location":"vi/installation/development/#lam-viec-voi-mongodb","title":"L\u00e0m vi\u1ec7c v\u1edbi MongoDB","text":""},{"location":"vi/installation/development/#mongodb-compass","title":"MongoDB Compass","text":"<p>K\u1ebft n\u1ed1i t\u1edbi: <code>mongodb://127.0.0.1:27017/legocity-dev</code></p> <p>Xem v\u00e0 ch\u1ec9nh s\u1eeda:</p> <ul> <li>Collections (Pages, Posts, Media, v.v.)</li> <li>Documents</li> <li>Indexes</li> </ul>"},{"location":"vi/installation/development/#command-line","title":"Command Line","text":"<pre><code># K\u1ebft n\u1ed1i t\u1edbi database\nmongosh legocity-dev\n\n# Li\u1ec7t k\u00ea collections\nshow collections\n\n# T\u00ecm documents\ndb.pages.find().pretty()\n\n# X\u00f3a collection\ndb.pages.deleteMany({})\n</code></pre>"},{"location":"vi/installation/development/#development-build","title":"Development Build","text":"<pre><code># Build cho development\npnpm build\n\n# Kh\u1edfi \u0111\u1ed9ng production server\npnpm start\n</code></pre>"},{"location":"vi/installation/development/#production-build","title":"Production Build","text":"<pre><code># Build t\u1ed1i \u01b0u cho production\nNODE_ENV=production pnpm build\n\n# Ph\u00e2n t\u00edch bundle size\npnpm build --analyze\n</code></pre>"},{"location":"vi/installation/development/#quality-checks","title":"Quality Checks","text":"<pre><code># Ch\u1ea1y t\u1ea5t c\u1ea3 checks tr\u01b0\u1edbc khi commit\npnpm lint        # ESLint\npnpm type-check  # TypeScript\npnpm test        # Jest tests\npnpm build       # Production build\n</code></pre>"},{"location":"vi/installation/development/#commit-changes","title":"Commit Changes","text":"<pre><code># Stage changes\ngit add .\n\n# Commit v\u1edbi descriptive message\ngit commit -m \"feat: add new block component\"\n\n# Tu\u00e2n theo conventional commits:\n# feat: feature m\u1edbi\n# fix: s\u1eeda bug\n# docs: t\u00e0i li\u1ec7u\n# style: formatting\n# refactor: c\u1ea5u tr\u00fac l\u1ea1i code\n# test: th\u00eam tests\n# chore: maintenance\n</code></pre>"},{"location":"vi/installation/development/#push-tao-pr","title":"Push &amp; T\u1ea1o PR","text":"<pre><code># Push l\u00ean fork c\u1ee7a b\u1ea1n\ngit push origin feature/your-feature\n\n# T\u1ea1o Pull Request tr\u00ean GitHub\n# \u0110i\u1ec1n PR template\n# \u0110\u1ee3i review\n</code></pre>"},{"location":"vi/installation/development/#giu-fork-updated","title":"Gi\u1eef Fork Updated","text":"<pre><code># Fetch upstream changes\ngit fetch upstream\n\n# C\u1eadp nh\u1eadt main branch\ngit checkout main\ngit merge upstream/main\ngit push origin main\n\n# Rebase feature branch\ngit checkout feature/your-feature\ngit rebase main\n</code></pre>"},{"location":"vi/installation/development/#port-3000-a-uoc-su-dung","title":"Port 3000 \u0110\u00e3 \u0111\u01b0\u1ee3c S\u1eed d\u1ee5ng","text":"<pre><code># Kill process\nnpx kill-port 3000\n\n# Ho\u1eb7c s\u1eed d\u1ee5ng port kh\u00e1c\nPORT=3001 pnpm dev\n</code></pre>"},{"location":"vi/installation/development/#build-errors","title":"Build Errors","text":"<pre><code># X\u00f3a cache\nrm -rf .next node_modules\npnpm install\npnpm dev\n</code></pre>"},{"location":"vi/installation/development/#mongodb-connection-issues","title":"MongoDB Connection Issues","text":"<pre><code># Ki\u1ec3m tra MongoDB \u0111ang ch\u1ea1y\nmongosh --eval \"db.version()\"\n\n# Kh\u1edfi \u0111\u1ed9ng l\u1ea1i MongoDB\n# Windows: net restart MongoDB\n# Linux: sudo systemctl restart mongod\n</code></pre>"},{"location":"vi/installation/development/#type-errors","title":"Type Errors","text":"<pre><code># T\u1ea1o l\u1ea1i Payload types\npnpm payload generate:types\n\n# Ki\u1ec3m tra tsconfig.json paths\n</code></pre>"},{"location":"vi/installation/development/#code-quality","title":"Code Quality","text":"<p>\u2705 Vi\u1ebft TypeScript, tr\u00e1nh <code>any</code> \u2705 Tu\u00e2n theo ESLint rules \u2705 Vi\u1ebft tests cho features m\u1edbi \u2705 Document logic ph\u1ee9c t\u1ea1p</p>"},{"location":"vi/installation/development/#performance","title":"Performance","text":"<p>\u2705 S\u1eed d\u1ee5ng React Server Components khi c\u00f3 th\u1ec3 \u2705 T\u1ed1i \u01b0u images v\u1edbi <code>next/image</code> \u2705 Lazy load heavy components \u2705 Monitor bundle size</p>"},{"location":"vi/installation/development/#security","title":"Security","text":"<p>\u2705 Kh\u00f4ng bao gi\u1edd commit secrets \u2705 Validate user inputs \u2705 S\u1eed d\u1ee5ng environment variables \u2705 Gi\u1eef dependencies updated</p>"},{"location":"vi/installation/development/#git","title":"Git","text":"<p>\u2705 Vi\u1ebft commit messages r\u00f5 r\u00e0ng \u2705 Gi\u1eef PRs focused v\u00e0 nh\u1ecf \u2705 Rebase tr\u01b0\u1edbc khi push \u2705 Review PR c\u1ee7a ch\u00ednh b\u1ea1n tr\u01b0\u1edbc</p>"},{"location":"vi/installation/development/#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udc1b Report Issues</li> <li>\ud83d\udce7 Email: CTU-SematX Team</li> </ul> <p>Environment s\u1eb5n s\u00e0ng? B\u1eaft \u0111\u1ea7u x\u00e2y d\u1ef1ng v\u1edbi Development Guide.</p>"},{"location":"vi/installation/docker/","title":"H\u01b0\u1edbng d\u1eabn thi\u1ebft l\u1eadp Docker","text":"<p>Ch\u1ea1y LegoCity trong containers v\u1edbi Docker Compose - c\u00e1ch nhanh nh\u1ea5t \u0111\u1ec3 b\u1eaft \u0111\u1ea7u.</p>"},{"location":"vi/installation/docker/#tong-quan","title":"T\u1ed5ng quan","text":"<p>\u01afu \u0111i\u1ec3m:</p> <ul> <li>\u2705 Thi\u1ebft l\u1eadp m\u1ed9t l\u1ec7nh</li> <li>\u2705 T\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch v\u1ee5 \u0111\u01b0\u1ee3c \u0111\u00f3ng g\u00f3i trong container (Next.js, MongoDB, Orion-LD)</li> <li>\u2705 Nh\u1ea5t qu\u00e1n gi\u1eefa c\u00e1c m\u00f4i tr\u01b0\u1eddng</li> <li>\u2705 D\u1ec5 d\u00e0ng d\u1ecdn d\u1eb9p</li> </ul> <p>Nh\u01b0\u1ee3c \u0111i\u1ec3m:</p> <ul> <li>\u26a0\ufe0f \u00cdt linh ho\u1ea1t cho ph\u00e1t tri\u1ec3n</li> <li>\u26a0\ufe0f Y\u00eau c\u1ea7u Docker Desktop (Windows/Mac) ho\u1eb7c Docker Engine (Linux)</li> </ul>"},{"location":"vi/installation/docker/#yeu-cau","title":"Y\u00eau c\u1ea7u","text":""},{"location":"vi/installation/docker/#cai-at-docker","title":"C\u00e0i \u0111\u1eb7t Docker","text":"WindowsmacOSLinux <p>T\u1ea3i v\u00e0 c\u00e0i \u0111\u1eb7t Docker Desktop for Windows</p> <pre><code># Ki\u1ec3m tra c\u00e0i \u0111\u1eb7t\ndocker --version\ndocker compose version\n</code></pre> <p>T\u1ea3i v\u00e0 c\u00e0i \u0111\u1eb7t Docker Desktop for Mac</p> <pre><code># Ki\u1ec3m tra c\u00e0i \u0111\u1eb7t\ndocker --version\ndocker compose version\n</code></pre> <pre><code># C\u00e0i Docker Engine\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n\n# C\u00e0i Docker Compose\nsudo apt install docker-compose-plugin\n\n# Th\u00eam user v\u00e0o docker group\nsudo usermod -aG docker $USER\nnewgrp docker\n\n# Ki\u1ec3m tra\ndocker --version\ndocker compose version\n</code></pre>"},{"location":"vi/installation/docker/#yeu-cau-he-thong","title":"Y\u00eau c\u1ea7u h\u1ec7 th\u1ed1ng","text":"<ul> <li>RAM: T\u1ed1i thi\u1ec3u 4 GB, khuy\u1ebfn ngh\u1ecb 8 GB</li> <li>Storage: 10 GB dung l\u01b0\u1ee3ng tr\u1ed1ng</li> <li>CPU: T\u1ed1i thi\u1ec3u 2 cores</li> </ul>"},{"location":"vi/installation/docker/#khoi-ong-nhanh","title":"Kh\u1edfi \u0111\u1ed9ng nhanh","text":""},{"location":"vi/installation/docker/#1-clone-kho-luu-tru","title":"1. Clone Kho l\u01b0u tr\u1eef","text":"<pre><code>git clone https://github.com/CTU-SematX/LegoCity.git\ncd LegoCity\n</code></pre>"},{"location":"vi/installation/docker/#2-cau-hinh-environment","title":"2. C\u1ea5u h\u00ecnh Environment","text":"<pre><code># Copy file environment m\u1eabu\ncp dashboard/.env.example dashboard/.env\n</code></pre> <p>Ch\u1ec9nh s\u1eeda <code>dashboard/.env</code>:</p> <pre><code># Database (s\u1eed d\u1ee5ng t\u00ean d\u1ecbch v\u1ee5 Docker)\nDATABASE_URI=mongodb://mongodb:27017/legocity\n\n# B\u1ea3o m\u1eadt\nPAYLOAD_SECRET=your-secret-key-min-32-chars\n\n# Server (expose ra host)\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Mapbox\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_mapbox_token\n\n# NGSI-LD Broker (s\u1eed d\u1ee5ng t\u00ean d\u1ecbch v\u1ee5 Docker)\nNGSI_LD_BROKER_URL=http://orion:1026\n</code></pre>"},{"location":"vi/installation/docker/#3-khoi-ong-tat-ca-dich-vu","title":"3. Kh\u1edfi \u0111\u1ed9ng t\u1ea5t c\u1ea3 D\u1ecbch v\u1ee5","text":"<pre><code>docker compose up -d\n</code></pre> <p>L\u1ec7nh n\u00e0y s\u1ebd kh\u1edfi \u0111\u1ed9ng:</p> <ul> <li>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n (Next.js + PayloadCMS) - Port 3000</li> <li>MongoDB - Port 27017</li> <li>Orion-LD (NGSI-LD Broker) - Port 1026</li> </ul>"},{"location":"vi/installation/docker/#4-kiem-tra-dich-vu","title":"4. Ki\u1ec3m tra D\u1ecbch v\u1ee5","text":"<pre><code># Xem tr\u1ea1ng th\u00e1i containers\ndocker compose ps\n\n# Xem logs\ndocker compose logs -f dashboard\n</code></pre>"},{"location":"vi/installation/docker/#5-truy-cap-bang-ieu-khien","title":"5. Truy c\u1eadp B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n","text":"<p>M\u1edf tr\u00ecnh duy\u1ec7t:</p> <ul> <li>B\u1ea3ng \u0111i\u1ec1u khi\u1ec3n: http://localhost:3000</li> <li>B\u1ea3ng qu\u1ea3n tr\u1ecb: http://localhost:3000/admin</li> <li>Orion-LD API: http://localhost:1026</li> </ul>"},{"location":"vi/installation/docker/#docker-compose-file","title":"Docker Compose File","text":"<p>File <code>docker-compose.yml</code> m\u1eb7c \u0111\u1ecbnh:</p> <pre><code>version: \"3.8\"\n\nservices:\n  dashboard:\n    build:\n      context: ./dashboard\n      dockerfile: Dockerfile\n    ports:\n      - \"3000:3000\"\n    environment:\n      - DATABASE_URI=mongodb://mongodb:27017/legocity\n      - PAYLOAD_SECRET=${PAYLOAD_SECRET}\n      - NEXT_PUBLIC_MAPBOX_TOKEN=${NEXT_PUBLIC_MAPBOX_TOKEN}\n    depends_on:\n      - mongodb\n    volumes:\n      - ./dashboard:/app\n      - /app/node_modules\n    command: pnpm dev\n\n  mongodb:\n    image: mongo:latest\n    ports:\n      - \"27017:27017\"\n    volumes:\n      - mongodb_data:/data/db\n\n  orion:\n    image: fiware/orion-ld:latest\n    ports:\n      - \"1026:1026\"\n    depends_on:\n      - mongodb\n    command: -dbhost mongodb -logLevel DEBUG\n\nvolumes:\n  mongodb_data:\n</code></pre>"},{"location":"vi/installation/docker/#quan-ly-services","title":"Qu\u1ea3n l\u00fd Services","text":""},{"location":"vi/installation/docker/#khoi-ong","title":"Kh\u1edfi \u0111\u1ed9ng","text":"<pre><code># Kh\u1edfi \u0111\u1ed9ng t\u1ea5t c\u1ea3\ndocker compose up -d\n\n# Kh\u1edfi \u0111\u1ed9ng service c\u1ee5 th\u1ec3\ndocker compose up -d dashboard\n\n# Xem logs real-time\ndocker compose logs -f\n</code></pre>"},{"location":"vi/installation/docker/#dung","title":"D\u1eebng","text":"<pre><code># D\u1eebng t\u1ea5t c\u1ea3\ndocker compose down\n\n# D\u1eebng v\u00e0 x\u00f3a volumes\ndocker compose down -v\n\n# Gi\u1eef l\u1ea1i data\ndocker compose stop\n</code></pre>"},{"location":"vi/installation/docker/#khoi-ong-lai","title":"Kh\u1edfi \u0111\u1ed9ng l\u1ea1i","text":"<pre><code># Kh\u1edfi \u0111\u1ed9ng l\u1ea1i t\u1ea5t c\u1ea3\ndocker compose restart\n\n# Kh\u1edfi \u0111\u1ed9ng l\u1ea1i service c\u1ee5 th\u1ec3\ndocker compose restart dashboard\n</code></pre>"},{"location":"vi/installation/docker/#rebuild","title":"Rebuild","text":"<pre><code># Rebuild t\u1ea5t c\u1ea3 images\ndocker compose build\n\n# Rebuild v\u00e0 kh\u1edfi \u0111\u1ed9ng\ndocker compose up -d --build\n\n# Rebuild service c\u1ee5 th\u1ec3\ndocker compose build dashboard\n</code></pre>"},{"location":"vi/installation/docker/#phat-trien-voi-docker","title":"Ph\u00e1t tri\u1ec3n v\u1edbi Docker","text":""},{"location":"vi/installation/docker/#hot-reload","title":"Hot Reload","text":"<p>File <code>docker-compose.yml</code> \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh v\u1edbi volumes \u0111\u1ec3 enable hot reload:</p> <pre><code>volumes:\n  - ./dashboard:/app\n  - /app/node_modules # Preserve node_modules in container\n</code></pre> <p>Changes trong <code>./dashboard</code> s\u1ebd t\u1ef1 \u0111\u1ed9ng reflect trong container.</p>"},{"location":"vi/installation/docker/#chay-commands-trong-container","title":"Ch\u1ea1y Commands trong Container","text":"<pre><code># M\u1edf shell trong dashboard container\ndocker compose exec dashboard sh\n\n# Ch\u1ea1y pnpm commands\ndocker compose exec dashboard pnpm install\ndocker compose exec dashboard pnpm add &lt;package&gt;\n\n# Ch\u1ea1y tests\ndocker compose exec dashboard pnpm test\n</code></pre>"},{"location":"vi/installation/docker/#truy-cap-database","title":"Truy c\u1eadp Database","text":"<pre><code># M\u1edf MongoDB shell\ndocker compose exec mongodb mongosh\n\n# Ho\u1eb7c t\u1eeb host (n\u1ebfu c\u00f3 mongosh)\nmongosh mongodb://localhost:27017/legocity\n</code></pre>"},{"location":"vi/installation/docker/#kiem-tra-orion-ld","title":"Ki\u1ec3m tra Orion-LD","text":"<pre><code># Health check\ncurl http://localhost:1026/version\n\n# L\u1ea5y entities\ncurl http://localhost:1026/ngsi-ld/v1/entities\n</code></pre>"},{"location":"vi/installation/docker/#tuy-chinh-cau-hinh","title":"T\u00f9y ch\u1ec9nh c\u1ea5u h\u00ecnh","text":""},{"location":"vi/installation/docker/#environment-variables","title":"Environment Variables","text":"<p>T\u1ea1o file <code>.env</code> trong root:</p> <pre><code># Dashboard\nPAYLOAD_SECRET=your-secret-here\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_token\nNEXT_PUBLIC_SERVER_URL=http://localhost:3000\n\n# Database\nMONGO_INITDB_ROOT_USERNAME=admin\nMONGO_INITDB_ROOT_PASSWORD=password\n\n# Orion-LD\nORION_LOG_LEVEL=INFO\n</code></pre>"},{"location":"vi/installation/docker/#custom-ports","title":"Custom Ports","text":"<p>Ch\u1ec9nh <code>docker-compose.yml</code>:</p> <pre><code>services:\n  dashboard:\n    ports:\n      - \"3001:3000\" # Host:Container\n\n  mongodb:\n    ports:\n      - \"27018:27017\"\n</code></pre>"},{"location":"vi/installation/docker/#persistent-storage","title":"Persistent Storage","text":"<p>Volumes \u0111\u01b0\u1ee3c t\u1ef1 \u0111\u1ed9ng t\u1ea1o v\u00e0 qu\u1ea3n l\u00fd:</p> <pre><code># Li\u1ec7t k\u00ea volumes\ndocker volume ls\n\n# Xem chi ti\u1ebft volume\ndocker volume inspect legocity_mongodb_data\n\n# Backup volume\ndocker run --rm -v legocity_mongodb_data:/data -v $(pwd):/backup \\\n  ubuntu tar czf /backup/mongodb-backup.tar.gz /data\n</code></pre>"},{"location":"vi/installation/docker/#thiet-lap-san-xuat","title":"Thi\u1ebft l\u1eadp s\u1ea3n xu\u1ea5t","text":""},{"location":"vi/installation/docker/#optimized-dockerfile","title":"Optimized Dockerfile","text":"<p>T\u1ea1o <code>dashboard/Dockerfile.prod</code>:</p> <pre><code>FROM node:20-alpine AS base\n\n# Dependencies\nFROM base AS deps\nWORKDIR /app\nCOPY package.json pnpm-lock.yaml ./\nRUN corepack enable &amp;&amp; pnpm install --frozen-lockfile\n\n# Builder\nFROM base AS builder\nWORKDIR /app\nCOPY --from=deps /app/node_modules ./node_modules\nCOPY . .\nRUN pnpm build\n\n# Runner\nFROM base AS runner\nWORKDIR /app\nENV NODE_ENV=production\n\nCOPY --from=builder /app/public ./public\nCOPY --from=builder /app/.next/standalone ./\nCOPY --from=builder /app/.next/static ./.next/static\n\nEXPOSE 3000\nCMD [\"node\", \"server.js\"]\n</code></pre>"},{"location":"vi/installation/docker/#production-compose","title":"Production Compose","text":"<p>T\u1ea1o <code>docker-compose.prod.yml</code>:</p> <pre><code>version: \"3.8\"\n\nservices:\n  dashboard:\n    build:\n      context: ./dashboard\n      dockerfile: Dockerfile.prod\n    restart: always\n    ports:\n      - \"3000:3000\"\n    environment:\n      - NODE_ENV=production\n    depends_on:\n      - mongodb\n\n  mongodb:\n    image: mongo:latest\n    restart: always\n    volumes:\n      - mongodb_data:/data/db\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME=${MONGO_USER}\n      - MONGO_INITDB_ROOT_PASSWORD=${MONGO_PASSWORD}\n\n  orion:\n    image: fiware/orion-ld:latest\n    restart: always\n    depends_on:\n      - mongodb\n    command: -dbhost mongodb -logLevel INFO\n\nvolumes:\n  mongodb_data:\n</code></pre> <p>Ch\u1ea1y production:</p> <pre><code>docker compose -f docker-compose.prod.yml up -d\n</code></pre>"},{"location":"vi/installation/docker/#xu-ly-su-co","title":"X\u1eed l\u00fd s\u1ef1 c\u1ed1","text":""},{"location":"vi/installation/docker/#container-khong-khoi-ong","title":"Container kh\u00f4ng kh\u1edfi \u0111\u1ed9ng","text":"<pre><code># Xem logs chi ti\u1ebft\ndocker compose logs dashboard\n\n# Ki\u1ec3m tra configuration\ndocker compose config\n\n# Xem container status\ndocker compose ps -a\n</code></pre>"},{"location":"vi/installation/docker/#port-conflicts","title":"Port conflicts","text":"<pre><code># T\u00ecm process \u0111ang d\u00f9ng port\n# Windows\nnetstat -ano | findstr :3000\n\n# macOS/Linux\nlsof -i :3000\n\n# Thay \u0111\u1ed5i port trong docker-compose.yml\n</code></pre>"},{"location":"vi/installation/docker/#memory-issues","title":"Memory issues","text":"<pre><code># T\u0103ng memory limit cho Docker Desktop\n# Settings \u2192 Resources \u2192 Memory\n\n# Ho\u1eb7c trong docker-compose.yml:\nservices:\n  dashboard:\n    deploy:\n      resources:\n        limits:\n          memory: 2G\n</code></pre>"},{"location":"vi/installation/docker/#network-issues","title":"Network issues","text":"<pre><code># T\u1ea1o l\u1ea1i network\ndocker compose down\ndocker network prune\ndocker compose up -d\n\n# Debug network\ndocker network inspect legocity_default\n</code></pre>"},{"location":"vi/installation/docker/#xoa-tat-ca","title":"X\u00f3a t\u1ea5t c\u1ea3","text":"<pre><code># D\u1eebng v\u00e0 x\u00f3a containers, networks\ndocker compose down\n\n# X\u00f3a th\u00eam volumes (X\u00d3A D\u1eee LI\u1ec6U!)\ndocker compose down -v\n\n# X\u00f3a images\ndocker compose down --rmi all\n</code></pre>"},{"location":"vi/installation/docker/#xoa-selective","title":"X\u00f3a selective","text":"<pre><code># Ch\u1ec9 x\u00f3a containers\ndocker compose rm\n\n# X\u00f3a unused images\ndocker image prune\n\n# X\u00f3a unused volumes\ndocker volume prune\n</code></pre>"},{"location":"vi/installation/docker/#cac-buoc-tiep-theo","title":"C\u00e1c b\u01b0\u1edbc ti\u1ebfp theo","text":"<ul> <li>\ud83d\udcda Ph\u00e1t tri\u1ec3n c\u1ee5c b\u1ed9 - Ph\u00e1t tri\u1ec3n kh\u00f4ng d\u00f9ng Docker</li> <li>\u2699\ufe0f H\u01b0\u1edbng d\u1eabn c\u1ea5u h\u00ecnh</li> <li>\ud83d\ude80 Production Deployment</li> <li>\ud83d\udd27 Kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1</li> </ul>"},{"location":"vi/installation/docker/#can-tro-giup","title":"C\u1ea7n tr\u1ee3 gi\u00fap?","text":"<ul> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udc1b Report Issues</li> </ul>"},{"location":"vi/installation/local/","title":"Thi\u1ebft l\u1eadp Development Local","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y gi\u1ea3i th\u00edch c\u00e1ch thi\u1ebft l\u1eadp m\u1ed9t m\u00f4i tr\u01b0\u1eddng development local cho LegoCity.</p> <p>\u0110\u1ed1i t\u01b0\u1ee3ng M\u1ee5c ti\u00eau</p> <p>H\u01b0\u1edbng d\u1eabn n\u00e0y d\u00e0nh cho contributors mu\u1ed1n:</p> <pre><code>- Ch\u1ea1y dashboard v\u00e0 PayloadCMS locally\n- Th\u1eed nghi\u1ec7m v\u1edbi blocks v\u00e0 views m\u1edbi\n- Ph\u00e1t tri\u1ec3n update servers v\u00e0 proxy behaviour\n\nC\u00e1c h\u01b0\u1edbng d\u1eabn l\u00e0 generic v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho vi\u1ec7c b\u1ea1n ch\u1ea1y everything v\u1edbi Docker, tr\u00ean VM, ho\u1eb7c tr\u1ef1c ti\u1ebfp tr\u00ean laptop c\u1ee7a b\u1ea1n.\n</code></pre>"},{"location":"vi/installation/local/#ieu-kien-tien-quyet","title":"\u0110i\u1ec1u ki\u1ec7n Ti\u00ean quy\u1ebft","text":""},{"location":"vi/installation/local/#cong-cu-bat-buoc","title":"C\u00f4ng c\u1ee5 B\u1eaft bu\u1ed9c","text":"Git <p>Clone repository v\u00e0 qu\u1ea3n l\u00fd branches</p> <pre><code>```bash\ngit --version\n```\n</code></pre> Node.js <p>S\u1eed d\u1ee5ng m\u1ed9t version t\u01b0\u01a1ng th\u00edch v\u1edbi dashboard v\u00e0 PayloadCMS</p> <pre><code>- Ki\u1ec3m tra `.nvmrc` ho\u1eb7c field `engines` trong `package.json`\n- N\u1ebfu kh\u00f4ng, s\u1eed d\u1ee5ng phi\u00ean b\u1ea3n LTS g\u1ea7n \u0111\u00e2y\n\n```bash\nnode --version\n```\n</code></pre> Package Manager <p>S\u1eed d\u1ee5ng package manager \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh b\u1edfi repository:</p> <pre><code>- `pnpm-lock.yaml` c\u00f3 m\u1eb7t \u2192 s\u1eed d\u1ee5ng **pnpm**\n- `yarn.lock` c\u00f3 m\u1eb7t \u2192 s\u1eed d\u1ee5ng **yarn**\n- N\u1ebfu kh\u00f4ng \u2192 s\u1eed d\u1ee5ng **npm**\n</code></pre> Docker (T\u00f9y ch\u1ecdn) <p>\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho vi\u1ec7c ch\u1ea1y supporting services</p> <pre><code>- Context broker\n- Databases\n- \u0110\u01a1n gi\u1ea3n h\u00f3a vi\u1ec7c kh\u1edbp deployment configuration\n\n```bash\ndocker --version\ndocker compose version\n```\n</code></pre>"},{"location":"vi/installation/local/#mapbox-access-token","title":"Mapbox Access Token","text":"<p>B\u1eaft bu\u1ed9c cho Map Rendering</p> <p>B\u1ea1n s\u1ebd c\u1ea7n m\u1ed9t Mapbox access token \u0111\u1ec3 render maps trong dashboard.</p> <pre><code>L\u1ea5y m\u1ed9t c\u00e1i t\u1ea1i [mapbox.com](https://www.mapbox.com/) v\u00e0 cung c\u1ea5p n\u00f3 qua:\n```\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_token_here\n```\n</code></pre>"},{"location":"vi/installation/local/#cau-truc-repository","title":"C\u1ea5u tr\u00fac Repository","text":"<pre><code>LegoCity/\n\u251c\u2500\u2500 dashboard/          # \u1ee8ng d\u1ee5ng Next.js\n\u2502   \u251c\u2500\u2500 src/           # Source code\n\u2502   \u251c\u2500\u2500 public/        # Static assets\n\u2502   \u2514\u2500\u2500 package.json   # Dependencies\n\u251c\u2500\u2500 docs/              # T\u00e0i li\u1ec7u MkDocs\n\u2502   \u251c\u2500\u2500 index.md      # Site n\u00e0y\n\u2502   \u2514\u2500\u2500 mkdocs.yml    # Config\n\u251c\u2500\u2500 orion-ld/         # C\u1ea5u h\u00ecnh NGSI-LD broker\n\u251c\u2500\u2500 proto/            # Prototypes\n\u2514\u2500\u2500 README.md         # T\u1ed5ng quan d\u1ef1 \u00e1n\n</code></pre> <p>Core pattern: <code>dashboard</code> + <code>docs</code> + <code>broker</code> + <code>support</code></p>"},{"location":"vi/installation/local/#2-tao-feature-branch","title":"2. T\u1ea1o Feature Branch","text":"<pre><code>git checkout -b feature/my-change\n</code></pre>"},{"location":"vi/installation/local/#3-cai-at-dependencies","title":"3. C\u00e0i \u0111\u1eb7t Dependencies","text":"S\u1eed d\u1ee5ng pnpm <p><code>bash     cd dashboard     pnpm install</code></p> S\u1eed d\u1ee5ng npm <p><code>bash     cd dashboard     npm install</code></p> S\u1eed d\u1ee5ng yarn <p><code>bash     cd dashboard     yarn install</code></p>"},{"location":"vi/installation/local/#cau-hinh-environment","title":"C\u1ea5u h\u00ecnh Environment","text":""},{"location":"vi/installation/local/#tao-environment-file","title":"T\u1ea1o Environment File","text":"<p>T\u1ea1o <code>.env</code> ho\u1eb7c <code>.env.local</code> trong th\u01b0 m\u1ee5c <code>dashboard/</code>:</p> dashboard/.env<pre><code># C\u1ea5u h\u00ecnh API\nNEXT_PUBLIC_API_BASE_URL=http://localhost:4000\n\n# Mapbox\nNEXT_PUBLIC_MAPBOX_TOKEN=pk.your_token_here\n\n# PayloadCMS Database\nDATABASE_URI=mongodb://localhost:27017/legocity\n\n# PayloadCMS Secret (t\u1ed1i thi\u1ec3u 32 k\u00fd t\u1ef1)\nPAYLOAD_SECRET=your-secret-key-here-min-32-chars\n\n# NGSI-LD Broker\nBROKER_URL=http://localhost:1026\n\n# T\u00f9y ch\u1ecdn: Domain-specific write keys\nBROKER_WRITE_KEY_ENVIRONMENT=key_env\nBROKER_WRITE_KEY_MOBILITY=key_mobility\n</code></pre> <p>L\u01b0u \u00fd B\u1ea3o m\u1eadt</p> <p>Kh\u00f4ng bao gi\u1edd commit c\u00e1c file <code>.env</code> ch\u1ee9a secrets th\u1ef1c v\u00e0o version control!</p>"},{"location":"vi/installation/local/#chay-ung-dung","title":"Ch\u1ea1y \u1ee8ng d\u1ee5ng","text":""},{"location":"vi/installation/local/#option-1-docker-compose-uoc-khuyen-nghi","title":"Option 1: Docker Compose (\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb)","text":"<p>Kh\u1edfi \u0111\u1ed9ng t\u1ea5t c\u1ea3 services c\u00f9ng l\u00fac:</p> <pre><code># T\u1eeb repository root\ndocker compose up\n</code></pre> <p>Ho\u1eb7c s\u1eed d\u1ee5ng Makefile:</p> <pre><code>make dev\n</code></pre> <p>\u0110i\u1ec1u n\u00e0y kh\u1edfi \u0111\u1ed9ng:</p> <ul> <li>Context broker</li> <li>MongoDB database</li> <li>PayloadCMS</li> <li>Dashboard</li> <li>Proxy (n\u1ebfu \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh)</li> <li>Update servers (n\u1ebfu \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh)</li> </ul> <p>Access URLs:</p> Service URL Dashboard http://localhost:3000 PayloadCMS Admin http://localhost:3000/admin Context Broker http://localhost:1026"},{"location":"vi/installation/local/#option-2-che-o-thu-cong","title":"Option 2: Ch\u1ebf \u0111\u1ed9 Th\u1ee7 c\u00f4ng","text":"<p>Ch\u1ea1y services ri\u00eang l\u1ebb:</p>"},{"location":"vi/installation/local/#khoi-ong-dashboard","title":"Kh\u1edfi \u0111\u1ed9ng Dashboard","text":"pnpm <p><code>bash     cd dashboard     pnpm dev</code></p> npm <p><code>bash     cd dashboard     npm run dev</code></p> yarn <p><code>bash     cd dashboard     yarn dev</code></p>"},{"location":"vi/installation/local/#khoi-ong-payloadcms","title":"Kh\u1edfi \u0111\u1ed9ng PayloadCMS","text":"<p>N\u1ebfu t\u00e1ch bi\u1ec7t kh\u1ecfi dashboard:</p> <pre><code>cd cms  # ho\u1eb7c th\u01b0 m\u1ee5c li\u00ean quan\nnpm run dev\n</code></pre> <p>K\u1ebft n\u1ed1i Database</p> <p>\u0110\u1ea3m b\u1ea3o MongoDB c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c tr\u01b0\u1edbc khi kh\u1edfi \u0111\u1ed9ng PayloadCMS</p>"},{"location":"vi/installation/local/#thiet-lap-ban-au","title":"Thi\u1ebft l\u1eadp Ban \u0111\u1ea7u","text":""},{"location":"vi/installation/local/#1-tao-admin-account","title":"1. T\u1ea1o Admin Account","text":"<ol> <li>\u0110i\u1ec1u h\u01b0\u1edbng \u0111\u1ebfn http://localhost:3000/admin</li> <li>\u0110i\u1ec1n v\u00e0o registration form:</li> <li>Email</li> <li>Password (t\u1ed1i thi\u1ec3u 8 k\u00fd t\u1ef1)</li> <li>X\u00e1c nh\u1eadn t\u1ea1o account</li> </ol>"},{"location":"vi/installation/local/#2-seed-data-tuy-chon","title":"2. Seed Data (T\u00f9y ch\u1ecdn)","text":"<p>Ch\u1ea1y seed scripts \u0111\u1ec3 populate sample data:</p> <pre><code># Example command (ki\u1ec3m tra package.json cho script th\u1ef1c t\u1ebf)\nnpm run seed\n</code></pre> <p>Xem Seed Database guide cho chi ti\u1ebft.</p>"},{"location":"vi/installation/local/#development-commands","title":"Development Commands","text":"<p>C\u00e1c l\u1ec7nh ph\u1ed5 bi\u1ebfn t\u1eeb th\u01b0 m\u1ee5c <code>dashboard/</code>:</p> Command Description <code>npm run dev</code> Kh\u1edfi \u0111\u1ed9ng dev server v\u1edbi hot reload <code>npm run build</code> Build production bundle <code>npm run start</code> Kh\u1edfi \u0111\u1ed9ng production server <code>npm run lint</code> Lint codebase <code>npm run test</code> Ch\u1ea1y tests <p>Ki\u1ec3m tra package.json</p> <p>C\u00e1c l\u1ec7nh th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 kh\u00e1c nhau. Lu\u00f4n ki\u1ec3m tra <code>package.json</code> cho c\u00e1c scripts c\u00f3 s\u1eb5n.</p>"},{"location":"vi/installation/local/#best-practices","title":"Best Practices","text":"<ol> <li>L\u00e0m vi\u1ec7c tr\u00ean feature branches (kh\u00f4ng ph\u1ea3i <code>main</code>)</li> <li>Gi\u1eef commits focused v\u00e0 m\u1ea1ch l\u1ea1c</li> <li>Ch\u1ea1y tests tr\u01b0\u1edbc PR (n\u1ebfu \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh)</li> <li>C\u1eadp nh\u1eadt docs khi th\u00eam features</li> <li>Tu\u00e2n theo h\u01b0\u1edbng d\u1eabn CONTRIBUTING.md (n\u1ebfu t\u1ed3n t\u1ea1i)</li> </ol>"},{"location":"vi/installation/local/#example-workflow","title":"Example Workflow","text":"<pre><code># T\u1ea1o feature branch\ngit checkout -b feature/new-block\n\n# Th\u1ef1c hi\u1ec7n thay \u0111\u1ed5i\n# ... edit files ...\n\n# Stage v\u00e0 commit\ngit add .\ngit commit -m \"feat: add weather block component\"\n\n# Push l\u00ean remote\ngit push origin feature/new-block\n\n# T\u1ea1o Pull Request tr\u00ean GitHub\n</code></pre>"},{"location":"vi/installation/local/#port-a-uoc-su-dung","title":"Port \u0110\u00e3 \u0111\u01b0\u1ee3c S\u1eed d\u1ee5ng","text":"<pre><code>Error: listen EADDRINUSE: address already in use :::3000\n</code></pre> <p>Gi\u1ea3i ph\u00e1p: Thay \u0111\u1ed5i port ho\u1eb7c kill process:</p> <pre><code># Windows\nnetstat -ano | findstr :3000\ntaskkill /PID &lt;PID&gt; /F\n\n# Linux/Mac\nlsof -ti:3000 | xargs kill -9\n</code></pre>"},{"location":"vi/installation/local/#mongodb-connection-failed","title":"MongoDB Connection Failed","text":"<pre><code>Error: connect ECONNREFUSED 127.0.0.1:27017\n</code></pre> <p>Gi\u1ea3i ph\u00e1p: \u0110\u1ea3m b\u1ea3o MongoDB \u0111ang ch\u1ea1y:</p> <pre><code># V\u1edbi Docker\ndocker compose up mongodb\n\n# Ho\u1eb7c ki\u1ec3m tra service status\ndocker ps | grep mongo\n</code></pre>"},{"location":"vi/installation/local/#missing-environment-variables","title":"Missing Environment Variables","text":"<pre><code>Error: NEXT_PUBLIC_MAPBOX_TOKEN is not defined\n</code></pre> <p>Gi\u1ea3i ph\u00e1p: Ki\u1ec3m tra file <code>.env</code> t\u1ed3n t\u1ea1i v\u00e0 ch\u1ee9a c\u00e1c variables b\u1eaft bu\u1ed9c.</p>"},{"location":"vi/installation/local/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<p>Development Environment S\u1eb5n s\u00e0ng</p> <p>B\u1ea1n b\u00e2y gi\u1edd n\u00ean c\u00f3:</p> <pre><code>-  Repository \u0111\u00e3 clone v\u00e0 dependencies \u0111\u00e3 c\u00e0i \u0111\u1eb7t\n-  Environment variables \u0111\u00e3 c\u1ea5u h\u00ecnh\n-  Services \u0111ang ch\u1ea1y (Docker ho\u1eb7c manual)\n-  Admin account \u0111\u00e3 t\u1ea1o\n-  Hi\u1ec3u bi\u1ebft v\u1ec1 development workflow\n</code></pre> <p>C\u00e1c B\u01b0\u1edbc Ti\u1ebfp theo:</p> <ul> <li>T\u1ea1o custom blocks</li> <li>Vi\u1ebft PayloadCMS plugins</li> <li>Th\u00eam seed data</li> </ul>"},{"location":"vi/reference/troubleshooting/","title":"X\u1eed l\u00fd s\u1ef1 c\u1ed1","text":"<p>H\u01b0\u1edbng d\u1eabn n\u00e0y gi\u00fap ch\u1ea9n \u0111o\u00e1n v\u00e0 gi\u1ea3i quy\u1ebft c\u00e1c v\u1ea5n \u0111\u1ec1 ph\u1ed5 bi\u1ebfn trong LegoCity.</p>"},{"location":"vi/reference/troubleshooting/#chan-oan-nhanh","title":"Ch\u1ea9n \u0111o\u00e1n nhanh","text":""},{"location":"vi/reference/troubleshooting/#kiem-tra-trang-thai-he-thong","title":"Ki\u1ec3m tra tr\u1ea1ng th\u00e1i h\u1ec7 th\u1ed1ng","text":"<pre><code># Ki\u1ec3m tra c\u00e1c d\u1ecbch v\u1ee5 \u0111ang ch\u1ea1y\ndocker compose ps\n\n# Ki\u1ec3m tra logs\ndocker compose logs dashboard\ndocker compose logs orion-ld\n\n# Ki\u1ec3m tra k\u1ebft n\u1ed1i database\nmongosh legocity --eval \"db.stats()\"\n\n# Ki\u1ec3m tra health endpoint\ncurl http://localhost:3000/api/health\n</code></pre>"},{"location":"vi/reference/troubleshooting/#loi-pho-bien-va-giai-phap-nhanh","title":"L\u1ed7i ph\u1ed5 bi\u1ebfn v\u00e0 gi\u1ea3i ph\u00e1p nhanh","text":"Tri\u1ec7u ch\u1ee9ng Nguy\u00ean nh\u00e2n c\u00f3 th\u1ec3 Gi\u1ea3i ph\u00e1p nhanh Dashboard kh\u00f4ng load Bi\u1ebfn m\u00f4i tr\u01b0\u1eddng thi\u1ebfu Ki\u1ec3m tra <code>.env</code> v\u00e0 restart Map tr\u1ed1ng Mapbox token kh\u00f4ng h\u1ee3p l\u1ec7 Verify token trong <code>.env</code> API tr\u1ea3 v\u1ec1 500 Database connection th\u1ea5t b\u1ea1i Ki\u1ec3m tra MongoDB \u0111ang ch\u1ea1y Admin panel 404 Build kh\u00f4ng ho\u00e0n th\u00e0nh Ch\u1ea1y <code>pnpm build</code> v\u00e0 restart \"Cannot find module\" Dependencies thi\u1ebfu Ch\u1ea1y <code>pnpm install</code> Port \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u1ee8ng d\u1ee5ng kh\u00e1c \u0111ang ch\u1ea1y \u0110\u1ed5i port ho\u1eb7c kill process c\u0169 TypeScript errors sau khi pull Types \u0111\u00e3 thay \u0111\u1ed5i Ch\u1ea1y <code>pnpm payload generate:types</code> Orion kh\u00f4ng ph\u1ea3n h\u1ed3i Container ch\u01b0a s\u1eb5n s\u00e0ng \u0110\u1ee3i ~10s sau <code>docker compose up</code>"},{"location":"vi/reference/troubleshooting/#van-e-cai-at","title":"V\u1ea5n \u0111\u1ec1 c\u00e0i \u0111\u1eb7t","text":""},{"location":"vi/reference/troubleshooting/#nodejs-version-mismatch","title":"Node.js Version Mismatch","text":"<p>V\u1ea5n \u0111\u1ec1: L\u1ed7i khi ch\u1ea1y <code>pnpm install</code> ho\u1eb7c <code>pnpm dev</code></p> <p>Nguy\u00ean nh\u00e2n: Node.js version kh\u00f4ng \u0111\u00fang (c\u1ea7n &gt;= 18.17.0)</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># Ki\u1ec3m tra version hi\u1ec7n t\u1ea1i\nnode --version\n\n# N\u1ebfu &lt; 18.17.0, c\u00e0i \u0111\u1eb7t Node.js m\u1edbi\n# S\u1eed d\u1ee5ng nvm (recommended):\nnvm install 18\nnvm use 18\n\n# Ho\u1eb7c t\u1ea3i t\u1eeb nodejs.org\n</code></pre>"},{"location":"vi/reference/troubleshooting/#pnpm-not-found","title":"pnpm Not Found","text":"<p>V\u1ea5n \u0111\u1ec1: <code>pnpm: command not found</code></p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># C\u00e0i \u0111\u1eb7t pnpm globally\nnpm install -g pnpm\n\n# Ho\u1eb7c s\u1eed d\u1ee5ng Corepack (Node 16.13+)\ncorepack enable\ncorepack prepare pnpm@latest --activate\n</code></pre>"},{"location":"vi/reference/troubleshooting/#docker-build-fails","title":"Docker Build Fails","text":"<p>V\u1ea5n \u0111\u1ec1: <code>docker compose build</code> th\u1ea5t b\u1ea1i</p> <p>C\u00e1c b\u01b0\u1edbc debug:</p> <ol> <li>Ki\u1ec3m tra disk space:</li> </ol> <pre><code>df -h\n</code></pre> <ol> <li>Clean Docker cache:</li> </ol> <pre><code>docker system prune -a\ndocker volume prune\n</code></pre> <ol> <li>Build v\u1edbi output chi ti\u1ebft:</li> </ol> <pre><code>docker compose build --no-cache --progress=plain\n</code></pre> <ol> <li>Check Docker daemon:    <pre><code>docker info\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#mongodb-connection-error","title":"MongoDB Connection Error","text":"<p>V\u1ea5n \u0111\u1ec1: <code>MongoNetworkError: connect ECONNREFUSED</code></p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Ki\u1ec3m tra MongoDB \u0111ang ch\u1ea1y:</li> </ol> <pre><code># V\u1edbi Docker\ndocker compose ps mongodb\n\n# Local MongoDB\nsudo systemctl status mongod\n</code></pre> <ol> <li>Ki\u1ec3m tra DATABASE_URI:</li> </ol> <pre><code># Ph\u1ea3i match v\u1edbi Docker service name\nDATABASE_URI=mongodb://mongodb:27017/legocity\n</code></pre> <ol> <li>Kh\u1edfi \u0111\u1ed9ng l\u1ea1i MongoDB:    <pre><code>docker compose restart mongodb\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#van-e-khi-development","title":"V\u1ea5n \u0111\u1ec1 khi Development","text":""},{"location":"vi/reference/troubleshooting/#build-failures","title":"Build Failures","text":"<p>V\u1ea5n \u0111\u1ec1: <code>pnpm build</code> th\u1ea5t b\u1ea1i v\u1edbi l\u1ed7i TypeScript ho\u1eb7c compilation</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Regenerate types:</li> </ol> <pre><code>pnpm payload generate:types\n</code></pre> <ol> <li>Clear cache:</li> </ol> <pre><code>rm -rf .next\nrm -rf node_modules/.cache\n</code></pre> <ol> <li>Out of memory:</li> </ol> <pre><code># T\u0103ng Node memory\nNODE_OPTIONS=\"--max-old-space-size=4096\" pnpm build\n</code></pre> <ol> <li>Module not found:    <pre><code># C\u00e0i \u0111\u1eb7t l\u1ea1i dependencies\nrm -rf node_modules pnpm-lock.yaml\npnpm install\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#van-e-runtime","title":"V\u1ea5n \u0111\u1ec1 Runtime","text":""},{"location":"vi/reference/troubleshooting/#man-hinh-trang-trang-trong","title":"M\u00e0n h\u00ecnh tr\u1eafng / Trang tr\u1ed1ng","text":"<p>V\u1ea5n \u0111\u1ec1: Trang load nh\u01b0ng kh\u00f4ng hi\u1ec3n th\u1ecb g\u00ec</p> <p>C\u00e1c b\u01b0\u1edbc debug:</p> <ol> <li> <p>Ki\u1ec3m tra browser console \u0111\u1ec3 t\u00ecm l\u1ed7i JavaScript</p> </li> <li> <p>Ki\u1ec3m tra Network tab \u0111\u1ec3 t\u00ecm request th\u1ea5t b\u1ea1i</p> </li> <li> <p>Verify environment variables:</p> </li> </ol> <pre><code># C\u00e1c bi\u1ebfn b\u1eaft bu\u1ed9c \u0111\u00e3 set?\necho $DATABASE_URI\necho $PAYLOAD_SECRET\necho $NEXT_PUBLIC_SERVER_URL\n</code></pre> <ol> <li>Ki\u1ec3m tra server logs:    <pre><code>pnpm dev\n# T\u00ecm l\u1ed7i trong terminal\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#map-khong-hien-thi","title":"Map kh\u00f4ng hi\u1ec3n th\u1ecb","text":"<p>V\u1ea5n \u0111\u1ec1: Khu v\u1ef1c map tr\u1ed1ng ho\u1eb7c hi\u1ec3n th\u1ecb l\u1ed7i</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Verify Mapbox token:</li> </ol> <pre><code># Ki\u1ec3m tra token \u0111\u00e3 set\necho $NEXT_PUBLIC_MAPBOX_TOKEN\n\n# Test token\ncurl \"https://api.mapbox.com/v4/mapbox.mapbox-streets-v8.json?access_token=$NEXT_PUBLIC_MAPBOX_TOKEN\"\n</code></pre> <ol> <li> <p>Ki\u1ec3m tra console \u0111\u1ec3 t\u00ecm l\u1ed7i:</p> </li> <li> <p>M\u1edf browser DevTools \u2192 Console</p> </li> <li> <p>T\u00ecm l\u1ed7i li\u00ean quan \u0111\u1ebfn Mapbox</p> </li> <li> <p>Verify token scope:</p> </li> <li>Token ph\u1ea3i c\u00f3 quy\u1ec1n <code>styles:read</code> v\u00e0 <code>fonts:read</code></li> <li>T\u1ea1o token m\u1edbi t\u1ea1i mapbox.com</li> </ol>"},{"location":"vi/reference/troubleshooting/#admin-panel-404","title":"Admin Panel 404","text":"<p>V\u1ea5n \u0111\u1ec1: Route <code>/admin</code> kh\u00f4ng t\u00ecm th\u1ea5y</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Rebuild application:</li> </ol> <pre><code>rm -rf .next\npnpm build\npnpm start\n</code></pre> <ol> <li>Ki\u1ec3m tra Payload config:</li> </ol> <pre><code>// payload.config.ts\nadmin: {\n  autoLogin: false,  // Ph\u1ea3i l\u00e0 false trong production\n}\n</code></pre> <ol> <li>Verify admin routes t\u1ed3n t\u1ea1i:    <pre><code>ls src/app/\\(payload\\)/admin\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#api-route-tra-ve-500","title":"API Route tr\u1ea3 v\u1ec1 500","text":"<p>V\u1ea5n \u0111\u1ec1: API endpoint throw server error</p> <p>Debug:</p> <ol> <li> <p>Ki\u1ec3m tra server logs \u0111\u1ec3 t\u00ecm chi ti\u1ebft l\u1ed7i</p> </li> <li> <p>Test v\u1edbi curl:</p> </li> </ol> <pre><code>curl -v http://localhost:3000/api/your-endpoint\n</code></pre> <ol> <li>Th\u00eam logging:    <pre><code>export async function GET(req: Request) {\n  try {\n    console.log(\"Request:\", req.url);\n    // ... code c\u1ee7a b\u1ea1n\n  } catch (error) {\n    console.error(\"Error:\", error);\n    return Response.json({ error: error.message }, { status: 500 });\n  }\n}\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#van-e-database","title":"V\u1ea5n \u0111\u1ec1 Database","text":""},{"location":"vi/reference/troubleshooting/#database-connection-cham","title":"Database Connection ch\u1eadm","text":"<p>V\u1ea5n \u0111\u1ec1: Queries ch\u1eadm ho\u1eb7c timeout</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Th\u00eam indexes:</li> </ol> <pre><code>// Trong MongoDB shell\ndb.pages.createIndex({ slug: 1 });\ndb.posts.createIndex({ publishedAt: -1 });\n</code></pre> <ol> <li>Monitor slow queries:</li> </ol> <pre><code>db.setProfilingLevel(2);\ndb.system.profile.find().sort({ ts: -1 }).limit(10);\n</code></pre> <ol> <li>Ki\u1ec3m tra database stats:    <pre><code>mongosh legocity --eval \"db.stats()\"\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#collection-not-found","title":"Collection Not Found","text":"<p>V\u1ea5n \u0111\u1ec1: <code>Collection 'pages' not found</code></p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Ki\u1ec3m tra collection name kh\u1edbp v\u1edbi config:</li> </ol> <pre><code>// collections/Pages.ts\nslug: \"pages\"; // Ph\u1ea3i kh\u1edbp\n</code></pre> <ol> <li>Verify database:</li> </ol> <pre><code>mongosh legocity --eval \"show collections\"\n</code></pre> <ol> <li>Seed database:    <pre><code>pnpm seed\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#database-migration-failed","title":"Database Migration Failed","text":"<p>V\u1ea5n \u0111\u1ec1: Schema changes kh\u00f4ng \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># Backup tr\u01b0\u1edbc!\nmongodump --db legocity --out ./backup\n\n# Drop v\u00e0 recreate\nmongosh legocity --eval \"db.dropDatabase()\"\npnpm seed\n\n# Ho\u1eb7c restore backup\nmongorestore --db legocity ./backup/legocity\n</code></pre>"},{"location":"vi/reference/troubleshooting/#van-e-docker","title":"V\u1ea5n \u0111\u1ec1 Docker","text":""},{"location":"vi/reference/troubleshooting/#container-thoat-ngay-lap-tuc","title":"Container tho\u00e1t ngay l\u1eadp t\u1ee9c","text":"<p>V\u1ea5n \u0111\u1ec1: Docker container kh\u1edfi \u0111\u1ed9ng r\u1ed3i d\u1eebng</p> <p>Debug:</p> <pre><code># Ki\u1ec3m tra logs\ndocker compose logs dashboard\n\n# Ki\u1ec3m tra l\u1ed7i trong build\ndocker compose build --no-cache dashboard\n\n# Ch\u1ea1y interactive\ndocker compose run --rm dashboard sh\n</code></pre>"},{"location":"vi/reference/troubleshooting/#khong-the-ket-noi-toi-service","title":"Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i t\u1edbi Service","text":"<p>V\u1ea5n \u0111\u1ec1: Frontend kh\u00f4ng th\u1ec3 reach MongoDB/Orion</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>S\u1eed d\u1ee5ng service names, kh\u00f4ng ph\u1ea3i localhost:</li> </ol> <pre><code># \u274c Sai\nDATABASE_URI=mongodb://localhost:27017/legocity\n\n# \u2705 \u0110\u00fang\nDATABASE_URI=mongodb://mongodb:27017/legocity\n</code></pre> <ol> <li>Ki\u1ec3m tra network:</li> </ol> <pre><code>docker compose ps\ndocker network ls\n</code></pre> <ol> <li>Test connectivity:    <pre><code>docker compose exec dashboard ping mongodb\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#volume-permission-issues","title":"Volume Permission Issues","text":"<p>V\u1ea5n \u0111\u1ec1: Permission denied errors (Linux)</p> <p>Gi\u1ea3i ph\u00e1p:</p> <pre><code># Fix ownership\nsudo chown -R $USER:$USER ./dashboard\n\n# Ho\u1eb7c ch\u1ea1y v\u1edbi current user\ndocker compose run --user \"$(id -u):$(id -g)\" dashboard pnpm dev\n</code></pre>"},{"location":"vi/reference/troubleshooting/#van-e-production","title":"V\u1ea5n \u0111\u1ec1 Production","text":""},{"location":"vi/reference/troubleshooting/#502-bad-gateway","title":"502 Bad Gateway","text":"<p>V\u1ea5n \u0111\u1ec1: Nginx hi\u1ec3n th\u1ecb l\u1ed7i 502</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Ki\u1ec3m tra app \u0111ang ch\u1ea1y:</li> </ol> <pre><code>pm2 status\n# Ho\u1eb7c\nsystemctl status legocity\n</code></pre> <ol> <li>Ki\u1ec3m tra Nginx config:</li> </ol> <pre><code>sudo nginx -t\nsudo systemctl reload nginx\n</code></pre> <ol> <li>Ki\u1ec3m tra logs:</li> </ol> <pre><code># App logs\npm2 logs\n\n# Nginx logs\nsudo tail -f /var/log/nginx/error.log\n</code></pre>"},{"location":"vi/reference/troubleshooting/#memory-leak","title":"Memory Leak","text":"<p>V\u1ea5n \u0111\u1ec1: Memory usage c\u1ee7a \u1ee9ng d\u1ee5ng t\u0103ng li\u00ean t\u1ee5c</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Monitor memory:</li> </ol> <pre><code># PM2 monitoring\npm2 monit\n\n# Ho\u1eb7c s\u1eed d\u1ee5ng htop\nhtop\n</code></pre> <ol> <li>Set memory limit:</li> </ol> <pre><code>// ecosystem.config.js\nmodule.exports = {\n  apps: [\n    {\n      name: \"legocity\",\n      script: \"node_modules/next/dist/bin/next\",\n      args: \"start\",\n      max_memory_restart: \"1G\",\n    },\n  ],\n};\n</code></pre> <ol> <li>Profile memory:    <pre><code>node --inspect node_modules/next/dist/bin/next start\n# S\u1eed d\u1ee5ng Chrome DevTools \u0111\u1ec3 profile\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#ssl-certificate-issues","title":"SSL Certificate Issues","text":"<p>V\u1ea5n \u0111\u1ec1: HTTPS kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng ho\u1eb7c l\u1ed7i certificate</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Ki\u1ec3m tra certificate validity:</li> </ol> <pre><code>sudo certbot certificates\n</code></pre> <ol> <li>Renew certificate:</li> </ol> <pre><code>sudo certbot renew\nsudo systemctl reload nginx\n</code></pre> <ol> <li>Test SSL config:    <pre><code>curl -vI https://your-domain.com\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#van-e-performance","title":"V\u1ea5n \u0111\u1ec1 Performance","text":""},{"location":"vi/reference/troubleshooting/#trang-load-cham","title":"Trang load ch\u1eadm","text":"<p>V\u1ea5n \u0111\u1ec1: C\u00e1c trang m\u1ea5t qu\u00e1 nhi\u1ec1u th\u1eddi gian \u0111\u1ec3 load</p> <p>Gi\u1ea3i ph\u00e1p:</p> <ol> <li>Enable caching:</li> </ol> <pre><code>// app/page.tsx\nexport const revalidate = 60; // ISR m\u1ed7i 60s\n</code></pre> <ol> <li>Optimize images:</li> </ol> <pre><code>import Image from \"next/image\";\n\n&lt;Image src=\"/image.jpg\" width={800} height={600} alt=\"Description\" /&gt;;\n</code></pre> <ol> <li>S\u1eed d\u1ee5ng dynamic imports:</li> </ol> <pre><code>const HeavyComponent = dynamic(() =&gt; import(\"./HeavyComponent\"), {\n  loading: () =&gt; &lt;p&gt;Loading...&lt;/p&gt;,\n});\n</code></pre> <ol> <li>Analyze bundle:    <pre><code>pnpm build --analyze\n</code></pre></li> </ol>"},{"location":"vi/reference/troubleshooting/#high-cpu-usage","title":"High CPU Usage","text":"<p>V\u1ea5n \u0111\u1ec1: CPU t\u0103ng cao trong ho\u1ea1t \u0111\u1ed9ng b\u00ecnh th\u01b0\u1eddng</p> <p>Ki\u1ec3m tra:</p> <ol> <li>Profile application:</li> </ol> <pre><code>node --prof node_modules/next/dist/bin/next start\nnode --prof-process isolate-*.log &gt; profile.txt\n</code></pre> <ol> <li> <p>Ki\u1ec3m tra infinite loops trong code</p> </li> <li> <p>Monitor processes:    <pre><code>top -p $(pgrep node)\n</code></pre></p> </li> </ol>"},{"location":"vi/reference/troubleshooting/#nhan-them-tro-giup","title":"Nh\u1eadn th\u00eam tr\u1ee3 gi\u00fap","text":""},{"location":"vi/reference/troubleshooting/#thu-thap-thong-tin-chan-oan","title":"Thu th\u1eadp th\u00f4ng tin ch\u1ea9n \u0111o\u00e1n","text":"<p>Tr\u01b0\u1edbc khi y\u00eau c\u1ea7u tr\u1ee3 gi\u00fap, thu th\u1eadp:</p> <pre><code># System info\nnode --version\npnpm --version\nmongosh --version\n\n# App info\ncat package.json | grep version\n\n# Environment\necho $NODE_ENV\nenv | grep -E '(DATABASE|PAYLOAD|NEXT_PUBLIC)'\n\n# Logs\npnpm dev &gt; debug.log 2&gt;&amp;1\n\n# Health check\ncurl http://localhost:3000/api/health\n</code></pre>"},{"location":"vi/reference/troubleshooting/#noi-nhan-tro-giup","title":"N\u01a1i nh\u1eadn tr\u1ee3 gi\u00fap","text":"<ul> <li>\ud83d\udc1b Bug Reports: GitHub Issues</li> <li>\ud83d\udcac Questions: GitHub Discussions</li> <li>\ud83d\udcd6 Documentation: LegoCity Docs</li> <li>\ud83d\udce7 Email: CTU-SematX Team</li> </ul>"},{"location":"vi/reference/troubleshooting/#issue-template","title":"Issue Template","text":"<p>Khi b\u00e1o c\u00e1o issues:</p> <pre><code>**M\u00f4 t\u1ea3 v\u1ea5n \u0111\u1ec1**\nM\u00f4 t\u1ea3 r\u00f5 r\u00e0ng \u0111i\u1ec1u g\u00ec sai\n\n**C\u00e1c b\u01b0\u1edbc t\u00e1i hi\u1ec7n**\n\n1. L\u00e0m vi\u1ec7c n\u00e0y\n2. R\u1ed3i l\u00e0m vi\u1ec7c n\u00e0y\n3. Th\u1ea5y l\u1ed7i\n\n**H\u00e0nh vi mong \u0111\u1ee3i**\n\u0110i\u1ec1u g\u00ec n\u00ean x\u1ea3y ra\n\n**M\u00f4i tr\u01b0\u1eddng**\n\n- OS: [v\u00ed d\u1ee5: Windows 11]\n- Node: [v\u00ed d\u1ee5: 18.17.0]\n- pnpm: [v\u00ed d\u1ee5: 8.6.0]\n- Browser: [v\u00ed d\u1ee5: Chrome 115]\n\n**Logs**\n</code></pre> <p>Paste logs li\u00ean quan \u1edf \u0111\u00e2y</p> <pre><code>**Screenshots**\nN\u1ebfu c\u00f3\n</code></pre> <p>V\u1eabn b\u1ecb stuck? H\u1ecfi trong GitHub Discussions - ch\u00fang t\u00f4i \u1edf \u0111\u00e2y \u0111\u1ec3 gi\u00fap \u0111\u1ee1!</p>"},{"location":"vi/user-guide/","title":"T\u1ed5ng quan h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng","text":"<p>Ph\u1ea7n n\u00e0y gi\u1ea3i th\u00edch c\u00e1ch l\u00e0m vi\u1ec7c v\u1edbi l\u1edbp d\u1eef li\u1ec7u trong LegoCity v\u00e0 c\u00e1ch n\u00f3 k\u1ebft n\u1ed1i v\u1edbi b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n.</p> <p>D\u00e0nh cho nh\u1eefng ng\u01b0\u1eddi:</p> <ul> <li>v\u1eadn h\u00e0nh ho\u1eb7c c\u1ea5u h\u00ecnh context brokers,</li> <li>x\u00e2y d\u1ef1ng ho\u1eb7c duy tr\u00ec c\u00e1c server c\u1eadp nh\u1eadt \u0111\u1ea9y d\u1eef li\u1ec7u v\u00e0o broker,</li> <li>c\u1ea7n hi\u1ec3u c\u00e1ch d\u1eef li\u1ec7u hi\u1ec3n th\u1ecb th\u00e0nh c\u00e1c l\u1edbp b\u1ea3n \u0111\u1ed3 v\u00e0 kh\u1ed1i trong UI.</li> </ul> <p>Ph\u1ea7n Usage \u0111\u01b0\u1ee3c t\u1ed5 ch\u1ee9c th\u00e0nh c\u00e1c trang sau.</p>"},{"location":"vi/user-guide/#du-lieu-brokers","title":"D\u1eef li\u1ec7u &amp; brokers","text":"<p>M\u00f4 t\u1ea3 lu\u1ed3ng d\u1eef li\u1ec7u t\u1ed5ng th\u1ec3 v\u00e0 vai tr\u00f2 c\u1ee7a:</p> <ul> <li>context broker, l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 NGSI-LD entities, v\u00e0</li> <li>c\u00e1c server c\u1eadp nh\u1eadt, l\u1ea5y d\u1eef li\u1ec7u b\u00ean ngo\u00e0i, chuy\u1ec3n \u0111\u1ed5i th\u00e0nh entities, v\u00e0 ghi v\u00e0o broker.</li> </ul> <p>Trang n\u00e0y t\u1eadp trung v\u00e0o:</p> <ul> <li>c\u00e1c thi\u1ebft l\u1eadp broker \u0111i\u1ec3n h\u00ecnh (\u0111\u01a1n v\u00e0 nhi\u1ec1u brokers),</li> <li>c\u00e1ch tr\u00e1ch nhi\u1ec7m \u0111\u01b0\u1ee3c chia gi\u1eefa broker v\u00e0 c\u00e1c server c\u1eadp nh\u1eadt,</li> <li>t\u1ea1i sao b\u1ea3ng \u0111i\u1ec1u khi\u1ec3n \u0111\u1ecdc nh\u01b0ng kh\u00f4ng ghi v\u00e0o broker.</li> </ul>"},{"location":"vi/user-guide/#entities","title":"Entities","text":"<p>M\u00f4 t\u1ea3 c\u00e1ch th\u00f4ng tin th\u00e0nh ph\u1ed1 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng NGSI-LD entities v\u00e0 c\u00e1ch Smart Data Models \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng.</p> <p>Trang n\u00e0y bao g\u1ed3m:</p> <ul> <li>c\u00e1c lo\u1ea1i entity ph\u1ed5 bi\u1ebfn trong deployment LegoCity,</li> <li>c\u00e1ch Smart Data Models \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn c\u1ea5u tr\u00fac v\u00e0 \u0111\u1eb7t t\u00ean attribute,</li> <li>quy \u01b0\u1edbc cho identifiers, types v\u00e0 geospatial attributes,</li> <li>h\u01b0\u1edbng d\u1eabn \u0111\u1ecbnh ngh\u0129a entity types m\u1edbi khi y\u00eau c\u1ea7u thay \u0111\u1ed5i.</li> </ul>"},{"location":"vi/user-guide/#khoa-api-quyen-truy-cap","title":"Kh\u00f3a API &amp; quy\u1ec1n truy c\u1eadp","text":"<p>M\u00f4 t\u1ea3 c\u00e1ch quy\u1ec1n ghi \u0111\u1ebfn context broker \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t.</p> <p>Trang n\u00e0y gi\u1ea3i th\u00edch:</p> <ul> <li>c\u00e1ch c\u00e1c server c\u1eadp nh\u1eadt c\u00f3 \u0111\u01b0\u1ee3c quy\u1ec1n ghi,</li> <li>c\u00e1c m\u1eabu \u0111\u1ec3 chia s\u1ebb ho\u1eb7c t\u00e1ch c\u00e1c kh\u00f3a ghi gi\u1eefa c\u00e1c servers,</li> <li>n\u01a1i c\u00e1c kh\u00f3a v\u00e0 tokens n\u00ean \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef,</li> <li>c\u00e1c k\u1ef3 v\u1ecdng c\u01a1 b\u1ea3n cho xoay kh\u00f3a v\u00e0 \u1ee9ng ph\u00f3 s\u1ef1 c\u1ed1.</li> </ul> <p>Quy\u1ec1n \u0111\u1ecdc v\u00e0 vai tr\u00f2 c\u1ee7a c\u00e1c proxy ch\u1ec9 \u0111\u1ecdc c\u0169ng \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u \u1edf m\u1ee9c cao.</p>"},{"location":"vi/user-guide/#server-cap-nhat-mau","title":"Server c\u1eadp nh\u1eadt m\u1eabu","text":"<p>M\u00f4 t\u1ea3 server c\u1eadp nh\u1eadt m\u1eabu \u0111i k\u00e8m v\u1edbi LegoCity.</p> <p>Trang n\u00e0y l\u00e0m r\u00f5:</p> <ul> <li>m\u1ee5c \u0111\u00edch v\u00e0 ph\u1ea1m vi c\u1ee7a m\u1eabu,</li> <li>c\u00e1ch c\u1ea5u h\u00ecnh (bi\u1ebfn m\u00f4i tr\u01b0\u1eddng, API b\u00ean ngo\u00e0i, quy\u1ec1n truy c\u1eadp broker),</li> <li>quy tr\u00ecnh l\u00e0m vi\u1ec7c \u0111i\u1ec3n h\u00ecnh \u0111\u1ec3 ch\u1ea1y n\u00f3 t\u1eeb \u0111\u1ea7u \u0111\u1ebfn cu\u1ed1i,</li> <li>c\u00e1ch c\u00e1c team c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c server c\u1eadp nh\u1eadt ri\u00eang.</li> </ul>"},{"location":"vi/user-guide/#cach-su-dung-phan-nay","title":"C\u00e1ch s\u1eed d\u1ee5ng ph\u1ea7n n\u00e0y","text":"<p>Th\u1ee9 t\u1ef1 \u0111\u1ecdc \u0111i\u1ec3n h\u00ecnh:</p> <ol> <li>Data &amp; brokers \u2013 \u0111\u1ec3 hi\u1ec3u lu\u1ed3ng d\u1eef li\u1ec7u t\u1ed5ng th\u1ec3.</li> <li>Entities \u2013 \u0111\u1ec3 h\u1ecdc c\u00e1ch c\u00e1c kh\u00e1i ni\u1ec7m th\u00e0nh ph\u1ed1 \u0111\u01b0\u1ee3c m\u00f4 h\u00ecnh h\u00f3a.</li> <li>API keys &amp; access \u2013 \u0111\u1ec3 xem write access \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t nh\u01b0 th\u1ebf n\u00e0o.</li> <li>Sample update server \u2013 \u0111\u1ec3 ch\u1ea1y v\u00ed d\u1ee5 th\u1ef1c t\u1ebf t\u1ed1i thi\u1ec3u.</li> </ol> <p>Sau khi \u0111\u1ecdc qua c\u00e1c trang n\u00e0y, b\u1ea1n s\u1ebd c\u00f3 c\u00e1i nh\u00ecn r\u00f5 r\u00e0ng v\u1ec1 c\u00e1ch d\u1eef li\u1ec7u v\u00e0o broker v\u00e0 c\u00e1ch n\u00f3 \u0111\u01b0\u1ee3c c\u1ea5u tr\u00fac tr\u01b0\u1edbc khi \u0111\u01b0\u1ee3c dashboard s\u1eed d\u1ee5ng.</p>"},{"location":"vi/user-guide/api-keys/","title":"Kh\u00f3a API v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch ki\u1ec3m so\u00e1t quy\u1ec1n truy c\u1eadp ghi v\u00e0o context broker trong tri\u1ec3n khai LegoCity v\u00e0 c\u00e1ch chia s\u1ebb kh\u00f3a API ho\u1eb7c token v\u1edbi c\u00e1c update server v\u00e0 read client.</p> <p>Trang n\u00e0y d\u00e0nh cho nh\u1eefng ng\u01b0\u1eddi:</p> <ul> <li>c\u1ea5u h\u00ecnh b\u1ea3o m\u1eadt tr\u00ean broker v\u00e0 proxy,</li> <li>v\u1eadn h\u00e0nh c\u00e1c update server,</li> <li>c\u1ea7n hi\u1ec3u c\u00e1ch qu\u1ea3n l\u00fd th\u00f4ng tin x\u00e1c th\u1ef1c qua c\u00e1c m\u00f4i tr\u01b0\u1eddng.</li> </ul>"},{"location":"vi/user-guide/api-keys/#cac-mau-truy-cap","title":"C\u00e1c m\u1eabu truy c\u1eadp","text":"<p>Trong LegoCity, c\u00f3 ba l\u1edbp truy c\u1eadp ch\u00ednh v\u00e0o broker v\u00e0 c\u00e1c API li\u00ean quan:</p> <ul> <li> <p>Truy c\u1eadp ghi v\u00e0o broker   Ch\u1ec9 \u0111\u01b0\u1ee3c c\u1ea5p cho c\u00e1c update server v\u00e0 c\u00f4ng c\u1ee5 qu\u1ea3n tr\u1ecb. D\u00f9ng \u0111\u1ec3 t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt c\u00e1c NGSI-LD entity.</p> </li> <li> <p>Truy c\u1eadp \u0111\u1ecdc n\u1ed9i b\u1ed9 v\u00e0o broker   \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi proxy v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 n\u1ed9i b\u1ed9 \u0111\u1ec3 truy v\u1ea5n entity. C\u00f3 th\u1ec3 c\u00f3 quy\u1ec1n r\u1ed9ng h\u01a1n nh\u01b0ng kh\u00f4ng \u0111\u01b0\u1ee3c expose ra tr\u00ecnh duy\u1ec7t.</p> </li> <li> <p>Truy c\u1eadp \u0111\u1ecdc c\u00f4ng khai qua proxy   \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi dashboard v\u00e0 b\u1ea5t k\u1ef3 client ngo\u00e0i n\u00e0o. B\u1ecb gi\u1edbi h\u1ea1n \u1edf c\u00e1c endpoint c\u1ee5 th\u1ec3, th\u01b0\u1eddng c\u00f3 rate limit.</p> </li> </ul> <p>LegoCity khuy\u1ebfn ngh\u1ecb:</p> <ul> <li>gi\u1edbi h\u1ea1n quy\u1ec1n truy c\u1eadp ghi cho m\u1ed9t t\u1eadp nh\u1ecf c\u00e1c d\u1ecbch v\u1ee5 \u0111\u01b0\u1ee3c ki\u1ec3m so\u00e1t,</li> <li>expose quy\u1ec1n truy c\u1eadp \u0111\u1ecdc cho UI th\u00f4ng qua m\u1ed9t l\u1edbp proxy, kh\u00f4ng tr\u1ef1c ti\u1ebfp \u0111\u1ebfn broker.</li> </ul>"},{"location":"vi/user-guide/api-keys/#cac-bien-cau-hinh","title":"C\u00e1c bi\u1ebfn c\u1ea5u h\u00ecnh","text":"<p>M\u1ed9t tri\u1ec3n khai n\u00ean chu\u1ea9n h\u00f3a c\u00e1ch truy\u1ec1n c\u00e1c endpoint c\u1ee7a broker v\u00e0 th\u00f4ng tin x\u00e1c th\u1ef1c v\u00e0o c\u00e1c d\u1ecbch v\u1ee5.</p> <p>C\u00e1c bi\u1ebfn \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li> <p><code>BROKER_URL</code>   URL c\u01a1 s\u1edf c\u1ee7a NGSI-LD context broker, v\u00ed d\u1ee5: <code>https://broker.example.com/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_KEY</code> ho\u1eb7c <code>BROKER_WRITE_TOKEN</code>   Th\u00f4ng tin x\u00e1c th\u1ef1c (token, API key, v.v.) cho quy\u1ec1n truy c\u1eadp ghi.</p> </li> <li> <p><code>BROKER_READ_KEY</code> (t\u00f9y ch\u1ecdn)   Th\u00f4ng tin x\u00e1c th\u1ef1c cho quy\u1ec1n truy c\u1eadp \u0111\u1ecdc, n\u1ebfu broker th\u1ef1c thi x\u00e1c th\u1ef1c \u0111\u1ecdc.</p> </li> </ul> <p>C\u00e1c bi\u1ebfn n\u00e0y l\u00e0:</p> <ul> <li>\u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a cho m\u1ed7i m\u00f4i tr\u01b0\u1eddng (development, staging, production),</li> <li>\u0111\u01b0\u1ee3c \u0111\u1eb7t l\u00e0m bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c l\u01b0u tr\u1eef trong m\u1ed9t secret manager,</li> <li>kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c commit v\u00e0o source repository.</li> </ul> <p>V\u00ed d\u1ee5 <code>.env</code> cho development local:</p> <pre><code>BROKER_URL=https://dev-broker.example.com/ngsi-ld/v1\nBROKER_WRITE_KEY=dev-broker-write-key\nBROKER_READ_KEY=dev-broker-read-key\n</code></pre> <p>C\u00e1c file <code>.env</code> n\u00ean \u0111\u01b0\u1ee3c b\u1ecf qua b\u1edfi version control.</p>"},{"location":"vi/user-guide/api-keys/#co-che-xac-thuc","title":"C\u01a1 ch\u1ebf x\u00e1c th\u1ef1c","text":"<p>C\u01a1 ch\u1ebf x\u00e1c th\u1ef1c th\u1ef1c t\u1ebf ph\u1ee5 thu\u1ed9c v\u00e0o broker v\u00e0 c\u01a1 s\u1edf h\u1ea1 t\u1ea7ng \u0111\u01b0\u1ee3c ch\u1ecdn. C\u00e1c t\u00f9y ch\u1ecdn ph\u1ed5 bi\u1ebfn:</p> <ul> <li> <p>Kh\u00f3a API ho\u1eb7c token t\u0129nh   Kh\u00f3a \u0111\u01b0\u1ee3c g\u1eedi trong header nh\u01b0 <code>Authorization</code> ho\u1eb7c <code>X-API-Key</code>. \u0110\u01a1n gi\u1ea3n \u0111\u1ec3 c\u1ea5u h\u00ecnh.</p> </li> <li> <p>Mutual TLS (mTLS)   Client certificate \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 x\u00e1c th\u1ef1c c\u00e1c d\u1ecbch v\u1ee5. B\u1ea3o m\u1eadt m\u1ea1nh h\u01a1n, qu\u1ea3n l\u00fd ph\u1ee9c t\u1ea1p h\u01a1n.</p> </li> <li> <p>OAuth2 / OpenID Connect   Token \u0111\u01b0\u1ee3c c\u1ea5p b\u1edfi m\u1ed9t identity provider. H\u1eefu \u00edch khi broker l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a n\u1ec1n t\u1ea3ng nh\u1eadn di\u1ec7n l\u1edbn h\u01a1n.</p> </li> </ul> <p>LegoCity mong \u0111\u1ee3i r\u1eb1ng:</p> <ul> <li>c\u00e1c update server s\u1eed d\u1ee5ng c\u00e1c ph\u01b0\u01a1ng ph\u00e1p kh\u00f4ng t\u01b0\u01a1ng t\u00e1c (kh\u00f4ng \u0111\u0103ng nh\u1eadp th\u1ee7 c\u00f4ng),</li> <li>th\u00f4ng tin x\u00e1c th\u1ef1c c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh \u0111\u01b0\u1ee3c, kh\u00f4ng hard-code,</li> <li>c\u01a1 ch\u1ebf \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0 c\u00e1c header y\u00eau c\u1ea7u \u0111\u01b0\u1ee3c ghi l\u1ea1i cho tri\u1ec3n khai.</li> </ul>"},{"location":"vi/user-guide/api-keys/#cac-mau-cho-khoa-ghi","title":"C\u00e1c m\u1eabu cho kh\u00f3a ghi","text":"<p>C\u00f3 nhi\u1ec1u c\u00e1ch \u0111\u1ec3 g\u00e1n kh\u00f3a ghi cho c\u00e1c update server. Tri\u1ec3n khai ph\u1ea3i ch\u1ecdn m\u1ed9t c\u00e1ch v\u00e0 ghi l\u1ea1i n\u00f3.</p>"},{"location":"vi/user-guide/api-keys/#khoa-ghi-uoc-chia-se-on","title":"Kh\u00f3a ghi \u0111\u01b0\u1ee3c chia s\u1ebb \u0111\u01a1n","text":"<p>T\u1ea5t c\u1ea3 c\u00e1c update server s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t kh\u00f3a ho\u1eb7c token \u0111\u1ec3 ghi v\u00e0o broker.</p> <p>\u0110\u1eb7c \u0111i\u1ec3m</p> <ul> <li>m\u1ed9t kh\u00f3a ghi cho m\u1ed7i broker ho\u1eb7c m\u1ed7i m\u00f4i tr\u01b0\u1eddng.</li> </ul> <p>\u01afu \u0111i\u1ec3m</p> <ul> <li>\u0111\u01a1n gi\u1ea3n \u0111\u1ec3 suy lu\u1eadn,</li> <li>chi ph\u00ed qu\u1ea3n tr\u1ecb th\u1ea5p.</li> </ul> <p>Nh\u01b0\u1ee3c \u0111i\u1ec3m</p> <ul> <li>n\u1ebfu m\u1ed9t server b\u1ecb x\u00e2m ph\u1ea1m, c\u00f9ng m\u1ed9t kh\u00f3a c\u00f3 th\u1ec3 b\u1ecb l\u1ea1m d\u1ee5ng t\u1eeb b\u1ea5t c\u1ee9 \u0111\u00e2u,</li> <li>thu h\u1ed3i kh\u00f3a y\u00eau c\u1ea7u c\u1eadp nh\u1eadt t\u1ea5t c\u1ea3 c\u00e1c server c\u00f9ng l\u00fac.</li> </ul> <p>Ph\u00f9 h\u1ee3p cho c\u00e1c tri\u1ec3n khai nh\u1ecf ho\u1eb7c prototype.</p>"},{"location":"vi/user-guide/api-keys/#khoa-rieng-cho-moi-update-server","title":"Kh\u00f3a ri\u00eang cho m\u1ed7i update server","text":"<p>M\u1ed7i update server c\u00f3 kh\u00f3a ghi ho\u1eb7c token ri\u00eang c\u1ee7a n\u00f3.</p> <p>\u0110\u1eb7c \u0111i\u1ec3m</p> <ul> <li>th\u00f4ng tin x\u00e1c th\u1ef1c kh\u00e1c nhau cho m\u1ed7i domain server (<code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>, v.v.).</li> </ul> <p>\u01afu \u0111i\u1ec3m</p> <ul> <li>x\u00e2m ph\u1ea1m m\u1ed9t server kh\u00f4ng expose quy\u1ec1n truy c\u1eadp ghi t\u1eeb c\u00e1c server kh\u00e1c,</li> <li>quy\u1ec1n truy c\u1eadp c\u00f3 th\u1ec3 b\u1ecb thu h\u1ed3i cho m\u1ed9t server duy nh\u1ea5t m\u00e0 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn ph\u1ea7n c\u00f2n l\u1ea1i,</li> <li>c\u00f3 th\u1ec3 g\u00e1n c\u00e1c scope kh\u00e1c nhau cho m\u1ed7i kh\u00f3a.</li> </ul> <p>Nh\u01b0\u1ee3c \u0111i\u1ec3m</p> <ul> <li>nhi\u1ec1u th\u00f4ng tin x\u00e1c th\u1ef1c h\u01a1n \u0111\u1ec3 qu\u1ea3n l\u00fd,</li> <li>c\u1ea7n nhi\u1ec1u t\u00e0i li\u1ec7u h\u01a1n \u0111\u1ec3 theo d\u00f5i quy\u1ec1n s\u1edf h\u1eefu.</li> </ul> <p>\u0110\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho c\u00e1c tri\u1ec3n khai nghi\u00eam t\u00fac.</p>"},{"location":"vi/user-guide/api-keys/#cac-mau-hybrid","title":"C\u00e1c m\u1eabu hybrid","text":"<p>M\u1ed9t s\u1ed1 tri\u1ec3n khai c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t kh\u00f3a cho m\u1ed7i domain:</p> <ul> <li>m\u1ed9t kh\u00f3a cho c\u00e1c server li\u00ean quan \u0111\u1ebfn m\u00f4i tr\u01b0\u1eddng,</li> <li>m\u1ed9t kh\u00f3a cho n\u01b0\u1edbc v\u00e0 l\u0169 l\u1ee5t,</li> <li>m\u1ed9t kh\u00f3a cho di chuy\u1ec3n.</li> </ul> <p>\u0110i\u1ec3m quan tr\u1ecdng l\u00e0 m\u1eabu ph\u1ea3i \u1ed5n \u0111\u1ecbnh, \u0111\u01b0\u1ee3c ghi l\u1ea1i, v\u00e0 \u0111\u01b0\u1ee3c ph\u1ea3n \u00e1nh trong gi\u00e1m s\u00e1t v\u00e0 ph\u1ea3n \u1ee9ng s\u1ef1 c\u1ed1.</p>"},{"location":"vi/user-guide/api-keys/#luu-tru-va-phan-phoi","title":"L\u01b0u tr\u1eef v\u00e0 ph\u00e2n ph\u1ed1i","text":"<p>B\u1ea5t k\u1ec3 m\u1eabu n\u00e0o, c\u00e1c kh\u00f3a ph\u1ea3i \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef v\u00e0 ph\u00e2n ph\u1ed1i m\u1ed9t c\u00e1ch an to\u00e0n.</p>"},{"location":"vi/user-guide/api-keys/#luu-tru-chap-nhan-uoc","title":"L\u01b0u tr\u1eef ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c","text":"<ul> <li>bi\u1ebfn m\u00f4i tr\u01b0\u1eddng \u0111\u01b0\u1ee3c inject v\u00e0o th\u1eddi \u0111i\u1ec3m tri\u1ec3n khai,</li> <li>secret manager do c\u00e1c n\u1ec1n t\u1ea3ng \u0111\u00e1m m\u00e2y cung c\u1ea5p,</li> <li>c\u00e1c c\u1eeda h\u00e0ng c\u1ea5u h\u00ecnh an to\u00e0n, t\u00e1ch bi\u1ec7t kh\u1ecfi application image.</li> </ul>"},{"location":"vi/user-guide/api-keys/#luu-tru-khong-chap-nhan-uoc","title":"L\u01b0u tr\u1eef kh\u00f4ng ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c","text":"<ul> <li>kh\u00f3a hard-code trong source code,</li> <li>kh\u00f3a \u0111\u01b0\u1ee3c commit v\u00e0o git repository,</li> <li>kh\u00f3a \u0111\u01b0\u1ee3c chia s\u1ebb m\u1ed9t c\u00e1ch kh\u00f4ng ch\u00ednh th\u1ee9c qua c\u00e1c k\u00eanh kh\u00f4ng m\u00e3 h\u00f3a.</li> </ul>"},{"location":"vi/user-guide/api-keys/#vi-du-cau-hinh","title":"V\u00ed d\u1ee5 c\u1ea5u h\u00ecnh","text":"<p>Cho ba update server:</p> <ul> <li> <p><code>env-weather-server</code></p> </li> <li> <p><code>BROKER_URL</code></p> </li> <li> <p><code>BROKER_WRITE_KEY_ENV</code></p> </li> <li> <p><code>water-flood-server</code></p> </li> <li> <p><code>BROKER_URL</code></p> </li> <li> <p><code>BROKER_WRITE_KEY_WATER</code></p> </li> <li> <p><code>mobility-parking-server</code></p> </li> <li><code>BROKER_URL</code></li> <li><code>BROKER_WRITE_KEY_MOBILITY</code></li> </ul> <p>M\u1ed7i d\u1ecbch v\u1ee5 \u0111\u1ecdc c\u1ea5u h\u00ecnh c\u1ee7a n\u00f3 t\u1eeb m\u00f4i tr\u01b0\u1eddng ho\u1eb7c m\u1ed9t secret manager khi kh\u1edfi \u0111\u1ed9ng.</p>"},{"location":"vi/user-guide/api-keys/#xoay-vong-khoa","title":"Xoay v\u00f2ng kh\u00f3a","text":"<p>Xoay v\u00f2ng kh\u00f3a thay th\u1ebf c\u00e1c kh\u00f3a hi\u1ec7n c\u00f3 b\u1eb1ng c\u00e1c kh\u00f3a m\u1edbi m\u00e0 kh\u00f4ng gi\u00e1n \u0111o\u1ea1n d\u1ecbch v\u1ee5 l\u00e2u.</p> <p>M\u1ed9t quy tr\u00ecnh xoay v\u00f2ng \u0111\u01a1n gi\u1ea3n:</p> <ol> <li> <p>T\u1ea1o kh\u00f3a m\u1edbi    T\u1ea1o kh\u00f3a ho\u1eb7c token m\u1edbi t\u1ea1i broker ho\u1eb7c gateway. L\u01b0u ch\u00fang trong secret manager ho\u1eb7c h\u1ec7 th\u1ed1ng c\u1ea5u h\u00ecnh.</p> </li> <li> <p>C\u1eadp nh\u1eadt c\u00e1c d\u1ecbch v\u1ee5    C\u1eadp nh\u1eadt bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c config cho m\u1ed7i update server \u0111\u1ec3 s\u1eed d\u1ee5ng kh\u00f3a m\u1edbi. Restart ho\u1eb7c reload c\u00e1c server.</p> </li> <li> <p>X\u00e1c minh ho\u1ea1t \u0111\u1ed9ng    Ki\u1ec3m tra r\u1eb1ng c\u00e1c update server ti\u1ebfp t\u1ee5c ghi entity th\u00e0nh c\u00f4ng. Gi\u00e1m s\u00e1t log v\u00e0 metric cho c\u00e1c l\u1ed7i ghi.</p> </li> <li> <p>Thu h\u1ed3i c\u00e1c kh\u00f3a c\u0169    Khi t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch v\u1ee5 \u0111\u01b0\u1ee3c x\u00e1c nh\u1eadn s\u1eed d\u1ee5ng kh\u00f3a m\u1edbi, x\u00f3a ho\u1eb7c v\u00f4 hi\u1ec7u h\u00f3a c\u00e1c kh\u00f3a c\u0169.</p> </li> </ol> <p>T\u00e0i li\u1ec7u n\u00ean n\u00eau r\u00f5:</p> <ul> <li>n\u01a1i c\u00e1c kh\u00f3a \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a,</li> <li>ai \u0111\u01b0\u1ee3c ph\u00e9p xoay v\u00f2ng ch\u00fang,</li> <li>t\u00edn hi\u1ec7u gi\u00e1m s\u00e1t n\u00e0o cho bi\u1ebft m\u1ed9t xoay v\u00f2ng th\u1ea5t b\u1ea1i.</li> </ul>"},{"location":"vi/user-guide/api-keys/#truy-cap-oc-va-proxy","title":"Truy c\u1eadp \u0111\u1ecdc v\u00e0 proxy","text":"<p>Truy c\u1eadp ghi v\u00e0 truy c\u1eadp \u0111\u1ecdc ph\u1ea3i \u0111\u01b0\u1ee3c x\u1eed l\u00fd kh\u00e1c nhau.</p>"},{"location":"vi/user-guide/api-keys/#truy-cap-oc-noi-bo","title":"Truy c\u1eadp \u0111\u1ecdc n\u1ed9i b\u1ed9","text":"<p>C\u00e1c d\u1ecbch v\u1ee5 n\u1ed9i b\u1ed9 (proxy, analytics) c\u00f3 th\u1ec3 \u0111\u1ecdc tr\u1ef1c ti\u1ebfp t\u1eeb broker. T\u00f9y thu\u1ed9c v\u00e0o c\u1ea5u h\u00ecnh, c\u00e1c ho\u1ea1t \u0111\u1ed9ng \u0111\u1ecdc c\u00f3 th\u1ec3 l\u00e0:</p> <ul> <li>kh\u00f4ng h\u1ea1n ch\u1ebf b\u00ean trong m\u1ed9t m\u1ea1ng \u0111\u00e1ng tin c\u1eady, ho\u1eb7c</li> <li>\u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 b\u1edfi m\u1ed9t kh\u00f3a ho\u1eb7c token ch\u1ec9 \u0111\u1ecdc.</li> </ul> <p>N\u1ebfu m\u1ed9t kh\u00f3a ch\u1ec9 \u0111\u1ecdc \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, n\u00f3 n\u00ean l\u00e0:</p> <ul> <li>kh\u00e1c bi\u1ec7t v\u1edbi c\u00e1c kh\u00f3a ghi,</li> <li>kh\u00f4ng \u0111\u01b0\u1ee3c expose ra tr\u00ecnh duy\u1ec7t.</li> </ul>"},{"location":"vi/user-guide/api-keys/#truy-cap-oc-cong-khai-qua-proxy","title":"Truy c\u1eadp \u0111\u1ecdc c\u00f4ng khai qua proxy","text":"<p>Dashboard v\u00e0 c\u00e1c client c\u00f4ng khai n\u00ean g\u1ecdi proxy, kh\u00f4ng ph\u1ea3i broker tr\u1ef1c ti\u1ebfp. Proxy:</p> <ul> <li>ph\u00e1t h\u00e0nh c\u00e1c truy v\u1ea5n \u0111\u1ecdc t\u1edbi broker,</li> <li>chuy\u1ec3n \u0111\u1ed5i c\u00e1c response th\u00e0nh c\u00e1c c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n h\u01a1n,</li> <li>th\u1ef1c thi caching, rate limit v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp.</li> </ul> <p>Th\u00f4ng tin x\u00e1c th\u1ef1c broker (\u0111\u1ecdc ho\u1eb7c ghi) kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c nh\u00fang trong frontend code. Tr\u00ecnh duy\u1ec7t ch\u1ec9 th\u1ea5y URL proxy v\u00e0 b\u1ea5t k\u1ef3 kh\u00f3a c\u1ea5p proxy ho\u1eb7c c\u01a1 ch\u1ebf x\u00e1c th\u1ef1c ng\u01b0\u1eddi d\u00f9ng n\u00e0o.</p>"},{"location":"vi/user-guide/api-keys/#vi-du-kich-ban","title":"V\u00ed d\u1ee5 k\u1ecbch b\u1ea3n","text":"<p>Xem x\u00e9t m\u1ed9t tri\u1ec3n khai v\u1edbi:</p> <ul> <li>m\u1ed9t broker t\u1ea1i <code>https://broker.city.example/ngsi-ld/v1</code>,</li> <li>ba update server: <code>env-weather-server</code>, <code>water-flood-server</code>, <code>mobility-parking-server</code>,</li> <li>m\u1ed9t proxy t\u1ea1i <code>https://api.city.example</code>.</li> </ul>"},{"location":"vi/user-guide/api-keys/#broker","title":"Broker","text":"<p>Token ghi \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh t\u1ea1i broker ho\u1eb7c gateway:</p> <ul> <li><code>TOKEN_ENV</code> cho c\u00e1c entity m\u00f4i tr\u01b0\u1eddng,</li> <li><code>TOKEN_WATER</code> cho c\u00e1c entity n\u01b0\u1edbc v\u00e0 l\u0169 l\u1ee5t,</li> <li><code>TOKEN_MOBILITY</code> cho c\u00e1c entity di chuy\u1ec3n.</li> </ul>"},{"location":"vi/user-guide/api-keys/#update-server","title":"Update server","text":"<ul> <li> <p><code>env-weather-server</code></p> </li> <li> <p><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_TOKEN=TOKEN_ENV</code></p> </li> <li> <p><code>water-flood-server</code></p> </li> <li> <p><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></p> </li> <li> <p><code>BROKER_WRITE_TOKEN=TOKEN_WATER</code></p> </li> <li> <p><code>mobility-parking-server</code></p> </li> <li><code>BROKER_URL=https://broker.city.example/ngsi-ld/v1</code></li> <li><code>BROKER_WRITE_TOKEN=TOKEN_MOBILITY</code></li> </ul> <p>M\u1ed7i server g\u1eedi token c\u1ee7a n\u00f3 trong header th\u00edch h\u1ee3p khi ghi entity.</p>"},{"location":"vi/user-guide/api-keys/#proxy","title":"Proxy","text":"<ul> <li>ch\u1ea1y t\u1ea1i <code>https://api.city.example</code>,</li> <li>s\u1eed d\u1ee5ng th\u00f4ng tin x\u00e1c th\u1ef1c n\u1ed9i b\u1ed9 ho\u1eb7c network trust \u0111\u1ec3 truy v\u1ea5n broker,</li> <li>expose c\u00e1c endpoint nh\u01b0:</li> <li><code>/map/weather</code></li> <li><code>/map/flood-zones</code></li> <li><code>/map/parking-facilities</code></li> </ul> <p>Dashboard g\u1ecdi c\u00e1c endpoint n\u00e0y v\u00e0 kh\u00f4ng bao gi\u1edd th\u1ea5y token c\u1ea5p broker.</p>"},{"location":"vi/user-guide/api-keys/#xu-ly-su-co","title":"X\u1eed l\u00fd s\u1ef1 c\u1ed1","text":"<p>N\u1ebfu m\u1ed9t kh\u00f3a b\u1ecb l\u1ed9 ho\u1eb7c nghi ng\u1edd b\u1ecb x\u00e2m ph\u1ea1m:</p> <ul> <li>x\u00e1c \u0111\u1ecbnh kh\u00f3a n\u00e0o b\u1ecb l\u1ed9 v\u00e0 d\u1ecbch v\u1ee5 n\u00e0o s\u1eed d\u1ee5ng n\u00f3,</li> <li>thu h\u1ed3i ho\u1eb7c v\u00f4 hi\u1ec7u h\u00f3a kh\u00f3a t\u1ea1i broker ho\u1eb7c gateway,</li> <li>t\u1ea1o v\u00e0 ph\u00e2n ph\u1ed1i m\u1ed9t kh\u00f3a thay th\u1ebf khi c\u1ea7n thi\u1ebft,</li> <li>c\u1eadp nh\u1eadt c\u1ea5u h\u00ecnh v\u00e0 restart c\u00e1c d\u1ecbch v\u1ee5 b\u1ecb \u1ea3nh h\u01b0\u1edfng,</li> <li>xem l\u1ea1i log cho c\u00e1c n\u1ed7 l\u1ef1c ghi tr\u00e1i ph\u00e9p ho\u1eb7c c\u00e1c m\u1eabu \u0111\u00e1ng ng\u1edd.</li> </ul> <p>T\u00e0i li\u1ec7u n\u00ean ch\u1ec9 ra:</p> <ul> <li>n\u01a1i c\u00e1c kh\u00f3a c\u00f3 th\u1ec3 b\u1ecb thu h\u1ed3i,</li> <li>log ho\u1eb7c dashboard n\u00e0o hi\u1ec3n th\u1ecb quy\u1ec1n truy c\u1eadp broker,</li> <li>c\u00e1ch x\u00e1c minh r\u1eb1ng c\u00e1c entity kh\u00f4ng b\u1ecb h\u1ecfng.</li> </ul>"},{"location":"vi/user-guide/api-keys/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>C\u00e1c update server l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n duy nh\u1ea5t c\u00f3 quy\u1ec1n truy c\u1eadp ghi v\u00e0o broker v\u00e0 s\u1eed d\u1ee5ng c\u00e1c kh\u00f3a ho\u1eb7c token \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a qua c\u1ea5u h\u00ecnh, kh\u00f4ng trong code.</li> <li>M\u1ed9t tri\u1ec3n khai ph\u1ea3i ch\u1ecdn v\u00e0 ghi l\u1ea1i m\u1ed9t m\u1eabu r\u00f5 r\u00e0ng cho c\u00e1c kh\u00f3a ghi (\u0111\u01b0\u1ee3c chia s\u1ebb, theo server, ho\u1eb7c hybrid).</li> <li>C\u00e1c kh\u00f3a ph\u1ea3i \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef an to\u00e0n, xoay v\u00f2ng th\u01b0\u1eddng xuy\u00ean, v\u00e0 thu h\u1ed3i ngay l\u1eadp t\u1ee9c n\u1ebfu b\u1ecb x\u00e2m ph\u1ea1m.</li> <li>Dashboard v\u00e0 c\u00e1c client c\u00f4ng khai l\u1ea5y d\u1eef li\u1ec7u th\u00f4ng qua proxy; th\u00f4ng tin x\u00e1c th\u1ef1c broker kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c expose ra tr\u00ecnh duy\u1ec7t.</li> <li>Truy c\u1eadp \u0111\u1ecdc n\u1ed9i b\u1ed9, truy c\u1eadp \u0111\u1ecdc b\u00ean ngo\u00e0i v\u00e0 truy c\u1eadp ghi n\u00ean \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh v\u00e0 gi\u00e1m s\u00e1t ri\u00eang bi\u1ec7t.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/","title":"D\u1eef li\u1ec7u v\u00e0 broker","text":"<p>Trang n\u00e0y gi\u1ea3i th\u00edch chi ti\u1ebft c\u00e1ch l\u1edbp d\u1eef li\u1ec7u c\u1ee7a LegoCity \u0111\u01b0\u1ee3c t\u1ed5 ch\u1ee9c xung quanh c\u00e1c NGSI-LD context broker v\u00e0 update server.</p> <p>Trang n\u00e0y t\u1eadp trung v\u00e0o:</p> <ul> <li>broker d\u1ef1 ki\u1ebfn l\u01b0u tr\u1eef v\u00e0 cung c\u1ea5p g\u00ec,</li> <li>c\u00e1ch d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c nh\u00f3m th\u00e0nh c\u00e1c domain,</li> <li>c\u00e1ch c\u00e1c update server \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf v\u00e0 v\u1eadn h\u00e0nh,</li> <li>c\u00e1ch c\u00e1c quy\u1ebft \u0111\u1ecbnh v\u1ec1 l\u1ecbch s\u1eed, ch\u1ea5t l\u01b0\u1ee3ng v\u00e0 ngu\u1ed3n d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c \u0111\u01b0a ra.</li> </ul> <p>Trang n\u00e0y kh\u00f4ng \u0111\u1ec1 c\u1eadp \u0111\u1ebfn c\u00e1c l\u1ec7nh tri\u1ec3n khai ho\u1eb7c t\u1ef1 \u0111\u1ed9ng h\u00f3a c\u01a1 s\u1edf h\u1ea1 t\u1ea7ng; nh\u1eefng \u0111i\u1ec1u \u0111\u00f3 \u0111\u01b0\u1ee3c ghi l\u1ea1i trong ph\u1ea7n Tri\u1ec3n khai.</p>"},{"location":"vi/user-guide/data-and-brokers/#1-luong-du-lieu-tong-the","title":"1. Lu\u1ed3ng d\u1eef li\u1ec7u t\u1ed5ng th\u1ec3","text":"<p>Lu\u1ed3ng d\u1eef li\u1ec7u c\u01a1 b\u1ea3n trong tri\u1ec3n khai LegoCity l\u00e0:</p> <ol> <li>M\u1ed9t h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i (v\u00ed d\u1ee5: API th\u1eddi ti\u1ebft, gateway c\u1ea3m bi\u1ebfn, m\u00f4 h\u00ecnh l\u0169 l\u1ee5t, ngu\u1ed3n c\u1ea5p v\u1eadn t\u1ea3i) expose d\u1eef li\u1ec7u th\u00f4.</li> <li>M\u1ed9t update server cho domain \u0111\u00f3 \u0111\u1ecdc d\u1eef li\u1ec7u th\u00f4 theo l\u1ecbch tr\u00ecnh.</li> <li>Update server chuy\u1ec3n \u0111\u1ed5i d\u1eef li\u1ec7u th\u00f4 th\u00e0nh NGSI-LD entity tu\u00e2n theo c\u00e1c m\u00f4 h\u00ecnh v\u00e0 quy \u01b0\u1edbc \u0111\u00e3 th\u1ecfa thu\u1eadn.</li> <li>Update server ghi c\u00e1c entity \u0111\u00f3 v\u00e0o m\u1ed9t context broker.</li> <li>Dashboard v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 \u1ee9ng d\u1ee5ng kh\u00e1c \u0111\u1ecdc entity t\u1eeb broker (th\u01b0\u1eddng qua proxy) v\u00e0 bi\u1ebfn ch\u00fang th\u00e0nh c\u00e1c l\u1edbp b\u1ea3n \u0111\u1ed3 v\u00e0 ph\u1ea7n t\u1eed UI.</li> </ol> <p>C\u00e1c r\u00e0ng bu\u1ed9c quan tr\u1ecdng l\u00e0:</p> <ul> <li>update server l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n duy nh\u1ea5t ghi v\u00e0o broker trong ho\u1ea1t \u0111\u1ed9ng b\u00ecnh th\u01b0\u1eddng,</li> <li>broker l\u00e0 ngu\u1ed3n duy nh\u1ea5t m\u00e0 dashboard \u0111\u1ecdc ng\u1eef c\u1ea3nh th\u00e0nh ph\u1ed1,</li> <li>n\u1ebfu m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 kh\u00f4ng c\u00f3 trong broker, n\u00f3 kh\u00f4ng t\u1ed3n t\u1ea1i t\u1eeb quan \u0111i\u1ec3m c\u1ee7a LegoCity.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#2-vai-tro-cua-context-broker","title":"2. Vai tr\u00f2 c\u1ee7a context broker","text":"<p>Context broker ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho:</p> <ul> <li>l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i c\u1ee7a c\u00e1c entity th\u00e0nh ph\u1ed1 m\u00e0 LegoCity c\u1ea7n,</li> <li>expose m\u1ed9t API NGSI-LD chu\u1ea9n \u0111\u1ec3 t\u1ea1o, c\u1eadp nh\u1eadt, truy v\u1ea5n v\u00e0 subscription,</li> <li>cung c\u1ea5p m\u1ed9t view nh\u1ea5t qu\u00e1n, chu\u1ea9n h\u00f3a v\u1ec1 \"th\u00e0nh ph\u1ed1 tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0o hi\u1ec7n t\u1ea1i\".</li> </ul> <p>T\u1eeb quan \u0111i\u1ec3m c\u1ee7a LegoCity, broker ph\u1ea3i:</p> <ul> <li>l\u01b0u tr\u1eef entity cho t\u1ea5t c\u1ea3 c\u00e1c domain trong ph\u1ea1m vi (v\u00ed d\u1ee5: m\u00f4i tr\u01b0\u1eddng, l\u0169 l\u1ee5t, di chuy\u1ec3n, d\u1ecbch v\u1ee5 c\u00f4ng),</li> <li>h\u1ed7 tr\u1ee3 c\u00e1c truy v\u1ea5n kh\u00f4ng gian \u0111\u1ecba l\u00fd v\u00e0 l\u1ecdc tr\u00ean c\u00e1c thu\u1ed9c t\u00ednh m\u00e0 UI s\u1ebd c\u1ea7n,</li> <li>x\u1eed l\u00fd kh\u1ed1i l\u01b0\u1ee3ng v\u00e0 t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt d\u1ef1 ki\u1ebfn c\u1ee7a c\u00e1c entity.</li> </ul> <p>Broker kh\u00f4ng \u0111\u01b0\u1ee3c mong \u0111\u1ee3i \u0111\u1ec3:</p> <ul> <li>th\u1ef1c hi\u1ec7n ph\u00e2n t\u00edch n\u1eb7ng,</li> <li>render b\u1ea3n \u0111\u1ed3,</li> <li>nh\u1eadn bi\u1ebft c\u00e1c kh\u00e1i ni\u1ec7m UI nh\u01b0 trang, kh\u1ed1i ho\u1eb7c quy\u1ec1n b\u00ean trong dashboard.</li> </ul> <p>Nh\u1eefng m\u1ed1i quan t\u00e2m \u0111\u00f3 l\u00e0 b\u00ean ngo\u00e0i broker.</p>"},{"location":"vi/user-guide/data-and-brokers/#21-nhung-gi-uoc-luu-tru-trong-broker","title":"2.1 Nh\u1eefng g\u00ec \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong broker","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i domain, broker l\u01b0u tr\u1eef:</p> <ul> <li>\u0111\u1ecbnh danh entity \u0111\u1ea1i di\u1ec7n cho c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng ho\u1eb7c quan s\u00e1t trong th\u1ebf gi\u1edbi th\u1ef1c,</li> <li>gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a c\u00e1c thu\u1ed9c t\u00ednh (tr\u1ea1ng th\u00e1i, \u0111o l\u01b0\u1eddng, n\u0103ng l\u1ef1c, v.v.),</li> <li>thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd (v\u1ecb tr\u00ed, h\u00ecnh h\u1ecdc, khu v\u1ef1c bao ph\u1ee7),</li> <li>timestamp cho bi\u1ebft th\u00f4ng tin \u0111\u01b0\u1ee3c quan s\u00e1t ho\u1eb7c c\u1eadp nh\u1eadt l\u1ea7n cu\u1ed1i khi n\u00e0o.</li> </ul> <p>V\u00ed d\u1ee5 v\u1ec1 nh\u1eefng g\u00ec n\u1eb1m trong ph\u1ea1m vi c\u1ee7a broker:</p> <ul> <li>\"C\u00f3 m\u1ed9t v\u00f9ng l\u0169 l\u1ee5t v\u1edbi \u0111a gi\u00e1c n\u00e0y v\u00e0 m\u1ee9c \u0111\u1ed9 r\u1ee7i ro hi\u1ec7n t\u1ea1i n\u00e0y.\"</li> <li>\"C\u00f3 m\u1ed9t c\u01a1 s\u1edf \u0111\u1ed7 xe v\u1edbi s\u1ee9c ch\u1ee9a n\u00e0y v\u00e0 t\u1ef7 l\u1ec7 l\u1ea5p \u0111\u1ea7y hi\u1ec7n t\u1ea1i n\u00e0y.\"</li> <li>\"C\u00f3 m\u1ed9t quan s\u00e1t th\u1eddi ti\u1ebft t\u1ea1i v\u1ecb tr\u00ed n\u00e0y v\u1edbi nhi\u1ec7t \u0111\u1ed9 v\u00e0 \u0111\u1ed9 \u1ea9m n\u00e0y.\"</li> </ul> <p>N\u1ebfu dashboard c\u1ea7n hi\u1ec3n th\u1ecb m\u1ed9t gi\u00e1 tr\u1ecb cho ng\u01b0\u1eddi d\u00f9ng, gi\u00e1 tr\u1ecb \u0111\u00f3 ph\u1ea3i c\u00f3 ho\u1eb7c c\u00f3 th\u1ec3 suy ra t\u1eeb c\u00e1c entity trong broker.</p>"},{"location":"vi/user-guide/data-and-brokers/#22-nhung-gi-khong-uoc-luu-tru-trong-broker","title":"2.2 Nh\u1eefng g\u00ec kh\u00f4ng \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong broker","text":"<p>Broker kh\u00f4ng b\u1eaft bu\u1ed9c ph\u1ea3i l\u01b0u tr\u1eef:</p> <ul> <li>c\u1ea5u h\u00ecnh UI (ki\u1ec3u b\u1ea3n \u0111\u1ed3, gi\u00e1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh hi\u1ec3n th\u1ecb l\u1edbp, b\u1ed1 c\u1ee5c panel),</li> <li>t\u00e0i kho\u1ea3n ng\u01b0\u1eddi d\u00f9ng, vai tr\u00f2 ho\u1eb7c quy\u1ec1n,</li> <li>t\u00e0i li\u1ec7u ho\u1eb7c v\u0103n b\u1ea3n m\u00f4 t\u1ea3 ch\u1ec9 li\u00ean quan \u0111\u1ebfn UI qu\u1ea3n tr\u1ecb.</li> </ul> <p>C\u00e1c m\u1ee5c n\u00e0y thu\u1ed9c v\u1ec1 PayloadCMS ho\u1eb7c c\u00e1c ph\u1ea7n kh\u00e1c c\u1ee7a stack LegoCity.</p>"},{"location":"vi/user-guide/data-and-brokers/#3-cau-truc-broker","title":"3. C\u1ea5u tr\u00fac broker","text":"<p>M\u1ed9t tri\u1ec3n khai LegoCity ph\u1ea3i ch\u1ecdn ch\u1ea1y bao nhi\u00eau broker v\u00e0 m\u1ed7i broker ch\u1ecbu tr\u00e1ch nhi\u1ec7m v\u1ec1 g\u00ec. \u0110\u00e2y l\u00e0 m\u1ed9t quy\u1ebft \u0111\u1ecbnh c\u1ea5u tr\u00fac \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn m\u1ecdi ph\u1ea7n kh\u00e1c c\u1ee7a h\u1ec7 th\u1ed1ng.</p>"},{"location":"vi/user-guide/data-and-brokers/#31-trien-khai-broker-on","title":"3.1 Tri\u1ec3n khai broker \u0111\u01a1n","text":"<p>Trong tri\u1ec3n khai broker \u0111\u01a1n:</p> <ul> <li>m\u1ed9t instance broker l\u01b0u tr\u1eef t\u1ea5t c\u1ea3 c\u00e1c entity cho tri\u1ec3n khai (t\u1ea5t c\u1ea3 c\u00e1c domain, t\u1ea5t c\u1ea3 c\u00e1c khu v\u1ef1c th\u00e0nh ph\u1ed1),</li> <li>t\u1ea5t c\u1ea3 c\u00e1c update server ghi v\u00e0o broker \u0111\u00f3,</li> <li>t\u1ea5t c\u1ea3 c\u00e1c dashboard v\u00e0 d\u1ecbch v\u1ee5 \u1ee9ng d\u1ee5ng \u0111\u1ecdc t\u1eeb broker \u0111\u00f3.</li> </ul> <p>\u0110\u00e2y th\u01b0\u1eddng l\u00e0 m\u1eb7c \u0111\u1ecbnh cho:</p> <ul> <li>b\u1eb1ng ch\u1ee9ng v\u1ec1 kh\u00e1i ni\u1ec7m,</li> <li>tri\u1ec3n khai nh\u1ecf \u0111\u1ebfn trung b\u00ecnh,</li> <li>m\u1ed9t th\u00e0nh ph\u1ed1 ho\u1eb7c khu\u00f4n vi\u00ean duy nh\u1ea5t.</li> </ul> <p>\u01afu \u0111i\u1ec3m:</p> <ul> <li>\u00edt endpoint h\u01a1n \u0111\u1ec3 c\u1ea5u h\u00ecnh,</li> <li>gi\u00e1m s\u00e1t v\u00e0 logging \u0111\u01a1n gi\u1ea3n h\u01a1n,</li> <li>d\u1ec5 d\u00e0ng h\u01a1n cho c\u00e1c th\u00e0nh vi\u00ean m\u1edbi trong nh\u00f3m \u0111\u1ec3 hi\u1ec3u.</li> </ul> <p>R\u1ee7i ro v\u00e0 r\u00e0ng bu\u1ed9c:</p> <ul> <li>n\u1ebfu broker kh\u00f4ng kh\u1ea3 d\u1ee5ng, t\u1ea5t c\u1ea3 c\u00e1c domain \u0111\u1ec1u b\u1ecb \u1ea3nh h\u01b0\u1edfng,</li> <li>t\u1ea5t c\u1ea3 c\u00e1c domain chia s\u1ebb c\u00f9ng m\u1ed9t gi\u1edbi h\u1ea1n hi\u1ec7u su\u1ea5t v\u00e0 m\u1edf r\u1ed9ng,</li> <li>c\u1ea7n \u0111\u1eb7t t\u00ean v\u00e0 ph\u1ea1m vi c\u1ea9n th\u1eadn \u0111\u1ec3 tr\u00e1nh xung \u0111\u1ed9t gi\u1eefa c\u00e1c domain.</li> </ul> <p>Trong th\u1ef1c t\u1ebf, m\u1ed9t tri\u1ec3n khai broker \u0111\u01a1n v\u1eabn n\u00ean t\u00e1ch c\u00e1c m\u00f4i tr\u01b0\u1eddng (v\u00ed d\u1ee5: m\u1ed9t broker cho development v\u00e0 m\u1ed9t cho production).</p>"},{"location":"vi/user-guide/data-and-brokers/#32-trien-khai-nhieu-broker","title":"3.2 Tri\u1ec3n khai nhi\u1ec1u broker","text":"<p>Trong tri\u1ec3n khai nhi\u1ec1u broker, c\u00e1c broker kh\u00e1c nhau \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho c\u00e1c ph\u1ea1m vi kh\u00e1c nhau. C\u00e1c m\u1eabu ph\u1ed5 bi\u1ebfn:</p> <ul> <li>m\u1ed9t broker cho m\u1ed7i m\u00f4i tr\u01b0\u1eddng (development, staging, production),</li> <li>m\u1ed9t broker cho m\u1ed7i th\u00e0nh ph\u1ed1 ho\u1eb7c khu v\u1ef1c h\u00e0nh ch\u00ednh,</li> <li>m\u1ed9t broker cho telemetry t\u1ea7n su\u1ea5t cao v\u00e0 m\u1ed9t broker kh\u00e1c cho d\u1eef li\u1ec7u tham chi\u1ebfu t\u0129nh h\u01a1n.</li> </ul> <p>\u01afu \u0111i\u1ec3m:</p> <ul> <li>t\u00e1ch bi\u1ec7t r\u00f5 r\u00e0ng h\u01a1n gi\u1eefa c\u00e1c m\u00f4i tr\u01b0\u1eddng ho\u1eb7c th\u00e0nh ph\u1ed1,</li> <li>ch\u00ednh s\u00e1ch \u0111i\u1ec1u ch\u1ec9nh v\u00e0 l\u01b0u gi\u1eef kh\u00e1c nhau cho m\u1ed7i broker,</li> <li>l\u1ed7i trong m\u1ed9t broker kh\u00f4ng \u1ea3nh h\u01b0\u1edfng ngay l\u1eadp t\u1ee9c \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c domain.</li> </ul> <p>Chi ph\u00ed v\u00e0 r\u00e0ng bu\u1ed9c:</p> <ul> <li>nhi\u1ec1u endpoint v\u00e0 th\u00f4ng tin x\u00e1c th\u1ef1c h\u01a1n \u0111\u1ec3 qu\u1ea3n l\u00fd,</li> <li>c\u00e1c update server ph\u1ea3i bi\u1ebft ghi v\u00e0o broker n\u00e0o,</li> <li>dashboard v\u00e0 proxy ph\u1ea3i \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh \u0111\u1ec3 truy v\u1ea5n broker ch\u00ednh x\u00e1c cho m\u1ed7i ng\u1eef c\u1ea3nh.</li> </ul> <p>T\u00e0i li\u1ec7u c\u1ee7a tri\u1ec3n khai LegoCity n\u00ean li\u1ec7t k\u00ea r\u00f5 r\u00e0ng:</p> <ul> <li>m\u1ed7i instance broker (t\u00ean v\u00e0 URL c\u01a1 s\u1edf),</li> <li>domain v\u00e0 lo\u1ea1i entity n\u00e0o m\u00e0 m\u1ed7i broker s\u1edf h\u1eefu,</li> <li>update server v\u00e0 \u1ee9ng d\u1ee5ng n\u00e0o \u0111\u01b0\u1ee3c ph\u00e9p truy c\u1eadp m\u1ed7i broker.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#4-domain-va-quyen-so-huu","title":"4. Domain v\u00e0 quy\u1ec1n s\u1edf h\u1eefu","text":"<p>Kh\u00f4ng c\u00f3 c\u1ea5u tr\u00fac, m\u1ed9t broker c\u00f3 th\u1ec3 tr\u1edf th\u00e0nh m\u1ed9t t\u1eadp h\u1ee3p ng\u1eabu nhi\u00ean c\u00e1c entity. LegoCity khuy\u1ebfn kh\u00edch nh\u00f3m c\u00e1c entity th\u00e0nh domain v\u00e0 g\u00e1n tr\u00e1ch nhi\u1ec7m r\u00f5 r\u00e0ng.</p> <p>C\u00e1c domain \u0111i\u1ec3n h\u00ecnh l\u00e0:</p> <ul> <li>M\u00f4i tr\u01b0\u1eddng (th\u1eddi ti\u1ebft, ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed, ti\u1ebfng \u1ed3n),</li> <li>N\u01b0\u1edbc v\u00e0 l\u0169 l\u1ee5t,</li> <li>Di chuy\u1ec3n v\u00e0 v\u1eadn t\u1ea3i,</li> <li>D\u1ecbch v\u1ee5 c\u00f4ng (y t\u1ebf, gi\u00e1o d\u1ee5c, h\u00e0nh ch\u00ednh),</li> <li>T\u00e0i s\u1ea3n c\u01a1 s\u1edf h\u1ea1 t\u1ea7ng (\u0111\u1ed7 xe, tr\u1ea1m s\u1ea1c, camera).</li> </ul> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i domain, t\u00e0i li\u1ec7u n\u00ean n\u00eau r\u00f5:</p> <ul> <li>lo\u1ea1i entity n\u00e0o thu\u1ed9c v\u1ec1 n\u00f3 (theo t\u00ean <code>type</code>),</li> <li>update server n\u00e0o ch\u1ecbu tr\u00e1ch nhi\u1ec7m t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt c\u00e1c entity \u0111\u00f3,</li> <li>instance broker n\u00e0o l\u01b0u tr\u1eef c\u00e1c entity \u0111\u00f3,</li> <li>dashboard ho\u1eb7c view b\u1ea3n \u0111\u1ed3 n\u00e0o ti\u00eau th\u1ee5 domain \u0111\u00f3.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y \u0111\u01b0a ra c\u00e2u tr\u1ea3 l\u1eddi r\u00f5 r\u00e0ng cho c\u00e1c c\u00e2u h\u1ecfi nh\u01b0:</p> <ul> <li>\"N\u1ebfu d\u1eef li\u1ec7u l\u0169 l\u1ee5t sai, ch\u00fang ta n\u00ean ki\u1ec3m tra server n\u00e0o?\"</li> <li>\"D\u1eef li\u1ec7u ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed \u0111\u1ebfn t\u1eeb \u0111\u00e2u?\"</li> <li>\"N\u1ebfu ch\u00fang ta th\u00eam m\u1ed9t th\u00e0nh ph\u1ed1 m\u1edbi, domain n\u00e0o c\u1ea7n broker m\u1edbi ho\u1eb7c server m\u1edbi?\"</li> </ul> <p>Domain l\u00e0 m\u1ed9t kh\u00e1i ni\u1ec7m t\u00e0i li\u1ec7u v\u00e0 quy\u1ec1n s\u1edf h\u1eefu; ch\u00fang kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n k\u1ef9 thu\u1eadt m\u1edbi.</p>"},{"location":"vi/user-guide/data-and-brokers/#5-update-server","title":"5. Update server","text":"<p>Update server l\u00e0 d\u1ecbch v\u1ee5 t\u00edch h\u1ee3p. Ch\u00fang k\u1ebft n\u1ed1i c\u00e1c h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i v\u1edbi context broker v\u00e0 l\u00e0 c\u00e1c writer th\u01b0\u1eddng xuy\u00ean duy nh\u1ea5t c\u1ee7a c\u00e1c entity.</p>"},{"location":"vi/user-guide/data-and-brokers/#51-trach-nhiem","title":"5.1 Tr\u00e1ch nhi\u1ec7m","text":"<p>M\u1ed9t update server ch\u1ecbu tr\u00e1ch nhi\u1ec7m cho m\u1ed9t v\u00f2ng l\u1eb7p ho\u00e0n ch\u1ec9nh:</p> <ol> <li> <p>C\u1ea5u h\u00ecnh    N\u00f3 \u0111\u1ecdc t\u1ea5t c\u1ea3 c\u1ea5u h\u00ecnh c\u1ee7a n\u00f3 t\u1eeb c\u00e1c bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c file c\u1ea5u h\u00ecnh, bao g\u1ed3m:</p> </li> <li> <p>URL broker v\u00e0 th\u00f4ng tin x\u00e1c th\u1ef1c,</p> </li> <li>endpoint API b\u00ean ngo\u00e0i v\u00e0 kh\u00f3a,</li> <li> <p>t\u1ea7n su\u1ea5t c\u1eadp nh\u1eadt v\u00e0 b\u1ea5t k\u1ef3 tham s\u1ed1 domain-specific n\u00e0o (v\u00ed d\u1ee5: danh s\u00e1ch c\u00e1c v\u1ecb tr\u00ed \u0111\u1ec3 gi\u00e1m s\u00e1t).</p> </li> <li> <p>Thu th\u1eadp d\u1eef li\u1ec7u    N\u00f3 li\u00ean h\u1ec7 v\u1edbi c\u00e1c ngu\u1ed3n d\u1eef li\u1ec7u b\u00ean ngo\u00e0i:</p> </li> <li> <p>l\u1ea5y d\u1eef li\u1ec7u th\u00f4,</p> </li> <li>x\u1eed l\u00fd ph\u00e2n trang, gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9 v\u00e0 l\u1ed7i t\u1ea1m th\u1eddi,</li> <li> <p>x\u00e1c th\u1ef1c r\u1eb1ng d\u1eef li\u1ec7u nh\u1eadn \u0111\u01b0\u1ee3c c\u00f3 c\u1ea5u tr\u00fac h\u1ee3p l\u1ec7.</p> </li> <li> <p>Chuy\u1ec3n \u0111\u1ed5i    N\u00f3 chuy\u1ec3n \u0111\u1ed5i d\u1eef li\u1ec7u th\u00f4 th\u00e0nh bi\u1ec3u di\u1ec5n entity n\u1ed9i b\u1ed9:</p> </li> <li> <p>ch\u1ecdn lo\u1ea1i entity,</p> </li> <li>\u0111\u1eb7t \u0111\u1ecbnh danh theo c\u00e1c quy \u01b0\u1edbc c\u1ee7a d\u1ef1 \u00e1n,</li> <li>\u0111i\u1ec1n c\u00e1c thu\u1ed9c t\u00ednh kh\u1edbp v\u1edbi Smart Data Model \u0111\u00e3 ch\u1ecdn,</li> <li> <p>\u0111\u1eb7t v\u1ecb tr\u00ed v\u00e0 timestamp.</p> </li> <li> <p>Xu\u1ea5t b\u1ea3n    N\u00f3 ghi entity v\u00e0o broker:</p> </li> <li> <p>t\u1ea1o c\u00e1c entity ch\u01b0a t\u1ed3n t\u1ea1i,</p> </li> <li>c\u1eadp nh\u1eadt thu\u1ed9c t\u00ednh cho c\u00e1c entity hi\u1ec7n c\u00f3,</li> <li> <p>x\u1eed l\u00fd c\u00e1c l\u1ed7i m\u1ed9t ph\u1ea7n v\u00e0 retry khi th\u00edch h\u1ee3p.</p> </li> <li> <p>B\u00e1o c\u00e1o v\u00e0 s\u1ee9c kh\u1ecfe    N\u00f3 ghi log c\u00e1c s\u1ef1 ki\u1ec7n ch\u00ednh:</p> </li> <li>bao nhi\u00eau entity \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o ho\u1eb7c c\u1eadp nh\u1eadt,</li> <li>khi n\u00e0o c\u1eadp nh\u1eadt th\u00e0nh c\u00f4ng l\u1ea7n cu\u1ed1i x\u1ea3y ra,</li> <li>c\u00f3 l\u1ed7i hay kh\u00f4ng v\u00e0 lo\u1ea1i g\u00ec.</li> </ol> <p>V\u00f2ng l\u1eb7p n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai nh\u01b0 m\u1ed9t d\u1ecbch v\u1ee5 ch\u1ea1y li\u00ean t\u1ee5c v\u1edbi m\u1ed9t b\u1ed9 \u0111\u1ebfm th\u1eddi gian ho\u1eb7c nh\u01b0 m\u1ed9t c\u00f4ng vi\u1ec7c \u0111\u01b0\u1ee3c l\u00ean l\u1ecbch.</p>"},{"location":"vi/user-guide/data-and-brokers/#52-muc-o-chi-tiet-va-pham-vi","title":"5.2 M\u1ee9c \u0111\u1ed9 chi ti\u1ebft v\u00e0 ph\u1ea1m vi","text":"<p>Ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb l\u00e0 gi\u1eef c\u00e1c update server c\u00f3 ph\u1ea1m vi h\u1eb9p:</p> <ul> <li>m\u1ed9t server cho m\u1ed7i ngu\u1ed3n d\u1eef li\u1ec7u b\u00ean ngo\u00e0i,</li> <li>ho\u1eb7c m\u1ed9t server cho m\u1ed7i domain khi c\u00e1c ngu\u1ed3n \u0111\u01b0\u1ee3c li\u00ean k\u1ebft ch\u1eb7t ch\u1ebd.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y tr\u00e1nh:</p> <ul> <li>tr\u1ed9n l\u1eabn c\u00e1c m\u1ed1i quan t\u00e2m kh\u00f4ng li\u00ean quan trong m\u1ed9t codebase duy nh\u1ea5t,</li> <li>l\u00e0m cho m\u1ed9t l\u1ed7i \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn nhi\u1ec1u domain,</li> <li>t\u1ea1o ra c\u00e1c coupling \u1ea9n kh\u00f3 debug.</li> </ul> <p>M\u1ed7i server n\u00ean c\u00f3 m\u1ed9t t\u00ean r\u00f5 r\u00e0ng v\u00e0 ph\u1ea1m vi \u0111\u01b0\u1ee3c ghi l\u1ea1i, v\u00ed d\u1ee5:</p> <ul> <li><code>env-weather-server</code> \u2013 \u0111\u1ecdc API th\u1eddi ti\u1ebft, ghi <code>WeatherObserved</code>,</li> <li><code>water-flood-server</code> \u2013 \u0111\u1ecdc \u0111\u1ea7u ra m\u00f4 h\u00ecnh l\u0169 l\u1ee5t, ghi <code>FloodZone</code>,</li> <li><code>mobility-parking-server</code> \u2013 \u0111\u1ecdc backend \u0111\u1ed7 xe, ghi <code>ParkingFacility</code> v\u00e0 <code>ParkingSpot</code>.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#53-idempotency-va-xu-ly-xung-ot","title":"5.3 Idempotency v\u00e0 x\u1eed l\u00fd xung \u0111\u1ed9t","text":"<p>Update server n\u00ean \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 idempotent:</p> <ul> <li>ch\u1ea1y c\u00f9ng m\u1ed9t c\u1eadp nh\u1eadt hai l\u1ea7n li\u00ean ti\u1ebfp kh\u00f4ng n\u00ean t\u1ea1o c\u00e1c entity tr\u00f9ng l\u1eb7p,</li> <li>c\u00e1c c\u1eadp nh\u1eadt n\u00ean lu\u00f4n h\u1ed9i t\u1ee5 v\u1ec1 tr\u1ea1ng th\u00e1i ch\u00ednh x\u00e1c.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 \u00fd ngh\u0129a \u0111\u1ed1i v\u1edbi:</p> <ul> <li>c\u00e1ch t\u1ea1o ID (ID \u1ed5n \u0111\u1ecbnh vs ID ng\u1eabu nhi\u00ean m\u1edbi),</li> <li>c\u00e1ch \u00e1p d\u1ee5ng c\u1eadp nh\u1eadt (replace vs patch),</li> <li>c\u00e1ch x\u1eed l\u00fd c\u00e1c entity \u0111\u00e3 x\u00f3a ho\u1eb7c l\u1ed7i th\u1eddi (x\u00f3a r\u00f5 r\u00e0ng, ho\u1eb7c \u0111\u00e1nh d\u1ea5u l\u00e0 kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng).</li> </ul> <p>D\u1ef1 \u00e1n n\u00ean x\u00e1c \u0111\u1ecbnh c\u00e1ch bi\u1ec3u di\u1ec5n vi\u1ec7c x\u00f3a v\u00e0 v\u00f4 hi\u1ec7u h\u00f3a, \u0111\u1ec3 UI c\u00f3 th\u1ec3 di\u1ec5n gi\u1ea3i ch\u00fang m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c (v\u00ed d\u1ee5: c\u00e1c entity kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng c\u00f3 b\u1ecb \u1ea9n hay \u0111\u01b0\u1ee3c t\u1ea1o ki\u1ec3u kh\u00e1c \u0111i).</p>"},{"location":"vi/user-guide/data-and-brokers/#6-trang-thai-hien-tai-va-lich-su","title":"6. Tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i v\u00e0 l\u1ecbch s\u1eed","text":"<p>C\u00e1c NGSI-LD broker c\u00f3 th\u1ec3 h\u1ed7 tr\u1ee3 c\u1ea3 truy v\u1ea5n ng\u1eef c\u1ea3nh hi\u1ec7n t\u1ea1i v\u00e0 temporal, nh\u01b0ng LegoCity ph\u1ea3i x\u00e1c \u0111\u1ecbnh c\u00e1ch s\u1eed d\u1ee5ng kh\u1ea3 n\u0103ng n\u00e0y.</p>"},{"location":"vi/user-guide/data-and-brokers/#61-trang-thai-hien-tai","title":"6.1 Tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i","text":"<p>\u0110\u1ed1i v\u1edbi nhi\u1ec1u dashboard, ch\u1ec9 tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i quan tr\u1ecdng. V\u00ed d\u1ee5:</p> <ul> <li>m\u1ee9c n\u01b0\u1edbc hi\u1ec7n t\u1ea1i,</li> <li>t\u1ef7 l\u1ec7 l\u1ea5p \u0111\u1ea7y \u0111\u1ed7 xe hi\u1ec7n t\u1ea1i,</li> <li>m\u1ee9c \u0111\u1ed9 r\u1ee7i ro l\u0169 l\u1ee5t hi\u1ec7n t\u1ea1i.</li> </ul> <p>Trong ch\u1ebf \u0111\u1ed9 n\u00e0y:</p> <ul> <li>broker gi\u1eef m\u1ed9t entity cho m\u1ed7i \u0111\u1ed1i t\u01b0\u1ee3ng trong th\u1ebf gi\u1edbi th\u1ef1c,</li> <li>m\u1ed7i c\u1eadp nh\u1eadt ghi \u0111\u00e8 c\u00e1c thu\u1ed9c t\u00ednh c\u00f3 li\u00ean quan,</li> <li>c\u00e1c gi\u00e1 tr\u1ecb c\u0169 kh\u00f4ng \u0111\u01b0\u1ee3c gi\u1eef trong broker.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y \u0111\u01a1n gi\u1ea3n h\u01a1n \u0111\u1ec3 v\u1eadn h\u00e0nh v\u00e0 th\u01b0\u1eddng \u0111\u1ee7 cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng theo ki\u1ec3u gi\u00e1m s\u00e1t.</p>"},{"location":"vi/user-guide/data-and-brokers/#62-lich-su-va-xu-huong","title":"6.2 L\u1ecbch s\u1eed v\u00e0 xu h\u01b0\u1edbng","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng, LegoCity c\u00f3 th\u1ec3 c\u1ea7n l\u1ecbch s\u1eed ng\u1eafn h\u1ea1n, v\u00ed d\u1ee5:</p> <ul> <li>bi\u1ec3u \u0111\u1ed3 c\u1ee7a 24 gi\u1edd g\u1ea7n \u0111\u00e2y v\u1ec1 th\u1eddi ti\u1ebft ho\u1eb7c ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed,</li> <li>s\u1ef1 ph\u00e1t tri\u1ec3n g\u1ea7n \u0111\u00e2y c\u1ee7a m\u1ee9c n\u01b0\u1edbc trong m\u1ed9t s\u1ef1 ki\u1ec7n l\u0169 l\u1ee5t.</li> </ul> <p>Hai ph\u01b0\u01a1ng ph\u00e1p c\u00f3 th\u1ec3:</p> <ul> <li>s\u1eed d\u1ee5ng c\u00e1c t\u00ednh n\u0103ng temporal c\u1ee7a broker (n\u1ebfu c\u00f3 v\u00e0 \u0111\u01b0\u1ee3c b\u1eadt) \u0111\u1ec3 l\u01b0u tr\u1eef l\u1ecbch s\u1eed thu\u1ed9c t\u00ednh,</li> <li>chuy\u1ec3n ti\u1ebfp d\u1eef li\u1ec7u sang m\u1ed9t c\u01a1 s\u1edf d\u1eef li\u1ec7u chu\u1ed7i th\u1eddi gian chuy\u00ean bi\u1ec7t trong khi ch\u1ec9 gi\u1eef c\u00e1c gi\u00e1 tr\u1ecb m\u1edbi nh\u1ea5t trong broker.</li> </ul> <p>L\u1ef1a ch\u1ecdn n\u00ean \u0111\u01b0\u1ee3c ghi l\u1ea1i cho m\u1ed7i domain:</p> <ul> <li>domain n\u00e0o ch\u1ec9 l\u01b0u tr\u1eef tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i,</li> <li>domain n\u00e0o gi\u1eef l\u1ea1i l\u1ecbch s\u1eed h\u1ea1n ch\u1ebf,</li> <li>d\u1eef li\u1ec7u ph\u00e2n t\u00edch d\u00e0i h\u1ea1n \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef \u1edf \u0111\u00e2u n\u1ebfu kh\u00f4ng c\u00f3 trong broker.</li> </ul> <p>Dashboard v\u00e0 proxy ph\u1ea3i \u0111\u01b0\u1ee3c c\u0103n ch\u1ec9nh v\u1edbi quy\u1ebft \u0111\u1ecbnh n\u00e0y \u0111\u1ec3 c\u00e1c truy v\u1ea5n th\u1ef1c t\u1ebf v\u00e0 hi\u1ec7u qu\u1ea3.</p>"},{"location":"vi/user-guide/data-and-brokers/#7-hop-ong-du-lieu-va-quy-uoc","title":"7. H\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u v\u00e0 quy \u01b0\u1edbc","text":"<p>\u0110\u1ec3 gi\u1eef l\u1edbp d\u1eef li\u1ec7u m\u1ea1ch l\u1ea1c, LegoCity d\u1ef1a v\u00e0o c\u00e1c h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u r\u00f5 r\u00e0ng gi\u1eefa c\u00e1c update server, broker v\u00e0 UI.</p> <p>C\u00e1c h\u1ee3p \u0111\u1ed3ng n\u00e0y bao g\u1ed3m:</p> <ul> <li>lo\u1ea1i entity n\u00e0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng,</li> <li>thu\u1ed9c t\u00ednh n\u00e0o ph\u1ea3i c\u00f3,</li> <li>quy \u01b0\u1edbc \u0111\u1eb7t t\u00ean n\u00e0o \u0111\u01b0\u1ee3c tu\u00e2n theo.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#71-loai-entity-va-mo-hinh","title":"7.1 Lo\u1ea1i entity v\u00e0 m\u00f4 h\u00ecnh","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i lo\u1ea1i entity \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong LegoCity, t\u00e0i li\u1ec7u n\u00ean ch\u1ec9 \u0111\u1ecbnh:</p> <ul> <li>t\u00ean c\u1ee7a lo\u1ea1i entity (v\u00ed d\u1ee5: <code>WeatherObserved</code>),</li> <li>li\u1ec7u n\u00f3 tu\u00e2n theo FIWARE Smart Data Model tr\u1ef1c ti\u1ebfp, m\u1ed9t phi\u00ean b\u1ea3n m\u1edf r\u1ed9ng, hay m\u1ed9t schema t\u00f9y ch\u1ec9nh,</li> <li>thu\u1ed9c t\u00ednh n\u00e0o l\u00e0 b\u1eaft bu\u1ed9c (ph\u1ea3i lu\u00f4n c\u00f3),</li> <li>thu\u1ed9c t\u00ednh n\u00e0o l\u00e0 t\u00f9y ch\u1ecdn v\u00e0 trong \u0111i\u1ec1u ki\u1ec7n n\u00e0o ch\u00fang xu\u1ea5t hi\u1ec7n.</li> </ul> <p>Update server ph\u1ea3i t\u00f4n tr\u1ecdng c\u00e1c \u0111\u1ecbnh ngh\u0129a n\u00e0y khi t\u1ea1o ho\u1eb7c c\u1eadp nh\u1eadt entity.</p>"},{"location":"vi/user-guide/data-and-brokers/#72-inh-danh","title":"7.2 \u0110\u1ecbnh danh","text":"<p>\u0110\u1ecbnh danh (<code>id</code>) c\u1ea7n ph\u1ea3i:</p> <ul> <li>\u1ed5n \u0111\u1ecbnh theo th\u1eddi gian cho c\u00f9ng m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng ho\u1eb7c v\u1ecb tr\u00ed trong th\u1ebf gi\u1edbi th\u1ef1c,</li> <li>\u0111\u1ee7 d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c \u0111\u1ec3 c\u00e1c h\u1ec7 th\u1ed1ng c\u00f3 th\u1ec3 tham chi\u1ebfu \u0111\u1ebfn entity b\u1eb1ng ID n\u1ebfu c\u1ea7n,</li> <li>duy nh\u1ea5t trong broker, ho\u1eb7c \u00edt nh\u1ea5t trong m\u1ed9t domain.</li> </ul> <p>T\u00e0i li\u1ec7u n\u00ean n\u00eau r\u00f5:</p> <ul> <li>c\u00e1ch x\u00e2y d\u1ef1ng ID (v\u00ed d\u1ee5: c\u00e1c m\u1eabu URN bao g\u1ed3m domain v\u00e0 v\u1ecb tr\u00ed),</li> <li>li\u1ec7u ID c\u00f3 \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb \u0111\u1ecbnh danh b\u00ean ngo\u00e0i hay \u0111\u01b0\u1ee3c t\u1ea1o n\u1ed9i b\u1ed9,</li> <li>c\u00e1ch x\u1eed l\u00fd thay \u0111\u1ed5i ID n\u1ebfu m\u1ed9t h\u1ec7 th\u1ed1ng b\u00ean ngo\u00e0i \u0111\u1ed5i t\u00ean m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#73-thuoc-tinh-khong-gian-ia-ly","title":"7.3 Thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd","text":"<p>V\u00ec LegoCity t\u1eadp trung v\u00e0o b\u1ea3n \u0111\u1ed3, c\u00e1c thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd ph\u1ea3i nh\u1ea5t qu\u00e1n:</p> <ul> <li>t\u00ean thu\u1ed9c t\u00ednh n\u00e0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng cho v\u1ecb tr\u00ed (v\u00ed d\u1ee5: lu\u00f4n lu\u00f4n l\u00e0 <code>location</code>),</li> <li>lo\u1ea1i h\u00ecnh h\u1ecdc n\u00e0o \u0111\u01b0\u1ee3c mong \u0111\u1ee3i cho m\u1ed7i lo\u1ea1i entity (\u0111i\u1ec3m, \u0111\u01b0\u1eddng, \u0111a gi\u00e1c),</li> <li>c\u00e1ch x\u1eed l\u00fd h\u1ec7 th\u1ed1ng tham chi\u1ebfu t\u1ecda \u0111\u1ed9 (th\u01b0\u1eddng l\u00e0 WGS84).</li> </ul> <p>S\u1ef1 nh\u1ea5t qu\u00e1n n\u00e0y cho ph\u00e9p:</p> <ul> <li>c\u00e1c l\u1edbp b\u1ea3n \u0111\u1ed3 chung c\u00f3 th\u1ec3 x\u1eed l\u00fd nhi\u1ec1u lo\u1ea1i entity,</li> <li>l\u1ecdc \u0111\u01a1n gi\u1ea3n theo bounding box ho\u1eb7c khu v\u1ef1c quan t\u00e2m.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#74-thuoc-tinh-thoi-gian","title":"7.4 Thu\u1ed9c t\u00ednh th\u1eddi gian","text":"<p>Th\u1eddi gian r\u1ea5t quan tr\u1ecdng \u0111\u1ed1i v\u1edbi ng\u1eef c\u1ea3nh:</p> <ul> <li>m\u1ed7i entity ki\u1ec3u quan s\u00e1t n\u00ean c\u00f3 m\u1ed9t timestamp quan s\u00e1t r\u00f5 r\u00e0ng,</li> <li>c\u00e1c entity \u0111\u1ea1i di\u1ec7n cho c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng t\u0129nh (v\u00ed d\u1ee5: m\u1ed9t c\u01a1 s\u1edf c\u00f4ng) c\u00f3 th\u1ec3 c\u00f3 timestamp t\u1ea1o ho\u1eb7c c\u1eadp nh\u1eadt l\u1ea7n cu\u1ed1i.</li> </ul> <p>T\u00e0i li\u1ec7u n\u00ean li\u1ec7t k\u00ea:</p> <ul> <li>thu\u1ed9c t\u00ednh n\u00e0o mang th\u00f4ng tin th\u1eddi gian,</li> <li>c\u00e1ch ch\u00fang \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong UI (v\u00ed d\u1ee5: \u0111\u1ec3 \u0111\u00e1nh d\u1ea5u d\u1eef li\u1ec7u c\u0169).</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#8-nhieu-nguon-cho-cung-mot-loai-entity","title":"8. Nhi\u1ec1u ngu\u1ed3n cho c\u00f9ng m\u1ed9t lo\u1ea1i entity","text":"<p>\u0110\u00f4i khi nhi\u1ec1u h\u01a1n m\u1ed9t ngu\u1ed3n b\u00ean ngo\u00e0i c\u00f3 th\u1ec3 cung c\u1ea5p d\u1eef li\u1ec7u cho c\u00f9ng m\u1ed9t lo\u1ea1i entity kh\u00e1i ni\u1ec7m. V\u00ed d\u1ee5: c\u00e1c c\u01a1 quan kh\u00e1c nhau c\u00f3 th\u1ec3 xu\u1ea5t b\u1ea3n c\u00e1c b\u1ea3n \u0111\u1ed3 l\u0169 l\u1ee5t ch\u1ed3ng ch\u00e9o m\u1ed9t ph\u1ea7n.</p> <p>Trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, LegoCity c\u1ea7n c\u00e1c quy t\u1eafc r\u00f5 r\u00e0ng \u0111\u1ec3 tr\u00e1nh nh\u1ea7m l\u1eabn:</p> <ul> <li>li\u1ec7u m\u1ed9t ngu\u1ed3n c\u00f3 \u0111\u01b0\u1ee3c coi l\u00e0 ngu\u1ed3n c\u00f3 th\u1ea9m quy\u1ec1n v\u00e0 c\u00e1c ngu\u1ed3n kh\u00e1c b\u1ecb b\u1ecf qua,</li> <li>li\u1ec7u c\u00e1c entity t\u1eeb c\u00e1c ngu\u1ed3n kh\u00e1c nhau c\u00f3 \u0111\u01b0\u1ee3c gi\u1eef ri\u00eang bi\u1ec7t b\u1eb1ng ID v\u00e0 metadata,</li> <li>li\u1ec7u m\u1ed9t d\u1ecbch v\u1ee5 t\u1ed5ng h\u1ee3p chuy\u00ean d\u1ee5ng c\u00f3 k\u1ebft h\u1ee3p d\u1eef li\u1ec7u t\u1eeb nhi\u1ec1u ngu\u1ed3n th\u00e0nh m\u1ed9t t\u1eadp entity duy nh\u1ea5t.</li> </ul> <p>N\u1ebfu nhi\u1ec1u ngu\u1ed3n \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, t\u00e0i li\u1ec7u n\u00ean ch\u1ec9 \u0111\u1ecbnh cho m\u1ed7i lo\u1ea1i entity:</p> <ul> <li>ngu\u1ed3n n\u00e0o cung c\u1ea5p lo\u1ea1i n\u00e0y,</li> <li>c\u00e1ch gi\u1ea3i quy\u1ebft xung \u0111\u1ed9t,</li> <li>thu\u1ed9c t\u00ednh n\u00e0o cho bi\u1ebft ngu\u1ed3n g\u1ed1c ho\u1eb7c ch\u1ea5t l\u01b0\u1ee3ng c\u1ee7a m\u1ed7i entity.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#9-subscription-va-luong-phan-ung","title":"9. Subscription v\u00e0 lu\u1ed3ng ph\u1ea3n \u1ee9ng","text":"<p>NGSI-LD h\u1ed7 tr\u1ee3 subscription \u0111\u1ec3 c\u00e1c d\u1ecbch v\u1ee5 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00f4ng b\u00e1o khi entity thay \u0111\u1ed5i. LegoCity c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng subscription \u0111\u1ec3 th\u00fac \u0111\u1ea9y c\u00e1c quy tr\u00ecnh backend, nh\u01b0ng kh\u00f4ng ph\u1ea3i nh\u01b0 m\u1ed9t c\u01a1 ch\u1ebf ch\u00ednh cho dashboard.</p> <p>C\u00e1c c\u00e1ch s\u1eed d\u1ee5ng c\u00f3 th\u1ec3 bao g\u1ed3m:</p> <ul> <li>m\u1ed9t d\u1ecbch v\u1ee5 c\u1eadp nh\u1eadt c\u00e1c ch\u1ec9 s\u1ed1 t\u1ed5ng h\u1ee3p khi c\u00e1c entity c\u1ea3m bi\u1ebfn thay \u0111\u1ed5i,</li> <li>m\u1ed9t th\u00e0nh ph\u1ea7n gi\u00e1m s\u00e1t c\u1ea3nh b\u00e1o khi v\u01b0\u1ee3t qua m\u1ed9t s\u1ed1 ng\u01b0\u1ee1ng nh\u1ea5t \u0111\u1ecbnh.</li> </ul> <p>N\u1ebfu subscription \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng:</p> <ul> <li>c\u00e1c th\u00e0nh ph\u1ea7n t\u1ea1o v\u00e0 qu\u1ea3n l\u00fd subscription n\u00ean \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh,</li> <li>ph\u1ea1m vi c\u1ee7a subscription (lo\u1ea1i entity n\u00e0o, \u0111i\u1ec1u ki\u1ec7n n\u00e0o) n\u00ean \u0111\u01b0\u1ee3c ghi l\u1ea1i,</li> <li>c\u00e1c chi\u1ebfn l\u01b0\u1ee3c x\u1eed l\u00fd l\u1ed7i v\u00e0 kh\u00f4i ph\u1ee5c n\u00ean \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh (\u0111i\u1ec1u g\u00ec x\u1ea3y ra khi vi\u1ec7c g\u1eedi th\u00f4ng b\u00e1o th\u1ea5t b\u1ea1i).</li> </ul> <p>Dashboard \u0111\u01b0\u1ee3c mong \u0111\u1ee3i ti\u1ebfp t\u1ee5c s\u1eed d\u1ee5ng c\u00e1c truy v\u1ea5n b\u00ecnh th\u01b0\u1eddng; b\u1ea5t k\u1ef3 logic \"push\" n\u00e0o n\u00ean \u0111\u01b0\u1ee3c trung gian b\u1edfi c\u00e1c d\u1ecbch v\u1ee5 \u1ee9ng d\u1ee5ng.</p>"},{"location":"vi/user-guide/data-and-brokers/#10-moi-quan-he-voi-dashboard-va-proxy","title":"10. M\u1ed1i quan h\u1ec7 v\u1edbi dashboard v\u00e0 proxy","text":"<p>L\u1edbp d\u1eef li\u1ec7u v\u00e0 l\u1edbp UI giao ti\u1ebfp th\u00f4ng qua m\u1ed9t giao di\u1ec7n h\u1eb9p.</p> <p>Trong m\u1ed9t thi\u1ebft l\u1eadp \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>l\u1edbp proxy expose m\u1ed9t t\u1eadp nh\u1ecf c\u00e1c endpoint HTTP \u0111\u01b0\u1ee3c t\u00f9y ch\u1ec9nh cho UI,</li> <li>c\u00e1c endpoint n\u00e0y truy v\u1ea5n broker n\u1ed9i b\u1ed9 b\u1eb1ng NGSI-LD v\u00e0 chi\u1ebfu c\u00e1c k\u1ebft qu\u1ea3 th\u00e0nh c\u00e1c c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n h\u01a1n,</li> <li>dashboard g\u1ecdi c\u00e1c endpoint n\u00e0y \u0111\u1ec3 l\u1ea5y d\u1eef li\u1ec7u c\u1ea7n thi\u1ebft cho c\u00e1c view b\u1ea3n \u0111\u1ed3 v\u00e0 kh\u1ed1i.</li> </ul> <p>H\u1ec7 qu\u1ea3:</p> <ul> <li>c\u00e1c chi ti\u1ebft n\u1ed9i b\u1ed9 c\u1ee7a broker kh\u00f4ng \u0111\u01b0\u1ee3c expose tr\u1ef1c ti\u1ebfp ra tr\u00ecnh duy\u1ec7t ho\u1eb7c client kh\u00f4ng \u0111\u00e1ng tin c\u1eady,</li> <li>c\u00e1c thay \u0111\u1ed5i trong c\u1ea5u tr\u00fac entity c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c h\u1ea5p th\u1ee5 b\u1edfi proxy m\u00e0 kh\u00f4ng ph\u00e1 v\u1ee1 ngay l\u1eadp t\u1ee9c UI,</li> <li>c\u00e1c ch\u00ednh s\u00e1ch b\u1ea3o m\u1eadt (ai c\u00f3 th\u1ec3 \u0111\u1ecdc g\u00ec) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tri\u1ec3n khai \u1edf m\u1ed9t n\u01a1i.</li> </ul> <p>Thi\u1ebft k\u1ebf c\u1ee7a c\u00e1c proxy endpoint n\u00e0y \u0111\u01b0\u1ee3c ghi l\u1ea1i trong ph\u1ea7n Development; t\u1eeb quan \u0111i\u1ec3m l\u1edbp d\u1eef li\u1ec7u, ch\u1ec9 c\u1ea7n hi\u1ec3u r\u1eb1ng:</p> <ul> <li>quy\u1ec1n truy c\u1eadp \u0111\u1ecdc \u0111\u01b0\u1ee3c t\u1eadp trung,</li> <li>quy\u1ec1n truy c\u1eadp ghi v\u1eabn v\u1edbi c\u00e1c update server,</li> <li>broker v\u1eabn l\u00e0 ngu\u1ed3n d\u1eef li\u1ec7u duy nh\u1ea5t.</li> </ul>"},{"location":"vi/user-guide/data-and-brokers/#11-tom-tat","title":"11. T\u00f3m t\u1eaft","text":"<ul> <li>Context broker l\u01b0u tr\u1eef bi\u1ec3u di\u1ec5n hi\u1ec7n t\u1ea1i c\u1ee7a th\u00e0nh ph\u1ed1 d\u01b0\u1edbi d\u1ea1ng c\u00e1c NGSI-LD entity v\u00e0 \u0111\u01b0\u1ee3c coi l\u00e0 ngu\u1ed3n d\u1eef li\u1ec7u.</li> <li>M\u1ed9t tri\u1ec3n khai ph\u1ea3i ch\u1ecdn v\u00e0 ghi l\u1ea1i c\u1ea5u tr\u00fac broker c\u1ee7a n\u00f3 (broker \u0111\u01a1n ho\u1eb7c nhi\u1ec1u broker) v\u00e0 c\u1ea5u tr\u00fac domain.</li> <li>Domain nh\u00f3m c\u00e1c lo\u1ea1i entity li\u00ean quan v\u00e0 update server; m\u1ed7i domain c\u00f3 quy\u1ec1n s\u1edf h\u1eefu v\u00e0 tr\u00e1ch nhi\u1ec7m r\u00f5 r\u00e0ng.</li> <li>Update server l\u00e0 c\u00e1c writer th\u01b0\u1eddng xuy\u00ean duy nh\u1ea5t v\u00e0o broker v\u00e0 ph\u1ea3i tu\u00e2n theo c\u00e1c h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c chia s\u1ebb cho c\u1ea5u tr\u00fac entity, \u0111\u1ecbnh danh, thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd v\u00e0 timestamp.</li> <li>C\u00e1c quy\u1ebft \u0111\u1ecbnh v\u1ec1 l\u1ecbch s\u1eed, l\u01b0u gi\u1eef v\u00e0 nhi\u1ec1u ngu\u1ed3n d\u1eef li\u1ec7u ph\u1ea3i r\u00f5 r\u00e0ng \u0111\u1ec3 dashboard v\u00e0 ph\u00e2n t\u00edch ho\u1ea1t \u0111\u1ed9ng d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c.</li> <li>Dashboard \u0111\u1ecdc t\u1eeb broker th\u00f4ng qua proxy, gi\u1eef c\u00e1c m\u1ed1i quan t\u00e2m UI \u0111\u01b0\u1ee3c t\u00e1ch bi\u1ec7t r\u00f5 r\u00e0ng kh\u1ecfi vi\u1ec7c thu th\u1eadp v\u00e0 l\u01b0u tr\u1eef d\u1eef li\u1ec7u.</li> </ul>"},{"location":"vi/user-guide/entities/","title":"Entity","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 c\u00e1ch LegoCity bi\u1ec3u di\u1ec5n th\u00f4ng tin th\u00e0nh ph\u1ed1 d\u01b0\u1edbi d\u1ea1ng NGSI-LD entity, c\u00e1ch s\u1eed d\u1ee5ng Smart Data Model v\u00e0 c\u00e1c quy \u01b0\u1edbc n\u00e0o \u00e1p d\u1ee5ng cho \u0111\u1ecbnh danh, thu\u1ed9c t\u00ednh v\u00e0 domain.</p> <p>Trang n\u00e0y d\u00e0nh cho nh\u1eefng ng\u01b0\u1eddi:</p> <ul> <li>thi\u1ebft k\u1ebf m\u00f4 h\u00ecnh d\u1eef li\u1ec7u cho tri\u1ec3n khai LegoCity,</li> <li>tri\u1ec3n khai c\u00e1c update server t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt entity,</li> <li>x\u00e2y d\u1ef1ng c\u00e1c endpoint proxy ho\u1eb7c l\u1edbp UI truy v\u1ea5n entity.</li> </ul>"},{"location":"vi/user-guide/entities/#1-vai-tro-cua-entity-trong-legocity","title":"1. Vai tr\u00f2 c\u1ee7a entity trong LegoCity","text":"<p>Trong LegoCity, h\u1ea7u h\u1ebft m\u1ecdi th\u1ee9 xu\u1ea5t hi\u1ec7n tr\u00ean b\u1ea3n \u0111\u1ed3 ho\u1eb7c trong dashboard \u0111\u1ec1u \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 b\u1edfi m\u1ed9t ho\u1eb7c nhi\u1ec1u entity.</p> <p>V\u00ed d\u1ee5:</p> <ul> <li>m\u1ed9t c\u1ea3m bi\u1ebfn \u0111o nhi\u1ec7t \u0111\u1ed9 v\u00e0 \u0111\u1ed9 \u1ea9m   \u2192 m\u1ed9t entity <code>WeatherObserved</code> cho m\u1ed7i \u0111i\u1ec3m quan s\u00e1t;</li> <li>m\u1ed9t khu v\u1ef1c d\u1ec5 b\u1ecb l\u0169 l\u1ee5t   \u2192 m\u1ed9t entity <code>FloodZone</code> v\u1edbi h\u00ecnh h\u1ecdc \u0111a gi\u00e1c;</li> <li>m\u1ed9t b\u1ec7nh vi\u1ec7n c\u00f4ng   \u2192 m\u1ed9t entity <code>HealthFacility</code> v\u1edbi c\u00e1c thu\u1ed9c t\u00ednh d\u1ecbch v\u1ee5 v\u00e0 v\u1ecb tr\u00ed \u0111i\u1ec3m;</li> <li>m\u1ed9t nh\u00e0 \u0111\u1ed7 xe   \u2192 m\u1ed9t entity <code>ParkingFacility</code> v\u1edbi s\u1ee9c ch\u1ee9a, t\u1ef7 l\u1ec7 l\u1ea5p \u0111\u1ea7y v\u00e0 tr\u1ea1ng th\u00e1i.</li> </ul> <p>C\u00e1c quy t\u1eafc l\u00e0:</p> <ul> <li>n\u1ebfu m\u1ed9t kh\u00e1i ni\u1ec7m c\u1ea7n xu\u1ea5t hi\u1ec7n trong UI ho\u1eb7c \u0111\u01b0\u1ee3c truy v\u1ea5n, n\u00f3 n\u00ean c\u00f3 m\u1ed9t lo\u1ea1i entity t\u01b0\u01a1ng \u1ee9ng,</li> <li>c\u00e1c update server t\u1ea1o v\u00e0 c\u1eadp nh\u1eadt entity theo logic domain-specific,</li> <li>broker l\u01b0u tr\u1eef c\u00e1c entity n\u00e0y v\u00e0 cung c\u1ea5p m\u1ed9t view nh\u1ea5t qu\u00e1n c\u1ee7a th\u00e0nh ph\u1ed1.</li> </ul>"},{"location":"vi/user-guide/entities/#11-cau-truc-cua-mot-entity-vi-du","title":"1.1 C\u1ea5u tr\u00fac c\u1ee7a m\u1ed9t Entity (V\u00ed d\u1ee5)","text":"<ul> <li>Tr\u01b0\u1edbc khi \u0111i v\u00e0o chi ti\u1ebft, \u0111\u00e2y l\u00e0 nh\u1eefng g\u00ec m\u1ed9t entity c\u1ee5 th\u1ec3 tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0o trong LegoCity (\u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n trong JSON-LD).</li> <li>Ch\u00fa \u00fd <code>type</code>, <code>id</code>, v\u00e0 c\u00e1ch c\u00e1c thu\u1ed9c t\u00ednh \u0111\u01b0\u1ee3c c\u1ea5u tr\u00fac v\u1edbi <code>value</code> v\u00e0 <code>unitCode</code>.</li> </ul> <pre><code>{\n  \"id\": \"urn:ngsi-ld:WeatherObserved:ctu:station:STATION_001\",\n  \"type\": \"WeatherObserved\",\n  \"@context\": \"https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\",\n  \"temperature\": {\n    \"type\": \"Property\",\n    \"value\": 30.5,\n    \"unitCode\": \"CEL\"\n  },\n  \"location\": {\n    \"type\": \"GeoProperty\",\n    \"value\": {\n      \"type\": \"Point\",\n      \"coordinates\": [105.78, 10.04]\n    }\n  },\n  \"observedAt\": {\n    \"type\": \"Property\",\n    \"value\": \"2023-11-29T10:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"vi/user-guide/entities/#2-loai-entity-va-domain","title":"2. Lo\u1ea1i entity v\u00e0 domain","text":"<p>M\u1ed9t tri\u1ec3n khai LegoCity n\u00ean duy tr\u00ec m\u1ed9t danh s\u00e1ch r\u00f5 r\u00e0ng c\u00e1c lo\u1ea1i entity \u0111ang s\u1eed d\u1ee5ng, \u0111\u01b0\u1ee3c nh\u00f3m theo domain.</p>"},{"location":"vi/user-guide/entities/#21-vi-du-cau-truc-domain","title":"2.1 V\u00ed d\u1ee5 c\u1ea5u tr\u00fac domain","text":"<p>C\u00e1c domain ch\u00ednh x\u00e1c ph\u1ee5 thu\u1ed9c v\u00e0o d\u1ef1 \u00e1n, nh\u01b0ng m\u1ed9t ph\u00e2n chia \u0111i\u1ec3n h\u00ecnh l\u00e0:</p> <ul> <li> <p>M\u00f4i tr\u01b0\u1eddng</p> </li> <li> <p><code>WeatherObserved</code> \u2013 quan s\u00e1t \u0111i\u1ec3m v\u1ec1 th\u1eddi ti\u1ebft t\u1ea1i c\u00e1c v\u1ecb tr\u00ed c\u1ee5 th\u1ec3.</p> </li> <li> <p><code>AirQualityObserved</code> \u2013 \u0111o l\u01b0\u1eddng ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed t\u1eeb c\u00e1c c\u1ea3m bi\u1ebfn c\u1ed1 \u0111\u1ecbnh ho\u1eb7c di \u0111\u1ed9ng.</p> </li> <li> <p>N\u01b0\u1edbc v\u00e0 l\u0169 l\u1ee5t</p> </li> <li> <p><code>FloodZone</code> \u2013 \u0111a gi\u00e1c \u0111\u1ea1i di\u1ec7n cho c\u00e1c khu v\u1ef1c c\u00f3 nguy c\u01a1 ho\u1eb7c hi\u1ec7n \u0111ang b\u1ecb l\u0169 l\u1ee5t.</p> </li> <li> <p><code>WaterLevel</code> \u2013 m\u1ee9c n\u01b0\u1edbc hi\u1ec7n t\u1ea1i t\u1ea1i c\u00e1c tr\u1ea1m c\u1ee5 th\u1ec3.</p> </li> <li> <p>Di chuy\u1ec3n v\u00e0 v\u1eadn t\u1ea3i</p> </li> <li> <p><code>ParkingFacility</code> \u2013 c\u1ea5u tr\u00fac \u0111\u1ed7 xe ngo\u00e0i \u0111\u01b0\u1eddng (nh\u00e0 xe, b\u00e3i \u0111\u1ed7).</p> </li> <li><code>ParkingSpot</code> \u2013 kh\u00f4ng gian \u0111\u1ed7 xe ri\u00eang l\u1ebb (t\u00f9y ch\u1ecdn, n\u1ebfu c\u1ea7n).</li> <li> <p><code>PublicTransportStop</code> \u2013 \u0111i\u1ec3m d\u1eebng xe bu\u00fdt ho\u1eb7c v\u1eadn chuy\u1ec3n v\u1edbi v\u1ecb tr\u00ed v\u00e0 tuy\u1ebfn \u0111\u01b0\u1ee3c ph\u1ee5c v\u1ee5.</p> </li> <li> <p>D\u1ecbch v\u1ee5 c\u00f4ng</p> </li> <li> <p><code>HealthFacility</code> \u2013 b\u1ec7nh vi\u1ec7n, ph\u00f2ng kh\u00e1m v\u00e0 c\u00e1c d\u1ecbch v\u1ee5 li\u00ean quan.</p> </li> <li><code>EducationalFacility</code> \u2013 tr\u01b0\u1eddng h\u1ecdc v\u00e0 tr\u01b0\u1eddng \u0111\u1ea1i h\u1ecdc.</li> <li> <p><code>PublicService</code> \u2013 d\u1ecbch v\u1ee5 c\u00f4ng h\u00e0nh ch\u00ednh ho\u1eb7c m\u1ee5c \u0111\u00edch chung.</p> </li> <li> <p>C\u01a1 s\u1edf h\u1ea1 t\u1ea7ng v\u00e0 t\u00e0i s\u1ea3n</p> </li> <li><code>ChargingStation</code> \u2013 \u0111i\u1ec3m s\u1ea1c EV.</li> <li><code>Camera</code> \u2013 camera gi\u00e1m s\u00e1t.</li> </ul> <p>V\u00ed d\u1ee5: M\u1ed9t dashboard l\u0169 l\u1ee5t c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng entity <code>FloodZone</code> v\u00e0 <code>WaterLevel</code>, trong khi m\u1ed9t dashboard di chuy\u1ec3n s\u1eed d\u1ee5ng <code>ParkingFacility</code> v\u00e0 <code>PublicTransportStop</code>. C\u1ea3 hai dashboard \u0111\u1ec1u \u0111\u1ecdc t\u1eeb c\u00f9ng m\u1ed9t broker nh\u01b0ng t\u1eadp trung v\u00e0o c\u00e1c lo\u1ea1i entity kh\u00e1c nhau.</p>"},{"location":"vi/user-guide/entities/#22-danh-muc-entity","title":"2.2 Danh m\u1ee5c entity","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i lo\u1ea1i entity trong tri\u1ec3n khai, t\u00e0i li\u1ec7u n\u00ean duy tr\u00ec m\u1ed9t m\u1ee5c danh m\u1ee5c.</p>"},{"location":"vi/user-guide/entities/#3-smart-data-model","title":"3. Smart Data Model","text":"<p>Khi c\u00f3 th\u1ec3, LegoCity n\u00ean d\u1ef1a c\u00e1c \u0111\u1ecbnh ngh\u0129a entity tr\u00ean FIWARE Smart Data Model.</p>"},{"location":"vi/user-guide/entities/#31-tai-sao-su-dung-smart-data-model","title":"3.1 T\u1ea1i sao s\u1eed d\u1ee5ng Smart Data Model","text":"<p>S\u1eed d\u1ee5ng Smart Data Model cung c\u1ea5p:</p> <ul> <li>t\u00ean thu\u1ed9c t\u00ednh nh\u1ea5t qu\u00e1n tr\u00ean c\u00e1c tri\u1ec3n khai,</li> <li>m\u1ed9t \u0111i\u1ec3m kh\u1edfi \u0111\u1ea7u r\u00f5 r\u00e0ng cho c\u00e1c domain m\u1edbi,</li> <li>d\u1ec5 d\u00e0ng t\u00e1i s\u1eed d\u1ee5ng c\u00e1c v\u00ed d\u1ee5 v\u00e0 c\u00f4ng c\u1ee5 c\u1ed9ng \u0111\u1ed3ng,</li> <li>\u00edt m\u01a1 h\u1ed3 h\u01a1n khi nhi\u1ec1u nh\u00f3m l\u00e0m vi\u1ec7c tr\u00ean c\u00f9ng m\u1ed9t domain.</li> </ul>"},{"location":"vi/user-guide/entities/#32-chien-luoc-ap-dung","title":"3.2 Chi\u1ebfn l\u01b0\u1ee3c \u00e1p d\u1ee5ng","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i lo\u1ea1i entity, quy\u1ebft \u0111\u1ecbnh m\u1ed9t trong nh\u1eefng \u0111i\u1ec1u sau:</p> <ul> <li> <p>\u00c1p d\u1ee5ng tr\u1ef1c ti\u1ebfp   S\u1eed d\u1ee5ng Smart Data Model nh\u01b0 \u0111\u00e3 \u0111\u1ecbnh ngh\u0129a.   V\u00ed d\u1ee5: s\u1eed d\u1ee5ng <code>WeatherObserved</code> ch\u00ednh x\u00e1c nh\u01b0 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong t\u00e0i li\u1ec7u Smart Data Model.</p> </li> <li> <p>\u00c1p d\u1ee5ng v\u1edbi m\u1edf r\u1ed9ng   S\u1eed d\u1ee5ng Smart Data Model l\u00e0m c\u01a1 s\u1edf, nh\u01b0ng th\u00eam c\u00e1c thu\u1ed9c t\u00ednh specific cho d\u1ef1 \u00e1n.   V\u00ed d\u1ee5:</p> </li> <li> <p><code>WeatherObserved</code> v\u1edbi m\u1ed9t thu\u1ed9c t\u00ednh b\u1ed5 sung <code>localAlertCode</code> ch\u1ec9 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong th\u00e0nh ph\u1ed1 n\u00e0y.</p> </li> <li> <p>M\u00f4 h\u00ecnh t\u00f9y ch\u1ec9nh   \u0110\u1ecbnh ngh\u0129a m\u1ed9t lo\u1ea1i entity specific cho d\u1ef1 \u00e1n khi kh\u00f4ng c\u00f3 Smart Data Model ph\u00f9 h\u1ee3p n\u00e0o t\u1ed3n t\u1ea1i.   V\u00ed d\u1ee5:</p> </li> <li><code>FloodZone</code> \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a xung quanh m\u1ed9t b\u1ea3n \u0111\u1ed3 r\u1ee7i ro l\u0169 l\u1ee5t t\u00f9y ch\u1ec9nh c\u00f3 c\u00e1c thu\u1ed9c t\u00ednh <code>riskLevel</code>, <code>sourceDataset</code>, <code>validUntil</code>.</li> </ul> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i lo\u1ea1i, danh m\u1ee5c entity n\u00ean n\u00eau r\u00f5 chi\u1ebfn l\u01b0\u1ee3c n\u00e0o \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn.</p>"},{"location":"vi/user-guide/entities/#33-json-ld-context-context","title":"3.3 JSON-LD Context (<code>@context</code>)","text":"<p>Trong NGSI-LD, m\u1ecdi entity ph\u1ea3i bao g\u1ed3m (ho\u1eb7c li\u00ean k\u1ebft \u0111\u1ebfn) m\u1ed9t <code>@context</code>. \u0110i\u1ec1u n\u00e0y cho h\u1ec7 th\u1ed1ng bi\u1ebft c\u00e1ch di\u1ec5n gi\u1ea3i t\u00ean thu\u1ed9c t\u00ednh (v\u00ed d\u1ee5: <code>temperature</code> tham chi\u1ebfu \u0111\u1ebfn m\u1ed9t \u0111\u1ecbnh ngh\u0129a c\u1ee5 th\u1ec3 trong t\u1eeb \u0111i\u1ec3n Smart Data Model).</p> <p>Trong LegoCity:</p> <ul> <li>Update server ph\u1ea3i n\u1ed1i th\u00eam URL <code>@context</code> ch\u00ednh x\u00e1c khi g\u1eedi d\u1eef li\u1ec7u.</li> <li>Proxy v\u00e0 dashboard th\u01b0\u1eddng l\u00e0m vi\u1ec7c v\u1edbi d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng ho\u1eb7c m\u1ed9t context m\u1eb7c \u0111\u1ecbnh.</li> </ul>"},{"location":"vi/user-guide/entities/#4-inh-danh-id","title":"4. \u0110\u1ecbnh danh (<code>id</code>)","text":"<p>\u0110\u1ecbnh danh entity ph\u1ea3i l\u00e0:</p> <ul> <li>duy nh\u1ea5t trong broker (ho\u1eb7c \u00edt nh\u1ea5t trong domain li\u00ean quan),</li> <li>\u1ed5n \u0111\u1ecbnh trong su\u1ed1t v\u00f2ng \u0111\u1eddi c\u1ee7a entity,</li> <li>\u0111\u1ee7 d\u1ef1 \u0111o\u00e1n \u0111\u1ec3 h\u1ed7 tr\u1ee3 li\u00ean k\u1ebft gi\u1eefa c\u00e1c h\u1ec7 th\u1ed1ng.</li> </ul>"},{"location":"vi/user-guide/entities/#41-cac-mau-inh-danh","title":"4.1 C\u00e1c m\u1eabu \u0111\u1ecbnh danh","text":"<p>M\u1ed9t tri\u1ec3n khai LegoCity n\u00ean ch\u1ecdn m\u1ed9t m\u1eabu v\u00e0 ghi l\u1ea1i n\u00f3.</p> <p>V\u00ed d\u1ee5 m\u1eabu:</p> <ul> <li> <p>\u0110\u1ed1i v\u1edbi t\u00e0i s\u1ea3n t\u0129nh (c\u01a1 s\u1edf \u0111\u1ed7 xe, b\u1ec7nh vi\u1ec7n):   <code>urn:ngsi-ld:ParkingFacility:ctu:parking:CTU_PARK_A</code> <code>urn:ngsi-ld:HealthFacility:ctu:hospital:CTU_HOSP_01</code></p> </li> <li> <p>\u0110\u1ed1i v\u1edbi entity quan s\u00e1t trong \u0111\u00f3 m\u1ed9t entity \u0111\u1ea1i di\u1ec7n cho m\u1ed9t chu\u1ed7i th\u1eddi gian t\u1ea1i m\u1ed9t v\u1ecb tr\u00ed:   <code>urn:ngsi-ld:WeatherObserved:ctu:station:STATION_001</code>   (thu\u1ed9c t\u00ednh \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt theo th\u1eddi gian, kh\u00f4ng c\u00f3 timestamp trong ID)</p> </li> <li> <p>\u0110\u1ed1i v\u1edbi entity quan s\u00e1t trong \u0111\u00f3 m\u1ed7i entity \u0111\u1ea1i di\u1ec7n cho m\u1ed9t \u0111i\u1ec3m duy nh\u1ea5t trong th\u1eddi gian:   <code>urn:ngsi-ld:WeatherObserved:ctu:station:STATION_001:2025-11-29T10:00:00Z</code></p> </li> </ul> <p>S\u1ef1 l\u1ef1a ch\u1ecdn gi\u1eefa hai m\u1eabu cu\u1ed1i c\u00f9ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn:</p> <ul> <li>li\u1ec7u b\u1ea1n ch\u1ec9 gi\u1eef tr\u1ea1ng th\u00e1i m\u1edbi nh\u1ea5t trong broker, hay</li> <li>li\u1ec7u b\u1ea1n mu\u1ed1n nhi\u1ec1u entity theo th\u1eddi gian cho c\u00e1c truy v\u1ea5n temporal.</li> </ul>"},{"location":"vi/user-guide/entities/#42-vong-oi-id","title":"4.2 V\u00f2ng \u0111\u1eddi ID","text":"<p>T\u00e0i li\u1ec7u n\u00ean l\u00e0m r\u00f5 cho m\u1ed7i lo\u1ea1i:</p> <ul> <li>li\u1ec7u ID c\u00f3 v\u0129nh vi\u1ec5n (kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c t\u00e1i s\u1eed d\u1ee5ng) hay c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c g\u00e1n l\u1ea1i,</li> <li>c\u00e1ch x\u1eed l\u00fd vi\u1ec7c x\u00f3a.</li> </ul> <p>V\u00ed d\u1ee5:</p> <ul> <li>Entity <code>ParkingFacility</code>: ID l\u00e0 v\u0129nh vi\u1ec5n. N\u1ebfu m\u1ed9t c\u01a1 s\u1edf \u0111\u00f3ng c\u1eeda, m\u1ed9t thu\u1ed9c t\u00ednh <code>status</code> thay \u0111\u1ed5i th\u00e0nh <code>closed</code> thay v\u00ec x\u00f3a entity.</li> <li><code>WeatherObserved</code> (m\u00f4 h\u00ecnh ch\u1ec9 m\u1edbi nh\u1ea5t): entity t\u1ed3n t\u1ea1i, thu\u1ed9c t\u00ednh \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt; c\u00e1c gi\u00e1 tr\u1ecb c\u0169 kh\u00f4ng \u0111\u01b0\u1ee3c x\u1eed l\u00fd ri\u00eang bi\u1ec7t.</li> </ul>"},{"location":"vi/user-guide/entities/#5-thuoc-tinh-khong-gian-ia-ly","title":"5. Thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd","text":"<p>V\u00ec LegoCity t\u1eadp trung v\u00e0o b\u1ea3n \u0111\u1ed3, c\u00e1c thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd ph\u1ea3i \u0111\u01b0\u1ee3c x\u1eed l\u00fd nh\u1ea5t qu\u00e1n.</p>"},{"location":"vi/user-guide/entities/#51-cac-quy-uoc-pho-bien","title":"5.1 C\u00e1c quy \u01b0\u1edbc ph\u1ed5 bi\u1ebfn","text":"<p>M\u1ed9t quy \u01b0\u1edbc \u0111i\u1ec3n h\u00ecnh l\u00e0:</p> <ul> <li>s\u1eed d\u1ee5ng <code>location</code> l\u00e0m thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd ch\u00ednh,</li> <li>bi\u1ec3u di\u1ec5n:</li> <li>c\u1ea3m bi\u1ebfn v\u00e0 c\u01a1 s\u1edf nh\u01b0 Point,</li> <li>c\u00e1c v\u00f9ng (l\u0169 l\u1ee5t, h\u00e0nh ch\u00ednh) nh\u01b0 Polygon.</li> </ul> <p>V\u00ed d\u1ee5:</p> <ul> <li><code>WeatherObserved.location</code> \u2192 Point t\u1ea1i t\u1ecda \u0111\u1ed9 c\u1ea3m bi\u1ebfn.</li> <li><code>ParkingFacility.location</code> \u2192 Point t\u1ea1i l\u1ed1i v\u00e0o ho\u1eb7c trung t\u00e2m.</li> <li><code>FloodZone.location</code> \u2192 Polygon \u0111\u1ea1i di\u1ec7n cho khu v\u1ef1c c\u00f3 nguy c\u01a1.</li> </ul> <p>T\u1ea5t c\u1ea3 c\u00e1c t\u1ecda \u0111\u1ed9 n\u00ean s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t h\u1ec7 th\u1ed1ng tham chi\u1ebfu t\u1ecda \u0111\u1ed9, th\u01b0\u1eddng l\u00e0 WGS84 (<code>[longitude, latitude]</code>).</p>"},{"location":"vi/user-guide/entities/#52-ky-vong-khong-gian-ia-ly-cho-moi-loai","title":"5.2 K\u1ef3 v\u1ecdng kh\u00f4ng gian \u0111\u1ecba l\u00fd cho m\u1ed7i lo\u1ea1i","text":"<p>\u0110\u1ed1i v\u1edbi m\u1ed7i lo\u1ea1i entity, danh m\u1ee5c entity n\u00ean ch\u1ec9 \u0111\u1ecbnh:</p> <ul> <li>li\u1ec7u <code>location</code> c\u00f3 b\u1eaft bu\u1ed9c kh\u00f4ng,</li> <li>lo\u1ea1i h\u00ecnh h\u1ecdc n\u00e0o h\u1ee3p l\u1ec7.</li> </ul> <p>V\u00ed d\u1ee5:</p> <ul> <li><code>WeatherObserved</code> \u2013 <code>location</code> b\u1eaft bu\u1ed9c, lo\u1ea1i h\u00ecnh h\u1ecdc: Point.</li> <li><code>FloodZone</code> \u2013 <code>location</code> b\u1eaft bu\u1ed9c, lo\u1ea1i h\u00ecnh h\u1ecdc: Polygon.</li> <li><code>PublicTransportStop</code> \u2013 <code>location</code> b\u1eaft bu\u1ed9c, lo\u1ea1i h\u00ecnh h\u1ecdc: Point.</li> <li><code>PublicService</code> \u2013 <code>location</code> b\u1eaft bu\u1ed9c, lo\u1ea1i h\u00ecnh h\u1ecdc: Point; c\u0169ng c\u00f3 th\u1ec3 bao g\u1ed3m m\u1ed9t \u0111\u1ecba ch\u1ec9 nh\u01b0 m\u1ed9t thu\u1ed9c t\u00ednh ri\u00eang bi\u1ec7t.</li> </ul>"},{"location":"vi/user-guide/entities/#6-thuoc-tinh-thoi-gian","title":"6. Thu\u1ed9c t\u00ednh th\u1eddi gian","text":"<p>Thu\u1ed9c t\u00ednh th\u1eddi gian cho bi\u1ebft khi n\u00e0o d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c quan s\u00e1t ho\u1eb7c c\u1eadp nh\u1eadt l\u1ea7n cu\u1ed1i.</p>"},{"location":"vi/user-guide/entities/#61-timestamp-quan-sat-vs-he-thong","title":"6.1 Timestamp quan s\u00e1t vs h\u1ec7 th\u1ed1ng","text":"<p>V\u00ed d\u1ee5:</p> <ul> <li> <p><code>WeatherObserved</code>:</p> </li> <li> <p><code>observedAt</code> \u2013 khi \u0111o l\u01b0\u1eddng \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n t\u1ea1i tr\u1ea1m,</p> </li> <li> <p><code>lastUpdate</code> \u2013 khi update server ghi entity n\u00e0y l\u1ea7n cu\u1ed1i (t\u00f9y ch\u1ecdn).</p> </li> <li> <p><code>WaterLevel</code>:</p> </li> <li> <p><code>observedAt</code> \u2013 th\u1eddi gian c\u1ee7a b\u00e0i \u0111\u1ecdc m\u1ee9c n\u01b0\u1edbc.</p> </li> <li> <p><code>FloodZone</code>:</p> </li> <li><code>validFrom</code> v\u00e0 <code>validTo</code> \u2013 kho\u1ea3ng th\u1eddi gian m\u00e0 b\u1ea3n \u0111\u1ed3 l\u0169 l\u1ee5t h\u1ee3p l\u1ec7, ho\u1eb7c</li> <li><code>lastAssessment</code> \u2013 khi v\u00f9ng \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 l\u1ea7n cu\u1ed1i.</li> </ul> <p>\u0110\u1ed1i v\u1edbi entity t\u0129nh (v\u00ed d\u1ee5: <code>HealthFacility</code>):</p> <ul> <li><code>createdAt</code> \u2013 khi entity \u0111\u01b0\u1ee3c t\u1ea1o trong h\u1ec7 th\u1ed1ng,</li> <li><code>modifiedAt</code> \u2013 khi c\u00e1c thu\u1ed9c t\u00ednh ch\u00ednh \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt l\u1ea7n cu\u1ed1i.</li> </ul>"},{"location":"vi/user-guide/entities/#62-su-dung-trong-legocity","title":"6.2 S\u1eed d\u1ee5ng trong LegoCity","text":"<p>T\u00e0i li\u1ec7u n\u00ean ch\u1ec9 \u0111\u1ecbnh, cho m\u1ed7i lo\u1ea1i entity:</p> <ul> <li>thu\u1ed9c t\u00ednh th\u1eddi gian n\u00e0o m\u00e0 UI s\u1eed d\u1ee5ng \u0111\u1ec3 quy\u1ebft \u0111\u1ecbnh li\u1ec7u d\u1eef li\u1ec7u c\u00f3 \"t\u01b0\u01a1i\" kh\u00f4ng,</li> <li>li\u1ec7u c\u00e1c m\u1ee5c c\u0169 h\u01a1n m\u1ed9t ng\u01b0\u1ee1ng nh\u1ea5t \u0111\u1ecbnh c\u00f3 n\u00ean \u0111\u01b0\u1ee3c l\u00e0m n\u1ed5i b\u1eadt ho\u1eb7c \u1ea9n.</li> </ul> <p>V\u00ed d\u1ee5:</p> <ul> <li>\u0110\u1ed1i v\u1edbi <code>WeatherObserved</code>, n\u1ebfu <code>observedAt</code> c\u0169 h\u01a1n 3 gi\u1edd, UI c\u00f3 th\u1ec3:</li> <li>hi\u1ec3n th\u1ecb m\u1ed9t bi\u1ec3u t\u01b0\u1ee3ng c\u1ea3nh b\u00e1o, ho\u1eb7c</li> <li>l\u00e0m nh\u1ea1t d\u1ea5u hi\u1ec7u tr\u00ean b\u1ea3n \u0111\u1ed3.</li> </ul>"},{"location":"vi/user-guide/entities/#7-thuoc-tinh-cot-loi-va-chat-luong","title":"7. Thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i v\u00e0 ch\u1ea5t l\u01b0\u1ee3ng","text":"<p>Ngo\u00e0i ID, v\u1ecb tr\u00ed v\u00e0 th\u1eddi gian, m\u1ed7i lo\u1ea1i entity c\u00f3 c\u00e1c thu\u1ed9c t\u00ednh specific cho domain.</p>"},{"location":"vi/user-guide/entities/#71-thuoc-tinh-cot-loi","title":"7.1 Thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i","text":"<p>M\u1ed7i lo\u1ea1i entity n\u00ean c\u00f3 m\u1ed9t t\u1eadp nh\u1ecf c\u00e1c thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i m\u00e0:</p> <ul> <li>\u0111\u01b0\u1ee3c y\u00eau c\u1ea7u \u0111\u1ec3 hi\u1ec3n th\u1ecb c\u00f3 \u00fd ngh\u0129a,</li> <li>\u0111\u01b0\u1ee3c mong \u0111\u1ee3i trong ho\u1ea1t \u0111\u1ed9ng b\u00ecnh th\u01b0\u1eddng,</li> <li>\u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1ea1o ki\u1ec3u v\u00e0 l\u1ecdc.</li> </ul> <p>V\u00ed d\u1ee5:</p> <ul> <li> <p><code>WeatherObserved</code> (M\u00f4i tr\u01b0\u1eddng):</p> </li> <li> <p><code>temperature</code>, <code>relativeHumidity</code>, <code>pressure</code>, <code>observedAt</code>, <code>location</code>.</p> </li> <li> <p><code>FloodZone</code> (N\u01b0\u1edbc &amp; l\u0169 l\u1ee5t):</p> </li> <li> <p><code>riskLevel</code> (v\u00ed d\u1ee5: th\u1ea5p / trung b\u00ecnh / cao),</p> </li> <li><code>status</code> (v\u00ed d\u1ee5: active / inactive),</li> <li> <p><code>location</code> (Polygon).</p> </li> <li> <p><code>ParkingFacility</code> (Di chuy\u1ec3n):</p> </li> <li><code>totalCapacity</code>,</li> <li><code>currentOccupancy</code>,</li> <li><code>status</code> (m\u1edf / \u0111\u00f3ng),</li> <li><code>location</code>.</li> </ul> <p>Danh m\u1ee5c entity n\u00ean li\u1ec7t k\u00ea c\u00e1c thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i n\u00e0y m\u1ed9t c\u00e1ch r\u00f5 r\u00e0ng.</p>"},{"location":"vi/user-guide/entities/#72-chat-luong-du-lieu-va-trang-thai","title":"7.2 Ch\u1ea5t l\u01b0\u1ee3ng d\u1eef li\u1ec7u v\u00e0 tr\u1ea1ng th\u00e1i","text":"<p>M\u1ed9t s\u1ed1 domain y\u00eau c\u1ea7u c\u00e1c ch\u1ec9 s\u1ed1 ch\u1ea5t l\u01b0\u1ee3ng.</p> <p>V\u00ed d\u1ee5:</p> <ul> <li> <p><code>WeatherObserved</code>:</p> </li> <li> <p><code>qualityIndex</code> ho\u1eb7c c\u1edd <code>validity</code> cho c\u00e1c b\u00e0i \u0111\u1ecdc c\u1ea3m bi\u1ebfn.</p> </li> <li> <p><code>AirQualityObserved</code>:</p> </li> <li> <p><code>aqi</code> (ch\u1ec9 s\u1ed1 ch\u1ea5t l\u01b0\u1ee3ng kh\u00f4ng kh\u00ed),</p> </li> <li><code>source</code> (t\u00ean nh\u00e0 cung c\u1ea5p),</li> <li> <p><code>confidence</code> (t\u00f9y ch\u1ecdn).</p> </li> <li> <p><code>FloodZone</code>:</p> </li> <li><code>sourceDataset</code>,</li> <li><code>confidenceLevel</code>.</li> </ul> <p>C\u00e1c thu\u1ed9c t\u00ednh n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3:</p> <ul> <li>l\u1ecdc ra d\u1eef li\u1ec7u ch\u1ea5t l\u01b0\u1ee3ng th\u1ea5p trong proxy ho\u1eb7c UI,</li> <li>hi\u1ec3n th\u1ecb c\u1ea3nh b\u00e1o ho\u1eb7c ch\u1ec9 s\u1ed1 \u0111\u1ed9 tin c\u1eady cho ng\u01b0\u1eddi d\u00f9ng.</li> </ul>"},{"location":"vi/user-guide/entities/#8-moi-quan-he-giua-cac-entity","title":"8. M\u1ed1i quan h\u1ec7 gi\u1eefa c\u00e1c entity","text":"<p>C\u00e1c m\u1ed1i quan h\u1ec7 NGSI-LD li\u00ean k\u1ebft r\u00f5 r\u00e0ng c\u00e1c entity.</p>"},{"location":"vi/user-guide/entities/#81-vi-du-ve-moi-quan-he","title":"8.1 V\u00ed d\u1ee5 v\u1ec1 m\u1ed1i quan h\u1ec7","text":"<p>C\u00e1c m\u1eabu m\u1ed1i quan h\u1ec7 ph\u1ed5 bi\u1ebfn trong b\u1ed1i c\u1ea3nh th\u00e0nh ph\u1ed1 th\u00f4ng minh:</p> <ul> <li> <p><code>ParkingSpot</code> \u2192 <code>ParkingFacility</code>   M\u1ed1i quan h\u1ec7: <code>belongsToFacility</code> (ch\u1ed7 thu\u1ed9c v\u1ec1 c\u01a1 s\u1edf).</p> </li> <li> <p><code>PublicService</code> \u2192 <code>FloodZone</code>   M\u1ed1i quan h\u1ec7: <code>locatedWithin</code> (d\u1ecbch v\u1ee5 n\u1eb1m trong v\u00f9ng l\u0169 l\u1ee5t).</p> </li> <li> <p><code>WeatherObserved</code> \u2192 <code>WeatherStation</code> (n\u1ebfu c\u00e1c tr\u1ea1m \u0111\u01b0\u1ee3c m\u00f4 h\u00ecnh h\u00f3a nh\u01b0 c\u00e1c entity ri\u00eang bi\u1ec7t).</p> </li> </ul> <p>C\u00e1c m\u1ed1i quan h\u1ec7 n\u00e0y cho ph\u00e9p:</p> <ul> <li>truy v\u1ea5n t\u1ea5t c\u1ea3 c\u00e1c ch\u1ed7 \u0111\u1ed7 xe cho m\u1ed9t c\u01a1 s\u1edf nh\u1ea5t \u0111\u1ecbnh,</li> <li>t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch v\u1ee5 c\u00f4ng hi\u1ec7n \u0111ang trong v\u00f9ng l\u0169 l\u1ee5t r\u1ee7i ro cao,</li> <li>li\u00ean k\u1ebft c\u00e1c quan s\u00e1t v\u1edbi c\u00e1c tr\u1ea1m v\u1eadt l\u00fd c\u1ee7a ch\u00fang.</li> </ul>"},{"location":"vi/user-guide/entities/#82-huong-dan-thiet-ke","title":"8.2 H\u01b0\u1edbng d\u1eabn thi\u1ebft k\u1ebf","text":"<p>Khi quy\u1ebft \u0111\u1ecbnh xem c\u00f3 n\u00ean s\u1eed d\u1ee5ng m\u1ed9t m\u1ed1i quan h\u1ec7 hay ch\u1ec9 sao ch\u00e9p th\u00f4ng tin:</p> <ul> <li> <p>s\u1eed d\u1ee5ng m\u1ed1i quan h\u1ec7 khi:</p> </li> <li> <p>nhi\u1ec1u entity tham chi\u1ebfu \u0111\u1ebfn c\u00f9ng m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng (v\u00ed d\u1ee5: nhi\u1ec1u <code>ParkingSpot</code> \u0111\u1ebfn m\u1ed9t <code>ParkingFacility</code>),</p> </li> <li> <p>b\u1ea1n c\u1ea7n gi\u1eef c\u00e1c thu\u1ed9c t\u00ednh c\u1ee7a \u0111\u1ed1i t\u01b0\u1ee3ng trung t\u00e2m \u1edf m\u1ed9t n\u01a1i (v\u00ed d\u1ee5: t\u00ean c\u01a1 s\u1edf, \u0111\u1ecba ch\u1ec9).</p> </li> <li> <p>s\u1eed d\u1ee5ng thu\u1ed9c t\u00ednh tr\u00f9ng l\u1eb7p khi:</p> </li> <li>li\u00ean k\u1ebft kh\u00f4ng b\u1eaft bu\u1ed9c,</li> <li>ho\u1eb7c khi s\u1ef1 \u0111\u01a1n gi\u1ea3n quan tr\u1ecdng h\u01a1n chu\u1ea9n h\u00f3a.</li> </ul> <p>\u0110\u1ed1i v\u1edbi m\u1ed7i m\u1ed1i quan h\u1ec7 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, t\u00e0i li\u1ec7u n\u00ean ch\u1ec9 \u0111\u1ecbnh:</p> <ul> <li>lo\u1ea1i ngu\u1ed3n,</li> <li>lo\u1ea1i \u0111\u00edch,</li> <li>t\u00ean thu\u1ed9c t\u00ednh cho m\u1ed1i quan h\u1ec7,</li> <li>cardinality (m\u1ed9t-m\u1ed9t, m\u1ed9t-nhi\u1ec1u).</li> </ul>"},{"location":"vi/user-guide/entities/#83-chi-tiet-trien-khai","title":"8.3 Chi ti\u1ebft tri\u1ec3n khai","text":"<p>V\u1ec1 m\u1eb7t k\u1ef9 thu\u1eadt, m\u1ed9t m\u1ed1i quan h\u1ec7 trong NGSI-LD kh\u00e1c v\u1edbi m\u1ed9t thu\u1ed9c t\u00ednh th\u00f4ng th\u01b0\u1eddng. N\u00f3 ph\u1ea3i s\u1eed d\u1ee5ng <code>\"type\": \"Relationship\"</code> v\u00e0 l\u01b0u tr\u1eef ID \u0111\u00edch trong <code>\"object\"</code> (kh\u00f4ng ph\u1ea3i <code>\"value\"</code>).</p> <p>V\u00ed d\u1ee5 v\u1ec1 m\u1ed9t Ch\u1ed7 \u0111\u1ed7 xe \u0111\u01b0\u1ee3c li\u00ean k\u1ebft v\u1edbi m\u1ed9t C\u01a1 s\u1edf:</p> <pre><code>\"refParkingFacility\": {\n  \"type\": \"Relationship\",\n  \"object\": \"urn:ngsi-ld:ParkingFacility:ctu:parking:CTU_PARK_A\"\n}\n</code></pre>"},{"location":"vi/user-guide/entities/#9-thiet-ke-cac-loai-entity-moi","title":"9. Thi\u1ebft k\u1ebf c\u00e1c lo\u1ea1i entity m\u1edbi","text":"<p>Khi c\u00e1c y\u00eau c\u1ea7u m\u1edbi xu\u1ea5t hi\u1ec7n, c\u00e1c lo\u1ea1i entity b\u1ed5 sung c\u00f3 th\u1ec3 c\u1ea7n thi\u1ebft. M\u1ed9t quy tr\u00ecnh nh\u1ea5t qu\u00e1n n\u00ean \u0111\u01b0\u1ee3c tu\u00e2n theo.</p>"},{"location":"vi/user-guide/entities/#91-quy-trinh-tung-buoc","title":"9.1 Quy tr\u00ecnh t\u1eebng b\u01b0\u1edbc","text":"<ol> <li>L\u00e0m r\u00f5 tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng</li> </ol> <p>V\u00ed d\u1ee5:    \"Ch\u00fang ta c\u1ea7n hi\u1ec3n th\u1ecb \u0111\u00f3ng \u0111\u01b0\u1eddng t\u1ea1m th\u1eddi do x\u00e2y d\u1ef1ng.\"</p> <ol> <li> <p>Ki\u1ec3m tra c\u00e1c m\u00f4 h\u00ecnh hi\u1ec7n c\u00f3</p> </li> <li> <p>Xem li\u1ec7u Smart Data Model \u0111\u00e3 c\u00f3 lo\u1ea1i entity cho \u0111i\u1ec1u n\u00e0y ch\u01b0a (v\u00ed d\u1ee5: c\u00e1c \u0111o\u1ea1n \u0111\u01b0\u1eddng, s\u1ef1 ki\u1ec7n).</p> </li> <li> <p>N\u1ebfu c\u00f3, \u0111i\u1ec1u ch\u1ec9nh ho\u1eb7c m\u1edf r\u1ed9ng n\u00f3.</p> </li> <li> <p>\u0110\u1ecbnh ngh\u0129a c\u00e1c thu\u1ed9c t\u00ednh c\u01a1 b\u1ea3n</p> </li> <li> <p>Ch\u1ecdn m\u1ed9t t\u00ean lo\u1ea1i, v\u00ed d\u1ee5: <code>RoadClosure</code>.</p> </li> <li>Quy\u1ebft \u0111\u1ecbnh li\u1ec7u n\u00f3 l\u00e0 t\u0129nh (m\u1ed9t entity cho m\u1ed7i \u0111o\u1ea1n \u0111\u01b0\u1eddng) hay d\u1ef1a tr\u00ean s\u1ef1 ki\u1ec7n (m\u1ed9t entity cho m\u1ed7i s\u1ef1 ki\u1ec7n \u0111\u00f3ng c\u1eeda).</li> <li> <p>Quy\u1ebft \u0111\u1ecbnh thu\u1ed9c t\u00ednh n\u00e0o l\u00e0 b\u1eaft bu\u1ed9c:</p> <ul> <li><code>location</code> (\u0111\u01b0\u1eddng ho\u1eb7c \u0111a gi\u00e1c),</li> <li><code>reason</code>,</li> <li><code>startTime</code>, <code>endTime</code>,</li> <li><code>affectedTransportModes</code>.</li> </ul> </li> <li> <p>Ch\u1ecdn m\u1ed9t m\u1eabu ID</p> </li> <li> <p>V\u00ed d\u1ee5: <code>urn:ngsi-ld:RoadClosure:ctu:RC_2025_0001</code>.</p> </li> <li> <p>Ghi l\u1ea1i lo\u1ea1i</p> </li> <li> <p>Th\u00eam n\u00f3 v\u00e0o danh m\u1ee5c entity v\u1edbi domain \"Di chuy\u1ec3n\",</p> </li> <li>Ch\u1ec9 \u0111\u1ecbnh update server n\u00e0o s\u1ebd qu\u1ea3n l\u00fd n\u00f3,</li> <li> <p>M\u00f4 t\u1ea3 ng\u1eef ngh\u0129a thu\u1ed9c t\u00ednh m\u1ed9t c\u00e1ch ng\u1eafn g\u1ecdn.</p> </li> <li> <p>Tri\u1ec3n khai v\u00e0 ki\u1ec3m tra</p> </li> <li> <p>Update server t\u1ea1o m\u1ed9t s\u1ed1 l\u01b0\u1ee3ng nh\u1ecf entity trong m\u00f4i tr\u01b0\u1eddng ki\u1ec3m tra,</p> </li> <li>Nh\u00f3m dashboard ki\u1ec3m tra r\u1eb1ng d\u1eef li\u1ec7u xu\u1ea5t hi\u1ec7n ch\u00ednh x\u00e1c v\u00e0 c\u00e1c thu\u1ed9c t\u00ednh \u0111\u1ee7.</li> </ol>"},{"location":"vi/user-guide/entities/#92-vi-du-inh-nghia-entity-kieu-tom-tat","title":"9.2 V\u00ed d\u1ee5 \u0111\u1ecbnh ngh\u0129a entity (ki\u1ec3u t\u00f3m t\u1eaft)","text":"<p>\u0110\u1ed1i v\u1edbi t\u00e0i li\u1ec7u, m\u1ed9t b\u1ea3n t\u00f3m t\u1eaft ng\u1eafn g\u1ecdn cho m\u1ed7i lo\u1ea1i entity th\u01b0\u1eddng \u0111\u1ee7:</p> <p>Entity: ParkingFacility Domain: Di chuy\u1ec3n M\u00f4 h\u00ecnh: FIWARE Smart Data Model (m\u1edf r\u1ed9ng v\u1edbi <code>localCode</code>) M\u1eabu ID: <code>urn:ngsi-ld:ParkingFacility:&lt;city&gt;:&lt;facilityCode&gt;</code> H\u00ecnh h\u1ecdc: <code>location</code> (Point) Thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i:</p> <ul> <li><code>name</code></li> <li><code>totalCapacity</code></li> <li><code>currentOccupancy</code></li> <li><code>status</code> (m\u1edf / \u0111\u00f3ng)</li> <li><code>localCode</code> (\u0111\u1ecbnh danh n\u1ed9i b\u1ed9)</li> </ul> <p>M\u1ee9c \u0111\u1ed9 chi ti\u1ebft n\u00e0y th\u01b0\u1eddng \u0111\u1ee7 cho c\u00e1c nh\u00e0 ph\u00e1t tri\u1ec3n v\u00e0 ng\u01b0\u1eddi t\u00edch h\u1ee3p.</p>"},{"location":"vi/user-guide/entities/#10-trach-nhiem-tai-lieu","title":"10. Tr\u00e1ch nhi\u1ec7m t\u00e0i li\u1ec7u","text":"<p>C\u00e1c \u0111\u1ecbnh ngh\u0129a entity l\u00e0 c\u00e1c h\u1ee3p \u0111\u1ed3ng \u0111\u01b0\u1ee3c chia s\u1ebb gi\u1eefa:</p> <ul> <li>c\u00e1c nh\u00f3m t\u00edch h\u1ee3p (update server),</li> <li>c\u00e1c nh\u00f3m backend (proxy v\u00e0 API),</li> <li>c\u00e1c nh\u00f3m frontend (dashboard v\u00e0 kh\u1ed1i).</li> </ul> <p>\u0110\u1ec3 tr\u00e1nh s\u1ef1 ph\u00e2n k\u1ef3:</p> <ul> <li>gi\u1eef danh m\u1ee5c entity d\u01b0\u1edbi version control c\u00f9ng v\u1edbi code,</li> <li>x\u1eed l\u00fd c\u00e1c thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi c\u00e1c lo\u1ea1i entity nh\u01b0 c\u00e1c thay \u0111\u1ed5i \u0111\u1ed1i v\u1edbi m\u1ed9t h\u1ee3p \u0111\u1ed3ng c\u00f4ng khai,</li> <li>y\u00eau c\u1ea7u r\u1eb1ng c\u00e1c lo\u1ea1i m\u1edbi ho\u1eb7c \u0111\u00e3 s\u1eeda \u0111\u1ed5i \u0111\u01b0\u1ee3c ghi l\u1ea1i tr\u01b0\u1edbc khi ch\u00fang \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong d\u1eef li\u1ec7u production.</li> </ul> <p>Ngay c\u1ea3 khi m\u1ed9t JSON schema \u0111\u1ea7y \u0111\u1ee7 kh\u00f4ng \u0111\u01b0\u1ee3c duy tr\u00ec, t\u00e0i li\u1ec7u n\u00ean lu\u00f4n bao g\u1ed3m:</p> <ul> <li>t\u00ean lo\u1ea1i v\u00e0 domain,</li> <li>m\u1eabu ID,</li> <li>thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd v\u00e0 th\u1eddi gian,</li> <li>thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i,</li> <li>b\u1ea5t k\u1ef3 m\u1ed1i quan h\u1ec7 quan tr\u1ecdng n\u00e0o.</li> </ul>"},{"location":"vi/user-guide/entities/#11-tom-tat","title":"11. T\u00f3m t\u1eaft","text":"<ul> <li>Entity l\u00e0 c\u00e1c \u0111\u01a1n v\u1ecb c\u01a1 b\u1ea3n c\u1ee7a ng\u1eef c\u1ea3nh th\u00e0nh ph\u1ed1 trong LegoCity; h\u1ea7u h\u1ebft m\u1ecdi th\u1ee9 hi\u1ec3n th\u1ecb trong UI \u0111\u1ec1u \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 b\u1edfi c\u00e1c entity trong broker.</li> <li>M\u1ed7i tri\u1ec3n khai n\u00ean duy tr\u00ec m\u1ed9t danh m\u1ee5c entity li\u1ec7t k\u00ea c\u00e1c lo\u1ea1i, domain, ngu\u1ed3n v\u00e0 thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i, v\u1edbi c\u00e1c v\u00ed d\u1ee5 c\u1ee5 th\u1ec3 nh\u1ecf.</li> <li>Smart Data Model n\u00ean \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1ea5t c\u1ee9 khi n\u00e0o c\u00f3 th\u1ec3; khi c\u1ea7n c\u00e1c m\u00f4 h\u00ecnh t\u00f9y ch\u1ec9nh, ch\u00fang ph\u1ea3i \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 r\u00f5 r\u00e0ng.</li> <li>C\u00e1c m\u1eabu \u0111\u1ecbnh danh, thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd, thu\u1ed9c t\u00ednh th\u1eddi gian v\u00e0 m\u1ed1i quan h\u1ec7 ph\u1ea3i tu\u00e2n theo c\u00e1c quy \u01b0\u1edbc \u0111\u01b0\u1ee3c chia s\u1ebb \u0111\u1ec3 c\u00e1c truy v\u1ea5n v\u00e0 h\u00ecnh \u1ea3nh h\u00f3a ho\u1ea1t \u0111\u1ed9ng d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c.</li> <li>Khi c\u00e1c lo\u1ea1i entity m\u1edbi \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u, ch\u00fang n\u00ean tu\u00e2n theo m\u1ed9t quy tr\u00ecnh thi\u1ebft k\u1ebf nh\u1ea5t qu\u00e1n, \u0111\u01b0\u1ee3c ghi l\u1ea1i v\u00e0 \u0111\u01b0\u1ee3c ki\u1ec3m tra end-to-end tr\u01b0\u1edbc khi \u00e1p d\u1ee5ng.</li> </ul>"},{"location":"vi/user-guide/sample-update-server/","title":"Sample update server","text":"<p>Trang n\u00e0y m\u00f4 t\u1ea3 sample update server n\u00ean \u0111\u01b0\u1ee3c bao g\u1ed3m v\u1edbi LegoCity. Sample l\u00e0 m\u1ed9t d\u1ecbch v\u1ee5 nh\u1ecf, \u0111\u1ed9c l\u1eadp cho th\u1ea5y c\u00e1ch:</p> <ul> <li>\u0111\u1ecdc c\u1ea5u h\u00ecnh (URL broker, token, kh\u00f3a API b\u00ean ngo\u00e0i),</li> <li>l\u1ea5y d\u1eef li\u1ec7u t\u1eeb m\u1ed9t ngu\u1ed3n b\u00ean ngo\u00e0i,</li> <li>chuy\u1ec3n \u0111\u1ed5i n\u00f3 th\u00e0nh c\u00e1c NGSI-LD entity,</li> <li>ghi entity v\u00e0o context broker.</li> </ul> <p>N\u00f3 d\u00e0nh cho:</p> <ul> <li>ng\u01b0\u1eddi d\u00f9ng m\u1edbi mu\u1ed1n x\u00e1c minh broker v\u00e0 lu\u1ed3ng d\u1eef li\u1ec7u c\u1ee7a h\u1ecd,</li> <li>c\u00e1c nh\u00e0 ph\u00e1t tri\u1ec3n c\u1ea7n m\u1ed9t \u0111i\u1ec3m kh\u1edfi \u0111\u1ea7u \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e1c update server th\u1ef1c.</li> </ul>"},{"location":"vi/user-guide/sample-update-server/#muc-ich-va-pham-vi","title":"M\u1ee5c \u0111\u00edch v\u00e0 ph\u1ea1m vi","text":"<p>Sample update server kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n production. M\u1ee5c ti\u00eau c\u1ee7a n\u00f3 l\u00e0:</p> <ul> <li> <p>Tr\u00ecnh di\u1ec5n   Hi\u1ec3n th\u1ecb m\u1ed9t \u0111\u01b0\u1eddng d\u1eabn end-to-end t\u1eeb m\u1ed9t ngu\u1ed3n d\u1eef li\u1ec7u b\u00ean ngo\u00e0i \u0111\u1ebfn c\u00e1c entity trong broker.</p> </li> <li> <p>Template   Cung c\u1ea5p m\u1ed9t c\u1ea5u tr\u00fac t\u1ed1i thi\u1ec3u c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c sao ch\u00e9p v\u00e0 m\u1edf r\u1ed9ng cho c\u00e1c t\u00edch h\u1ee3p th\u1ef1c.</p> </li> <li> <p>X\u00e1c minh   Cho ph\u00e9p c\u00e1c nh\u00e0 v\u1eadn h\u00e0nh nhanh ch\u00f3ng x\u00e1c nh\u1eadn r\u1eb1ng:</p> </li> <li>broker c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c,</li> <li>x\u00e1c th\u1ef1c \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh ch\u00ednh x\u00e1c,</li> <li>c\u00e1c entity tr\u1edf n\u00ean hi\u1ec3n th\u1ecb trong dashboard.</li> </ul> <p>Sample server n\u00ean l\u00e0:</p> <ul> <li>\u0111\u1ee7 nh\u1ecf \u0111\u1ec3 \u0111\u1ecdc trong m\u1ed9t l\u1ea7n ng\u1ed3i,</li> <li>t\u1eadp trung v\u00e0o m\u1ed9t domain (th\u01b0\u1eddng l\u00e0 m\u00f4i tr\u01b0\u1eddng),</li> <li>an to\u00e0n \u0111\u1ec3 ch\u1ea1y trong m\u00f4i tr\u01b0\u1eddng development.</li> </ul>"},{"location":"vi/user-guide/sample-update-server/#vi-du-domain-va-loai-entity","title":"V\u00ed d\u1ee5 domain v\u00e0 lo\u1ea1i entity","text":"<p>\u0110\u1ec3 gi\u1eef cho sample c\u1ee5 th\u1ec3, n\u00f3 \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb t\u1eadp trung v\u00e0o m\u1ed9t domain \u0111\u01a1n gi\u1ea3n nh\u01b0 quan s\u00e1t th\u1eddi ti\u1ebft.</p> <p>L\u1ef1a ch\u1ecdn \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li>Domain: M\u00f4i tr\u01b0\u1eddng</li> <li>Lo\u1ea1i entity: <code>WeatherObserved</code></li> <li>Ngu\u1ed3n d\u1eef li\u1ec7u: API th\u1eddi ti\u1ebft c\u00f4ng khai ho\u1eb7c d\u1eef li\u1ec7u ki\u1ec3m tra t\u0129nh</li> </ul> <p>H\u00e0nh vi mong \u0111\u1ee3i:</p> <ul> <li>l\u1ea5y th\u1eddi ti\u1ebft hi\u1ec7n t\u1ea1i cho m\u1ed9t ho\u1eb7c m\u1ed9t v\u00e0i v\u1ecb tr\u00ed,</li> <li>\u00e1nh x\u1ea1 response th\u00e0nh m\u1ed9t ho\u1eb7c nhi\u1ec1u entity <code>WeatherObserved</code>,</li> <li>ghi c\u00e1c entity v\u00e0o broker,</li> <li>t\u00f9y ch\u1ecdn l\u1eb7p l\u1ea1i \u0111i\u1ec1u n\u00e0y tr\u00ean m\u1ed9t b\u1ed9 \u0111\u1ebfm th\u1eddi gian (v\u00ed d\u1ee5: m\u1ed7i 5\u201310 ph\u00fat).</li> </ul> <p>M\u00f4 h\u00ecnh entity n\u00ean tu\u00e2n theo c\u00e1c quy \u01b0\u1edbc gi\u1ed1ng nh\u01b0 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n Entity:</p> <ul> <li>ID \u1ed5n \u0111\u1ecbnh cho m\u1ed7i v\u1ecb tr\u00ed,</li> <li>thu\u1ed9c t\u00ednh <code>location</code> (Point),</li> <li>timestamp <code>observedAt</code>,</li> <li>c\u00e1c thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i nh\u01b0 <code>temperature</code> v\u00e0 <code>relativeHumidity</code>.</li> </ul>"},{"location":"vi/user-guide/sample-update-server/#vi-tri-repository","title":"V\u1ecb tr\u00ed repository","text":"<p>Repository LegoCity n\u00ean ch\u1ee9a sample update server trong m\u1ed9t th\u01b0 m\u1ee5c \u0111\u01b0\u1ee3c \u0111\u1eb7t t\u00ean r\u00f5 r\u00e0ng, v\u00ed d\u1ee5:</p> <ul> <li><code>services/sample-update-server/</code></li> <li>ho\u1eb7c <code>examples/update-server-weather/</code></li> </ul> <p>Th\u01b0 m\u1ee5c n\u00ean bao g\u1ed3m:</p> <ul> <li>code \u1ee9ng d\u1ee5ng,</li> <li>m\u1ed9t README t\u1ed1i thi\u1ec3u specific cho server,</li> <li>c\u00e1c v\u00ed d\u1ee5 c\u1ea5u h\u00ecnh (v\u00ed d\u1ee5: <code>.env.example</code>),</li> <li>b\u1ea5t k\u1ef3 script ho\u1eb7c Dockerfile n\u00e0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ch\u1ea1y n\u00f3.</li> </ul> <p>Trang t\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 h\u00e0nh vi d\u1ef1 \u0111\u1ecbnh; repository ch\u1ee9a c\u00e1c chi ti\u1ebft tri\u1ec3n khai th\u1ef1c t\u1ebf.</p>"},{"location":"vi/user-guide/sample-update-server/#cau-hinh","title":"C\u1ea5u h\u00ecnh","text":"<p>Sample update server ph\u1ea3i c\u00f3 th\u1ec3 c\u1ea5u h\u00ecnh \u0111\u01b0\u1ee3c ch\u1ec9 th\u00f4ng qua c\u00e1c bi\u1ebfn m\u00f4i tr\u01b0\u1eddng ho\u1eb7c file c\u1ea5u h\u00ecnh, kh\u00f4ng b\u1eb1ng c\u00e1ch ch\u1ec9nh s\u1eeda source code.</p> <p>C\u00e1c bi\u1ebfn c\u1ea5u h\u00ecnh \u0111i\u1ec3n h\u00ecnh:</p> <ul> <li> <p>k\u1ebft n\u1ed1i broker:</p> </li> <li> <p><code>BROKER_URL</code>     URL c\u01a1 s\u1edf c\u1ee7a NGSI-LD context broker.</p> </li> <li> <p><code>BROKER_WRITE_KEY</code> ho\u1eb7c <code>BROKER_WRITE_TOKEN</code>     Th\u00f4ng tin x\u00e1c th\u1ef1c \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 x\u00e1c th\u1ef1c c\u00e1c ho\u1ea1t \u0111\u1ed9ng ghi.</p> </li> <li> <p>ngu\u1ed3n d\u1eef li\u1ec7u b\u00ean ngo\u00e0i:</p> </li> <li> <p><code>WEATHER_API_URL</code>     URL c\u01a1 s\u1edf c\u1ee7a API d\u1eef li\u1ec7u th\u1eddi ti\u1ebft (ho\u1eb7c endpoint).</p> </li> <li> <p><code>WEATHER_API_KEY</code> (t\u00f9y ch\u1ecdn)     Kh\u00f3a API ho\u1eb7c token, n\u1ebfu \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u b\u1edfi d\u1ecbch v\u1ee5 b\u00ean ngo\u00e0i.</p> </li> <li> <p>h\u00e0nh vi \u1ee9ng d\u1ee5ng:</p> </li> <li><code>UPDATE_INTERVAL_SECONDS</code>     T\u1ea7n su\u1ea5t server l\u1ea5y d\u1eef li\u1ec7u v\u00e0 c\u1eadp nh\u1eadt entity.</li> <li><code>LOCATIONS</code>     Danh s\u00e1ch c\u00e1c v\u1ecb tr\u00ed ho\u1eb7c \u0111\u1ecbnh danh tr\u1ea1m \u0111\u1ec3 \u0111\u01b0\u1ee3c gi\u00e1m s\u00e1t (\u0111\u1ecbnh d\u1ea1ng \u0111\u01b0\u1ee3c quy\u1ebft \u0111\u1ecbnh b\u1edfi tri\u1ec3n khai).</li> </ul> <p>V\u00ed d\u1ee5 <code>.env</code> cho development:</p> <pre><code>BROKER_URL=https://dev-broker.example.com/ngsi-ld/v1\nBROKER_WRITE_KEY=dev-broker-write-key\nWEATHER_API_URL=https://api.example.com/weather\nWEATHER_API_KEY=dev-weather-api-key\nUPDATE_INTERVAL_SECONDS=300\nLOCATIONS=CTU_CAMPUS,CTU_CITY_CENTER\n</code></pre> <p>C\u00e1c t\u00ean v\u00e0 \u0111\u1ecbnh d\u1ea1ng th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 kh\u00e1c nhau, nh\u01b0ng ch\u00fang ph\u1ea3i \u0111\u01b0\u1ee3c ghi l\u1ea1i r\u00f5 r\u00e0ng trong README c\u1ee7a sample server.</p>"},{"location":"vi/user-guide/sample-update-server/#quy-trinh-cong-viec-cap-cao","title":"Quy tr\u00ecnh c\u00f4ng vi\u1ec7c c\u1ea5p cao","text":"<p>Sample update server tu\u00e2n theo m\u1ed9t v\u00f2ng l\u1eb7p \u0111\u01a1n gi\u1ea3n:</p> <ol> <li> <p>T\u1ea3i c\u1ea5u h\u00ecnh</p> </li> <li> <p>\u0111\u1ecdc c\u00e0i \u0111\u1eb7t broker,</p> </li> <li>\u0111\u1ecdc c\u00e0i \u0111\u1eb7t API b\u00ean ngo\u00e0i,</li> <li>\u0111\u1ecdc danh s\u00e1ch c\u00e1c v\u1ecb tr\u00ed ho\u1eb7c tr\u1ea1m,</li> <li> <p>\u0111\u1ecdc kho\u1ea3ng th\u1eddi gian c\u1eadp nh\u1eadt.</p> </li> <li> <p>L\u1ea5y d\u1eef li\u1ec7u b\u00ean ngo\u00e0i</p> </li> <li> <p>cho m\u1ed7i v\u1ecb tr\u00ed trong <code>LOCATIONS</code>, g\u1ecdi API th\u1eddi ti\u1ebft,</p> </li> <li>x\u1eed l\u00fd c\u00e1c l\u1ed7i c\u01a1 b\u1ea3n (v\u1ea5n \u0111\u1ec1 m\u1ea1ng, response kh\u00f4ng h\u1ee3p l\u1ec7),</li> <li> <p>log c\u00e1c l\u1ed7i m\u00e0 kh\u00f4ng crash ngay l\u1eadp t\u1ee9c.</p> </li> <li> <p>Chuy\u1ec3n \u0111\u1ed5i th\u00e0nh entity</p> </li> <li> <p>cho m\u1ed7i v\u1ecb tr\u00ed v\u00e0 response t\u01b0\u01a1ng \u1ee9ng:</p> <ul> <li>ch\u1ecdn m\u1ed9t ID entity (v\u00ed d\u1ee5: <code>urn:ngsi-ld:WeatherObserved:ctu:station:CTU_CAMPUS</code>),</li> <li>x\u00e2y d\u1ef1ng m\u1ed9t entity v\u1edbi:</li> <li><code>type = \"WeatherObserved\"</code>,</li> <li><code>location</code> nh\u01b0 m\u1ed9t thu\u1ed9c t\u00ednh kh\u00f4ng gian \u0111\u1ecba l\u00fd (Point),</li> <li>th\u1eddi gian <code>observedAt</code>,</li> <li>c\u00e1c thu\u1ed9c t\u00ednh c\u1ed1t l\u00f5i (v\u00ed d\u1ee5: <code>temperature</code>, <code>relativeHumidity</code>, <code>pressure</code>),</li> <li>tu\u00e2n theo c\u00e1c quy \u01b0\u1edbc entity c\u1ee7a d\u1ef1 \u00e1n.</li> </ul> </li> <li> <p>Ghi entity v\u00e0o broker</p> </li> <li> <p>g\u1eedi c\u00e1c request t\u1ea1o ho\u1eb7c c\u1eadp nh\u1eadt \u0111\u1ebfn endpoint entity c\u1ee7a broker,</p> </li> <li>x\u1eed l\u00fd c\u00e1c l\u1ed7i HTTP v\u00e0 log ch\u00fang,</li> <li> <p>x\u00e1c nh\u1eadn th\u00e0nh c\u00f4ng v\u1edbi logging c\u01a1 b\u1ea3n (v\u00ed d\u1ee5: \"\u0111\u00e3 c\u1eadp nh\u1eadt 2 entity\").</p> </li> <li> <p>\u0110\u1ee3i v\u00e0 l\u1eb7p l\u1ea1i</p> </li> <li>ng\u1ee7 trong <code>UPDATE_INTERVAL_SECONDS</code>,</li> <li>l\u1eb7p l\u1ea1i v\u00f2ng l\u1eb7p trong khi ti\u1ebfn tr\u00ecnh \u0111ang ch\u1ea1y.</li> </ol> <p>Trong m\u00f4i tr\u01b0\u1eddng development, m\u1ed9t l\u1ea7n l\u1eb7p duy nh\u1ea5t (kh\u00f4ng c\u00f3 v\u00f2ng l\u1eb7p) c\u00f3 th\u1ec3 \u0111\u1ee7 \u0111\u1ec3 x\u00e1c nh\u1eadn c\u1ea5u h\u00ecnh.</p>"},{"location":"vi/user-guide/sample-update-server/#chay-sample-server","title":"Ch\u1ea1y sample server","text":"<p>C\u00e1c l\u1ec7nh ch\u00ednh x\u00e1c ph\u1ee5 thu\u1ed9c v\u00e0o stack \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng (v\u00ed d\u1ee5: Go, Node.js ho\u1eb7c ng\u00f4n ng\u1eef kh\u00e1c), nh\u01b0ng quy tr\u00ecnh chung l\u00e0:</p> <ol> <li> <p>Chu\u1ea9n b\u1ecb m\u00f4i tr\u01b0\u1eddng</p> </li> <li> <p>\u0111\u1ea3m b\u1ea3o r\u1eb1ng m\u1ed9t context broker \u0111ang ch\u1ea1y v\u00e0 c\u00f3 th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c t\u1ea1i URL b\u1ea1n d\u1ef1 \u0111\u1ecbnh s\u1eed d\u1ee5ng,</p> </li> <li> <p>\u0111\u1ea3m b\u1ea3o r\u1eb1ng m\u1ed9t kh\u00f3a ghi ho\u1eb7c token \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh v\u00e0 h\u1ee3p l\u1ec7.</p> </li> <li> <p>Clone repository</p> </li> <li> <p>clone repository LegoCity,</p> </li> <li> <p>chuy\u1ec3n v\u00e0o th\u01b0 m\u1ee5c sample server:</p> <ul> <li>v\u00ed d\u1ee5: <code>cd services/sample-update-server</code>    ho\u1eb7c <code>cd examples/update-server-weather</code>.</li> </ul> </li> <li> <p>T\u1ea1o c\u1ea5u h\u00ecnh</p> </li> <li> <p>sao ch\u00e9p file c\u1ea5u h\u00ecnh v\u00ed d\u1ee5, v\u00ed d\u1ee5:</p> <ul> <li>sao ch\u00e9p <code>.env.example</code> sang <code>.env</code>,</li> </ul> </li> <li> <p>\u0111i\u1ec1n v\u00e0o:</p> <ul> <li><code>BROKER_URL</code>,</li> <li><code>BROKER_WRITE_KEY</code> ho\u1eb7c token,</li> <li><code>WEATHER_API_URL</code>,</li> <li><code>WEATHER_API_KEY</code> n\u1ebfu c\u1ea7n,</li> <li><code>LOCATIONS</code> v\u00e0 <code>UPDATE_INTERVAL_SECONDS</code>.</li> </ul> </li> <li> <p>C\u00e0i \u0111\u1eb7t dependencies</p> </li> <li> <p>c\u00e0i \u0111\u1eb7t dependencies theo tri\u1ec3n khai (v\u00ed d\u1ee5: <code>npm install</code>, ho\u1eb7c build m\u1ed9t binary Go).</p> </li> <li> <p>Ch\u1ea1y server</p> </li> <li> <p>kh\u1edfi \u0111\u1ed9ng \u1ee9ng d\u1ee5ng (v\u00ed d\u1ee5: <code>npm run start</code> ho\u1eb7c <code>./sample-update-server</code>),</p> </li> <li> <p>ki\u1ec3m tra log \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng:</p> <ul> <li>c\u1ea5u h\u00ecnh \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea3i,</li> <li>c\u00e1c request \u0111\u1ebfn API b\u00ean ngo\u00e0i th\u00e0nh c\u00f4ng,</li> <li>c\u00e1c entity \u0111\u00e3 \u0111\u01b0\u1ee3c ghi v\u00e0o broker.</li> </ul> </li> <li> <p>X\u00e1c minh trong broker v\u00e0 dashboard</p> </li> <li> <p>truy v\u1ea5n broker ho\u1eb7c s\u1eed d\u1ee5ng UI qu\u1ea3n l\u00fd c\u1ee7a n\u00f3 \u0111\u1ec3 x\u00e1c nh\u1eadn r\u1eb1ng:</p> <ul> <li>c\u00e1c entity <code>WeatherObserved</code> t\u1ed3n t\u1ea1i,</li> <li>c\u00e1c thu\u1ed9c t\u00ednh v\u00e0 v\u1ecb tr\u00ed c\u00f3 gi\u00e1 tr\u1ecb h\u1ee3p l\u00fd.</li> </ul> </li> <li>n\u1ebfu dashboard LegoCity \u0111ang ch\u1ea1y:<ul> <li>m\u1edf view b\u1ea3n \u0111\u1ed3 t\u01b0\u01a1ng \u1ee9ng,</li> <li>x\u00e1c nh\u1eadn r\u1eb1ng c\u00e1c d\u1ea5u hi\u1ec7u th\u1eddi ti\u1ebft xu\u1ea5t hi\u1ec7n \u1edf c\u00e1c v\u1ecb tr\u00ed mong \u0111\u1ee3i.</li> </ul> </li> </ol>"},{"location":"vi/user-guide/sample-update-server/#hanh-vi-va-log-mong-oi","title":"H\u00e0nh vi v\u00e0 log mong \u0111\u1ee3i","text":"<p>Sample server n\u00ean t\u1ea1o ra c\u00e1c log r\u00f5 r\u00e0ng, t\u1ed1i thi\u1ec3u. V\u00ed d\u1ee5 v\u1ec1 c\u00e1c th\u00f4ng b\u00e1o log (v\u1ec1 m\u1eb7t kh\u00e1i ni\u1ec7m):</p> <ul> <li> <p>khi kh\u1edfi \u0111\u1ed9ng:</p> </li> <li> <p>\"\u0110\u00e3 t\u1ea3i c\u1ea5u h\u00ecnh: 2 v\u1ecb tr\u00ed, kho\u1ea3ng th\u1eddi gian c\u1eadp nh\u1eadt 300 gi\u00e2y.\"</p> </li> <li> <p>tr\u00ean c\u1eadp nh\u1eadt th\u00e0nh c\u00f4ng:</p> </li> <li> <p>\"\u0110\u00e3 l\u1ea5y d\u1eef li\u1ec7u th\u1eddi ti\u1ebft cho CTU_CAMPUS (nhi\u1ec7t \u0111\u1ed9 30.1 \u00b0C).\"</p> </li> <li>\"\u0110\u00e3 c\u1eadp nh\u1eadt entity urn:ngsi-ld:WeatherObserved:ctu:station:CTU_CAMPUS.\"</li> <li> <p>\"Chu k\u1ef3 c\u1eadp nh\u1eadt ho\u00e0n th\u00e0nh: 2 entity \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.\"</p> </li> <li> <p>tr\u00ean l\u1ed7i:</p> </li> <li>\"Kh\u00f4ng l\u1ea5y \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u th\u1eddi ti\u1ebft cho CTU_CITY_CENTER: HTTP 500 t\u1eeb API.\"</li> <li>\"Kh\u00f4ng ghi \u0111\u01b0\u1ee3c entity urn:... v\u00e0o broker: HTTP 401 (unauthorized).\"</li> </ul> <p>M\u1ee5c \u0111\u00edch l\u00e0 gi\u00fap c\u00e1c nh\u00e0 v\u1eadn h\u00e0nh d\u1ec5 d\u00e0ng th\u1ea5y:</p> <ul> <li>li\u1ec7u d\u1eef li\u1ec7u b\u00ean ngo\u00e0i c\u00f3 s\u1eb5n kh\u00f4ng,</li> <li>li\u1ec7u x\u00e1c th\u1ef1c v\u1edbi broker c\u00f3 ho\u1ea1t \u0111\u1ed9ng kh\u00f4ng,</li> <li>li\u1ec7u h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u (c\u1ea5u tr\u00fac entity) c\u00f3 \u0111\u01b0\u1ee3c t\u00f4n tr\u1ecdng kh\u00f4ng.</li> </ul>"},{"location":"vi/user-guide/sample-update-server/#mo-rong-sample-server","title":"M\u1edf r\u1ed9ng sample server","text":"<p>Khi sample server ho\u1ea1t \u0111\u1ed9ng trong development, c\u00e1c nh\u00f3m c\u00f3 th\u1ec3:</p> <ul> <li>sao ch\u00e9p d\u1ef1 \u00e1n v\u00e0 \u0111i\u1ec1u ch\u1ec9nh n\u00f3 cho c\u00e1c domain kh\u00e1c (v\u00ed d\u1ee5: l\u0169 l\u1ee5t ho\u1eb7c \u0111\u1ed7 xe),</li> <li>ho\u1eb7c m\u1edf r\u1ed9ng c\u00f9ng m\u1ed9t server \u0111\u1ec3 x\u1eed l\u00fd c\u00e1c lo\u1ea1i entity b\u1ed5 sung.</li> </ul> <p>C\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb khi m\u1edf r\u1ed9ng:</p> <ul> <li> <p>gi\u1eef c\u1ea5u h\u00ecnh domain-specific:</p> </li> <li> <p>c\u00e1c bi\u1ebfn m\u00f4i tr\u01b0\u1eddng m\u1edbi cho c\u00e1c ngu\u1ed3n m\u1edbi,</p> </li> <li> <p>c\u1ea5u h\u00ecnh c\u00f3 c\u1ea5u tr\u00fac cho nhi\u1ec1u domain n\u1ebfu s\u1eed d\u1ee5ng m\u1ed9t ti\u1ebfn tr\u00ecnh duy nh\u1ea5t.</p> </li> <li> <p>gi\u1eef logic chuy\u1ec3n \u0111\u1ed5i ri\u00eang bi\u1ec7t cho m\u1ed7i lo\u1ea1i entity:</p> </li> <li> <p>m\u1ed9t h\u00e0m ho\u1eb7c module cho m\u1ed7i lo\u1ea1i (<code>WeatherObserved</code>, <code>FloodZone</code>, v.v.),</p> </li> <li> <p>tr\u00e1nh tr\u1ed9n c\u00e1c chuy\u1ec3n \u0111\u1ed5i kh\u00f4ng li\u00ean quan v\u00e0o m\u1ed9t kh\u1ed1i l\u1edbn.</p> </li> <li> <p>gi\u1eef logging v\u00e0 x\u1eed l\u00fd l\u1ed7i nh\u1ea5t qu\u00e1n:</p> </li> <li>c\u00e1c th\u00f4ng b\u00e1o log t\u01b0\u01a1ng t\u1ef1 tr\u00ean c\u00e1c server,</li> <li>m\u00e3 l\u1ed7i v\u00e0 m\u00f4 t\u1ea3 r\u00f5 r\u00e0ng.</li> </ul>"},{"location":"vi/user-guide/sample-update-server/#moi-quan-he-voi-tai-lieu-khac","title":"M\u1ed1i quan h\u1ec7 v\u1edbi t\u00e0i li\u1ec7u kh\u00e1c","text":"<p>Trang n\u00e0y t\u1eadp trung v\u00e0o h\u00e0nh vi kh\u00e1i ni\u1ec7m v\u00e0 c\u1ea5u h\u00ecnh c\u1ee7a sample update server.</p> <p>C\u00e1c t\u00e0i li\u1ec7u li\u00ean quan:</p> <ul> <li> <p>D\u1eef li\u1ec7u v\u00e0 broker   Gi\u1ea3i th\u00edch lu\u1ed3ng d\u1eef li\u1ec7u t\u1ed5ng th\u1ec3 v\u00e0 vai tr\u00f2 c\u1ee7a c\u00e1c broker v\u00e0 update server.</p> </li> <li> <p>Entity   M\u00f4 t\u1ea3 c\u00e1c lo\u1ea1i entity, domain v\u00e0 h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u m\u00e0 sample ph\u1ea3i tu\u00e2n theo.</p> </li> <li> <p>Kh\u00f3a API v\u00e0 ki\u1ec3m so\u00e1t truy c\u1eadp   Gi\u1ea3i th\u00edch c\u00e1ch c\u1ea5u h\u00ecnh v\u00e0 qu\u1ea3n l\u00fd token ghi v\u00e0 URL broker.</p> </li> </ul> <p>Sample update server n\u00ean tri\u1ec3n khai c\u00e1c m\u1eabu \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong c\u00e1c t\u00e0i li\u1ec7u n\u00e0y, \u0111\u1ec3 n\u00f3 ph\u1ee5c v\u1ee5 nh\u01b0 m\u1ed9t v\u00ed d\u1ee5 th\u1ef1c t\u1ebf cho c\u00e1c t\u00edch h\u1ee3p t\u01b0\u01a1ng lai.</p>"},{"location":"vi/user-guide/sample-update-server/#tom-tat","title":"T\u00f3m t\u1eaft","text":"<ul> <li>Sample update server l\u00e0 m\u1ed9t d\u1ecbch v\u1ee5 nh\u1ecf, \u0111\u1ed9c l\u1eadp tr\u00ecnh di\u1ec5n c\u00e1ch l\u1ea5y d\u1eef li\u1ec7u b\u00ean ngo\u00e0i, chuy\u1ec3n \u0111\u1ed5i n\u00f3 th\u00e0nh c\u00e1c NGSI-LD entity v\u00e0 ghi c\u00e1c entity \u0111\u00f3 v\u00e0o broker.</li> <li>N\u00f3 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 d\u1ec5 d\u00e0ng ch\u1ea1y trong development \u0111\u1ec3 x\u00e1c minh c\u1ea5u h\u00ecnh v\u00e0 lu\u1ed3ng d\u1eef li\u1ec7u.</li> <li>C\u1ea5u h\u00ecnh \u0111\u01b0\u1ee3c x\u1eed l\u00fd th\u00f4ng qua c\u00e1c bi\u1ebfn m\u00f4i tr\u01b0\u1eddng, bao g\u1ed3m chi ti\u1ebft k\u1ebft n\u1ed1i broker, c\u00e0i \u0111\u1eb7t API b\u00ean ngo\u00e0i, v\u1ecb tr\u00ed v\u00e0 kho\u1ea3ng th\u1eddi gian c\u1eadp nh\u1eadt.</li> <li>Sample t\u1eadp trung v\u00e0o m\u1ed9t lo\u1ea1i entity (th\u01b0\u1eddng l\u00e0 <code>WeatherObserved</code> trong domain M\u00f4i tr\u01b0\u1eddng) nh\u01b0ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng ho\u1eb7c sao ch\u00e9p cho c\u00e1c domain kh\u00e1c.</li> <li>Log n\u00ean l\u00e0m r\u00f5 li\u1ec7u d\u1eef li\u1ec7u b\u00ean ngo\u00e0i, quy\u1ec1n truy c\u1eadp broker v\u00e0 t\u1ea1o entity c\u00f3 ho\u1ea1t \u0111\u1ed9ng nh\u01b0 mong \u0111\u1ee3i kh\u00f4ng.</li> <li>Tri\u1ec3n khai ph\u1ea3i ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c h\u1ee3p \u0111\u1ed3ng d\u1eef li\u1ec7u v\u00e0 c\u00e1c m\u1eabu b\u1ea3o m\u1eadt \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a t\u00e0i li\u1ec7u LegoCity.</li> </ul>"}]}